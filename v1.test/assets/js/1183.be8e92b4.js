(window.webpackJsonp=window.webpackJsonp||[]).push([[1183],{2747:function(t,s,a){"use strict";a.r(s);var e=a(19),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"польотні-завдання"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#польотні-завдання"}},[t._v("#")]),t._v(" Польотні завдання")]),t._v(" "),a("p",[a("em",[t._v("Польотні завдання")]),t._v(" використовуються у "),a("RouterLink",{attrs:{to:"/uk/concept/flight_modes.html"}},[t._v("Режимах польоту")]),t._v(' для забезпечення певної поведінки під час руху, наприклад "слідуй за мною" або пом\'якшування польоту.')],1),t._v(" "),a("h2",{attrs:{id:"загальнии-огляд"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#загальнии-огляд"}},[t._v("#")]),t._v(" Загальний огляд")]),t._v(" "),a("p",[t._v("Польотне завдання є класом в програмному каркасі польотних завдань похідним від базового класу "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/flight_mode_manager/tasks/FlightTask/FlightTask.hpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("FlightTask"),a("OutboundLink")],1),t._v(". Його мета - генерувати задані значення для контролера з довільних вхідних даних, де кожне завдання реалізує бажану поведінку рухомого засобу для певного режиму. Розробники як правило перевизначаються віртуальні методи "),a("code",[t._v("activate()")]),t._v(" та "),a("code",[t._v("update()")]),t._v(" викликаючи мінімальну реалізацію базового завдання та розширяючи її реалізацією бажаної поведінки. Метод "),a("code",[t._v("activate()")]),t._v(" викликається при перемиканні на завдання та дозволяє ініціалізувати його стан й м'яко перебрати на себе функціонал базуючись на заданих значеннях які попереднє завдання тільки передало.")]),t._v(" "),a("p",[a("code",[t._v("update()")]),t._v(" викликається на кожній ітерації циклу під час виконання і містить реалізацію базової поведінки створення заданих значень.")]),t._v(" "),a("p",[t._v("За загальним правилом, завдання містяться у піддиректорії "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/main/src/modules/flight_mode_manager/tasks",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/src/modules/flight_mode_manager/tasks"),a("OutboundLink")],1),t._v(' за назвою завдання, а назви файлів вихідного коду мають префікс "FlightTask".')]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("Відео огляди із зібрань розробників PX4 "),a("a",{attrs:{href:"#video"}},[t._v("надано нижче")]),t._v(".")])]),t._v(" "),a("h2",{attrs:{id:"створення-польотного-завдання"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#створення-польотного-завдання"}},[t._v("#")]),t._v(" Створення польотного завдання")]),t._v(" "),a("p",[t._v("Нижченаведені інструкції можуть бути використані для створення завдання "),a("em",[t._v("MyTask")]),t._v(":")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Створіть каталог для нової польотної задачі в "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/main/src/modules/flight_mode_manager/tasks",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/src/modules/flight_mode_manager/tasks"),a("OutboundLink")],1),t._v(". За правилами директорія називається за завданням, тому ми назвемо її "),a("strong",[t._v("/MyTask")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" PX4-Autopilot/src/modules/flight_mode_manager/tasks/MyTask\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Створіть порожні файли вихідного коду та налаштування "),a("em",[t._v("cmake")]),t._v(" для нового завдання у директорії "),a("em",[t._v("MyTask")]),t._v(' використовуючи префікс "FlightTask":')]),t._v(" "),a("ul",[a("li",[t._v("CMakeLists.txt")]),t._v(" "),a("li",[t._v("FlightTaskMyTask.hpp")]),t._v(" "),a("li",[t._v("FlightTaskMyTask.cpp")])])]),t._v(" "),a("li",[a("p",[t._v("Оновіть "),a("strong",[t._v("CMakeLists.txt")]),t._v(" для нового завдання")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Скопіюйте вміст "),a("strong",[t._v("CMakeLists.txt")]),t._v(" з іншого завдання, наприклад, "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/flight_mode_manager/tasks/Orbit/CMakeLists.txt",target:"_blank",rel:"noopener noreferrer"}},[t._v("Orbit/CMakeLists.txt"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("Оновіть відмітку про авторське право до поточного року")]),t._v(" "),a("div",{staticClass:"language-cmake extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############################################################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   Copyright (c) 2021 PX4 Development Team. All rights reserved.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Модифікуйте код щоб він відповідав новому завданню, наприклад замініть "),a("code",[t._v("FlightTaskOrbit")]),t._v(" на "),a("code",[t._v("FlightTaskMyTask")]),t._v(". Код буде виглядати приблизно так:")]),t._v(" "),a("div",{staticClass:"language-cmake extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("px4_add_library")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightTaskMyTask\n    FlightTaskMyTask.cpp\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("target_link_libraries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightTaskMyTask "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("PUBLIC")]),t._v(" FlightTask"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("target_include_directories")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightTaskMyTask "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("PUBLIC")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("CMAKE_CURRENT_SOURCE_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("Оновіть файл заголовків (у цьому випадку "),a("strong",[t._v("FlightTaskMyTask. pp")]),t._v("): Більшість завдань повторно реалізує віртуальні методи "),a("code",[t._v("activate()")]),t._v(" і "),a("code",[t._v("update()")]),t._v(", в цьому прикладі ми також маємо приватну змінну.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("pragma")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token expression"}},[t._v("once")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FlightTask.hpp"')])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlightTaskMyTask")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token base-clause"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlightTask")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FlightTaskMyTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("virtual")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FlightTaskMyTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" trajectory_setpoint_s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("last_setpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),t._v(" _origin_z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.f")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Оновіть cpp файли відповідно. Цей приклад надає як просту реалізацію "),a("strong",[t._v("FlightTaskMyTask.cpp")]),t._v(", яка просто показує, що методи завдань викликаються.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FlightTaskMyTask.hpp"')])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlightTaskMyTask")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" trajectory_setpoint_s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("last_setpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlightTask")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("last_setpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PX4_INFO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FlightTaskMyTask activate was called! ret: %d"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// report if activation was successful")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlightTaskMyTask")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PX4_INFO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FlightTaskMyTask update was called!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// report update")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Додайте нове завдання до списку завдань, які будуть зібрані в "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/flight_mode_manager/CMakeLists.txt#L40",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/src/modules/flight_mode_manager/CMakeLists.txt"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-cmake extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" px4_constrained_flash_build"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPEND flight_tasks_all\n  AutoFollowTarget\n  Orbit\n  MyTask\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("endif")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n...\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Оновіть режим польоту, щоб переконатися, що завдання було викликано. Зазвичай для обрання певного польотного завдання використовується параметр.")]),t._v(" "),a("p",[t._v("Наприклад, щоб активувати наше нове завдання "),a("code",[t._v("MyTask")]),t._v(" в позиційному режимі мультикоптера:")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Оновіть "),a("code",[t._v("MPC_POS_MODE")]),t._v(" ("),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/mc_pos_control/multicopter_position_mode_params.c",target:"_blank",rel:"noopener noreferrer"}},[t._v("multicopter_position_mode_params."),a("OutboundLink")],1),t._v('), щоб додати варіант для вибору "MyTask", якщо параметр має раніше невикористане значення, наприклад 5:')]),t._v(" "),a("div",{staticClass:"language-c extra-class"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" @value "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" Direct velocity\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" @value "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" Smoothed velocity\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" @value "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" Acceleration based\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" @value "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" My task\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" @group Multicopter Position Control\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PARAM_DEFINE_INT32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MPC_POS_MODE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Додайте мітку case для нового варіанту в операторі switch для параметра в "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/flight_mode_manager/FlightModeManager.cpp#L266-L285",target:"_blank",rel:"noopener noreferrer"}},[t._v("FlightModeManager.cpp"),a("OutboundLink")],1),t._v(", щоб увімкнути завдання коли "),a("code",[t._v("_param_mpc_pos_mode")]),t._v(" має відповідне значення.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// manual position control")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_param_mpc_pos_mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n     error "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("switchTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightTaskIndex"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("ManualPositionSmoothVel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add case for new task: MyTask")]),t._v("\n     error "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("switchTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FlightTaskIndex"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("MyTask"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])])])])])]),t._v(" "),a("h2",{attrs:{id:"перевірка-нового-польотного-завдання"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#перевірка-нового-польотного-завдання"}},[t._v("#")]),t._v(" Перевірка нового польотного завдання")]),t._v(" "),a("p",[t._v("Щоб перевірити польотне завдання треба запустити рухомий засіб з увімкненим завданням. Для прикладу вище це означає встановити параметр "),a("code",[t._v("MPC_POS_MODE")]),t._v(" у 5, злетіти та перемикнути засіб у "),a("RouterLink",{attrs:{to:"/uk/flight_modes_mc/position.html"}},[t._v("Режим позиціювання")]),t._v(".")],1),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("Завдання, визначене вище, повинно перевірятися тільки на симуляторі.\nКод не створює заданих значень, тому засіб не полетить.")])]),t._v(" "),a("p",[t._v("Зберіть симуляцію SITL (gazebo-classic)")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gazebo-classic\n")])])]),a("p",[t._v("Відкрийте QGroundControl (якщо не відкрито, жодне повідомлення не буде надруковано). В консолі, злетіть та перемкніться у режим позиціювання:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("pxh"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" commander takeoff\npxh"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" commander mode posctl\n")])])]),a("p",[t._v("Консоль постійно буде показувати: "),a("code",[t._v("INFO [FlightTaskMyTask] FlightTaskMyTask update was called!")]),t._v(". Якщо ви хочете змінити режим польоту на інший, ви можете ввести команду для зміни режиму, наприклад "),a("code",[t._v("commander mode altctl")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"відео"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#відео"}},[t._v("#")]),t._v(" Відео")]),t._v(" "),a("p",[t._v("Наступні відео дають огляд польотних завдань в PX4. Перше охоплює стан програмного каркаса для польотних завдань в PX4 v1.9. Друге - це оновлення, яке охоплює зміни в PX4 v1.11.")]),t._v(" "),a("h3",{attrs:{id:"огляд-архітектури-польотних-завдань-px4-px4-developer-summit-2019"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#огляд-архітектури-польотних-завдань-px4-px4-developer-summit-2019"}},[t._v("#")]),t._v(" Огляд архітектури польотних завдань PX4 (PX4 Developer Summit 2019)")]),t._v(" "),a("p",[t._v("Опис того, як працюють режими польоту у PX4 v1.9 (Dennis Mannhart, Matthias Grob).")]),t._v(" "),a("p"),a("div",{staticClass:"embed-responsive embed-responsive-16by9"},[a("iframe",{staticClass:"embed-responsive-item youtube-player",attrs:{type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/-dkQG8YLffc",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""}})]),a("p"),t._v(" "),a("h3",{attrs:{id:"огляд-управління-мультикоптером-від-датчиків-до-двигунів-px4-developer-summit-virtual-2020"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#огляд-управління-мультикоптером-від-датчиків-до-двигунів-px4-developer-summit-virtual-2020"}},[t._v("#")]),t._v(" Огляд управління мультикоптером від датчиків до двигунів (PX4 Developer Summit Virtual 2020)")]),t._v(" "),a("p"),a("div",{staticClass:"embed-responsive embed-responsive-16by9"},[a("iframe",{staticClass:"embed-responsive-item youtube-player",attrs:{type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/orvng_11ngQ",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""}})]),a("p"),t._v(" "),a("p",[t._v("Відповідний розділ цього відео з оновленою інформацією про польотні завдання в PX4 v11.1 на (9 мін. 20 сек.). "),a("a",{attrs:{href:"https://static.sched.com/hosted_files/px4developersummitvirtual2020/1b/PX4%20Developer%20Summit%202020%20-%20Overview%20of%20multicopter%20control%20from%20sensors%20to%20motors.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("Слайди знаходяться тут (PDF)"),a("OutboundLink")],1),t._v(", відповідні слайди - 9 та 12.")])])}),[],!1,null,null,null);s.default=n.exports}}]);