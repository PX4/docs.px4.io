import{_ as t,a as e}from"./chunks/control_allocation_pipeline.BoExmcYK.js";import{_ as i,c as l,a8 as r,o as s}from"./chunks/framework.BDnHobkS.js";const u=JSON.parse('{"title":"Розподіл керування (змішування)","description":"","frontmatter":{},"headers":[],"relativePath":"uk/concept/control_allocation.md","filePath":"uk/concept/control_allocation.md"}'),o={name:"uk/concept/control_allocation.md"};function n(p,a,h,c,d,m){return s(),l("div",null,a[0]||(a[0]=[r('<h1 id="розподіл-керування-змішування" tabindex="-1">Розподіл керування (змішування) <a class="header-anchor" href="#розподіл-керування-змішування" aria-label="Permalink to &quot;Розподіл керування (змішування)&quot;">​</a></h1><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Розподіл керування замінює застарілий підхід змішування, який використовувався в PX4 v1.13 або раніше. Документацію по PX4 v1.13 дивіться в: <a href="https://docs.px4.io/v1.13/en/concept/mixing.html" target="_blank" rel="noreferrer">Змішування та приводи</a>, <a href="https://docs.px4.io/v1.13/en/concept/geometry_files.html" target="_blank" rel="noreferrer">Файли геометрії</a> та <a href="https://docs.px4.io/v1.13/en/dev_airframes/adding_a_new_frame.html" target="_blank" rel="noreferrer">Додавання налаштувань нового планера</a>.</p></div><p>PX4 приймає бажані команди моменту та тяги від основних контролерів і перекладає їх у команди приводів, які керують двигунами чи сервоприводами.</p><p>Переклад залежить від фізичної геометрії планеру. Скажемо наприклад, за командою моменту &quot;повернути праворуч&quot;:</p><ul><li>Літак з одним сервоприводом на елерон накаже одному сервоприводу підняти, а іншому опустити їх.</li><li>Мультикоптер порине вправо змінивши швидкість всіх двигунів.</li></ul><p>PX4 відокремлює цю логіку перекладу, що називається &quot;змішуванням&quot;, від контролера позиції/швидкості. Це гарантує, що основним контролерам не потрібна особлива обробка для кожної геометрії планерів і значно покращує повторне використання.</p><p>Крім того, PX4 абстрагує відображення функцій виводу до конкретних апаратних виходів. Це означає, що будь-який двигун або сервопривід може бути призначений майже на будь-який фізичний вивід.</p><p><img src="'+t+'" alt="Огляд змішування"></p><h2 id="конвеєр-керування-приводами" tabindex="-1">Конвеєр керування приводами <a class="header-anchor" href="#конвеєр-керування-приводами" aria-label="Permalink to &quot;Конвеєр керування приводами&quot;">​</a></h2><p>Огляд конвеєрів змішування в термінах модулів та uORB (натисніть для показу в повноекранному режимі):</p><p><img src="'+e+`" alt="Pipeline Overview"></p><p>Примітки:</p><ul><li>Регулятор швидкості видає задані значення моменту та тяги</li><li>модуль <code>control_allocator</code>: <ul><li>обробляє різні геометрії на основі параметрів конфігурації</li><li>робить змішування</li><li>обробляє відмови двигунів</li><li>публікує сигнали керування двигуном та сервоприводами</li><li>публікує корекції для сервоприводів окремо щоб їх можна було додати як відхилення при <a href="./../config/actuators.html#actuator-testing">перевірці приводів</a> (використовуючи тестувальні повзунки).</li></ul></li><li>Драйвери виходу: <ul><li>обробляють апаратну ініціалізацію та оновлення</li><li>використовують поділювану бібліотеку <a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/lib/mixer_module/" target="_blank" rel="noreferrer">src/libs/mixer_module</a>. Драйвер визначає префікс параметру, наприклад <code>PWM_MAIN</code>, який бібліотека використовує для налаштування. Її головне завдання зробити вибірку з вхідних дані та призначити правильні дані на виходи засновуючись на встановлених користувачем значеннях параметрів <code>&lt;param_prefix&gt;_FUNCx</code>. Наприклад, якщо <code>PWM_MAIN_FUNC3</code> встановлено у <strong>Motor 2</strong>, це означає що на 2-й двигун з <code>actuator_motors</code> встановлено 3-й вивід.</li><li>функції виводу визначаються у <a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/lib/mixer_module/output_functions.yaml" target="_blank" rel="noreferrer">src/lib/mixer_module/output_functions.yaml</a>.</li></ul></li><li>якщо ви хочете керувати виводом з MAVLink, встановіть відповідну вихідну функцію в <strong>Offboard Actuator Set x</strong>, а потім відправте MAVLink команду <a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_ACTUATOR" target="_blank" rel="noreferrer">MAV_CMD_DO_SETUATOR</a>.</li></ul><h2 id="додавання-новоі-геометріі-або-функціі-виводу" tabindex="-1">Додавання нової геометрії або функції виводу <a class="header-anchor" href="#додавання-новоі-геометріі-або-функціі-виводу" aria-label="Permalink to &quot;Додавання нової геометрії або функції виводу&quot;">​</a></h2><p>Дивіться <a href="https://github.com/PX4/PX4-Autopilot/commit/5cdb6fbd8e1352dcb94bd58918da405f8ff930d7" target="_blank" rel="noreferrer">цей коміт</a> як додати нову геометрію. Інтерфейс QGC автоматично покаже правильний інтерфейс налаштування, коли в новій геометрії встановлено <a href="./../advanced_config/parameter_reference.html#CA_AIRFRAME">CA_AIRFRAME</a>.</p><p><a href="https://github.com/PX4/PX4-Autopilot/commit/a65533b46986e32254b64b7c92469afb8178e370" target="_blank" rel="noreferrer">Цей коміт</a> показує як додати нову функцію виходу. Будь-яка тема uORB може бути підписана і закріплена за функцією.</p><p>Зауважте що параметри для розподілу керування визначені у <a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/control_allocator/module.yaml" target="_blank" rel="noreferrer">src/modules/control_allocator/module.yaml</a> Схема для цього файлу є <a href="https://github.com/PX4/PX4-Autopilot/blob/main/validation/module_schema.yaml#L440=" target="_blank" rel="noreferrer">тут</a> (конкретніше, шукайте термін <code>mixer:</code></p><h2 id="встановлення-геометріі-планеру-за-замовчуванням" tabindex="-1">Встановлення геометрії планеру за замовчуванням <a class="header-anchor" href="#встановлення-геометріі-планеру-за-замовчуванням" aria-label="Permalink to &quot;Встановлення геометрії планеру за замовчуванням&quot;">​</a></h2><p>Коли <a href="./../dev_airframes/adding_a_new_frame.html">додаєте нові налаштування планера</a>, встановіть відповідне значення <a href="./../advanced_config/parameter_reference.html#CA_AIRFRAME">CA_AIRFRAME</a> змішувача та інші значення за замовчуванням для геометрії.</p><p>Ви можете це побачити наприклад, у файлі конфігурації планера <a href="https://github.com/PX4/PX4-Autopilot/blob/main/ROMFS/px4fmu_common/init.d/airframes/13200_generic_vtol_tailsitter" target="_blank" rel="noreferrer">13200_generic_vtol_tailsitter</a></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA_AIRFRAME</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA_ROTOR_COUNT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA_ROTOR0_KM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -0.05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA_ROTOR0_PY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><h2 id="налаштування-геометріі-та-виходів" tabindex="-1">Налаштування геометрії та виходів <a class="header-anchor" href="#налаштування-геометріі-та-виходів" aria-label="Permalink to &quot;Налаштування геометрії та виходів&quot;">​</a></h2><p>Геометрія для плати та параметри за замовчуванням для рухомого засобу встановлюються (з файлу налаштувань планера) коли планер обирається у QGroundControl: <a href="./../config/airframe.html">Основне налаштування &gt; Планери</a>.</p><p>Параметри геометрії та відображення виводу для певних планерів та апаратного забезпечення польотних контролерів потім налаштовується у QGroundControl на екрані <strong>Приводи</strong>: <a href="./../config/actuators.html">Базове налаштування &gt; Налаштування та перевірка приводу</a>.</p>`,24)]))}const f=i(o,[["render",n]]);export{u as __pageData,f as default};
