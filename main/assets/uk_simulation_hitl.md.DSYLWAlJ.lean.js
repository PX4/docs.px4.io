import{_ as a,a as e,b as t,c as s}from"./chunks/qgc_hitl_autoconnect.BB2nZkz6.js";import{_ as o,c as l,a8 as n,o as r}from"./chunks/framework.BDnHobkS.js";const f=JSON.parse('{"title":"Симуляція з апаратним забезпеченням в контурі (HITL)","description":"","frontmatter":{},"headers":[],"relativePath":"uk/simulation/hitl.md","filePath":"uk/simulation/hitl.md"}'),p={name:"uk/simulation/hitl.md"};function h(c,i,d,m,u,k){return r(),l("div",null,i[0]||(i[0]=[n('<h1 id="симуляція-з-апаратним-забезпеченням-в-контурі-hitl" tabindex="-1">Симуляція з апаратним забезпеченням в контурі (HITL) <a class="header-anchor" href="#симуляція-з-апаратним-забезпеченням-в-контурі-hitl" aria-label="Permalink to &quot;Симуляція з апаратним забезпеченням в контурі (HITL)&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>HITL is <a href="./../simulation/community_supported_simulators.html">community supported and maintained</a>. Це може працювати або не працювати з поточними версіями PX4.</p><p>Дивіться <a href="./../dev_setup/dev_env.html">Встановлення інструментарію</a> для інформації про середовища та інструменти, що підтримуються основною командою розробників.</p></div><p>Апаратне забезпечення в контурі (HITL або HIL) режим симуляції в якому звичайна прошивка PX4 виконується на реальному пристрої польотного контролера. Цей підхід має перевагу у вигляді можливості тестування більшості коду для польоту на реальному апаратному забезпеченні.</p><p>PX4 supports HITL for multicopters (using <a href="./../sim_jmavsim/">jMAVSim</a> or <a href="./../sim_gazebo_classic/">Gazebo Classic</a>) and VTOL (using Gazebo Classic).</p><p><a id="compatible_airframe"></a></p><h2 id="планери-сумісні-з-hitl" tabindex="-1">Планери сумісні з HITL <a class="header-anchor" href="#планери-сумісні-з-hitl" aria-label="Permalink to &quot;Планери сумісні з HITL&quot;">​</a></h2><p>The set of compatible airframes vs simulators is:</p><table tabindex="0"><thead><tr><th>Планер</th><th><code>SYS_AUTOSTART</code></th><th>Gazebo Classic</th><th>jMAVSim</th></tr></thead><tbody><tr><td><a href="./../airframes/airframe_reference.html#copter_simulation_hil_quadcopter_x">HIL Quadcopter X</a></td><td>1001</td><td>Y</td><td>Y</td></tr><tr><td><a href="./../airframes/airframe_reference.html#vtol_standard_vtol_hil_standard_vtol_quadplane">HIL Standard VTOL QuadPlane</a></td><td>1002</td><td>Y</td><td></td></tr><tr><td><a href="./../airframes/airframe_reference.html#copter_quadrotor_x_generic_quadcopter">Generic Quadrotor x</a> copter</td><td>4001</td><td>Y</td><td>Y</td></tr></tbody></table><p><a id="simulation_environment"></a></p><h2 id="середовище-симуляціі-hitl" tabindex="-1">Середовище симуляції HITL <a class="header-anchor" href="#середовище-симуляціі-hitl" aria-label="Permalink to &quot;Середовище симуляції HITL&quot;">​</a></h2><p>У симуляції з апаратним забезпеченням у контурі (HITL) звичайна прошивка PX4 виконується на реальному обладнані. JMAVSim або Gazebo Classic (які працюють на комп&#39;ютері розробки) підключені до пристрою польотного контролера через USB/UART. The simulator acts as gateway to share MAVLink data between PX4 and <em>QGroundControl</em>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The simulator can also be connected via UDP if the flight controller has networking support and uses a stable, low-latency connection (e.g. a wired Ethernet connection - WiFi is usually not sufficiently reliable). For example, this configuration has been tested with PX4 running on a Raspberry Pi connected via Ethernet to the computer (a startup configuration that includes the command for running jMAVSim can be found <a href="https://github.com/PX4/PX4-Autopilot/blob/main/posix-configs/rpi/px4_hil.config" target="_blank" rel="noreferrer">here</a>).</p></div><p>Діаграма нижче показує середовище симуляції:</p><ul><li>A HITL configuration is selected (via <em>QGroundControl</em>) that doesn&#39;t start any real sensors.</li><li><em>jMAVSim</em> or <em>Gazebo Classic</em> are connected to the flight controller via USB.</li><li>The simulator is connected to <em>QGroundControl</em> via UDP and bridges its MAVLink messages to PX4.</li><li><em>Gazebo Classic</em> and <em>jMAVSim</em> can also connect to an offboard API and bridge MAVLink messages to PX4.</li><li>(Optional) A serial connection can be used to connect Joystick/Gamepad hardware via <em>QGroundControl</em>.</li></ul><p><img src="'+a+'" alt="HITL Setup - jMAVSim and Gazebo Classic"></p><h2 id="hitl-у-порівнянні-з-sitl" tabindex="-1">HITL у порівнянні з SITL <a class="header-anchor" href="#hitl-у-порівнянні-з-sitl" aria-label="Permalink to &quot;HITL у порівнянні з SITL&quot;">​</a></h2><p>SITL працює на комп&#39;ютері розробки в модельованому середовищі та використовує прошивку спеціально створену для цього середовища. Крім драйверів симуляції для забезпечення підроблених даних середовища від симулятора система поводиться як зазвичай.</p><p>На противагу, HITL виконує звичайну прошивку PX4 в &quot;режимі HITL&quot; на звичайному обладнані. Дані симуляції потрапляють в систему в іншій точці ніж для SITL. Основні модулі на кшталт командного або датчиків мають режими HITL, що оминають частину звичайної функціональності при старті.</p><p>Підсумовуючи, HITL виконує PX4 на реальному обладнанні за допомогою стандартної прошивки, а SITL фактично більше виконує стандартний системний код.</p><h2 id="налаштування-hitl" tabindex="-1">Налаштування HITL <a class="header-anchor" href="#налаштування-hitl" aria-label="Permalink to &quot;Налаштування HITL&quot;">​</a></h2><h3 id="конфігурація-px4" tabindex="-1">Конфігурація PX4 <a class="header-anchor" href="#конфігурація-px4" aria-label="Permalink to &quot;Конфігурація PX4&quot;">​</a></h3><ol><li><p>Connect the autopilot directly to <em>QGroundControl</em> via USB.</p></li><li><p>Увімкніть режим HITL</p><ol><li><p>Open <strong>Setup &gt; Safety</strong> section.</p></li><li><p>Enable HITL mode by selecting <strong>Enabled</strong> from the <em>HITL Enabled</em> list:</p><p><img src="'+e+'" alt="QGroundControl HITL configuration"></p></li></ol></li><li><p>Вибір планера</p><ol><li><p>Open <strong>Setup &gt; Airframes</strong></p></li><li><p>Select a <a href="#compatible_airframe">compatible airframe</a> you want to test. Then click <strong>Apply and Restart</strong> on top-right of the <em>Airframe Setup</em> page.</p><p><img src="'+t+'" alt="Select Airframe"></p></li></ol></li><li><p>При необхідності відкалібруйте пульт РК або джойстик.</p></li><li><p>Налаштування UDP</p><ol><li><p>Under the <em>General</em> tab of the settings menu, uncheck all <em>AutoConnect</em> boxes except for <strong>UDP</strong>.</p><p><img src="'+s+`" alt="QGC Auto-connect settings for HITL"></p></li></ol></li><li><p>(Необов&#39;язково) Налаштуйте джойстик та запобіжник відмови. Set the following <a href="./../advanced_config/parameters.html">parameters</a> in order to use a joystick instead of an RC remote control transmitter:</p><ul><li><a href="./../advanced_config/parameter_reference.html#COM_RC_IN_MODE">COM_RC_IN_MODE</a> to &quot;Joystick/No RC Checks&quot;. Це дозволить керування джойстиком та відключить перевірки пульту РК.</li><li><a href="./../advanced_config/parameter_reference.html#NAV_RCL_ACT">NAV_RCL_ACT</a> to &quot;Disabled&quot;. Це гарантує, що ніякі дії запобігання відмові не будуть перешкоджати коли не виконується HITL з радіо керуванням.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The <em>QGroundControl User Guide</em> also has instructions on <a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/setup_view/joystick.html" target="_blank" rel="noreferrer">Joystick</a> and <a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/settings_view/virtual_joystick.html" target="_blank" rel="noreferrer">Virtual Joystick</a> setup.</p></div></li></ol><p>:::</p><p>Once configuration is complete, <strong>close</strong> <em>QGroundControl</em> and disconnect the flight controller hardware from the computer.</p><h3 id="налаштування-відповідних-симуляторів" tabindex="-1">Налаштування відповідних симуляторів <a class="header-anchor" href="#налаштування-відповідних-симуляторів" aria-label="Permalink to &quot;Налаштування відповідних симуляторів&quot;">​</a></h3><p>Дотримуйтесь відповідних кроків для певного симулятора в наступних розділах.</p><h4 id="gazebo-classic" tabindex="-1">Gazebo Classic <a class="header-anchor" href="#gazebo-classic" aria-label="Permalink to &quot;Gazebo Classic&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Make sure <em>QGroundControl</em> is not running!</p></div><ol><li><p>Build PX4 with <a href="./../sim_gazebo_classic/">Gazebo Classic</a> (in order to build the Gazebo Classic plugins).</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Firmware_clon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DONT_RUN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gazebo-classic</span></span></code></pre></div></li><li><p>Open the vehicle model&#39;s sdf file (e.g. <strong>Tools/simulation/gazebo-classic/sitl_gazebo-classic/models/iris_hitl/iris_hitl.sdf</strong>).</p></li><li><p>Replace the <code>serialDevice</code> parameter (<code>/dev/ttyACM0</code>) if necessary.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The serial device depends on what port is used to connect the vehicle to the computer (this is usually <code>/dev/ttyACM0</code>). An easy way to check on Ubuntu is to plug in the autopilot, open up a terminal, and type <code>dmesg | grep &quot;tty&quot;</code>. Останній показаний пристрій і буде тим що потрібно.</p></div></li></ol><p>:::</p><ol start="4"><li><p>Налаштуйте змінні середовища:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Tools/simulation/gazebo-classic/setup_gazebo.bash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/build/px4_sitl_default</span></span></code></pre></div><p>та запустіть Gazebo Classic в режимі HITL:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gazebo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Tools/simulation/gazebo-classic/sitl_gazebo-classic/worlds/hitl_iris.world</span></span></code></pre></div></li><li><p>Start <em>QGroundControl</em>. Воно повинно автоматично підключитися до PX4 та Gazebo Classic.</p></li></ol><h4 id="jmavsim-тільки-квадрокоптер" tabindex="-1">jMAVSim (тільки квадрокоптер) <a class="header-anchor" href="#jmavsim-тільки-квадрокоптер" aria-label="Permalink to &quot;jMAVSim (тільки квадрокоптер)&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Make sure <em>QGroundControl</em> is not running!</p></div><ol><li><p>Під&#39;єднайте політний контролер до комп&#39;ютера та дочекайтесь коли він завантажиться.</p></li><li><p>Запустіть jMAVSim в режимі HITL:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/simulation/jmavsim/jmavsim_run.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -q</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/ttyACM0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 921600</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 250</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Replace the serial port name <code>/dev/ttyACM0</code> as appropriate. On macOS this port would be <code>/dev/tty.usbmodem1</code>. На Windows (включно з Cygwin) це буде COM1 або інший порт - перевірте з&#39;єднання в менеджері пристроїв Windows.</p></div></li></ol><p>:::</p><ol start="3"><li>Start <em>QGroundControl</em>. Воно повинно автоматично підключитися до PX4 та jMAVSim.</li></ol><h2 id="політ-за-автономним-завданням-у-hitl" tabindex="-1">Політ за автономним завданням у HITL <a class="header-anchor" href="#політ-за-автономним-завданням-у-hitl" aria-label="Permalink to &quot;Політ за автономним завданням у HITL&quot;">​</a></h2><p>You should be able to use <em>QGroundControl</em> to <a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/fly_view/fly_view.html#missions" target="_blank" rel="noreferrer">run missions</a> and otherwise control the vehicle.</p>`,38)]))}const C=o(p,[["render",h]]);export{f as __pageData,C as default};
