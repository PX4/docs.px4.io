import{_ as e,a as t,b as r,c as o,d as i,e as l,f as d,g as n}from"./chunks/geotag.CSyJG1b9.js";import{_ as c,c as h,a8 as m,o as s}from"./chunks/framework.BDnHobkS.js";const I=JSON.parse('{"title":"Камери, підключені до виходів керування польотом","description":"","frontmatter":{},"headers":[],"relativePath":"uk/camera/fc_connected_camera.md","filePath":"uk/camera/fc_connected_camera.md"}'),_={name:"uk/camera/fc_connected_camera.md"};function p(u,a,g,f,M,b){return s(),h("div",null,a[0]||(a[0]=[m('<h1 id="камери-підключені-до-виходів-керування-польотом" tabindex="-1">Камери, підключені до виходів керування польотом <a class="header-anchor" href="#камери-підключені-до-виходів-керування-польотом" aria-label="Permalink to &quot;Камери, підключені до виходів керування польотом&quot;">​</a></h1><p>Ця тема пояснює, як використовувати PX4 з <a href="./../camera/">камерою</a>, яка приєднана до виходів контролера польоту.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><a href="./../camera/mavlink_v2_camera.html">Камери MAVLink</a>, які використовують <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">Протокол камери MAVLink v2</a>, рекомендовані.</p></div><h2 id="загальнии-огляд" tabindex="-1">Загальний огляд <a class="header-anchor" href="#загальнии-огляд" aria-label="Permalink to &quot;Загальний огляд&quot;">​</a></h2><p>PX4 може викликати <a href="./../camera/">camera</a>, підключену до виходів керування польотом за допомогою <a href="#mavlink-command-interface">команд камери</a> в місіях або відправлений наземними станціями. Підтримувані команди є підмножиною тих, що визначені в MAVLink <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">Протоколі камери v1</a>.</p><p>Кожен раз, коли спрацьовує камера, опубліковано повідомлення MAVLink <a href="https://mavlink.io/en/messages/common.html#CAMERA_TRIGGER" target="_blank" rel="noreferrer">CAMERA_TRIGGER</a>, що містить номер послідовності (тобто поточний номер послідовності зображення сеансу) та відповідний часовий позначення. Цей часовий міткий може бути використаний для кількох цілей, включаючи: міткування фотографій для повітряного обстеження та реконструкції, синхронізацію багатокамерної системи або візуально-інерціальної навігації.</p><p>Камера може бути підключена до різних виходів, включаючи виходи PWM, виходи GPIO та кару MAP2 від Seagull через виходи PWM.</p><p>Камери також можуть (за бажанням) сигналізувати PX4 у саму точну мить, коли знімається фото/кадр, використовуючи <a href="#camera-capture-configuration">вивід захоплення камери</a>, який приєднаний до їх гарячого черевика. Це дозволяє більш точну прив&#39;язку зображень до позиції GPS для прив&#39;язки до місцевості або потрібну вибірку IMU для синхронізації ВІО, тощо.</p><h2 id="команднии-інтерфеис-mavlink" tabindex="-1">Командний інтерфейс MAVLink <a class="header-anchor" href="#команднии-інтерфеис-mavlink" aria-label="Permalink to &quot;Командний інтерфейс MAVLink&quot;">​</a></h2><p>PX4 підтримує наступні команди MAVLink для камер, підключених до КП, як у місіях, так і в разі їх отримання від БПК(GCS):</p><ul><li><a href="#mav-cmd-do-set-cam-trigg-interval">MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL</a> — встановити інтервал часу між зніманнями.</li><li><a href="#mav-cmd-do-set-cam-trigg-dist">MAV_CMD_DO_SET_CAM_TRIGG_DIST</a> — встановити відстань між зніманнями</li><li><a href="#mav-cmd-do-trigger-control">MAV_CMD_DO_TRIGGER_CONTROL</a> — почати/зупинити знімання (використовуючи відстань або час, як визначено попередніми командами).</li><li><a href="#mav-cmd-oblique-survey">MAV_CMD_OBLIQUE_SURVEY</a> — початок/зупинка відхиленого обстеження</li><li><a href="#мав-команда-керування-цифровою-камерою">MAV_CMD_DO_DIGICAM_CONTROL</a> — тестова зйомка камери з GCS.</li></ul><p>Підтримувана поведінка перерахована нижче (вони не точно відповідають специфікації MAVLink).</p><h3 id="mav-cmd-do-trigger-control" tabindex="-1">MAV_CMD_DO_TRIGGER_CONTROL <a class="header-anchor" href="#mav-cmd-do-trigger-control" aria-label="Permalink to &quot;MAV_CMD_DO_TRIGGER_CONTROL&quot;">​</a></h3><p><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_TRIGGER_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_DO_TRIGGER_CONTROL</a> - Приймається в &quot;командному&quot; режимі (<code>TRIG_MODE</code> 1).</p><table tabindex="0"><thead><tr><th>Параметри команди</th><th>Опис</th></tr></thead><tbody><tr><td>Параметр №1</td><td>Увімкнення/вимкнення спрацювання. <code>1</code>: увімкнути (запуск), <code>0</code>: вимкнути.</td></tr><tr><td>Параметр №2</td><td>Скидання послідовності спрацьовування. <code>1</code>: скинути, будь-яке інше значення нічого не робить.</td></tr><tr><td>Параметр №3</td><td>Призупинення спрацьовування, але без вимкнення камери або прибирання об&#39;єктиву. <code>1</code>: призупинити, <code>0</code>: перезапустити.</td></tr></tbody></table><h3 id="mav-cmd-do-digicam-control" tabindex="-1">MAV_CMD_DO_DIGICAM_CONTROL <a class="header-anchor" href="#mav-cmd-do-digicam-control" aria-label="Permalink to &quot;MAV_CMD_DO_DIGICAM_CONTROL&quot;">​</a></h3><p><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_DIGICAM_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_DO_DIGICAM_CONTROL</a> - Приймається в усіх режимах.</p><p>Використовується GCS для перевірки знімання камерою з інтерфейсу користувача. Драйвер спрацювання не підтримує всі параметри керування камерою, визначені специфікацією MAVLink.</p><table tabindex="0"><thead><tr><th>Параметри команди</th><th>Опис</th></tr></thead><tbody><tr><td>Параметр №5</td><td>Виконати команду одноразово (встановіть у 1 для знімання єдиного кадру).</td></tr></tbody></table><h3 id="mav-cmd-do-set-cam-trigg-dist" tabindex="-1">MAV_CMD_DO_SET_CAM_TRIGG_DIST <a class="header-anchor" href="#mav-cmd-do-set-cam-trigg-dist" aria-label="Permalink to &quot;MAV_CMD_DO_SET_CAM_TRIGG_DIST&quot;">​</a></h3><p><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_DIST" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_DIST</a> - Приймається у режимі &quot;політного завдання&quot; (<code>TRIG_MODE</code> 4)</p><p>Ця команда генерується автоматично під час виконання політного завдання для спрацювання камери на основі завдань обстеження з GCS.</p><h3 id="mav-cmd-do-set-cam-trigg-interval" tabindex="-1">MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL <a class="header-anchor" href="#mav-cmd-do-set-cam-trigg-interval" aria-label="Permalink to &quot;MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL&quot;">​</a></h3><p><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL</a></p><h3 id="mav-cmd-oblique-survey" tabindex="-1">MAV_CMD_OBLIQUE_SURVEY <a class="header-anchor" href="#mav-cmd-oblique-survey" aria-label="Permalink to &quot;MAV_CMD_OBLIQUE_SURVEY&quot;">​</a></h3><p><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_OBLIQUE_SURVEY" target="_blank" rel="noreferrer">MAV_CMD_OBLIQUE_SURVEY</a> - Команда політного завдання, щоб налаштувати автоматичне кріплення камери обертатись при зніманні навскіс.</p><p>Приймає від <code>param1</code> до <code>param4</code>, як вказано у визначенні повідомлення MAVLink. Налаштування інтеграції затвору (<code>param2</code>) виконується тільки з бекендом GPIO.</p><h2 id="налаштування-спрацьовування" tabindex="-1">Налаштування спрацьовування <a class="header-anchor" href="#налаштування-спрацьовування" aria-label="Permalink to &quot;Налаштування спрацьовування&quot;">​</a></h2><p>Камери можна підключати до FC для виклику за допомогою різних інтерфейсів, таких як PWM та GPIO, вказавши відповідний <a href="#trigger-interface-backends">задній інтерфейс тригера</a>. Ви також можете вказати камеру <a href="#trigger-mode">режим тригера</a>.</p><p>Цю конфігурацію найлегше виконати з розділу <em>QGroundControl</em> <a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/setup_view/camera.html#px4-camera-setup" target="_blank" rel="noreferrer">Налаштування рухомого засобу &gt; Камера</a>.</p><p><img src="'+e+'" alt="Пускові контакти"></p><p>Різні <a href="#trigger-modes">режими спрацювання</a>, <a href="#trigger-interface-backends">бекенди інтерфейсу спуску</a> та <a href="#trigger-output-pin-configuration">налаштування виводу спуску</a> описані нижче (їх також можна встановити прямо з <a href="./../advanced_config/parameters.html">параметрів</a>).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Розділ налаштувань камери за замовчуванням недоступний для польотних контролерів на основі FMUv2 (наприклад 3DR Pixhawk), оскільки модуль камери не включено в прошивку автоматично. Для додаткової інформації дивіться <a href="./../advanced_config/parameters.html#parameter-not-in-firmware">Пошук/Оновлення параметрів &gt; Параметри, яких немає в прошивці</a>.</p></div><h3 id="режими-спрацювання" tabindex="-1">Режими спрацювання <a class="header-anchor" href="#режими-спрацювання" aria-label="Permalink to &quot;Режими спрацювання&quot;">​</a></h3><p>Підтримуються чотири різні режими, керуються параметром <a href="./../advanced_config/parameter_reference.html#TRIG_MODE">TRIG_MODE</a>:</p><table tabindex="0"><thead><tr><th>Режим</th><th>Опис</th></tr></thead><tbody><tr><td>0</td><td>Спрацювання камери вимкнено.</td></tr><tr><td>1</td><td>Працює як звичайний вимірювач інтервалів який можна увімкнути або вимкнути використовуючи команду MAVLink <code>MAV_CMD_DO_TRIGGER_CONTROL</code>. Дивіться <a href="#mavlink-command-interface">командний інтерфейс</a> для додаткової інформації.</td></tr><tr><td>2</td><td>Вмикає вимірювач інтервалів.</td></tr><tr><td>3</td><td>Спрацювання основані на відстані. Знімок робиться кожного разу, коли перевищується встановлена горизонтальна відстань. Мінімальний інтервал часу між двома знімками, однак, обмежується встановленим інтервалом спрацьовування.</td></tr><tr><td>4</td><td>Спрацьовує автоматично при виконанні опитування в режимі місії.</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Якщо ви вперше вмикаєте додаток спрацювання камери, не забудьте перезавантажитись після зміни параметру <code>TRIG_MODE</code>.</p></div><h3 id="бекенди-інтерфеису-спрацювання" tabindex="-1">Бекенди інтерфейсу спрацювання <a class="header-anchor" href="#бекенди-інтерфеису-спрацювання" aria-label="Permalink to &quot;Бекенди інтерфейсу спрацювання&quot;">​</a></h3><p>Драйвер спрацювання камери підтримує кілька бекендів - кожен для конкретного застосування, що керується параметром <a href="./../advanced_config/parameter_reference.html#TRIG_INTERFACE">TRIG_INTERFACE</a>:</p><table tabindex="0"><thead><tr><th>Номер</th><th>Опис</th></tr></thead><tbody><tr><td>1</td><td>Вмикає інтерфейс GPIO. AUX виходи дають періодичний високий або низький сигнал (в залежності від параметра <code>TRIG_POLARITY</code>) кожен інтервал часу <a href="./../advanced_config/parameter_reference.html#TRIG_INTERVAL">TRIG_INTERVAL</a>. Це може бути використано для безпосереднього спуску більшості стандартних камер машинного зору. Зверніть увагу, що на апаратному забезпеченні серії PX4FMU (Pixhawk, Pixracer тощо) рівень сигналу на AUX контактах становить 3,3 В.</td></tr><tr><td>2</td><td>Вмикає інтерфейс Seagull MAP2. Це дозволяє використовувати <a href="http://www.seagulluav.com/product/seagull-map2/" target="_blank" rel="noreferrer">Seagull MAP2</a> для взаємодії з безліччю камер, що підтримуються. Контакт/канал 1 (спуск камери) так контакт/канал 2 (селектор режиму) MAP2 повинні бути підключені до <a href="#trigger-output-pin-configuration">контактів спрацювання камери</a> з налаштованим низьким та високим сигналом. За допомогою Seagull MAP2, PX4 також підтримує автоматичний контроль потужності та функційність утримання в робочому стані камер Sony Multiport, таких як QX-1.</td></tr><tr><td>3</td><td>Цей режим дозволяє використовувати камери MAVLink, які використовували старі інтерфейси <a href="#mavlink-command-interface">описані вище</a>. Повідомлення автоматично видаються на каналі <code>onboard</code> MAVLink під час знаходження їх в місіях. PX4 випускає повідомлення MAVLink <code>CAMERA_TRIGGER</code>, коли спрацьовує камера, за замовчуванням на канал <code>onboard</code> (якщо він не використовується, буде потрібно ввімкнути власний потік). <a href="./../camera/mavlink_v1_camera.html">Прості камери MAVLink</a> пояснюють цей випадок більш детально.</td></tr><tr><td>4</td><td>Вмикає загальний інтерфейс ШІМ. Це дозволяє використовувати <a href="https://hobbyking.com/en_us/universal-remote-control-infrared-shutter-ir-rc-1g.html" target="_blank" rel="noreferrer">інфрачервоні спускові пристрої</a> або сервоприводи для спуску камери.</td></tr></tbody></table><h3 id="налаштування-вихідних-контактів-спуску" tabindex="-1">Налаштування вихідних контактів спуску <a class="header-anchor" href="#налаштування-вихідних-контактів-спуску" aria-label="Permalink to &quot;Налаштування вихідних контактів спуску&quot;">​</a></h3><p>Контакти спуску камери встановлюються в <em>QGroundControl</em> на екрані налаштувань <a href="./../config/actuators.html">Приводи</a>.</p><p>Контакти спуску можуть бути встановлені призначенням функції <code>Camera_Trigger</code> на будь-який вихід FMU. Якщо використовується налаштування спрацювання, яке потребує двох контактів (наприклад Seagull MAP2), ви можете призначити її на будь-які два виходи.</p><p>Однак зверніть увагу, якщо вивід <em>ШІМ</em> було використано для спуску камери (наприклад як у Seagull MAP2), уся група ШІМ не може бути використана для чого-небудь ще (ви не зможете використати інший вивід в групі для приводу, двигуна або захоплення камери, оскільки таймер вже використано).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>At time of writing triggering only works on FMU pins:</p><ul><li>На контролері польоту Pixhawk, який має як FMU, так і плати вводу-виводу, контакти FMU призначені на виходи <code>AUX</code> (наприклад Pixhawk 4, CUAV v5+).</li><li>Контакти контролера, що має лише FMU призначено на виходи <code>MAIN</code> (наприклад Pixhawk 4 mini, CUAV v5 nano).</li></ul></div><h3 id="інші-параметри" tabindex="-1">Інші параметри <a class="header-anchor" href="#інші-параметри" aria-label="Permalink to &quot;Інші параметри&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Параметр</th><th>Опис</th></tr></thead><tbody><tr><td><a href="./../advanced_config/parameter_reference.html#TRIG_POLARITY">TRIG_POLARITY</a></td><td>Доречний лише при використанні інтерфейсу GPIO. Встановлює полярність контакту спрацювання. Високий сигнал в активному стані означає що сигнал на контакті зазвичай низький і підіймається на високий рівень під час спрацювання. Низький сигнал в активному стані - навпаки.</td></tr><tr><td><a href="./../advanced_config/parameter_reference.html#TRIG_INTERVAL">TRIG_INTERVAL</a></td><td>Визначає час між двома послідовними подіями спрацьовування в мілісекундах.</td></tr><tr><td><a href="./../advanced_config/parameter_reference.html#TRIG_ACT_TIME">TRIG_ACT_TIME</a></td><td>Визначає час у мілісекундах, протягом якого контакт спуску утримується в стані &quot;активний&quot; перед поверненням до нейтрального. У режимах ШІМ мінімум обмежується 40 мс щоб завжди вміщати активний імпульс у сигнал ШІМ з частотою 50 Гц.</td></tr></tbody></table><p>Повний список параметрів, що стосуються модуля спуску камери можна знайти на сторінці <a href="./../advanced_config/parameter_reference.html#camera-trigger">довіднику параметрів</a>.</p><h2 id="налаштування-захоплення-камери" tabindex="-1">Налаштування захоплення камери <a class="header-anchor" href="#налаштування-захоплення-камери" aria-label="Permalink to &quot;Налаштування захоплення камери&quot;">​</a></h2><p>Камери можуть також (необов&#39;язково) використовувати контакт захоплення камерою, щоб сигналізувати точну мить, коли зроблено фото/кадр. Це дозволяє більш точну прив&#39;язку зображень до позиції GPS для прив&#39;язки до місцевості або потрібну вибірку IMU для синхронізації ВІО, тощо.</p><p>Захоплення/зворотний зв&#39;язок камери вмикається в PX4 встановленням <a href="./../advanced_config/parameter_reference.html#CAM_CAP_FBACK">CAM_CAP_FBACK = 1</a>. Контакт, використаний для захоплення камерою потім налаштовується на екрані налаштувань <em>QGroundControl</em> <a href="./../config/actuators.html">Приводи</a>, призначенням функції <code>Camera_Capture</code> на будь-який вихід FMU.</p><p>Зверніть увагу, якщо <em>вивід ШІМ</em> було використано як вхід захоплення камерою, уся група ШІМ не може бути використана для чого-небудь ще (ви не зможете використати інший вивід в групі для приводу, двигуна або спуску камери, оскільки таймер вже використано).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>At time of writing camera capture only works on FMU pins:</p><ul><li>На контролері польоту Pixhawk, який має як FMU, так і плати вводу-виводу, контакти FMU призначені на виходи <code>AUX</code> (наприклад Pixhawk 4, CUAV v5+).</li><li>Контакти контролера, що має лише FMU призначено на виходи <code>MAIN</code> (наприклад Pixhawk 4 mini, CUAV v5 nano).</li></ul></div><p>PX4 виявляє висхідний фронт сигналу з відповідним рівнем напруги на контакті захоплення камерою (для контролерів польоту Pixhawk це зазвичай 3,3 В). Якщо камера не видає відповідної напруги, то для забезпечення сумісності сигналу буде потрібен додатковий контур.</p><p>Камери, які мають роз&#39;єм типу &quot;гарячий башмак&quot; (для підключення спалаху), зазвичай можна під&#39;єднати за допомогою адаптера для цього роз&#39;єму. Наприклад <a href="https://www.seagulluav.com/product/seagull-sync2/" target="_blank" rel="noreferrer">універсальний адаптер роз&#39;єму &quot;гарячий башмак&quot; Seagull #SYNC2</a> - це оптрон, який відокремлює та зсуває напругу спалаху до напруги Pixhawk. Він вставляється в роз&#39;єм для спалаху зверху камери. Червоні та чорні вихідні дроти під&#39;єднані до шини живлення/землі сервоприводу, а білий дріт - до вхідного контакту захоплення.</p><p><img src="'+t+'" alt="Seagull SYNC#2"></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>PX4 видає повідомлення MAVLink <a href="https://mavlink.io/en/messages/common.html#CAMERA_TRIGGER" target="_blank" rel="noreferrer">CAMERA_TRIGGER</a> як на спрацювання камери, так і на захоплення камерою. Якщо налаштовано захоплення камерою, використовується відмітка часу від драйвера захоплення камери, в іншому випадку використовується відмітка часу спрацювання.</p></div><h2 id="тестування-функціональності-тригера" tabindex="-1">Тестування функціональності тригера <a class="header-anchor" href="#тестування-функціональності-тригера" aria-label="Permalink to &quot;Тестування функціональності тригера&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Наступні розділи застаріли і потребують повторного тестування.</p></div><ol><li><p>На консолі PX4:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">camera_trigger</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span></code></pre></div></li><li><p>Від <em>QGroundControl</em>:</p><p>Клацніть на <strong>Запуск камери</strong> на головній панелі інструментів. Ці знімки не відображаються або не підраховуються для геотегування.</p><p><img src="'+r+'" alt="QGC Тестова Камера"></p></li></ol><h2 id="приклад-sony-qx-1-фотограметрія" tabindex="-1">Приклад Sony QX-1 (Фотограметрія) <a class="header-anchor" href="#приклад-sony-qx-1-фотограметрія" aria-label="Permalink to &quot;Приклад Sony QX-1 (Фотограметрія)&quot;">​</a></h2><p><img src="'+o+'" alt="фотограметрія"></p><p>У цьому прикладі ми використаємо кабель спускового пристрою Seagull MAP2 для інтерфейсу з Sony QX-1 та використаємо налаштування для створення ортомозаїк після проведення повністю автономної місії обстеження.</p><h3 id="налаштування-тригера" tabindex="-1">Налаштування тригера <a class="header-anchor" href="#налаштування-тригера" aria-label="Permalink to &quot;Налаштування тригера&quot;">​</a></h3><p>Рекомендовані налаштування камери:</p><ul><li><code>TRIG_INTERFACE=2</code> (Seagull MAP2).</li><li><code>TRIG_MODE=4</code> (Контрольований місією).</li><li>Залиште решту параметрів за замовчуванням.</li></ul><p>Вам потрібно підключити карту Seagull MAP2 до контактів FMU на вашому автопілоті. Інший кінець кабелю MAP2 буде вставлено в роз&#39;єм &quot;MULTI&quot; QX-1.</p><h3 id="налаштування-камери" tabindex="-1">Налаштування камери <a class="header-anchor" href="#налаштування-камери" aria-label="Permalink to &quot;Налаштування камери&quot;">​</a></h3><p>Ми використовуємо Sony QX-1 з об&#39;єктивом 16-50 мм f3.5-5.6 для цього прикладу.</p><p>Щоб уникнути затримки автофокусу та вимірювання при спрацюванні камери, слід дотримуватися наступних вказівок:</p><ul><li>Ручне фокусування на безкінечність</li><li>Встановіть камеру в режим постійного знімання</li><li>Вручну встановіть експозицію та діафрагму</li><li>ISO повинен бути встановлений якнайнижчим</li><li>Ручний баланс білого, відповідний для сцени</li></ul><h3 id="планування-місіі" tabindex="-1">Планування місії <a class="header-anchor" href="#планування-місіі" aria-label="Permalink to &quot;Планування місії&quot;">​</a></h3><p><img src="'+i+'" alt="QGC Опитування Полігону"></p><p><img src="'+l+'" alt="QGC Параметри Огляду"></p><h3 id="геотегування" tabindex="-1">Геотегування <a class="header-anchor" href="#геотегування" aria-label="Permalink to &quot;Геотегування&quot;">​</a></h3><p>Завантажте/скопіюйте файл журналу та зображення з польоту та вказіть QGroundControl на них. Потім клацніть на <strong>Почати позначення</strong>.</p><p><img src="'+d+'" alt="QGC Геомаркування"></p><p>Ви можете перевірити геотегування за допомогою безкоштовного онлайн-сервісу, такого як <a href="https://www.pic2map.com/" target="_blank" rel="noreferrer">Pic2Map</a>. Зверніть увагу, що Pic2Map обмежений лише 40 зображеннями.</p><h3 id="реконструкція" tabindex="-1">Реконструкція <a class="header-anchor" href="#реконструкція" aria-label="Permalink to &quot;Реконструкція&quot;">​</a></h3><p>Ми використовуємо <a href="https://pix4d.com/" target="_blank" rel="noreferrer">Pix4D</a> для реконструкції у 3D.</p><p><img src="'+n+'" alt="Геомаркування"></p><h2 id="приклад-синхронізаціі-camera-imu-vio" tabindex="-1">Приклад синхронізації Camera-IMU (VIO) <a class="header-anchor" href="#приклад-синхронізаціі-camera-imu-vio" aria-label="Permalink to &quot;Приклад синхронізації Camera-IMU (VIO)&quot;">​</a></h2><p>У цьому прикладі ми розглянемо основи синхронізації вимірювань ІМП з візуальними даними для побудови стерео навігаційної системи Visual-Inertial Navigation System (VINS). Щоб було зрозуміло, ідея тут полягає не в тому, щоб вимірювати IMU точно у той же час, що і ми фотографуємо, а отримувати правильний часовий штамп на наших зображеннях, щоб надавати точні дані нашому алгоритму VIO.</p><p>Автопілот та супутник мають різні бази часу (час завантаження для автопілота та UNIX епоха для супутника), тому замість вигинати будь-який з годинників, ми безпосередньо спостерігаємо різницю часу між годинниками. Це зміщення додається або віднімається від міток часу в повідомленнях MAVLink (наприклад, <code>HIGHRES_IMU</code>) в компоненті перекладача міжпрограмного забезпечення (наприклад, MAVROS на співмешканці та <code>mavlink_receiver</code> в PX4). Фактичний алгоритм синхронізації є модифікованою версією алгоритму мережевого протоколу часу (NTP) та використовує експоненційний рухомий середній для згладжування відстеженого зсуву часу. Ця синхронізація виконується автоматично, якщо використовується MAVROS з високосмуговим зв&#39;язком на борту (режим MAVLink onboard`).</p><p>Для отримання синхронізованих кадрів зображення та інерційних вимірювань ми підключаємо входи тригера двох камер до контакту GPIO на автопілоті. Часовий штамп інерційного вимірювання від початку впливу та номер послідовності зображень записуються й відправляються на спільний комп&#39;ютер (<code>повідомлення CAMERA_TRIGGER</code>), який буферизує ці пакети та кадри зображень, отримані з камери. Вони збігаються за порядковим номером (перший кадр зображення - послідовність 0), часовими позначками зображень (з міткою часу від повідомлення CAMERA_TRIGGER) та потім публікуються.</p><p>Наступна діаграма ілюструє послідовність подій, які повинні відбутися для правильного відміткового зображень.</p><p><a href="https://mermaid.live/edit#pako:eNqNUs9rwjAU_lceOW-3nXIQpIoIVkftZIdCeTbPNqxJXJI6ivi_L1Er6Dzs9kK-H3lfviOrjCDGmaPvjnRFE4m1RVVogKXxBFbWjQezg_fPN-CQS0Xgel3Bj_QNKDxY40A6EEYTYOeNQi8rbNs-SkTS62g04DgkqMgi5EG2JguWUPR_vaoLSlh5CKAb63reGuMdoBbR96Zwz7kzvQylcrXjPDFKBe71BYnR3po2ClzhkXnZNR1vFlJ_cR6GMkkn5WRV5tl8NptmZbJa5tlqEXmtMXuYBtMe4m05X-bTbDNegJJtKx1VRgv3NIybQTJOp9l4EH94zGMY99ugmqcfa49q_zyER3aKvmpg-G3QndqS_R_17AJSYU3n9PfdNuzXFJq0YC8sgBVKEbp0jHoF8w0pKhgPo6Addq0vWKFPARp7sg4lYtzbjl5Ytxfoh-oxvsPW0ekXb8TjxQ" target="_blank" rel="noreferrer"><img src="https://mermaid.ink/img/pako:eNqNUs9rwjAU_lceOW-3nXIQpIoIVkftZIdCeTbPNqxJXJI6ivi_L1Er6Dzs9kK-H3lfviOrjCDGmaPvjnRFE4m1RVVogKXxBFbWjQezg_fPN-CQS0Xgel3Bj_QNKDxY40A6EEYTYOeNQi8rbNs-SkTS62g04DgkqMgi5EG2JguWUPR_vaoLSlh5CKAb63reGuMdoBbR96Zwz7kzvQylcrXjPDFKBe71BYnR3po2ClzhkXnZNR1vFlJ_cR6GMkkn5WRV5tl8NptmZbJa5tlqEXmtMXuYBtMe4m05X-bTbDNegJJtKx1VRgv3NIybQTJOp9l4EH94zGMY99ugmqcfa49q_zyER3aKvmpg-G3QndqS_R_17AJSYU3n9PfdNuzXFJq0YC8sgBVKEbp0jHoF8w0pKhgPo6Addq0vWKFPARp7sg4lYtzbjl5Ytxfoh-oxvsPW0ekXb8TjxQ?type=png" alt="Mermaid sequence diagram"></a></p><h3 id="крок-1" tabindex="-1">Крок 1 <a class="header-anchor" href="#крок-1" aria-label="Permalink to &quot;Крок 1&quot;">​</a></h3><p>Спочатку встановіть TRIG_MODE на 1, щоб драйвер чекав на команду запуску та перезавантажте свій FCU, щоб отримати решту параметрів.</p><h3 id="крок-2" tabindex="-1">Крок 2 <a class="header-anchor" href="#крок-2" aria-label="Permalink to &quot;Крок 2&quot;">​</a></h3><p>Для цілей цього прикладу ми налаштуємо тригер для співпраці з камерою Point Grey Firefly MV, що працює з частотою 30 FPS.</p><ul><li><code>TRIG_INTERVAL</code>: 33.33 мс</li><li><code>TRIG_POLARITY</code>: 0 (активний низький)</li><li><code>TRIG_ACT_TIME</code>: 0.5 мс. Ручний номер у цьому випадку має бути не менш ніж 1 мікросекунда.</li><li><code>TRIG_MODE</code>: 1, тому що ми хочемо, щоб ваш драйвер камери був готовий до отримання зображень перед початком запуску. Це важливо для належної обробки послідовних номерів.</li></ul><h3 id="крок-3" tabindex="-1">Крок 3 <a class="header-anchor" href="#крок-3" aria-label="Permalink to &quot;Крок 3&quot;">​</a></h3><p>Підключіть свої камери до роз&#39;єму AUX, підключивши земельний і сигнальний контакти до відповідного місця.</p><h3 id="крок-4" tabindex="-1">Крок 4 <a class="header-anchor" href="#крок-4" aria-label="Permalink to &quot;Крок 4&quot;">​</a></h3><p>Вам доведеться змінити свій драйвер, щоб дотримуватися схеми послідовності вище. Для камер <a href="https://github.com/ProjectArtemis/ueye_cam" target="_blank" rel="noreferrer">IDS Imaging UEye</a> та для камер, що відповідають стандарту <a href="https://github.com/andre-nguyen/camera1394" target="_blank" rel="noreferrer">IEEE1394 compliant</a>, доступні публічні посилання на референтні реалізації.</p><h2 id="дивіться-також" tabindex="-1">Дивіться також <a class="header-anchor" href="#дивіться-також" aria-label="Permalink to &quot;Дивіться також&quot;">​</a></h2><ul><li>Драйвер Тригера камери: <a href="https://github.com/PX4/PX4-Autopilot/tree/main/src/drivers/camera_trigger" target="_blank" rel="noreferrer">вихідний код</a></li><li>Драйвер захоплення камери: <a href="https://github.com/PX4/PX4-Autopilot/tree/main/src/drivers/camera_capture" target="_blank" rel="noreferrer">вихідний код</a></li></ul>',98)]))}const R=c(_,[["render",p]]);export{I as __pageData,R as default};
