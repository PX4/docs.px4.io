import{_ as a,c as t,a8 as o,o as s}from"./chunks/framework.BDnHobkS.js";const h=JSON.parse('{"title":"Magnetometer (Compass) Hardware & Setup","description":"","frontmatter":{},"headers":[],"relativePath":"zh/gps_compass/magnetometer.md","filePath":"zh/gps_compass/magnetometer.md"}'),r={name:"zh/gps_compass/magnetometer.md"};function n(l,e,i,m,p,c){return s(),t("div",null,e[0]||(e[0]=[o('<h1 id="magnetometer-compass-hardware-setup" tabindex="-1">Magnetometer (Compass) Hardware &amp; Setup <a class="header-anchor" href="#magnetometer-compass-hardware-setup" aria-label="Permalink to &quot;Magnetometer (Compass) Hardware &amp; Setup&quot;">​</a></h1><p>PX4 uses a magnetometer (compass) for determining the yaw and heading of the vehicle relative to the earth&#39;s magnetic field.</p><p><a href="./../flight_controller/pixhawk_series.html">Pixhawk series</a> flight controllers, and many others, include an internal compass. On small vehicles the performance of the internal compass is almost always poor, because the flight controller has to be mounted close to motor/ESC power lines and other sources of electromagnetic interference. The internal compass <em>may</em> be useful on larger vehicles (e.g. VTOL) where it is possible to reduce electromagnetic interference by mounting the flight controller a long way from power supply lines.</p><p>On most vehicles, and in particular on small vehicles, we recommend using a <em>combined GPS + Compass</em> <a href="./../assembly/mount_gps_compass.html">mounted as far away from the motor/ESC power supply lines as possible</a> - typically on a pedestal or wing (for fixed-wing). While you can use a <a href="#stand-alone-compass-modules">stand-alone external compass</a> (as listed below) it is far more common to use a <a href="#combined-gnss-compass-modules">combined GPS/Compass module</a>.</p><p>Magnetometers support connection to either the I2C/SPI-bus (Pixhawk <code>GPS1</code> or <code>GPS2</code> ports) or to the CAN bus. If a module doesn&#39;t include &quot;CAN&quot; in its product name then it is probably an I2C/SPI compass.</p><p>Up to 4 internal or external magnetometers can be connected, though only one will actually be used as a heading source. The system automatically chooses the best available compass based on their <em>priority</em> (external magnetometers have a higher priority than internal magnetometers). If the primary compass fails in-flight, it will failover to the next one. If it fails before flight, arming will be denied.</p><h2 id="supported-compasses" tabindex="-1">Supported Compasses <a class="header-anchor" href="#supported-compasses" aria-label="Permalink to &quot;Supported Compasses&quot;">​</a></h2><h3 id="compass-parts" tabindex="-1">Compass Parts <a class="header-anchor" href="#compass-parts" aria-label="Permalink to &quot;Compass Parts&quot;">​</a></h3><p>PX4 can be used with many magnetometer parts, including: Bosch BMM 150 MEMS (via I2C bus), HMC5883 / HMC5983 (I2C or SPI), IST8310 (I2C), LIS3MDL (I2C or SPI), RM3100, and more. Other supported magnetometer parts and their busses can be inferred from the drivers listed in <a href="./../modules/modules_driver_magnetometer.html">Modules Reference: Magnetometer (Driver)</a>.</p><p>These parts are included in stand alone compass modules, combined compass/GNSS modules, and also in many flight controllers,</p><h3 id="combined-gnss-compass-modules" tabindex="-1">Combined GNSS/Compass Modules <a class="header-anchor" href="#combined-gnss-compass-modules" aria-label="Permalink to &quot;Combined GNSS/Compass Modules&quot;">​</a></h3><p>See <a href="./../gps_compass/#supported-gnss">Global Navigation Satellite Systems (GNSS)</a> for a list of appropriate modules.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If GNSS is required, then a combined GNSS/Compass module will be preferred over the stand-alone modules below.</p></div><h3 id="stand-alone-compass-modules" tabindex="-1">Stand-Alone Compass Modules <a class="header-anchor" href="#stand-alone-compass-modules" aria-label="Permalink to &quot;Stand-Alone Compass Modules&quot;">​</a></h3><p>This list contains stand-alone magnetometer modules (without GNSS).</p><table tabindex="0"><thead><tr><th style="text-align:left;">设备</th><th style="text-align:center;">罗盘</th><th style="text-align:center;">DroneCan</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://www.tindie.com/products/avionicsanonymous/uavcan-magnetometer/" target="_blank" rel="noreferrer">Avionics Anonymous UAVCAN Magnetometer</a></td><td style="text-align:center;">?</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;"><a href="https://holybro.com/products/dronecan-rm3100-compass" target="_blank" rel="noreferrer">Holybro DroneCAN RM3100 Compass/Magnetometer</a></td><td style="text-align:center;">RM3100</td><td style="text-align:center;">✓</td></tr><tr><td style="text-align:left;"><a href="https://holybro.com/products/dronecan-rm3100-compass" target="_blank" rel="noreferrer">RaccoonLab DroneCAN/Cyphal Magnetometer RM3100</a></td><td style="text-align:center;">RM3100</td><td style="text-align:center;">✓</td></tr></tbody></table><p>注意：</p><ul><li>✓ or a specific part number indicate that a features is supported, while ✘ or empty show that the feature is not supported. &quot;?&quot; indicates &quot;unknown&quot;.</li><li>A compass that is not &quot;DroneCAN&quot; can be assumed to be SPI or I2C.</li></ul><h2 id="mounting" tabindex="-1">Mounting <a class="header-anchor" href="#mounting" aria-label="Permalink to &quot;Mounting&quot;">​</a></h2><p><a href="./../assembly/mount_gps_compass.html">Mounting the Compass</a> explains how to mount a compass or GPS/Compass module.</p><h2 id="i2c-spi-compass-setup" tabindex="-1">I2C/SPI Compass Setup <a class="header-anchor" href="#i2c-spi-compass-setup" aria-label="Permalink to &quot;I2C/SPI Compass Setup&quot;">​</a></h2><p>On <a href="./../flight_controller/pixhawk_series.html">Pixhawk Series</a> flight controllers you can connect to either the <code>GPS1</code> or <code>GPS2</code> ports (which have pins for I2C/SPI). No further configuration is required.</p><h2 id="can-compass-setup" tabindex="-1">CAN Compass Setup <a class="header-anchor" href="#can-compass-setup" aria-label="Permalink to &quot;CAN Compass Setup&quot;">​</a></h2><p><a href="./../dronecan/">DroneCAN</a> covers the setup for DroneCAN peripherals, including compasses.</p><p>You will need to connect the compass to the <a href="./../can/#wiring">CAN bus</a>, enable DroneCAN, and specifically enable magnetometers (search for <code>UAVCAN_SUB_MAG</code>).</p><h2 id="calibration" tabindex="-1">Calibration <a class="header-anchor" href="#calibration" aria-label="Permalink to &quot;Calibration&quot;">​</a></h2><p><a href="./../config/compass.html">Compass Calibration</a> explains how to calibrate all compasses on the vehicle.</p><p>The process is straightforward and will autodetect, <a href="./../advanced_config/parameter_reference.html#SENS_MAG_AUTOROT">set default rotations</a>, calibrate, and prioritise, all connected magnetometers.</p><h2 id="see-also" tabindex="-1">See also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;See also&quot;">​</a></h2><ul><li><a href="./../advanced_config/compass_power_compensation.html">Compass Power Compensation</a></li></ul>',30)]))}const u=a(r,[["render",n]]);export{h as __pageData,u as default};
