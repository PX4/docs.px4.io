(window.webpackJsonp=window.webpackJsonp||[]).push([[522],{2330:function(t,s,e){"use strict";e.r(s);var a=e(19),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ros-2-user-guide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-user-guide"}},[t._v("#")]),t._v(" ROS 2 User Guide")]),t._v(" "),a("p",[t._v("The ROS 2-PX4 architecture provides a deep integration between ROS 2 and PX4, allowing ROS 2 subscribers or publisher nodes to interface directly with PX4 uORB topics.")]),t._v(" "),a("p",[t._v("This topic provides an overview of the architecture and application pipeline, and explains how to setup and use ROS 2 with PX4.")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("The "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html"}},[t._v("uXRCE-DDS")]),t._v(" middleware is supported in releases from "),a("strong",[t._v("PX4 v1.14")]),t._v(".\n"),a("strong",[t._v("PX4 v1.13")]),t._v(" does not support ROS 2 via "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html"}},[t._v("uXRCE-DDS")]),t._v(" middleware (see "),a("a",{attrs:{href:"https://docs.px4.io/v1.13/en/ros/ros2_comm.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4 v1.13 Docs"),a("OutboundLink")],1),t._v(" for information).\n")],1)]),t._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),a("p",[t._v("The application pipeline for ROS 2 is very straightforward, thanks to the use of the "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html"}},[t._v("uXRCE-DDS")]),t._v(" communications middleware.")],1),t._v(" "),a("p",[a("img",{attrs:{src:e(351),alt:"Architecture uXRCE-DDS with ROS 2"}})]),t._v(" "),a("p",[t._v("The uXRCE-DDS middleware consists of a client running on PX4 and an agent running on the companion computer, with bi-directional data exchange between them over a serial, UDP, TCP or custom link.\nThe agent acts as a proxy for the client to publish and subscribe to topics in the global DDS data space.")]),t._v(" "),a("p",[t._v("The PX4 "),a("RouterLink",{attrs:{to:"/en/modules/modules_system.html#uxrce-dds-client"}},[t._v("uxrce_dds_client")]),t._v(' is generated at build time and included in PX4 firmware by default.\nIt includes both the "generic" micro XRCE-DDS client code, and PX4-specific translation code that it uses to publish to/from uORB topics.\nThe subset of uORB messages that are generated into the client are listed in '),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/src/modules/uxrce_dds_client/dds_topics.yaml"),a("OutboundLink")],1),t._v(".\nThe generator uses the uORB message definitions in the source tree: "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/main/msg",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/msg"),a("OutboundLink")],1),t._v(" to create the code for sending ROS 2 messages.")],1),t._v(" "),a("p",[t._v("ROS 2 applications need to be built in a workspace that has the "),a("em",[t._v("same")]),t._v(" message definitions that were used to create the uXRCE-DDS client module in the PX4 Firmware.\nYou can include these by cloning the interface package "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),a("OutboundLink")],1),t._v(" into your ROS 2 workspace (branches in the repo correspond to the messages for different PX4 releases).")]),t._v(" "),a("p",[t._v("Note that the micro XRCE-DDS "),a("em",[t._v("agent")]),t._v(" itself has no dependency on client-side code.\nIt can be built from "),a("a",{attrs:{href:"https://github.com/eProsima/Micro-XRCE-DDS-Agent",target:"_blank",rel:"noopener noreferrer"}},[t._v("source"),a("OutboundLink")],1),t._v(" either standalone or as part of a ROS build, or installed as a snap.")]),t._v(" "),a("p",[t._v("You will normally need to start both the client and agent when using ROS 2.\nNote that the uXRCE-DDS client is built into firmware by default but not started automatically except for simulator builds.")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("In PX4v1.13 and earlier, ROS 2 was dependent on definitions in "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),a("OutboundLink")],1),t._v(".\nThis repo is no longer needed, but does contain useful examples.")])]),t._v(" "),a("h2",{attrs:{id:"installation-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-setup"}},[t._v("#")]),t._v(" Installation & Setup")]),t._v(" "),a("p",[t._v('The supported ROS 2 platforms for PX4 development are ROS 2 "Humble" on Ubuntu 22.04, and ROS 2 "Foxy" on Ubuntu 20.04.')]),t._v(" "),a("p",[t._v('ROS 2 "Humble" is recommended because it is the current ROS 2 LTS distribution.\nROS 2 "Roxy" reached end-of-life in May 2023, but is still stable and works with PX4.')]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("PX4 is not as well tested on Ubuntu 22.04 as it is on Ubuntu 20.04 (at time of writing), and Ubuntu 20.04 is needed if you want to use "),a("RouterLink",{attrs:{to:"/en/sim_gazebo_classic/"}},[t._v("Gazebo Classic")]),t._v(".")],1)]),t._v(" "),a("p",[t._v("To setup ROS 2 for use with PX4:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#install-px4"}},[t._v("Install PX4")]),t._v(" (to use the PX4 simulator)")]),t._v(" "),a("li",[a("a",{attrs:{href:"#install-ros-2"}},[t._v("Install ROS 2")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#setup-micro-xrce-dds-agent-client"}},[t._v("Setup Micro XRCE-DDS Agent & Client")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#build-ros-2-workspace"}},[t._v("Build & Run ROS 2 Workspace")])])]),t._v(" "),a("p",[t._v("Other dependencies of the architecture that are installed automatically, such as "),a("em",[t._v("Fast DDS")]),t._v(", are not covered.")]),t._v(" "),a("h3",{attrs:{id:"install-px4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-px4"}},[t._v("#")]),t._v(" Install PX4")]),t._v(" "),a("p",[t._v("You need to install the PX4 development toolchain in order to use the simulator.")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("The only dependency ROS 2 has on PX4 is the set of message definitions, which it gets from "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),a("OutboundLink")],1),t._v(".\nYou only need to install PX4 if you need the simulator (as we do in this guide), or if you are creating a build that publishes custom uORB topics.")])]),t._v(" "),a("p",[t._v("Set up a PX4 development environment on Ubuntu in the normal way:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/PX4-Autopilot.git --recursive\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" ./PX4-Autopilot/Tools/setup/ubuntu.sh\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" PX4-Autopilot/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl\n")])])]),a("p",[t._v("For more information and troubleshooting see: "),a("RouterLink",{attrs:{to:"/en/dev_setup/dev_env_linux_ubuntu.html"}},[t._v("Ubuntu Development Environment")]),t._v(" and "),a("RouterLink",{attrs:{to:"/en/dev_setup/building_px4.html"}},[t._v("Download PX4 source")]),t._v(".")],1),t._v(" "),a("h3",{attrs:{id:"install-ros-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-ros-2"}},[t._v("#")]),t._v(" Install ROS 2")]),t._v(" "),a("p",[t._v("To install ROS 2 and its dependencies:")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Install ROS 2.")]),t._v(" "),a("tabs",[a("tab",{attrs:{name:"humble"}},[a("p",[t._v('To install ROS 2 "Humble" on Ubuntu 22.04:')]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" locales\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" locale-gen en_US en_US.UTF-8\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-locale "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LC_ALL")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LANG")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LANG")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" software-properties-common\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository universe\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -y\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deb [arch='),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("dpkg --print-architecture"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" /etc/os-release "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" $UBUNTU_CODENAME"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(' main"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /etc/apt/sources.list.d/ros2.list "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-humble-desktop\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-dev-tools\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"source /opt/ros/humble/setup.bash"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" .bashrc\n")])])]),a("p",[t._v("The instructions above are reproduced from the official installation guide: "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Install ROS 2 Humble"),a("OutboundLink")],1),t._v(".\nYou can install "),a("em",[t._v("either")]),t._v(" the desktop ("),a("code",[t._v("ros-humble-desktop")]),t._v(") "),a("em",[t._v("or")]),t._v(" bare-bones versions ("),a("code",[t._v("ros-humble-ros-base")]),t._v("), "),a("em",[t._v("and")]),t._v(" the development tools ("),a("code",[t._v("ros-dev-tools")]),t._v(").")])]),t._v(" "),a("tab",{attrs:{name:"foxy"}},[a("p",[t._v('To install ROS 2 "Foxy" on Ubuntu 20.04:')]),t._v(" "),a("ul",[a("li",[t._v("Follow the official installation guide: "),a("a",{attrs:{href:"https://index.ros.org/doc/ros2/Installation/Foxy/Linux-Install-Debians/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Install ROS 2 Foxy"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("p",[t._v("You can install "),a("em",[t._v("either")]),t._v(" the desktop ("),a("code",[t._v("ros-foxy-desktop")]),t._v(") "),a("em",[t._v("or")]),t._v(" bare-bones versions ("),a("code",[t._v("ros-foxy-ros-base")]),t._v("), "),a("em",[t._v("and")]),t._v(" the development tools ("),a("code",[t._v("ros-dev-tools")]),t._v(").")])])],1)],1),t._v(" "),a("li",[a("p",[t._v("Some Python dependencies must also be installed (using "),a("strong",[a("code",[t._v("pip")])]),t._v(" or "),a("strong",[a("code",[t._v("apt")])]),t._v("):")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --user -U empy pyros-genmsg setuptools\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"setup-micro-xrce-dds-agent-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-micro-xrce-dds-agent-client"}},[t._v("#")]),t._v(" Setup Micro XRCE-DDS Agent & Client")]),t._v(" "),a("p",[t._v("For ROS 2 to communicate with PX4, "),a("RouterLink",{attrs:{to:"/en/modules/modules_system.html#uxrce-dds-client"}},[t._v("uXRCE-DDS client")]),t._v(" must be running on PX4, connected to a micro XRCE-DDS agent running on the companion computer.")],1),t._v(" "),a("h4",{attrs:{id:"setup-the-agent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-the-agent"}},[t._v("#")]),t._v(" Setup the Agent")]),t._v(" "),a("p",[t._v("The agent can be installed onto the companion computer in a "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html#micro-xrce-dds-agent-installation"}},[t._v("number of ways")]),t._v('.\nBelow we show how to build the agent "standalone" from source and connect to a client running on the PX4 simulator.')],1),t._v(" "),a("p",[t._v("To setup and start the agent:")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Open a terminal.")])]),t._v(" "),a("li",[a("p",[t._v("Enter the following commands to fetch and build the agent from source:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/eProsima/Micro-XRCE-DDS-Agent.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" Micro-XRCE-DDS-Agent\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" build\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" build\ncmake "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ldconfig /usr/local/lib/\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Start the agent with settings for connecting to the uXRCE-DDS client running on the simulator:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("MicroXRCEAgent udp4 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v("\n")])])])])]),t._v(" "),a("p",[t._v("The agent is now running, but you won't see much until we start PX4 (in the next step).")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("You can leave the agent running in this terminal!\nNote that only one agent is allowed per connection channel.")])]),t._v(" "),a("h4",{attrs:{id:"start-the-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#start-the-client"}},[t._v("#")]),t._v(" Start the Client")]),t._v(" "),a("p",[t._v("The PX4 simulator starts the uXRCE-DDS client automatically, connecting to UDP port 8888 on the local host.")]),t._v(" "),a("p",[t._v("To start the simulator (and client):")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Open a new terminal in the root of the "),a("strong",[t._v("PX4 Autopilot")]),t._v(" repo that was installed above.")])]),t._v(" "),a("li",[a("p",[t._v("Start a PX4 "),a("RouterLink",{attrs:{to:"/en/sim_gazebo_gz/"}},[t._v("Gazebo")]),t._v(" simulation using:")],1),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gz_x500\n")])])])])]),t._v(" "),a("p",[t._v("The agent and client are now running they should connect.")]),t._v(" "),a("p",[t._v("The PX4 terminal displays the "),a("RouterLink",{attrs:{to:"/en/debug/system_console.html"}},[t._v("NuttShell/PX4 System Console")]),t._v(" output as PX4 boots and runs.\nAs soon as the agent connects the output should include "),a("code",[t._v("INFO")]),t._v(" messages showing creation of data writers:")],1),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("...\nINFO  [uxrce_dds_client] synchronized with time offset 1675929429203524us\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/failsafe_flags data writer, topic id: 83\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/sensor_combined data writer, topic id: 168\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/timesync_status data writer, topic id: 188\n...\n")])])]),a("p",[t._v("The micro XRCE-DDS agent terminal should also start to show output, as equivalent topics are created in the DDS network:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("...\n[1675929445.268957] info     | ProxyClient.cpp    | create_publisher         | publisher created      | client_key: 0x00000001, publisher_id: 0x0DA(3), participant_id: 0x001(1)\n[1675929445.269521] info     | ProxyClient.cpp    | create_datawriter        | datawriter created     | client_key: 0x00000001, datawriter_id: 0x0DA(5), publisher_id: 0x0DA(3)\n[1675929445.270412] info     | ProxyClient.cpp    | create_topic             | topic created          | client_key: 0x00000001, topic_id: 0x0DF(2), participant_id: 0x001(1)\n...\n")])])]),a("h3",{attrs:{id:"build-ros-2-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-ros-2-workspace"}},[t._v("#")]),t._v(" Build ROS 2 Workspace")]),t._v(" "),a("p",[t._v("This section shows how create a ROS 2 workspace hosted in your home directory (modify the commands as needed to put the source code elsewhere).")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),a("OutboundLink")],1),t._v(" packages are cloned to a workspace folder, and then the "),a("code",[t._v("colcon")]),t._v(" tool is used to build the workspace.\nThe example is run using "),a("code",[t._v("ros2 launch")]),t._v(".")]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("The example builds the "),a("a",{attrs:{href:"#ros-2-listener"}},[t._v("ROS 2 Listener")]),t._v(" example application, located in "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),a("OutboundLink")],1),t._v(".\n"),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),a("OutboundLink")],1),t._v(" is needed too so that the example can interpret PX4 ROS 2 topics.")])]),t._v(" "),a("h4",{attrs:{id:"building-the-workspace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-the-workspace"}},[t._v("#")]),t._v(" Building the Workspace")]),t._v(" "),a("p",[t._v("To create and build the workspace:")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Open a new terminal.")])]),t._v(" "),a("li",[a("p",[t._v("Create and navigate into a new workspace directory using:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p ~/ws_sensor_combined/src/\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/src/\n")])])]),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("A naming convention for workspace folders can make it easier to manage workspaces.")])])]),t._v(" "),a("li",[a("p",[t._v("Clone the example repository and "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),a("OutboundLink")],1),t._v(" to the "),a("code",[t._v("/src")]),t._v(" directory (the "),a("code",[t._v("main")]),t._v(" branch is cloned by default, which corresponds to the the version of PX4 we are running):")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/px4_msgs.git\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/px4_ros_com.git\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Source the ROS 2 development environment into the current terminal and compile the workspace using "),a("code",[t._v("colcon")]),t._v(":")]),t._v(" "),a("tabs",[a("tab",{attrs:{name:"humble"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash\ncolcon build\n")])])])]),t._v(" "),a("tab",{attrs:{name:"foxy"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/foxy/setup.bash\ncolcon build\n")])])])])],1),t._v(" "),a("p",[t._v("This builds all the folders under "),a("code",[t._v("/src")]),t._v(" using the sourced toolchain.")])],1)]),t._v(" "),a("h4",{attrs:{id:"running-the-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-the-example"}},[t._v("#")]),t._v(" Running the Example")]),t._v(" "),a("p",[t._v("To run the executables that you just built, you need to source "),a("code",[t._v("local_setup.bash")]),t._v('.\nThis provides access to the "environment hooks" for the current workspace.\nIn other words, it makes the executables that were just built available in the current terminal.')]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html#source-the-overlay",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS2 beginner tutorials"),a("OutboundLink")],1),t._v(" recommend that you "),a("em",[t._v("open a new terminal")]),t._v(" for running your executables.")])]),t._v(" "),a("p",[t._v("In a new terminal:")]),t._v(" "),a("ol",[a("li",[a("p",[t._v('Navigate into the top level of your workspace directory and source the ROS 2 environment (in this case "Humble"):')]),t._v(" "),a("tabs",[a("tab",{attrs:{name:"humble"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash\n")])])])]),t._v(" "),a("tab",{attrs:{name:"foxy"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/foxy/setup.bash\n")])])])])],1)],1),t._v(" "),a("li",[a("p",[t._v("Source the "),a("code",[t._v("local_setup.bash")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" install/local_setup.bash\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Now launch the example.\nNote here that we use "),a("code",[t._v("ros2 launch")]),t._v(", which is described below.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ros2 launch px4_ros_com sensor_combined_listener.launch.py\n")])])])])]),t._v(" "),a("p",[t._v("If this is working you should see data being printed on the terminal/console where you launched the ROS listener:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("RECEIVED DATA FROM SENSOR COMBINED\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("\nts: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("870938190")]),t._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00341645")]),t._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00626475")]),t._v("\ngyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -0.000515705\ngyro_integral_dt: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4739")]),t._v("\naccelerometer_timestamp_relative: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -0.273381\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0949186")]),t._v("\naccelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -9.76044\naccelerometer_integral_dt: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4739")]),t._v("\n")])])]),a("h2",{attrs:{id:"controlling-a-vehicle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controlling-a-vehicle"}},[t._v("#")]),t._v(" Controlling a Vehicle")]),t._v(" "),a("p",[t._v("To control applications, ROS 2 applications:")]),t._v(" "),a("ul",[a("li",[t._v("subscribe to (listen to) telemetry topics published by PX4")]),t._v(" "),a("li",[t._v("publish to topics that cause PX4 to perform some action.")])]),t._v(" "),a("p",[t._v("The topics that you can use are defined in "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),a("OutboundLink")],1),t._v(", and you can get more information about their data in the "),a("RouterLink",{attrs:{to:"/en/msg_docs/"}},[t._v("uORB Message Reference")]),t._v(".\nFor example, "),a("RouterLink",{attrs:{to:"/en/msg_docs/VehicleGlobalPosition.html"}},[t._v("VehicleGlobalPosition")]),t._v(" can be used to get the vehicle global position, while "),a("RouterLink",{attrs:{to:"/en/msg_docs/VehicleCommand.html"}},[t._v("VehicleCommand")]),t._v(" can be used to command actions such as takeoff and land.")],1),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"#ros-2-example-applications"}},[t._v("ROS 2 Example applications")]),t._v(" examples below provide concrete examples of how to use these topics.")]),t._v(" "),a("h2",{attrs:{id:"compatibility-issues"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compatibility-issues"}},[t._v("#")]),t._v(" Compatibility Issues")]),t._v(" "),a("p",[t._v("This section contains information that may affect how you write your ROS code.")]),t._v(" "),a("h3",{attrs:{id:"ros-2-subscriber-qos-settings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-subscriber-qos-settings"}},[t._v("#")]),t._v(" ROS 2 Subscriber QoS Settings")]),t._v(" "),a("p",[t._v("ROS 2 code that subscribes to topics published by PX4 "),a("em",[t._v("must")]),t._v(" specify a appropriate (compatible) QoS setting in order to listen to topics.\nSpecifically, nodes should subscribe using the ROS 2 predefined QoS sensor data (from the "),a("a",{attrs:{href:"#ros-2-listener"}},[t._v("listener example source code")]),t._v("):")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nrmw_qos_profile_t qos_profile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rmw_qos_profile_sensor_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" qos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoSInitialization")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("qos_profile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos_profile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nsubscription_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_subscription")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/fmu/out/sensor_combined"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("This is needed because the ROS 2 default "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html#qos-profiles",target:"_blank",rel:"noopener noreferrer"}},[t._v("Quality of Service (QoS) settings"),a("OutboundLink")],1),t._v(" are different from the settings used by PX4.\nNot all combinations of publisher-subscriber "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html#qos-compatibilities",target:"_blank",rel:"noopener noreferrer"}},[t._v("Qos settings are possible"),a("OutboundLink")],1),t._v(", and it turns out that the default ROS 2 settings for subscribing are not!\nNote that ROS code does not have to set QoS settings when publishing (the PX4 settings are compatible with ROS defaults in this case).")]),t._v(" "),a("h3",{attrs:{id:"ros-2-px4-frame-conventions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-px4-frame-conventions"}},[t._v("#")]),t._v(" ROS 2 & PX4 Frame Conventions")]),t._v(" "),a("p",[t._v("The local/world and body frames used by ROS and PX4 are different.")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Frame")]),t._v(" "),a("th",[t._v("PX4")]),t._v(" "),a("th",[t._v("ROS")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Body")]),t._v(" "),a("td",[t._v("FRD (X "),a("strong",[t._v("F")]),t._v("orward, Y "),a("strong",[t._v("R")]),t._v("ight, Z "),a("strong",[t._v("D")]),t._v("own)")]),t._v(" "),a("td",[t._v("FLU (X "),a("strong",[t._v("F")]),t._v("orward, Y "),a("strong",[t._v("L")]),t._v("eft, Z "),a("strong",[t._v("U")]),t._v("p)")])]),t._v(" "),a("tr",[a("td",[t._v("World")]),t._v(" "),a("td",[t._v("FRD or NED (X "),a("strong",[t._v("N")]),t._v("orth, Y "),a("strong",[t._v("E")]),t._v("ast, Z "),a("strong",[t._v("D")]),t._v("own)")]),t._v(" "),a("td",[t._v("FLU or ENU (X "),a("strong",[t._v("E")]),t._v("ast, Y "),a("strong",[t._v("N")]),t._v("orth, Z "),a("strong",[t._v("U")]),t._v("p)")])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("See "),a("a",{attrs:{href:"http://www.ros.org/reps/rep-0105.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("REP105: Coordinate Frames for Mobile Platforms"),a("OutboundLink")],1),t._v(" for more information about ROS frames.")])]),t._v(" "),a("p",[t._v("Both frames are shown in the image below (FRD on the left/FLU on the right).")]),t._v(" "),a("p",[a("img",{attrs:{src:e(350),alt:"Reference frames"}})]),t._v(" "),a("p",[t._v("The FRD (NED) conventions are adopted on "),a("strong",[t._v("all")]),t._v(" PX4 topics unless explicitly specified in the associated message definition.\nTherefore, ROS 2 nodes that want to interface with PX4 must take care of the frames conventions.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("To rotate a vector from ENU to NED two basic rotations must be performed:")]),t._v(" "),a("ul",[a("li",[t._v("first a pi/2 rotation around the "),a("code",[t._v("Z")]),t._v("-axis (up),")]),t._v(" "),a("li",[t._v("then a pi rotation around the "),a("code",[t._v("X")]),t._v("-axis (old East/new North).")])])]),t._v(" "),a("li",[a("p",[t._v("To rotate a vector from NED to ENU two basic rotations must be performed:")])]),t._v(" "),a("li",[a("ul",[a("li",[t._v("first a pi/2 rotation around the "),a("code",[t._v("Z")]),t._v("-axis (down),")]),t._v(" "),a("li",[t._v("then a pi rotation around the "),a("code",[t._v("X")]),t._v("-axis (old North/new East). Note that the two resulting operations are mathematically equivalent.")])])]),t._v(" "),a("li",[a("p",[t._v("To rotate a vector from FLU to FRD a pi rotation around the "),a("code",[t._v("X")]),t._v("-axis (front) is sufficient.")])]),t._v(" "),a("li",[a("p",[t._v("To rotate a vector from FRD to FLU a pi rotation around the "),a("code",[t._v("X")]),t._v("-axis (front) is sufficient.")])])]),t._v(" "),a("p",[t._v("Examples of vectors that require rotation are:")]),t._v(" "),a("ul",[a("li",[t._v("all fields in "),a("RouterLink",{attrs:{to:"/en/msg_docs/TrajectorySetpoint.html"}},[t._v("TrajectorySetpoint")]),t._v(" message; ENU to NED conversion is required before sending them.")],1),t._v(" "),a("li",[t._v("all fields in "),a("RouterLink",{attrs:{to:"/en/msg_docs/VehicleThrustSetpoint.html"}},[t._v("VehicleThrustSetpoint")]),t._v(" message; FLU to FRD conversion is required before sending them.")],1)]),t._v(" "),a("p",[t._v("Similarly to vectors, also quanternions representing the attitude of the vehicle (body frame) w.r.t. the world frame require conversion.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_ros_com"),a("OutboundLink")],1),t._v(" provides the shared library "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/include/px4_ros_com/frame_transforms.h",target:"_blank",rel:"noopener noreferrer"}},[t._v("frame_transforms"),a("OutboundLink")],1),t._v(" to easily perform such conversions.")]),t._v(" "),a("h2",{attrs:{id:"ros-2-example-applications"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-example-applications"}},[t._v("#")]),t._v(" ROS 2 Example Applications")]),t._v(" "),a("h3",{attrs:{id:"ros-2-listener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-listener"}},[t._v("#")]),t._v(" ROS 2 Listener")]),t._v(" "),a("p",[t._v("The ROS 2 "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/tree/main/src/examples/listeners",target:"_blank",rel:"noopener noreferrer"}},[t._v("listener examples"),a("OutboundLink")],1),t._v(" in the "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),a("OutboundLink")],1),t._v(" repo demonstrate how to write ROS nodes to listen to topics published by PX4.")]),t._v(" "),a("p",[t._v("Here we consider the "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/src/examples/listeners/sensor_combined_listener.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("sensor_combined_listener.cpp"),a("OutboundLink")],1),t._v(" node under "),a("code",[t._v("px4_ros_com/src/examples/listeners")]),t._v(", which subscribes to the "),a("RouterLink",{attrs:{to:"/en/msg_docs/SensorCombined.html"}},[t._v("SensorCombined")]),t._v(" message.")],1),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[a("a",{attrs:{href:"#build-ros-2-workspace"}},[t._v("Build ROS 2 Workspace")]),t._v(" shows how to build and run this example.")])]),t._v(" "),a("p",[t._v("The code first imports the C++ libraries needed to interface with the ROS 2 middleware and the header file for the "),a("code",[t._v("SensorCombined")]),t._v(" message to which the node subscribes:")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<rclcpp/rclcpp.hpp>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<px4_msgs/msg/sensor_combined.hpp>")])]),t._v("\n")])])]),a("p",[t._v("Then it creates a "),a("code",[t._v("SensorCombinedListener")]),t._v(" class that subclasses the generic "),a("code",[t._v("rclcpp::Node")]),t._v(" base class.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @brief Sensor Combined uORB topic data callback\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SensorCombinedListener")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token base-clause"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),a("p",[t._v("This creates a callback function for when the "),a("code",[t._v("SensorCombined")]),t._v(" uORB messages are received (now as micro XRCE-DDS messages), and outputs the content of the message fields each time the message is received.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("explicit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SensorCombinedListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sensor_combined_listener"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\trmw_qos_profile_t qos_profile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rmw_qos_profile_sensor_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" qos "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoSInitialization")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("qos_profile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos_profile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\n\t\tsubscription_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_subscription")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/fmu/out/sensor_combined"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("UniquePtr msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RECEIVED SENSOR COMBINED DATA"')]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"============================="')]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ts: "')]),t._v("          "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("timestamp    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[0]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[1]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[2]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_integral_dt: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_integral_dt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_timestamp_relative: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_timestamp_relative "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[0]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[1]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[2]: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_integral_dt: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_integral_dt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("The subscription sets a QoS profile based on "),a("code",[t._v("rmw_qos_profile_sensor_data")]),t._v(".\nThis is needed because the default ROS 2 QoS profile for subscribers is incompatible with the PX4 profile for publishers.\nFor more information see: "),a("a",{attrs:{href:"#ros-2-subscriber-qos-settings"}},[t._v("ROS 2 Subscriber QoS Settings")]),t._v(",")])]),t._v(" "),a("p",[t._v("The lines below create a publisher to the "),a("code",[t._v("SensorCombined")]),t._v(" uORB topic, which can be matched with one or more compatible ROS 2 subscribers to the "),a("code",[t._v("fmu/sensor_combined/out")]),t._v(" ROS 2 topic.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("Subscription"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr subscription_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("The instantiation of the "),a("code",[t._v("SensorCombinedListener")]),t._v(" class as a ROS node is done on the "),a("code",[t._v("main")]),t._v(" function.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Starting sensor_combined listener node..."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setvbuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _IONBF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BUFSIZ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("spin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SensorCombinedListener"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("This particular example has an associated launch file at "),a("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/launch/sensor_combined_listener.launch.py",target:"_blank",rel:"noopener noreferrer"}},[t._v("launch/sensor_combined_listener.launch.py"),a("OutboundLink")],1),t._v(".\nThis allows it to be launched using the "),a("a",{attrs:{href:"#ros2-launch"}},[a("code",[t._v("ros2 launch")])]),t._v(" command.")]),t._v(" "),a("h3",{attrs:{id:"ros-2-advertiser"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-advertiser"}},[t._v("#")]),t._v(" ROS 2 Advertiser")]),t._v(" "),a("p",[t._v("A ROS 2 advertiser node publishes data into the DDS/RTPS network (and hence to the PX4 Autopilot).")]),t._v(" "),a("p",[t._v("Taking as an example the "),a("code",[t._v("debug_vect_advertiser.cpp")]),t._v(" under "),a("code",[t._v("px4_ros_com/src/advertisers")]),t._v(", first we import required headers, including the "),a("code",[t._v("debug_vect")]),t._v(" msg header.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<chrono>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<rclcpp/rclcpp.hpp>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<px4_msgs/msg/debug_vect.hpp>")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono_literals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Then the code creates a "),a("code",[t._v("DebugVectAdvertiser")]),t._v(" class that subclasses the generic "),a("code",[t._v("rclcpp::Node")]),t._v(" base class.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DebugVectAdvertiser")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token base-clause"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" rclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),a("p",[t._v("The code below creates a function for when messages are to be sent.\nThe messages are sent based on a timed callback, which sends two messages per second based on a timer.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DebugVectAdvertiser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug_vect_advertiser"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tpublisher_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_publisher")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("DebugVect"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmu/debug_vect/in"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" timer_callback "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" debug_vect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DebugVect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tdebug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("time_point_cast")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("microseconds"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("steady_clock"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("time_since_epoch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("string name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("begin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("begin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tdebug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tdebug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tdebug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("z "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("RCLCPP_INFO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_logger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\033[97m Publishing debug_vect: time: %llu x: %f y: %f z: %f \\033[0m"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("publisher_"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("publish")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("debug_vect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\ttimer_ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_wall_timer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v("ms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timer_callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("TimerBase"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr timer_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("Publisher"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("DebugVect"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr publisher_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("The instantiation of the "),a("code",[t._v("DebugVectAdvertiser")]),t._v(" class as a ROS node is done on the "),a("code",[t._v("main")]),t._v(" function.")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tstd"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Starting debug_vect advertiser node..."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setvbuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _IONBF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BUFSIZ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("spin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("DebugVectAdvertiser"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\trclcpp"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"offboard-control"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#offboard-control"}},[t._v("#")]),t._v(" Offboard Control")]),t._v(" "),a("p",[t._v("For a complete reference example on how to use Offboard control with PX4, see: "),a("RouterLink",{attrs:{to:"/en/ros/ros2_offboard_control.html"}},[t._v("ROS 2 Offboard control example")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"using-flight-controller-hardware"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-flight-controller-hardware"}},[t._v("#")]),t._v(" Using Flight Controller Hardware")]),t._v(" "),a("p",[t._v("ROS 2 with PX4 running on a flight controller is almost the same as working with PX4 on the simulator.\nThe only difference is that you need to start both the agent "),a("em",[t._v("and the client")]),t._v(", with settings appropriate for the communication channel.")]),t._v(" "),a("p",[t._v("For more information see "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html#starting-agent-and-client"}},[t._v("Starting uXRCE-DDS")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"custom-uorb-topics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#custom-uorb-topics"}},[t._v("#")]),t._v(" Custom uORB Topics")]),t._v(" "),a("p",[t._v("ROS 2 needs to have the "),a("em",[t._v("same")]),t._v(" message definitions that were used to create the uXRCE-DDS client module in the PX4 Firmware in order to interpret the messages.\nThe definition are stored in the ROS 2 interface package "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),a("OutboundLink")],1),t._v(" and they are automatically synchronized by CI on the "),a("code",[t._v("main")]),t._v(" and release branches.\nNote that all the messages from PX4 source code are present in the repository, but only those listed in "),a("code",[t._v("dds_topics.yaml")]),t._v(" will be available as ROS 2 topics.\nTherefore,")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("If you're using a main or release version of PX4 you can get the message definitions by cloning the interface package "),a("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),a("OutboundLink")],1),t._v(" into your workspace.")])]),t._v(" "),a("li",[a("p",[t._v("If you're creating or modifying uORB messages you must manually update the messages in your workspace from your PX4 source tree.\nGenerally this means that you would update "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),a("OutboundLink")],1),t._v(", clone the interface package, and then manually synchronize it by copying the new/modified message definitions from "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/main/msg",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/msg"),a("OutboundLink")],1),t._v(" to its "),a("code",[t._v("msg")]),t._v(" folders.\nAssuming that PX4-Autopilot is in your home directory "),a("code",[t._v("~")]),t._v(", while "),a("code",[t._v("px4_msgs")]),t._v(" is in "),a("code",[t._v("~/px4_ros_com/src/")]),t._v(", then the command might be:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" ~/px4_ros_com/src/px4_msgs/msg/*.msg\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" ~/PX4-Autopilot/mgs/*.msg ~/px4_ros_com/src/px4_msgs/msg/\n")])])]),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("Technically, "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),a("OutboundLink")],1),t._v(" completely defines the relationship between PX4 uORB topics and ROS 2 messages.\nFor more information see "),a("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html#dds-topics-yaml"}},[t._v("uXRCE-DDS > DDS Topics YAML")]),t._v(".")],1)])])]),t._v(" "),a("h2",{attrs:{id:"customizing-the-topic-namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#customizing-the-topic-namespace"}},[t._v("#")]),t._v(" Customizing the Topic Namespace")]),t._v(" "),a("p",[t._v("Custom topic namespaces can be applied at build time (changing "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),a("OutboundLink")],1),t._v(") or at runtime (useful for multi vehicle operations):")]),t._v(" "),a("ul",[a("li",[t._v("One possibility is to use the "),a("code",[t._v("-n")]),t._v(" option when starting the "),a("RouterLink",{attrs:{to:"/en/modules/modules_system.html#uxrce-dds-client"}},[t._v("uxrce_dds_client")]),t._v(" from command line.\nThis technique can be used both in simulation and real vehicles.")],1),t._v(" "),a("li",[t._v("A custom namespace can be provided for simulations (only) by setting the environment variable "),a("code",[t._v("PX4_UXRCE_DDS_NS")]),t._v(" before starting the simulation.")])]),t._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("Changing the namespace at runtime will append the desired namespace as a prefix to all "),a("code",[t._v("topic")]),t._v(" fields in "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),a("OutboundLink")],1),t._v(".\nTherefore, commands like:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("uxrce_dds_client start -n uav_1\n")])])]),a("p",[t._v("or")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PX4_UXRCE_DDS_NS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("uav_1 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gz_x500\n")])])]),a("p",[t._v("will generate topics under the namespaces:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("/uav_1/fmu/in/  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for subscribers")]),t._v("\n/uav_1/fmu/out/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for publishers")]),t._v("\n")])])])]),t._v(" "),a("h2",{attrs:{id:"ros2-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros2-cli"}},[t._v("#")]),t._v(" ros2 CLI")]),t._v(" "),a("p",[t._v("The "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ros2 CLI"),a("OutboundLink")],1),t._v(" is a useful tool for working with ROS.\nYou can use it, for example, to quickly check whether topics are being published, and also inspect them in detail if you have "),a("code",[t._v("px4_msg")]),t._v(" in the workspace.\nThe command also lets you launch more complex ROS systems via a launch file.\nA few possibilities are demonstrated below.")]),t._v(" "),a("h3",{attrs:{id:"ros2-topic-list"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-list"}},[t._v("#")]),t._v(" ros2 topic list")]),t._v(" "),a("p",[t._v("Use "),a("code",[t._v("ros2 topic list")]),t._v(" to list the topics visible to ROS 2:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ros2 topic list\n")])])]),a("p",[t._v("If PX4 is connected to the agent, the result will be a list of topic types:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/fmu/in/obstacle_distance\n/fmu/in/offboard_control_mode\n/fmu/in/onboard_computer_status\n...\n")])])]),a("p",[t._v("Note that the workspace does not need to build with "),a("code",[t._v("px4_msgs")]),t._v(" for this to succeed; topic type information is part of the message payload.")]),t._v(" "),a("h3",{attrs:{id:"ros2-topic-echo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-echo"}},[t._v("#")]),t._v(" ros2 topic echo")]),t._v(" "),a("p",[t._v("Use "),a("code",[t._v("ros2 topic echo")]),t._v(" to show the details of a particular topic.")]),t._v(" "),a("p",[t._v("Unlike with "),a("code",[t._v("ros2 topic list")]),t._v(", for this to work you must be in a workspace has built the "),a("code",[t._v("px4_msgs")]),t._v(" and sourced "),a("code",[t._v("local_setup.bash")]),t._v(" so that ROS can interpret the messages.")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("ros2 topic "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" /fmu/out/vehicle_status\n")])])]),a("p",[t._v("The command will echo the topic details as they update.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("---\ntimestamp: 1675931593364359\narmed_time: 0\ntakeoff_time: 0\narming_state: 1\nlatest_arming_reason: 0\nlatest_disarming_reason: 0\nnav_state_timestamp: 3296000\nnav_state_user_intention: 4\nnav_state: 4\nfailure_detector_status: 0\nhil_state: 0\n...\n---\n")])])]),a("h3",{attrs:{id:"ros2-topic-hz"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-hz"}},[t._v("#")]),t._v(" ros2 topic hz")]),t._v(" "),a("p",[t._v("You can get statistics about the rates of messages using "),a("code",[t._v("ros2 topic hz")]),t._v(".\nFor example, to get the rates for "),a("code",[t._v("SensorCombined")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ros2 topic hz /fmu/out/sensor_combined\n")])])]),a("p",[t._v("The output will look something like:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("average rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("248.187")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00147s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2724")]),t._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("248.006")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00147s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2972")]),t._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.330")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00148s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3212")]),t._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.497")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00149s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3464")]),t._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.458")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00149s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3712")]),t._v("\naverage rate: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.485")]),t._v("\n  min: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00148s window: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3960")]),t._v("\n")])])]),a("h3",{attrs:{id:"ros2-launch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ros2-launch"}},[t._v("#")]),t._v(" ros2 launch")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("ros2 launch")]),t._v(" command is used to start a ROS 2 launch file.\nFor example, above we used "),a("code",[t._v("ros2 launch px4_ros_com sensor_combined_listener.launch.py")]),t._v(" to start the listener example.")]),t._v(" "),a("p",[t._v("You don't need to have a launch file, but they are very useful if you have a complex ROS 2 system that needs to start several components.")]),t._v(" "),a("p",[t._v("For information about launch files see "),a("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Intermediate/Launch/Creating-Launch-Files.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS 2 Tutorials > Creating launch files"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"troubleshooting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),a("h3",{attrs:{id:"missing-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#missing-dependencies"}},[t._v("#")]),t._v(" Missing dependencies")]),t._v(" "),a("p",[t._v("The standard installation should include all the tools needed by ROS 2.")]),t._v(" "),a("p",[t._v("If any are missing, they can be added separately:")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[a("code",[t._v("colcon")])]),t._v(" build tools should be in the development tools.\nIt can be installed using:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" python3-colcon-common-extensions\n")])])])]),t._v(" "),a("li",[a("p",[t._v("The Eigen3 library used by the transforms library should be in the both the desktop and base packages.\nIt should be installed as shown:")]),t._v(" "),a("tabs",[a("tab",{attrs:{name:"humble"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-humble-eigen3-cmake-module\n")])])])]),t._v(" "),a("tab",{attrs:{name:"foxy"}},[a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-foxy-eigen3-cmake-module\n")])])])])],1)],1)]),t._v(" "),a("h2",{attrs:{id:"additional-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#additional-information"}},[t._v("#")]),t._v(" Additional information")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=F5oelooT67E",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS 2 in PX4: Technical Details of a Seamless Transition to XRCE-DDS"),a("OutboundLink")],1),t._v(" - Pablo Garrido & Nuno Marques (youtube)")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/ros2/ros2/wiki/DDS-and-ROS-middleware-implementations",target:"_blank",rel:"noopener noreferrer"}},[t._v("DDS and ROS middleware implementations"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports},350:function(t,s,e){t.exports=e.p+"assets/img/ref_frames.ec278837.png"},351:function(t,s,e){t.exports=e.p+"assets/img/architecture_xrce-dds_ros2.fed61809.svg"}}]);