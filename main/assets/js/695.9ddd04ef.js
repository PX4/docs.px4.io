(window.webpackJsonp=window.webpackJsonp||[]).push([[695],{2013:function(e,t,o){"use strict";o.r(t);var i=o(19),n=Object(i.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"offboard-mode"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#offboard-mode"}},[e._v("#")]),e._v(" Offboard Mode")]),e._v(" "),i("p",[i("RouterLink",{attrs:{to:"/en/getting_started/flight_modes.html#key_position_fixed"}},[i("img",{attrs:{src:o(327),title:"Position fix required (e.g. GPS)",width:"30px"}})])],1),e._v(" "),i("p",[e._v("The vehicle obeys position, velocity, acceleration, attitude, attitude rates or thrust/torque setpoints provided by some source that is external to the flight stack, such as a companion computer.\nThe setpoints may be provided using MAVLink (or a MAVLink API such as "),i("a",{attrs:{href:"https://mavsdk.mavlink.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAVSDK"),i("OutboundLink")],1),e._v(") or by "),i("RouterLink",{attrs:{to:"/en/ros/ros2.html"}},[e._v("ROS 2")]),e._v(".")],1),e._v(" "),i("p",[e._v('PX4 requires that the external controller provides a continuous 2Hz "proof of life" signal, by streaming any of the supported MAVLink setpoint messages or the ROS 2 '),i("RouterLink",{attrs:{to:"/en/msg_docs/OffboardControlMode.html"}},[e._v("OffboardControlMode")]),e._v(" message.\nPX4 enables offboard control only after receiving the signal for more than a second, and will regain control if the signal stops.")],1),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("ul",[i("li",[e._v("This mode requires position or pose/attitude information - e.g. GPS, optical flow, visual-inertial odometry, mocap, etc.")]),e._v(" "),i("li",[e._v("RC control is disabled except to change modes (you can also fly without any manual controller at all by setting the parameter "),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_RC_IN_MODE"}},[e._v("COM_RC_IN_MODE")]),e._v(" to 4: Stick input disabled).")],1),e._v(" "),i("li",[e._v("The vehicle must be already be receiving a stream of MAVLink setpoint messages or ROS 2 "),i("RouterLink",{attrs:{to:"/en/msg_docs/OffboardControlMode.html"}},[e._v("OffboardControlMode")]),e._v(" messages before arming in offboard mode or switching to offboard mode when flying.")],1),e._v(" "),i("li",[e._v("The vehicle will exit offboard mode if MAVLink setpoint messages or "),i("code",[e._v("OffboardControlMode")]),e._v(" are not received at a rate of > 2Hz.")]),e._v(" "),i("li",[e._v("Not all coordinate frames and field values allowed by MAVLink are supported for all setpoint messages and vehicles.\nRead the sections below "),i("em",[e._v("carefully")]),e._v(" to ensure only supported values are used.")])])]),e._v(" "),i("h2",{attrs:{id:"description"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#description"}},[e._v("#")]),e._v(" Description")]),e._v(" "),i("p",[e._v("Offboard mode is used for controlling vehicle movement and attitude, by setting position, velocity, acceleration, attitude, attitude rates or thrust/torque setpoints.")]),e._v(" "),i("p",[e._v("PX4 must receive a stream of MAVLink setpoint messages or the ROS 2 "),i("RouterLink",{attrs:{to:"/en/msg_docs/OffboardControlMode.html"}},[e._v("OffboardControlMode")]),e._v(" at 2 Hz as proof that the external controller is healthy.\nThe stream must be sent for at least a second before PX4 will arm in offboard mode, or switch to offboard mode when flying.\nIf the rate falls below 2Hz while under external control PX4 will switch out of offboard mode after a timeout ("),i("a",{attrs:{href:"#COM_OF_LOSS_T"}},[e._v("COM_OF_LOSS_T")]),e._v("), and attempt to land or perform some other failsafe action.\nThe action depends on whether or not RC control is available, and is defined in the parameter "),i("a",{attrs:{href:"#COM_OBL_RC_ACT"}},[e._v("COM_OBL_RC_ACT")]),e._v(".")],1),e._v(" "),i("p",[e._v('When using MAVLink the setpoint messages convey both the signal to indicate that the external source is "alive", and the setpoint value itself.\nIn order to hold position in this case the vehicle must receive a stream of setpoints for the current position.')]),e._v(" "),i("p",[e._v("When using ROS 2 the proof that the external source is alive is provided by a stream of "),i("RouterLink",{attrs:{to:"/en/msg_docs/OffboardControlMode.html"}},[e._v("OffboardControlMode")]),e._v(" messages, while the actual setpoint is provided by publishing to one of the setpoint uORB topics, such as "),i("RouterLink",{attrs:{to:"/en/msg_docs/TrajectorySetpoint.html"}},[e._v("TrajectorySetpoint")]),e._v(".\nIn order to hold position in this case the vehicle must receive a stream of "),i("code",[e._v("OffboardControlMode")]),e._v(" but would only need the "),i("code",[e._v("TrajectorySetpoint")]),e._v(" once.")],1),e._v(" "),i("p",[e._v("Note that offboard mode only supports a very limited set of MAVLink commands and messages.\nOperations, like taking off, landing, return to launch, may be best handled using the appropriate modes.\nOperations like uploading, downloading missions can be performed in any mode.")]),e._v(" "),i("h2",{attrs:{id:"ros-2-messages"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-messages"}},[e._v("#")]),e._v(" ROS 2 Messages")]),e._v(" "),i("p",[e._v("The following ROS 2 messages and their particular fields and field values are allowed for the specified frames.\nIn addition to providing heartbeat functionality, "),i("code",[e._v("OffboardControlMode")]),e._v(" has two other main purposes:")]),e._v(" "),i("ol",[i("li",[e._v("Controls the level of the "),i("RouterLink",{attrs:{to:"/en/flight_stack/controller_diagrams.html"}},[e._v("PX4 control architecture")]),e._v(" at which offboard setpoints must be injected, and disables the bypassed controllers.")],1),e._v(" "),i("li",[e._v("Determines which valid estimates (position or velocity) are required, and also which setpoint messages should be used.")])]),e._v(" "),i("p",[e._v("The "),i("code",[e._v("OffboardControlMode")]),e._v(" message is defined as shown.")]),e._v(" "),i("div",{staticClass:"language- extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[e._v("# Off-board control mode\n\nuint64 timestamp\t\t# time since system start (microseconds)\n\nbool position\nbool velocity\nbool acceleration\nbool attitude\nbool body_rate\nbool actuator\n")])])]),i("p",[e._v("The fields are ordered in terms of priority such that "),i("code",[e._v("position")]),e._v(" takes precedence over "),i("code",[e._v("velocity")]),e._v(" and later fields, "),i("code",[e._v("velocity")]),e._v(" takes precedence over "),i("code",[e._v("acceleration")]),e._v(", and so on.\nThe first field that has a non-zero value (from top to bottom) defines what valid estimate is required in order to use offboard mode, and the setpoint message(s) that can be used.\nFor example, if the "),i("code",[e._v("acceleration")]),e._v(" field is the first non-zero value, then PX4 requires a valid "),i("code",[e._v("velocity estimate")]),e._v(", and the setpoint must be specified using the "),i("code",[e._v("TrajectorySetpoint")]),e._v(" message.")]),e._v(" "),i("table",[i("thead",[i("tr",[i("th",[e._v("desired control quantity")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("position field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("velocity field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("acceleration field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("attitude field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("body_rate field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("actuator field")]),e._v(" "),i("th",{staticStyle:{"text-align":"center"}},[e._v("required estimate")]),e._v(" "),i("th",[e._v("required message")])])]),e._v(" "),i("tbody",[i("tr",[i("td",[e._v("position (NED)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("position")]),e._v(" "),i("td",[i("code",[e._v("TrajectorySetpoint")])])]),e._v(" "),i("tr",[i("td",[e._v("velocity (NED)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("velocity")]),e._v(" "),i("td",[i("code",[e._v("TrajectorySetpoint")])])]),e._v(" "),i("tr",[i("td",[e._v("acceleration (NED)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("velocity")]),e._v(" "),i("td",[i("code",[e._v("TrajectorySetpoint")])])]),e._v(" "),i("tr",[i("td",[e._v("attitude (FRD)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("none")]),e._v(" "),i("td",[i("RouterLink",{attrs:{to:"/en/msg_docs/VehicleAttitudeSetpoint.html"}},[e._v("VehicleAttitudeSetpoint")])],1)]),e._v(" "),i("tr",[i("td",[e._v("body_rate (FRD)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("-")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("none")]),e._v(" "),i("td",[i("RouterLink",{attrs:{to:"/en/msg_docs/VehicleRatesSetpoint.html"}},[e._v("VehicleRatesSetpoint")])],1)]),e._v(" "),i("tr",[i("td",[e._v("thrust and torque (FRD)")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✗")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("✓")]),e._v(" "),i("td",{staticStyle:{"text-align":"center"}},[e._v("none")]),e._v(" "),i("td",[i("RouterLink",{attrs:{to:"/en/msg_docs/VehicleThrustSetpoint.html"}},[e._v("VehicleThrustSetpoint")]),e._v(" and "),i("RouterLink",{attrs:{to:"/en/msg_docs/VehicleTorqueSetpoint.html"}},[e._v("VehicleTorqueSetpoint")])],1)])])]),e._v(" "),i("p",[e._v("where ✓ means that the bit is set, ✗ means that the bit is not set and "),i("code",[e._v("-")]),e._v(" means that the bit is value is irrelevant.")]),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v("Before using offboard mode with ROS 2, please spend a few minutes understanding the different "),i("RouterLink",{attrs:{to:"/en/ros/ros2_comm.html#ros-2-px4-frame-conventions"}},[e._v("frame conventions")]),e._v(" that PX4 and ROS 2 use.")],1)]),e._v(" "),i("h3",{attrs:{id:"copter"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#copter"}},[e._v("#")]),e._v(" Copter")]),e._v(" "),i("ul",[i("li",[i("p",[i("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/msg/TrajectorySetpoint.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("px4_msgs::msg::TrajectorySetpoint"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported:\n"),i("ul",[i("li",[e._v("Position setpoint ("),i("code",[e._v("position")]),e._v(" different from "),i("code",[e._v("NaN")]),e._v("). Non-"),i("code",[e._v("NaN")]),e._v(" values of velocity and acceleration are used as feedforward terms for the inner loop controllers.")]),e._v(" "),i("li",[e._v("Velocity setpoint ("),i("code",[e._v("velocity")]),e._v(" different from "),i("code",[e._v("NaN")]),e._v(" and "),i("code",[e._v("position")]),e._v(" set to "),i("code",[e._v("NaN")]),e._v("). Non-"),i("code",[e._v("NaN")]),e._v(" values acceleration are used as feedforward terms for the inner loop controllers.")]),e._v(" "),i("li",[e._v("Acceleration setpoint ("),i("code",[e._v("acceleration")]),e._v(" different from "),i("code",[e._v("NaN")]),e._v(" and "),i("code",[e._v("position")]),e._v(" and "),i("code",[e._v("velocity")]),e._v(" set to "),i("code",[e._v("NaN")]),e._v(")")])])])]),e._v(" "),i("ul",[i("li",[e._v("All values are interpreted in NED (Nord, East, Down) coordinate system and the units are [m], [m/s] and [m/s^2] for position, velocity and acceleration, respectively.")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/msg/VehicleAttitudeSetpoint.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("px4_msgs::msg::VehicleAttitudeSetpoint"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combination is supported:\n"),i("ul",[i("li",[e._v("quaterion "),i("code",[e._v("q_d")]),e._v(" + thrust setpoint "),i("code",[e._v("thrust_body")]),e._v(". Non-"),i("code",[e._v("NaN")]),e._v(" values of "),i("code",[e._v("yaw_sp_move_rate")]),e._v(" are used as feedforward terms expressed in Earth frame and in [rad/s].")])])])]),e._v(" "),i("ul",[i("li",[e._v("The quaterion represents the rotation between the drone body FRD (front, right, down) frame and the NED frame. The trust is in the drone body FRD frame and expressed in normalized [-1, 1] values.")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/msg/VehicleRatesSetpoint.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("px4_msgs::msg::VehicleRatesSetpoint"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combination is supported:\n"),i("ul",[i("li",[i("code",[e._v("roll")]),e._v(", "),i("code",[e._v("pitch")]),e._v(", "),i("code",[e._v("yaw")]),e._v(" and "),i("code",[e._v("thrust_body")]),e._v(".")])])])]),e._v(" "),i("ul",[i("li",[e._v("All the value are in the drone body FRD frame. The rates are in [rad/s] while thrust_body is normalized in [-1, 1].")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/msg/VehicleThrustSetpoint.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("px4_msgs::msg::VehicleThrustSetpoint"),i("OutboundLink")],1),e._v(" + "),i("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/main/msg/VehicleTorqueSetpoint.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("px4_msgs::msg::VehicleTorqueSetpoint"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combination is supported:\n"),i("ul",[i("li",[i("code",[e._v("xyz")]),e._v(" for thrust and "),i("code",[e._v("xyz")]),e._v(" for torque.")])])])]),e._v(" "),i("ul",[i("li",[e._v("All the value are in the drone body FRD frame and normalized in [-1, 1].")]),e._v(" "),i("li",[e._v("In order to save resources, this mode is disabled by default.\nIf you want to use it you need to manually add  "),i("code",[e._v("vehicle_thrust_setpoint")]),e._v(" and "),i("code",[e._v("vehicle_torque_setpoint")]),e._v(" to the list of "),i("RouterLink",{attrs:{to:"/en/middleware/uxrce_dds.html#dds-topics-yaml"}},[e._v("subscribed topics")]),e._v(", and manually recompile the firmware.")],1)])])]),e._v(" "),i("h2",{attrs:{id:"mavlink-messages"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#mavlink-messages"}},[e._v("#")]),e._v(" MAVLink Messages")]),e._v(" "),i("p",[e._v("The following MAVLink messages and their particular fields and field values are allowed for the specified frames.")]),e._v(" "),i("h3",{attrs:{id:"copter-vtol"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#copter-vtol"}},[e._v("#")]),e._v(" Copter/VTOL")]),e._v(" "),i("ul",[i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_LOCAL_NED"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported: "),e._v(" "),i("ul",[i("li",[e._v("Position setpoint (only "),i("code",[e._v("x")]),e._v(", "),i("code",[e._v("y")]),e._v(", "),i("code",[e._v("z")]),e._v(")")]),e._v(" "),i("li",[e._v("Velocity setpoint (only "),i("code",[e._v("vx")]),e._v(", "),i("code",[e._v("vy")]),e._v(", "),i("code",[e._v("vz")]),e._v(")")]),e._v(" "),i("li",[e._v("Acceleration setpoint  (only "),i("code",[e._v("afx")]),e._v(", "),i("code",[e._v("afy")]),e._v(", "),i("code",[e._v("afz")]),e._v(")")]),e._v(" "),i("li",[e._v("Position setpoint "),i("strong",[e._v("and")]),e._v(" velocity setpoint (the velocity setpoint is used as feedforward; it is added to the output of the position controller and the result is used as the input to the velocity controller).")]),e._v(" "),i("li",[e._v("Position setpoint "),i("strong",[e._v("and")]),e._v(" velocity setpoint "),i("strong",[e._v("and")]),e._v(" acceleration (the velocity and the acceleration setpoints are used as feedforwards; the velocity setpoint is added to the output of the position controller and the result is used as the input to the velocity controller; the acceleration setpoint is added to the output of the velocity controller and the result used to compute the thrust vector).")])])])]),e._v(" "),i("ul",[i("li",[i("ul",[i("li",[e._v("PX4 supports the following  "),i("code",[e._v("coordinate_frame")]),e._v(" values (only): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_LOCAL_NED"),i("OutboundLink")],1),e._v(" and "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_BODY_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_BODY_NED"),i("OutboundLink")],1),e._v(".")])])])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_GLOBAL_INT",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_GLOBAL_INT"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported: "),e._v(" "),i("ul",[i("li",[i("p",[e._v("Position setpoint (only "),i("code",[e._v("lat_int")]),e._v(", "),i("code",[e._v("lon_int")]),e._v(", "),i("code",[e._v("alt")]),e._v(")")])]),e._v(" "),i("li",[i("p",[e._v("Velocity setpoint (only "),i("code",[e._v("vx")]),e._v(", "),i("code",[e._v("vy")]),e._v(", "),i("code",[e._v("vz")]),e._v(")")])]),e._v(" "),i("li",[i("p",[i("em",[e._v("Thrust")]),e._v(" setpoint  (only "),i("code",[e._v("afx")]),e._v(", "),i("code",[e._v("afy")]),e._v(", "),i("code",[e._v("afz")]),e._v(")")]),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v('Acceleration setpoint values are mapped to create a normalized thrust setpoint (i.e. acceleration setpoints are not "properly" supported).')])])]),e._v(" "),i("li",[i("p",[e._v("Position setpoint "),i("strong",[e._v("and")]),e._v(" velocity setpoint (the velocity setpoint is used as feedforward; it is added to the output of the position controller and the result is used as the input to the velocity controller).")])])])])]),e._v(" "),i("ul",[i("li",[e._v("PX4 supports the following  "),i("code",[e._v("coordinate_frame")]),e._v(" values (only): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_GLOBAL",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_GLOBAL"),i("OutboundLink")],1),e._v(".")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_ATTITUDE_TARGET",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_ATTITUDE_TARGET"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported:\n"),i("ul",[i("li",[e._v("Attitude/orientation ("),i("code",[e._v("SET_ATTITUDE_TARGET.q")]),e._v(") with thrust setpoint ("),i("code",[e._v("SET_ATTITUDE_TARGET.thrust")]),e._v(").")]),e._v(" "),i("li",[e._v("Body rate ("),i("code",[e._v("SET_ATTITUDE_TARGET")]),e._v(" "),i("code",[e._v(".body_roll_rate")]),e._v(" ,"),i("code",[e._v(".body_pitch_rate")]),e._v(", "),i("code",[e._v(".body_yaw_rate")]),e._v(") with thrust setpoint  ("),i("code",[e._v("SET_ATTITUDE_TARGET.thrust")]),e._v(").")])])])])])]),e._v(" "),i("h3",{attrs:{id:"fixed-wing"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#fixed-wing"}},[e._v("#")]),e._v(" Fixed-wing")]),e._v(" "),i("ul",[i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_LOCAL_NED"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported (via "),i("code",[e._v("type_mask")]),e._v("): "),e._v(" "),i("ul",[i("li",[e._v("Position setpoint ("),i("code",[e._v("x")]),e._v(", "),i("code",[e._v("y")]),e._v(", "),i("code",[e._v("z")]),e._v(" only; velocity and acceleration setpoints are ignored).\n"),i("ul",[i("li",[i("p",[e._v("Specify the "),i("em",[e._v("type")]),e._v(" of the setpoint in "),i("code",[e._v("type_mask")]),e._v(" (if these bits are not set the vehicle will fly in a flower-like pattern):")]),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v("Some of the "),i("em",[e._v("setpoint type")]),e._v(" values below are not part of the MAVLink standard for the "),i("code",[e._v("type_mask")]),e._v(" field.")])]),e._v(" "),i("p",[e._v("The values are:")]),e._v(" "),i("ul",[i("li",[e._v("292: Gliding setpoint.\nThis configures TECS to prioritize airspeed over altitude in order to make the vehicle glide when there is no thrust (i.e. pitch is controlled to regulate airspeed).\nIt is equivalent to setting "),i("code",[e._v("type_mask")]),e._v(" as "),i("code",[e._v("POSITION_TARGET_TYPEMASK_Z_IGNORE")]),e._v(", "),i("code",[e._v("POSITION_TARGET_TYPEMASK_VZ_IGNORE")]),e._v(", "),i("code",[e._v("POSITION_TARGET_TYPEMASK_AZ_IGNORE")]),e._v(".")]),e._v(" "),i("li",[e._v("4096: Takeoff setpoint.")]),e._v(" "),i("li",[e._v("8192: Land setpoint.")]),e._v(" "),i("li",[e._v("12288: Loiter setpoint (fly a circle centred on setpoint).")]),e._v(" "),i("li",[e._v("16384: Idle setpoint (zero throttle, zero roll / pitch).")])])])])])])]),e._v(" "),i("li",[e._v("PX4 supports the coordinate frames ("),i("code",[e._v("coordinate_frame")]),e._v(" field): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_LOCAL_NED"),i("OutboundLink")],1),e._v(" and "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_BODY_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_BODY_NED"),i("OutboundLink")],1),e._v(".")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_GLOBAL_INT",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_GLOBAL_INT"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported (via "),i("code",[e._v("type_mask")]),e._v("): "),e._v(" "),i("ul",[i("li",[e._v("Position setpoint (only "),i("code",[e._v("lat_int")]),e._v(", "),i("code",[e._v("lon_int")]),e._v(", "),i("code",[e._v("alt")]),e._v(")\n"),i("ul",[i("li",[i("p",[e._v("Specify the "),i("em",[e._v("type")]),e._v(" of the setpoint in "),i("code",[e._v("type_mask")]),e._v(" (if these bits are not set the vehicle will fly in a flower-like pattern):")]),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v("The "),i("em",[e._v("setpoint type")]),e._v(" values below are not part of the MAVLink standard for the "),i("code",[e._v("type_mask")]),e._v(" field.")])]),e._v(" "),i("p",[e._v("The values are:")]),e._v(" "),i("ul",[i("li",[e._v("4096: Takeoff setpoint.")]),e._v(" "),i("li",[e._v("8192: Land setpoint.")]),e._v(" "),i("li",[e._v("12288: Loiter setpoint (fly a circle centred on setpoint).")]),e._v(" "),i("li",[e._v("16384: Idle setpoint (zero throttle, zero roll / pitch).")])])])])])])]),e._v(" "),i("li",[e._v("PX4 supports the following  "),i("code",[e._v("coordinate_frame")]),e._v(" values (only): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_GLOBAL",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_GLOBAL"),i("OutboundLink")],1),e._v(".")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_ATTITUDE_TARGET",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_ATTITUDE_TARGET"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported:\n"),i("ul",[i("li",[e._v("Attitude/orientation ("),i("code",[e._v("SET_ATTITUDE_TARGET.q")]),e._v(") with thrust setpoint ("),i("code",[e._v("SET_ATTITUDE_TARGET.thrust")]),e._v(").")]),e._v(" "),i("li",[e._v("Body rate ("),i("code",[e._v("SET_ATTITUDE_TARGET")]),e._v(" "),i("code",[e._v(".body_roll_rate")]),e._v(" ,"),i("code",[e._v(".body_pitch_rate")]),e._v(", "),i("code",[e._v(".body_yaw_rate")]),e._v(") with thrust setpoint  ("),i("code",[e._v("SET_ATTITUDE_TARGET.thrust")]),e._v(").")])])])])])]),e._v(" "),i("h3",{attrs:{id:"rover"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#rover"}},[e._v("#")]),e._v(" Rover")]),e._v(" "),i("ul",[i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_LOCAL_NED"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported (in "),i("code",[e._v("type_mask")]),e._v("): "),e._v(" "),i("ul",[i("li",[e._v("Position setpoint (only "),i("code",[e._v("x")]),e._v(", "),i("code",[e._v("y")]),e._v(", "),i("code",[e._v("z")]),e._v(")\n"),i("ul",[i("li",[i("p",[e._v("Specify the "),i("em",[e._v("type")]),e._v(" of the setpoint in "),i("code",[e._v("type_mask")]),e._v(":")]),e._v(" "),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v("The "),i("em",[e._v("setpoint type")]),e._v(" values below are not part of the MAVLink standard for the "),i("code",[e._v("type_mask")]),e._v(" field.\n::")]),e._v(" "),i("p",[e._v("The values are:")]),e._v(" "),i("ul",[i("li",[e._v("12288: Loiter setpoint (vehicle stops when close enough to setpoint).")])])])])])]),e._v(" "),i("li",[e._v("Velocity setpoint (only "),i("code",[e._v("vx")]),e._v(", "),i("code",[e._v("vy")]),e._v(", "),i("code",[e._v("vz")]),e._v(")")])])])]),e._v(" "),i("ul",[i("li",[e._v("PX4 supports the coordinate frames ("),i("code",[e._v("coordinate_frame")]),e._v(" field): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_LOCAL_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_LOCAL_NED"),i("OutboundLink")],1),e._v(" and "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_BODY_NED",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_BODY_NED"),i("OutboundLink")],1),e._v(".")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_POSITION_TARGET_GLOBAL_INT",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_POSITION_TARGET_GLOBAL_INT"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported (in "),i("code",[e._v("type_mask")]),e._v("): "),e._v(" "),i("ul",[i("li",[e._v("Position setpoint (only "),i("code",[e._v("lat_int")]),e._v(", "),i("code",[e._v("lon_int")]),e._v(", "),i("code",[e._v("alt")]),e._v(")")])])]),e._v(" "),i("li",[e._v("Specify the "),i("em",[e._v("type")]),e._v(" of the setpoint in "),i("code",[e._v("type_mask")]),e._v(" (not part of the MAVLink standard).\nThe values are:\n"),i("ul",[i("li",[e._v("Following bits not set then normal behaviour.")]),e._v(" "),i("li",[e._v("12288: Loiter setpoint (vehicle stops when close enough to setpoint).")])])])]),e._v(" "),i("ul",[i("li",[e._v("PX4 supports the coordinate frames ("),i("code",[e._v("coordinate_frame")]),e._v(" field): "),i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_FRAME_GLOBAL",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAV_FRAME_GLOBAL"),i("OutboundLink")],1),e._v(".")])])]),e._v(" "),i("li",[i("p",[i("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#SET_ATTITUDE_TARGET",target:"_blank",rel:"noopener noreferrer"}},[e._v("SET_ATTITUDE_TARGET"),i("OutboundLink")],1)]),e._v(" "),i("ul",[i("li",[e._v("The following input combinations are supported:\n"),i("ul",[i("li",[e._v("Attitude/orientation ("),i("code",[e._v("SET_ATTITUDE_TARGET.q")]),e._v(") with thrust setpoint ("),i("code",[e._v("SET_ATTITUDE_TARGET.thrust")]),e._v(")."),i("div",{staticClass:"custom-block note"},[i("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),i("p",[e._v("Only the yaw setting is actually used/extracted.")])])])])])])])]),e._v(" "),i("h2",{attrs:{id:"offboard-parameters"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#offboard-parameters"}},[e._v("#")]),e._v(" Offboard Parameters")]),e._v(" "),i("p",[i("em",[e._v("Offboard mode")]),e._v(" is affected by the following parameters:")]),e._v(" "),i("table",[i("thead",[i("tr",[i("th",[e._v("Parameter")]),e._v(" "),i("th",[e._v("Description")])])]),e._v(" "),i("tbody",[i("tr",[i("td",[i("a",{attrs:{id:"COM_OF_LOSS_T"}}),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_OF_LOSS_T"}},[e._v("COM_OF_LOSS_T")])],1),e._v(" "),i("td",[e._v("Time-out (in seconds) to wait when offboard connection is lost before triggering offboard lost failsafe ("),i("code",[e._v("COM_OBL_RC_ACT")]),e._v(")")])]),e._v(" "),i("tr",[i("td",[i("a",{attrs:{id:"COM_OBL_RC_ACT"}}),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_OBL_RC_ACT"}},[e._v("COM_OBL_RC_ACT")])],1),e._v(" "),i("td",[e._v("Flight mode to switch to if offboard control is lost (Values are - "),i("code",[e._v("0")]),e._v(": "),i("em",[e._v("Position")]),e._v(", "),i("code",[e._v("1")]),e._v(": "),i("em",[e._v("Altitude")]),e._v(", "),i("code",[e._v("2")]),e._v(": "),i("em",[e._v("Manual")]),e._v(", "),i("code",[e._v("3")]),e._v(": *Return, "),i("code",[e._v("4")]),e._v(": "),i("em",[e._v("Land")]),e._v(").")])]),e._v(" "),i("tr",[i("td",[i("a",{attrs:{id:"COM_RC_OVERRIDE"}}),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_RC_OVERRIDE"}},[e._v("COM_RC_OVERRIDE")])],1),e._v(" "),i("td",[e._v("Controls whether stick movement on a multicopter (or VTOL in MC mode) causes a mode change to "),i("RouterLink",{attrs:{to:"/en/flight_modes_mc/position.html"}},[e._v("Position mode")]),e._v(". This is not enabled for offboard mode by default.")],1)]),e._v(" "),i("tr",[i("td",[i("a",{attrs:{id:"COM_RC_STICK_OV"}}),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_RC_STICK_OV"}},[e._v("COM_RC_STICK_OV")])],1),e._v(" "),i("td",[e._v("The amount of stick movement that causes a transition to "),i("RouterLink",{attrs:{to:"/en/flight_modes_mc/position.html"}},[e._v("Position mode")]),e._v(" (if "),i("a",{attrs:{href:"#COM_RC_OVERRIDE"}},[e._v("COM_RC_OVERRIDE")]),e._v(" is enabled).")],1)]),e._v(" "),i("tr",[i("td",[i("a",{attrs:{id:"COM_RCL_EXCEPT"}}),i("RouterLink",{attrs:{to:"/en/advanced_config/parameter_reference.html#COM_RCL_EXCEPT"}},[e._v("COM_RCL_EXCEPT")])],1),e._v(" "),i("td",[e._v("Specify modes in which RC loss is ignored and the failsafe action not triggered. Set bit "),i("code",[e._v("2")]),e._v(" to ignore RC loss in Offboard mode.")])])])]),e._v(" "),i("h2",{attrs:{id:"developer-resources"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#developer-resources"}},[e._v("#")]),e._v(" Developer Resources")]),e._v(" "),i("p",[e._v("Typically developers do not directly work at the MAVLink layer, but instead use a robotics API like "),i("a",{attrs:{href:"https://mavsdk.mavlink.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("MAVSDK"),i("OutboundLink")],1),e._v(" or "),i("a",{attrs:{href:"http://www.ros.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ROS"),i("OutboundLink")],1),e._v(" (these provide a developer friendly API, and take care of managing and maintaining connections, sending messages and monitoring responses - the minutiae of working with "),i("em",[e._v("Offboard mode")]),e._v(" and MAVLink).")]),e._v(" "),i("p",[e._v("The following resources may be useful for a developer audience:")]),e._v(" "),i("ul",[i("li",[i("RouterLink",{attrs:{to:"/en/ros/offboard_control.html"}},[e._v("Offboard Control from Linux")])],1),e._v(" "),i("li",[i("RouterLink",{attrs:{to:"/en/ros/mavros_offboard_cpp.html"}},[e._v("ROS/MAVROS Offboard Example (C++)")])],1),e._v(" "),i("li",[i("RouterLink",{attrs:{to:"/en/ros/mavros_offboard_python.html"}},[e._v("ROS/MAVROS Offboard Example (Python)")])],1)])])}),[],!1,null,null,null);t.default=n.exports},327:function(e,t,o){e.exports=o.p+"assets/img/position_fixed.38e4a675.svg"}}]);