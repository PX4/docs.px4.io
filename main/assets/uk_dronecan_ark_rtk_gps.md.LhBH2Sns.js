import{_ as a,a as r,b as i,c as t}from"./chunks/ark_rtk_gps_ublox_f9p_firmware_update.DySJgfy7.js";import{_ as o,c as l,a8 as n,o as c}from"./chunks/framework.BDnHobkS.js";const g=JSON.parse('{"title":"ARK RTK GPS","description":"","frontmatter":{},"headers":[],"relativePath":"uk/dronecan/ark_rtk_gps.md","filePath":"uk/dronecan/ark_rtk_gps.md"}'),d={name:"uk/dronecan/ark_rtk_gps.md"};function s(h,e,m,u,f,_){return c(),l("div",null,e[0]||(e[0]=[n('<h1 id="ark-rtk-gps" tabindex="-1">ARK RTK GPS <a class="header-anchor" href="#ark-rtk-gps" aria-label="Permalink to &quot;ARK RTK GPS&quot;">​</a></h1><p><a href="https://arkelectron.gitbook.io/ark-documentation/sensors/ark-rtk-gps" target="_blank" rel="noreferrer">ARK RTK GPS</a> is an open source <a href="./">DroneCAN</a> <a href="./../gps_compass/rtk_gps.html">RTK GPS</a>, <a href="https://www.u-blox.com/en/product/zed-f9p-module" target="_blank" rel="noreferrer">u-blox F9P</a>, magnetometer, barometer, IMU, buzzer, and safety switch module.</p><p><img src="'+a+'" alt="ARK RTK GPS"></p><h2 id="де-купити" tabindex="-1">Де купити <a class="header-anchor" href="#де-купити" aria-label="Permalink to &quot;Де купити&quot;">​</a></h2><p>Замовте цей модуль з:</p><ul><li><a href="https://arkelectron.com/product/ark-rtk-gps/" target="_blank" rel="noreferrer">ARK Electronics</a> (US)</li></ul><h2 id="характеристики-обладнання" tabindex="-1">Характеристики обладнання <a class="header-anchor" href="#характеристики-обладнання" aria-label="Permalink to &quot;Характеристики обладнання&quot;">​</a></h2><ul><li><a href="https://github.com/ARK-Electronics/ARK_RTK_GPS" target="_blank" rel="noreferrer">Open Source Schematic and BOM</a></li><li>Датчики <ul><li>Ublox F9P GPS <ul><li>Multi-band GNSS receiver delivers centimetre level accuracy in seconds</li><li>Одночасний прийом GPS, GLONASS, Galileo та BeiDou</li><li>Багатосмуговий RTK зі швидкими часами збіжності та надійною продуктивністю</li><li>Висока швидкість оновлення для високодинамічних додатків</li><li>Centimetre accuracy in a small and energy efficient module</li></ul></li><li>Bosch BMM150 Magnetometer</li><li>Bosch BMP388 Barometer</li><li>Invensense ICM-42688-P 6-Axis IMU</li></ul></li><li>STM32F412CEU6 MCU</li><li>Кнопка безпеки</li><li>Зумер</li><li>Два роз&#39;єми стандарту CAN для Pixhawk (4 контакти JST GH)</li><li>Роз&#39;єм F9P &quot;UART 2&quot; <ul><li>3-контактний JST-GH</li><li>TX, RX, GND</li></ul></li><li>Роз&#39;єм для відлагодження стандарту Pixhawk (6 контактів JST SH)</li><li>LED індикатори <ul><li>Індикатор безпеки</li><li>GPS Fix</li><li>Статус RTK</li><li>RGB Статус системи</li></ul></li><li>USA Built</li><li>Вимоги до живлення <ul><li>5V</li><li>Середній струм 170мA</li><li>180мА Макс</li></ul></li></ul><h2 id="налаштування-програмного-забезпечення" tabindex="-1">Налаштування програмного забезпечення <a class="header-anchor" href="#налаштування-програмного-забезпечення" aria-label="Permalink to &quot;Налаштування програмного забезпечення&quot;">​</a></h2><h3 id="підключення" tabindex="-1">Підключення <a class="header-anchor" href="#підключення" aria-label="Permalink to &quot;Підключення&quot;">​</a></h3><p>ARK RTK GPS підключений до шини CAN за допомогою стандартного кабелю Pixhawk 4 pin JST GH. For more information, refer to the <a href="./../can/#wiring">CAN Wiring</a> instructions.</p><h3 id="встановлення" tabindex="-1">Встановлення <a class="header-anchor" href="#встановлення" aria-label="Permalink to &quot;Встановлення&quot;">​</a></h3><p>The recommended mounting orientation is with the connectors on the board pointing towards the <strong>back of vehicle</strong>.</p><p>The sensor can be mounted anywhere on the frame, but you will need to specify its position, relative to vehicle centre of gravity, during <a href="#px4-configuration">PX4 configuration</a>.</p><h2 id="налаштування-прошивки" tabindex="-1">Налаштування прошивки <a class="header-anchor" href="#налаштування-прошивки" aria-label="Permalink to &quot;Налаштування прошивки&quot;">​</a></h2><p>ARK RTK GPS runs the <a href="./px4_cannode_fw.html">PX4 cannode firmware</a>. As such, it supports firmware update over the CAN bus and <a href="./#node-id-allocation">dynamic node allocation</a>.</p><p>ARK RTK GPS boards ship with recent firmware pre-installed, but if you want to build and flash the latest firmware yourself, refer to the <a href="./px4_cannode_fw.html#building-the-firmware">cannode firmware build instructions</a>.</p><p>Firmware target: <code>ark_can-rtk-gps_default</code> Bootloader target: <code>ark_can-rtk-gps_canbootloader</code></p><h2 id="налаштування-польотного-контролера" tabindex="-1">Налаштування польотного контролера <a class="header-anchor" href="#налаштування-польотного-контролера" aria-label="Permalink to &quot;Налаштування польотного контролера&quot;">​</a></h2><h3 id="увімкнення-dronecan" tabindex="-1">Увімкнення DroneCAN <a class="header-anchor" href="#увімкнення-dronecan" aria-label="Permalink to &quot;Увімкнення DroneCAN&quot;">​</a></h3><p>In order to use the ARK RTK GPS, connect it to the Pixhawk CAN bus and enable the DroneCAN driver by setting parameter <a href="./../advanced_config/parameter_reference.html#UAVCAN_ENABLE">UAVCAN_ENABLE</a> to <code>2</code> for dynamic node allocation (or <code>3</code> if using <a href="./../dronecan/escs.html">DroneCAN ESCs</a>).</p><p>Кроки наступні:</p><ul><li>In <em>QGroundControl</em> set the parameter <a href="./../advanced_config/parameter_reference.html#UAVCAN_ENABLE">UAVCAN_ENABLE</a> to <code>2</code> or <code>3</code> and reboot (see <a href="./../advanced_config/parameters.html">Finding/Updating Parameters</a>).</li><li>Підключіть ARK RTK GPS CAN до шини CAN Pixhawk.</li></ul><p>Після активації модуль буде виявлено при завантаженні. Дані GPS повинні надходити з частотою 10 Гц.</p><h3 id="конфігурація-px4" tabindex="-1">Конфігурація PX4 <a class="header-anchor" href="#конфігурація-px4" aria-label="Permalink to &quot;Конфігурація PX4&quot;">​</a></h3><p>You need to set necessary <a href="./">DroneCAN</a> parameters and define offsets if the sensor is not centred within the vehicle:</p><ul><li>Enable GPS yaw fusion by setting bit 3 of <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_CTRL">EKF2_GPS_CTRL</a> to true.</li><li>Enable GPS blending to ensure the heading is always published by setting <a href="./../advanced_config/parameter_reference.html#SENS_GPS_MASK">SENS_GPS_MASK</a> to 7 (all three bits checked).</li><li>Enable <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_GPS">UAVCAN_SUB_GPS</a>, <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_MAG">UAVCAN_SUB_MAG</a>, and <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_BARO">UAVCAN_SUB_BARO</a>.</li><li>The parameters <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_X">EKF2_GPS_POS_X</a>, <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_Y">EKF2_GPS_POS_Y</a> and <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_Z">EKF2_GPS_POS_Z</a> can be set to account for the offset of the ARK RTK GPS from the vehicles centre of gravity.</li><li>Set <a href="./../advanced_config/parameter_reference.html#CANNODE_TERM">CANNODE_TERM</a> to <code>1</code> on the GPS if this it that last node on the CAN bus.</li></ul><h3 id="setting-up-moving-baseline-gps-heading" tabindex="-1">Setting Up Moving Baseline &amp; GPS Heading <a class="header-anchor" href="#setting-up-moving-baseline-gps-heading" aria-label="Permalink to &quot;Setting Up Moving Baseline &amp; GPS Heading&quot;">​</a></h3><p>Найпростіший спосіб налаштування рухомого базису та напрямку GPS з двома модулями GPS ARK RTK відбувається через CAN, хоча можна зробити це через UART, щоб зменшити обсяг даних на шині CAN, якщо це потрібно.</p><p>Зверніть увагу, що заголовок виводиться лише у випадку, якщо Rover знаходиться в режимі фіксованого RTX. Він не виведе заголовок у RTK Float.</p><p>Налаштування через CAN:</p><ul><li>Переконайтеся, що ARK RTK GPS модулі підключені до Pixhawk через CAN (один може бути підключений до вторинного порту CAN). Два ARK RTK GPS повинні бути підключені до однієї і тієї ж CAN шини для надсилання корекцій.</li><li>Choose one ARK RTK GPS to be the <em>Rover</em> and one to be the <em>Moving Base</em>.</li><li>Reopen QGroundControl, go to parameters, and select <code>Standard</code> to hide that dropdown and select <code>Component ##</code> to view each of your ARK RTK GPS&#39;s CAN node parameters<div class="info custom-block"><p class="custom-block-title">INFO</p><p><code>Component ##</code> won&#39;t be visible unless the ARK RTK GPS is connected to the Pixhawk prior to opening QGroundControl.</p></div></li></ul><p>:::</p><ul><li>On the <em>Rover</em>, set the following: <ul><li><a href="./../advanced_config/parameter_reference.html#GPS_UBX_MODE">GPS_UBX_MODE</a> to <code>3</code></li><li><a href="./../advanced_config/parameter_reference.html#GPS_YAW_OFFSET">GPS_YAW_OFFSET</a> to <code>0</code> if your <em>Rover</em> is in front of your <em>Moving Base</em>, <code>90</code> if <em>Rover</em> is right of <em>Moving Base</em>, <code>180</code> if <em>Rover</em> is behind <em>Moving Base</em>, or <code>270</code> if <em>Rover</em> is left of <em>Moving Base</em>.</li><li><a href="./../advanced_config/parameter_reference.html#CANNODE_SUB_MBD">CANNODE_SUB_MBD</a> to <code>1</code>.</li></ul></li><li>On the <em>Moving Base</em>, set the following: <ul><li><a href="./../advanced_config/parameter_reference.html#GPS_UBX_MODE">GPS_UBX_MODE</a> to <code>4</code>.</li><li><a href="./../advanced_config/parameter_reference.html#CANNODE_PUB_MBD">CANNODE_PUB_MBD</a> to <code>1</code>.</li></ul></li></ul><p>Налаштування через UART:</p><ul><li>Переконайтеся, що модулі GPS ARK RTK підключені до Pixhawk через CAN.</li><li>Переконайтеся, що модулі GPS ARK RTK підключені один до одного через їх порт UART2 (схема виводів UART2 показана нижче). Зверніть увагу, що TX одного модуля потрібно підключити до RX іншого.</li></ul><table tabindex="0"><thead><tr><th>Pin</th><th>Назва</th></tr></thead><tbody><tr><td>1</td><td>TX</td></tr><tr><td>2</td><td>RX</td></tr><tr><td>3</td><td>GND</td></tr></tbody></table><ul><li>On the <em>Rover</em>, set the following: <ul><li><a href="./../advanced_config/parameter_reference.html#GPS_UBX_MODE">GPS_UBX_MODE</a> to <code>1</code></li><li><a href="./../advanced_config/parameter_reference.html#GPS_YAW_OFFSET">GPS_YAW_OFFSET</a> to <code>0</code> if your <em>Rover</em> is in front of your <em>Moving Base</em>, <code>90</code> if <em>Rover</em> is right of <em>Moving Base</em>, <code>180</code> if <em>Rover</em> is behind <em>Moving Base</em>, or <code>270</code> if <em>Rover</em> is left of <em>Moving Base</em>.</li></ul></li><li>On the <em>Moving Base</em>, set the following: <ul><li><a href="./../advanced_config/parameter_reference.html#GPS_UBX_MODE">GPS_UBX_MODE</a> to <code>2</code>.</li></ul></li></ul><h2 id="значення-led-індикаторів" tabindex="-1">Значення LED індикаторів <a class="header-anchor" href="#значення-led-індикаторів" aria-label="Permalink to &quot;Значення LED індикаторів&quot;">​</a></h2><ul><li><p>Світлодіоди статусу GPS розташовані праворуч від роз&#39;ємів</p><ul><li>Миготіння зеленого - це фіксація GPS</li><li>Миготіння синього - це отримані корекції та RTK Float</li><li>Сталий синій - це RTK зафіксовано</li></ul></li><li><p>Світлодіоди статусу CAN розташовані зверху ліворуч від роз&#39;ємів</p><ul><li>Повільне блимання зеленого - чекає на підключення CAN</li><li>Швидко блимаюче зелене світло - нормальна робота</li><li>Повільне блимання зеленим і синім - перелік CAN</li><li>Повільне блимання зеленого, синього і червоного - оновлення прошивки в процесі</li><li>Миготливий червоний - помилка <ul><li>Якщо ви бачите червоний світлодіод, це означає, що виникла помилка, і вам слід перевірити наступне <ul><li>Переконайтеся, що у польотному контролері встановлено SD-картку</li><li>Make sure the ARK RTK GPS has <code>ark_can-rtk-gps_canbootloader</code> installed prior to flashing <code>ark_can-rtk-gps_default</code></li><li>Видаліть бінарні файли з кореневих та ufw директорій SD-карти та спробуйте зібрати та знову прошити</li></ul></li></ul></li></ul></li></ul><h3 id="оновлення-модуля-ublox-f9p" tabindex="-1">Оновлення модуля Ublox F9P <a class="header-anchor" href="#оновлення-модуля-ublox-f9p" aria-label="Permalink to &quot;Оновлення модуля Ublox F9P&quot;">​</a></h3><p>ARK RTK GPS поставляється з модулем Ublox F9P з версією 1.13 або новішою. Проте ви можете перевірити версію та оновити прошивку за бажанням.</p><p>Кроки наступні:</p><ul><li><a href="https://www.u-blox.com/en/product/u-center" target="_blank" rel="noreferrer">Download u-center from u-blox.com</a> and install on your PC (Windows only)</li><li>Open the <a href="https://www.u-blox.com/en/product/zed-f9p-module#tab-documentation-resources" target="_blank" rel="noreferrer">u-blox ZED-F9P website</a></li><li>Прокрутіть вниз і клацніть на поле &quot;Show Legacy Documents&quot;</li><li>Прокрутіть вниз ще раз до Оновлення прошивки та завантажте потрібну прошивку (потрібна версія не нижче 1.13)</li><li>Підтримуючи перемикач безпеки на ARK RTK GPS, підключіть його до живлення через один з його портів CAN і утримуйте до тих пір, поки всі 3 світлодіода не почнуть швидко мигати</li><li>Підключіть ARK RTK GPS до комп&#39;ютера за допомогою його порту відладки через кабель, такого як Black Magic Probe або FTDI</li><li>Open u-center, select the COM port for the ARK RTK GPS and connect <img src="'+r+'" alt="U-Center Connect"></li><li>Check the current firmware version by selecting View, Messages View, UBX, MON, VER <img src="'+i+'" alt="Check Version"></li><li>Для оновлення прошивки: <ul><li>Виберіть Tools, Firmware Update</li><li>Поле зображення прошивки повинно бути файлом .bin, завантаженим зі сторінки веб-сайту u-blox ZED-F9P</li><li>Поставте прапорець &quot;Використовувати цю швидкість передачі для оновлення&quot; та виберіть 115200 зі списку</li><li>Переконайтеся, що інші прапорці відображаються так, як показано нижче</li><li>Натисніть зелену кнопку GO внизу зліва</li><li>&quot;Firmware Update SUCCESS&quot; should be displayed if it updated successfully <img src="'+t+'" alt="Firmware Update"></li></ul></li></ul><h2 id="дивіться-також" tabindex="-1">Дивіться також <a class="header-anchor" href="#дивіться-також" aria-label="Permalink to &quot;Дивіться також&quot;">​</a></h2><ul><li><a href="https://arkelectron.gitbook.io/ark-documentation/sensors/ark-rtk-gps" target="_blank" rel="noreferrer">ARK RTK GPS Documentation</a> (ARK Docs)</li></ul>',46)]))}const P=o(d,[["render",s]]);export{g as __pageData,P as default};
