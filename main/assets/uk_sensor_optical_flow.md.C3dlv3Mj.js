import{_ as r,a as o}from"./chunks/px4flow_offset.gpRBdLx0.js";import{_ as n,c as i,j as e,a,a8 as s,o as l}from"./chunks/framework.BDnHobkS.js";const b=JSON.parse('{"title":"Оптичний потік(Optical Flow)","description":"","frontmatter":{},"headers":[],"relativePath":"uk/sensor/optical_flow.md","filePath":"uk/sensor/optical_flow.md"}'),d={name:"uk/sensor/optical_flow.md"};function h(c,t,p,f,m,_){return l(),i("div",null,t[0]||(t[0]=[e("h1",{id:"оптичнии-потік-optical-flow",tabindex:"-1"},[a("Оптичний потік(Optical Flow) "),e("a",{class:"header-anchor",href:"#оптичнии-потік-optical-flow","aria-label":'Permalink to "Оптичний потік(Optical Flow)"'},"​")],-1),e("p",null,[e("em",null,"Optical Flow"),a(" uses a downward facing camera and a downward facing distance sensor for velocity estimation. It can be used to determine speed when navigating without GNSS — in buildings, underground, or in any other GNSS-denied environment.")],-1),e("p",null,[a("The video below shows PX4 holding position using the "),e("a",{href:"#ark-flow"},"Ark Flow"),a(" sensor for velocity estimation in "),e("a",{href:"./../flight_modes_mc/position.html"},"Position Mode"),a(":")],-1),e("lite-youtube",{videoid:"aPQKgUof3Pc",title:"ARK Flow with PX4 Optical Flow Position Hold"},null,-1),s('<p>The image below shows an optical flow setup with a separate flow sensor (<a href="./../sensor/px4flow.html">PX4Flow</a>) and distance sensor (<a href="./../sensor/lidar_lite.html">Lidar-Lite</a>):</p><p><img src="'+r+'" alt="Optical flow lidar attached"></p><h2 id="установка" tabindex="-1">Установка <a class="header-anchor" href="#установка" aria-label="Permalink to &quot;Установка&quot;">​</a></h2><p>An Optical Flow setup requires a downward facing camera and a downward facing <a href="./../sensor/rangefinders.html">distance sensor</a> (preferably a LiDAR). These can be combined in a single product, such as the <a href="#ark-flow">Ark Flow</a>, or they may be separate sensors.</p><p>The sensor(s) can be connected via MAVLink, I2C or any other bus that supports the peripheral.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If connected to PX4 via MAVLink the Optical Flow camera sensor must publish the <a href="https://mavlink.io/en/messages/common.html#OPTICAL_FLOW_RAD" target="_blank" rel="noreferrer">OPTICAL_FLOW_RAD</a> message, and the distance sensor must publish the <a href="https://mavlink.io/en/messages/common.html#DISTANCE_SENSOR" target="_blank" rel="noreferrer">DISTANCE_SENSOR</a> message. The information is written to the corresponding uORB topics: <a href="./../msg_docs/DistanceSensor.html">DistanceSensor</a> and <a href="./../msg_docs/ObstacleDistance.html">ObstacleDistance</a>.</p></div><p>Вихід потоку при руху в різних напрямках повинен бути наступним:</p><table tabindex="0"><thead><tr><th>Рух транспортного засобу</th><th>Інтегрований потік</th></tr></thead><tbody><tr><td>Вперед</td><td>+ Y</td></tr><tr><td>Назад</td><td>- Y</td></tr><tr><td>Справа</td><td>- X</td></tr><tr><td>Зліва</td><td>+ X</td></tr></tbody></table><p>For pure rotations the <code>integrated_xgyro</code> and <code>integrated_x</code> (respectively <code>integrated_ygyro</code> and <code>integrated_y</code>) have to be the same.</p><p>Дані сенсора від пристрою оптичного потоку об&#39;єднуються з іншими джерелами даних швидкості. The approach used for fusing sensor data and any offsets from the center of the vehicle must be configured in the <a href="#estimators">estimator</a>.</p><h2 id="датчики-потоку-камери" tabindex="-1">Датчики потоку/Камери <a class="header-anchor" href="#датчики-потоку-камери" aria-label="Permalink to &quot;Датчики потоку/Камери&quot;">​</a></h2><h3 id="ark-flow" tabindex="-1">ARK Flow <a class="header-anchor" href="#ark-flow" aria-label="Permalink to &quot;ARK Flow&quot;">​</a></h3><p><a href="./../dronecan/ark_flow.html">ARK Flow</a> is a <a href="./../dronecan/">DroneCAN</a> optical flow sensor, <a href="./../sensor/rangefinders.html">distance sensor</a>, and IMU. В ньому є оптичний датчик потоку PAW3902, оптичний датчик відстані Broadcom AFBR-S50LV85D на відстані 30 метрів та ІМП-датчик BMI088.</p><h3 id="датчики-на-основі-pmw3901" tabindex="-1">Датчики на основі PMW3901 <a class="header-anchor" href="#датчики-на-основі-pmw3901" aria-label="Permalink to &quot;Датчики на основі PMW3901&quot;">​</a></h3><p><a href="./../sensor/pmw3901.html">PMW3901</a> is an optical flow tracking sensor similar to what you would find in a computer mouse, but adapted to work between 80 mm and infinity. Він використовується в ряді продуктів, включаючи деякі від: Bitcraze, Tindie, Hex, Thone та Alientek.</p><h3 id="інші-камери-сенсори" tabindex="-1">Інші Камери/Сенсори <a class="header-anchor" href="#інші-камери-сенсори" aria-label="Permalink to &quot;Інші Камери/Сенсори&quot;">​</a></h3><p>Також можна використовувати дошку/квадрокоптер, яка має вбудовану камеру. For this the <a href="https://github.com/PX4/OpticalFlow" target="_blank" rel="noreferrer">Optical Flow repo</a> can be used (see also <a href="https://github.com/PX4/snap_cam" target="_blank" rel="noreferrer">snap_cam</a>).</p><h2 id="далекомір" tabindex="-1">Далекомір <a class="header-anchor" href="#далекомір" aria-label="Permalink to &quot;Далекомір&quot;">​</a></h2><p>You can use any supported <a href="./../sensor/rangefinders.html">distance sensor</a>. Проте ми рекомендуємо використовувати LIDAR замість зондів сонар, через їхню надійність та точність.</p><h2 id="оцінювач" tabindex="-1">Оцінювач <a class="header-anchor" href="#оцінювач" aria-label="Permalink to &quot;Оцінювач&quot;">​</a></h2><p>Оцінювачі об&#39;єднують дані з датчика оптичного потоку та інших джерел. Налаштування для виконання злиття, а також відносні зсуви до центру транспортного засобу повинні бути вказані для використаного оцінювача.</p><p>Зміщення обчислюються відносно орієнтації транспортного засобу та центру, як показано нижче:</p><p><img src="'+o+'" alt="Optical Flow offsets"></p><p>Optical Flow based navigation is enabled by both <a href="#ekf2">EKF2</a> and LPE (deprecated).</p><h3 id="ekf2" tabindex="-1">Extended Kalman Filter (EKF2) <a class="header-anchor" href="#ekf2" aria-label="Permalink to &quot;Extended Kalman Filter (EKF2) {#ekf2}&quot;">​</a></h3><p>For optical flow fusion using EKF2, set <a href="./../advanced_config/parameter_reference.html#EKF2_OF_CTRL">EKF2_OF_CTRL</a>.</p><p>Якщо ваш оптичний датчик потоку зміщений від центру транспортного засобу, ви можете встановити це за допомогою наступних параметрів.</p><table tabindex="0"><thead><tr><th>Параметр</th><th>Опис</th></tr></thead><tbody><tr><td><a id="EKF2_OF_POS_X"></a><a href="./../advanced_config/parameter_reference.html#EKF2_OF_POS_X">EKF2_OF_POS_X</a></td><td>Позиція X оптичного потоку фокусної точки в системі тіла (за замовчуванням 0.0 м).</td></tr><tr><td><a id="EKF2_OF_POS_Y"></a><a href="./../advanced_config/parameter_reference.html#EKF2_OF_POS_Y">EKF2_OF_POS_Y</a></td><td>Позиція Y оптичного потоку фокусної точки в системі тіла (за замовчуванням 0.0 м).</td></tr><tr><td><a id="EKF2_OF_POS_Z"></a><a href="./../advanced_config/parameter_reference.html#EKF2_OF_POS_Z">EKF2_OF_POS_Z</a></td><td>Позиція Z оптичного потоку фокусної точки в системі тіла (за замовчуванням 0.0 м).</td></tr></tbody></table><p>See <a href="./../advanced_config/tuning_the_ecl_ekf.html#optical-flow">Using the ECL EKF &gt; Optical flow</a> for more information.</p>',29)]))}const F=n(d,[["render",h]]);export{b as __pageData,F as default};
