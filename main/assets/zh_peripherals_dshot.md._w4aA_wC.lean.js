import{_ as i,c as e,a8 as a,o as t}from"./chunks/framework.BDnHobkS.js";const k=JSON.parse('{"title":"DShot 电调","description":"","frontmatter":{},"headers":[],"relativePath":"zh/peripherals/dshot.md","filePath":"zh/peripherals/dshot.md"}'),n={name:"zh/peripherals/dshot.md"};function h(l,s,o,p,r,d){return t(),e("div",null,s[0]||(s[0]=[a(`<h1 id="dshot-电调" tabindex="-1">DShot 电调 <a class="header-anchor" href="#dshot-电调" aria-label="Permalink to &quot;DShot 电调&quot;">​</a></h1><p>DShot is an alternative ESC protocol that has several advantages over <a href="./../peripherals/pwm_escs_and_servo.html">PWM</a> or <a href="./../peripherals/oneshot.html">OneShot</a>:</p><ul><li>低延迟</li><li>通过校验提高鲁棒性</li><li>由于协议使用数字编码，因此无需电调校准</li><li>很多电调支持数传反馈。</li><li>可以通过命令反转电机方向（而不是物理调换两根线/重新焊接）。</li><li>支持其他好用的命令。</li></ul><p>本章介绍了如何连接和配置 DShot 电调。</p><h2 id="wiring" tabindex="-1">Wiring/Connections <a class="header-anchor" href="#wiring" aria-label="Permalink to &quot;Wiring/Connections {#wiring}&quot;">​</a></h2><p>DShot ESC are wired the same way as <a href="./pwm_escs_and_servo.html">PWM ESCs</a>. 唯一的区别在于它们只能连接到FMU，通常只能连接到某些引脚的子集。</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You may want to check the actuator configuration screen to see what pins are available for DShot on your controller before wiring up!</p></div><p>Pixhawk controllers with both an FMU and an IO board usually label them as <code>AUX</code> (FMU) and <code>MAIN</code> (IO), respectively. These match the <code>PWM AUX</code> and <code>PWM MAIN</code> output tabs on the actuator configuration screen. For these controllers connect the DShot ESC to the <code>AUX</code> port.</p><p>Controllers that don&#39;t have an IO board usually label the (single) output port as <code>MAIN</code>, and this is where you will connect your DShot ESC. If the controller without IO has its own firmware, the actuator assignment will be to the matching <code>PWM MAIN</code> outputs. However if the same firmware is used for hardware with/without the IO board, such as for the Pixhawk 4 and Pixhawk 4 Mini, then actuator assignment tab used is the same in both cases: <code>PWM AUX</code> (i.e. not matching the port label <code>MAIN</code> in the &quot;mini&quot; case).</p><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Remove propellers before changing ESC configuration parameters!</p></div><p>Enable DShot for your required outputs in the <a href="./../config/actuators.html">Actuator Configuration</a>.</p><p>DShot comes with different speed options: <em>DShot150</em>, <em>DShot300</em>, <em>DShot600</em> and <em>DShot1200</em>, where the number indicates the speed in kilo-bits/second. 您应该将参数设置为您的电调支持的最高速度（根据其说明书）。</p><p>然后连接电池并解锁无人机。 电调应该初始化，电机应该按照正确的方向转动。</p><ul><li>If the motors do not spin in the correct direction (for the <a href="./../airframes/airframe_reference.html">selected airframe</a>) you can reverse them in the UI using the <strong>Set Spin Direction</strong> option (this option appears after you select DShot and assign motors). You can also reverse motors by sending an <a href="#commands">ESC Command</a>.</li></ul><h2 id="commands" tabindex="-1">ESC Commands <a class="header-anchor" href="#commands" aria-label="Permalink to &quot;ESC Commands {#commands}&quot;">​</a></h2><p>Commands can be sent to the ESC via the <a href="./../debug/mavlink_shell.html">MAVLink shell</a>. See <a href="./../modules/modules_driver.html#dshot">here</a> for a full reference of the supported commands.</p><p>其中最重要的是：</p><ul><li><p>Make a motor connected to to FMU output pin 1 beep (helps with identifying motors)</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> beep1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div></li><li><p>Retrieve ESC information (requires telemetry, see below):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nsh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> esc_info</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] ESC Type: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#TEKKO32_4in1#</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] MCU Serial Number: xxxxxx-xxxxxx-xxxxxx-xxxxxx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] Firmware version: 32.60</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] Rotation Direction: normal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] 3D Mode: off</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] Low voltage Limit: off</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] Current Limit: off</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] LED 0: unsupported</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] LED 1: unsupported</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] LED 2: unsupported</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">INFO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [dshot] LED 3: unsupported</span></span></code></pre></div></li><li><p>Permanently set the spin direction of a motor connected to FMU output pin 1 (while motors are <em>not</em> spinning):</p><ul><li><p>Set spin direction to <code>reversed</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reverse</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> save</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div><p>Retrieving ESC information will then show:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Rotation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Direction:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reversed</span></span></code></pre></div></li><li><p>Set spin direction to <code>normal</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> normal</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> save</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div><p>Retrieving ESC information will then show:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Rotation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Direction:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> normal</span></span></code></pre></div></li></ul><p>:::note</p><ul><li>The commands will have no effect if the motors are spinning, or if the ESC is already set to the corresponding direction.</li><li>The ESC will revert to its last saved direction (normal or reversed) on reboot if <code>save</code> is not called after changing the direction.</li></ul></li></ul><p>:::</p><h2 id="telemetry" tabindex="-1">Telemetry <a class="header-anchor" href="#telemetry" aria-label="Permalink to &quot;Telemetry&quot;">​</a></h2><p>有些电调能够向飞控发送Telemetry数据，包括：</p><ul><li>温度</li><li>电压</li><li>电流</li><li>累计消耗的电量</li><li>转速值</li></ul><p>这些DShot 电调会有一条额外的连接线。</p><p>开启遥测数据功能（仅对于能支持遥测数据的电调）:</p><ol><li>把电调上的TELE端口连接到飞控上空的串口的 RX 端。</li><li>Enable telemetry on that serial port using <a href="./../advanced_config/parameter_reference.html#DSHOT_TEL_CFG">DSHOT_TEL_CFG</a>.</li></ol><p>重启后，您可以检查TELE数据传输是否正常工作（确保电池已连接），方法如下：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dshot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> esc_info</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You may have to configure <a href="./../advanced_config/parameter_reference.html#MOT_POLE_COUNT">MOT_POLE_COUNT</a> to get the correct RPM values.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Not all DSHOT-capable ESCs support <code>[esc_info]</code>(e.g. APD 80F3x), even when telemetry is supported and enabled. 显示的错误是：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERROR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [dshot] No data received. If telemetry is setup correctly, try again.</span></span></code></pre></div><p>查看制造商文档以获取详细信息。</p></div>`,30)]))}const g=i(n,[["render",h]]);export{k as __pageData,g as default};
