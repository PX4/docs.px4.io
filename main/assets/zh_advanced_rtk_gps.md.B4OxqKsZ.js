import{_ as i,c as a,a8 as e,o as t}from"./chunks/framework.BDnHobkS.js";const c=JSON.parse('{"title":"RTK GPS (PX4 集成)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/advanced/rtk_gps.md","filePath":"zh/advanced/rtk_gps.md"}'),n={name:"zh/advanced/rtk_gps.md"};function l(h,s,p,r,k,o){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="rtk-gps-px4-集成" tabindex="-1">RTK GPS (PX4 集成) <a class="header-anchor" href="#rtk-gps-px4-集成" aria-label="Permalink to &quot;RTK GPS (PX4 集成)&quot;">​</a></h1><p><a href="https://en.wikipedia.org/wiki/Real_Time_Kinematic" target="_blank" rel="noreferrer">Real Time Kinematic</a> (RTK) provides centimeter-level GPS accuracy. 这一章节将介绍 RTK 是如何集成到 PX4 中的。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Instructions for <em>using</em> RTK GNSS are provided in <a href="./../gps_compass/rtk_gps.html">Hardware &gt; RTK GPS</a>.</p></div><h2 id="综述" tabindex="-1">综述 <a class="header-anchor" href="#综述" aria-label="Permalink to &quot;综述&quot;">​</a></h2><p>RTK是使用导航信号的载波相位来进行测距的，而不是使用导航信号所搭载的信息。 它依靠一个单一的参考基站站实时校正，这种校正可以与多个流动站一起工作。</p><p>PX4 配置 RTK 需要两个 RTK GPS 模块和一个数传。 The fixed-position ground-based GPS unit is called the <em>Base</em> and the in-air unit is called the <em>Rover</em>. The Base unit connects to <em>QGroundControl</em> (via USB) and uses the datalink to stream RTCM corrections to the vehicle (using the MAVLink <a href="https://mavlink.io/en/messages/common.html#GPS_RTCM_DATA" target="_blank" rel="noreferrer">GPS_RTCM_DATA</a> message). 在自驾仪上，MAVLink消息包被解包得到RTCM的修正信息，并把这些信息发送给移动站，移动站结合修正信息最终解算得到 RTK 解。</p><p>The datalink should typically be able to handle an uplink rate of 300 bytes per second (see the <a href="#uplink-datarate">Uplink Datarate</a> section below for more information).</p><h2 id="支持的-rtk-gps-模块" tabindex="-1">支持的 RTK GPS 模块 <a class="header-anchor" href="#支持的-rtk-gps-模块" aria-label="Permalink to &quot;支持的 RTK GPS 模块&quot;">​</a></h2><p>The list of devices that we have tested can be found <a href="./../gps_compass/rtk_gps.html#supported-devices">in the user guide</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Most devices come with two variants, a base and a rover. 确保选择正确的变体。</p></div><h2 id="自动配置" tabindex="-1">自动配置 <a class="header-anchor" href="#自动配置" aria-label="Permalink to &quot;自动配置&quot;">​</a></h2><p>The PX4 GPS stack automatically sets up the GPS modules to send and receive the correct messages over the UART or USB, depending on where the module is connected (to <em>QGroundControl</em> or the autopilot).</p><p>As soon as the autopilot receives <code>GPS_RTCM_DATA</code> MAVLink messages, it automatically forwards the RTCM data to the attached GPS module over existing data channels (a dedicated channel for correction data is not required).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The u-blox U-Center RTK module configuration tool is not needed/used!</p></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Both <em>QGroundControl</em> and the autopilot firmware share the same <a href="https://github.com/PX4/GpsDrivers" target="_blank" rel="noreferrer">PX4 GPS driver stack</a>. 实际上，这意味着只需要将新协议和/或消息添加到一个地方。</p></div><h3 id="rtcm-报文" tabindex="-1">RTCM 报文 <a class="header-anchor" href="#rtcm-报文" aria-label="Permalink to &quot;RTCM 报文&quot;">​</a></h3><p>QGroundControl 配置RTK 基地站输出以下 RTCM3.2 帧, 每个帧均为 1 Hz, 除非另有说明：</p><ul><li><strong>1005</strong> - Station coordinates XYZ for antenna reference point (Base position), 0.2 Hz.</li><li><strong>1077</strong> - Full GPS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution).</li><li><strong>1087</strong> - Full GLONASS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution).</li><li><strong>1230</strong> - GLONASS code-phase biases.</li><li><strong>1097</strong> - Full Galileo pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)</li><li><strong>1127</strong> - Full BeiDou pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)</li></ul><h2 id="上行数据速率" tabindex="-1">上行数据速率 <a class="header-anchor" href="#上行数据速率" aria-label="Permalink to &quot;上行数据速率&quot;">​</a></h2><p>The raw RTCM messages from the base are packed into a MAVLink <code>GPS_RTCM_DATA</code> message and sent over the datalink. MAVLink 消息的最大长度是182字节。 根据RTCM的信息类型，MAVLink信息是不会填满的。</p><p>RTCM 基础位置消息(1005)长度为 22 字节， 而其他卫星的长度则因可见卫星的数量和卫星信号的数量而异（M8P等L1单元只有一个）。 Since at a given time, the <em>maximum</em> number of satellites visible from any single constellation is 12, under real-world conditions, theoretically an uplink rate of 300 B/s is sufficient.</p><p>If <em>MAVLink 1</em> is used, a 182-byte <code>GPS_RTCM_DATA</code> message is sent for every RTCM message, irrespective of its length. 因此，大约每秒上行需求是700多个字节。 这可能导致低带宽半双轨遥测模块 (如3DR Telemetry Radios) 连接的饱和。</p><p>If <em>MAVLink 2</em> is used then any empty space in the <code>GPS_RTCM_DATA message</code> is removed. 由此产生的上行链路需求与理论值 (约 300 字节/秒) 大致相同。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>PX4 automatically switches to MAVLink 2 if the GCS and telemetry modules support it.</p></div><p>MAVLink 2 必须用于低带宽链接以保证 RTK 性能。 必须注意确保数传链在整个过程中使用 MAVLink 2。 You can verify the protocol version by using the <code>mavlink status</code> command on the system console:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nsh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">instance</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        GCS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> heartbeat:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  593486</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> us</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ago</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chan:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           3DR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RADIO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txbuf:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          94</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          61</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   58</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> errors:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        fixed:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        flow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ON</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rates:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        tx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.285</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txerr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mult:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.366</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        accepting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commands:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        MAVLink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        transport</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protocol:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (/dev/ttyS1 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@57600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,26)]))}const F=i(n,[["render",l]]);export{c as __pageData,F as default};
