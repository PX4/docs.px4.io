import{_ as i,a as s,b as e,c as t}from"./chunks/comp_params.D8ShN-Ld.js";import{_ as p,c as o,a8 as l,o as n}from"./chunks/framework.BDnHobkS.js";const f=JSON.parse('{"title":"Compass Power Compensation","description":"","frontmatter":{},"headers":[],"relativePath":"uk/advanced_config/compass_power_compensation.md","filePath":"uk/advanced_config/compass_power_compensation.md"}'),r={name:"uk/advanced_config/compass_power_compensation.md"};function c(h,a,m,d,k,_){return n(),o("div",null,a[0]||(a[0]=[l('<h1 id="compass-power-compensation" tabindex="-1">Compass Power Compensation <a class="header-anchor" href="#compass-power-compensation" aria-label="Permalink to &quot;Compass Power Compensation&quot;">​</a></h1><p>Компаси (магнітометри) повинні бути встановлені якнайдалі від кабелів, які переносять великі струми, оскільки вони створюють магнітні поля, які можуть вплинути на показання компасу.</p><p>Ця тема пояснює, як компенсувати виниклі магнітні поля у випадках, коли переміщення компасу нереалістичне.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Переміщення компасу подалі від кабелів, що переносять потужність, є найпростішим і найефективнішим способом вирішення цієї проблеми, оскільки сила магнітних полів зменшується квадратично з відстані від кабелю.</p></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Процес продемонстрований для багатороторного вертольота, але є так само ефективним для інших типів транспортних засобів.</p></div><p><a id="when"></a></p><h2 id="коли-застосовна-компенсація-потужності" tabindex="-1">Коли застосовна компенсація потужності? <a class="header-anchor" href="#коли-застосовна-компенсація-потужності" aria-label="Permalink to &quot;Коли застосовна компенсація потужності?&quot;">​</a></h2><p>Виконання компенсації потужності рекомендується лише у випадку, якщо виконуються всі наступні умови:</p><ol><li><p>Компас не може бути віддалений від кабелів, які переносять потужність.</p></li><li><p>Існує сильна кореляція між показаннями компасу та встановленим значенням тяги та/або поточним зарядом батареї.</p><p><img src="'+i+'" alt="Corrupted mag"></p></li><li><p>Кабелі дрона всі закріплені на місці / не рухаються (розраховані параметри компенсації будуть недійсними, якщо кабелі, які переносять струм, можуть рухатися).</p></li></ol><p><a id="how"></a></p><h2 id="як-компенсувати-компас" tabindex="-1">Як компенсувати компас <a class="header-anchor" href="#як-компенсувати-компас" aria-label="Permalink to &quot;Як компенсувати компас&quot;">​</a></h2><ol><li><p>Переконайтеся, що ваш дрон працює на версії прошивки, що підтримує компенсацію потужності (поточний майстер або версії від v.1.11.0).</p></li><li><p>Виконайте <a href="./../config/compass.html#compass-calibration">стандартну калібрування компасу</a>.</p></li><li><p>Встановіть параметр <a href="./../advanced_config/parameter_reference.html#SDLOG_MODE">SDLOG_MODE</a> на 2, щоб увімкнути журналювання даних після завантаження.</p></li><li><p>Встановіть прапорець параметра <a href="./../advanced_config/parameter_reference.html#SDLOG_PROFILE">SDLOG_PROFILE</a> для <em>Порівняння датчиків</em> (біт 6), щоб отримати більше точок даних.</p></li><li><p>Закріпіть дрон таким чином, щоб він не міг рухатися, та прикріпіть пропелери (щоб двигуни могли витягувати такий самий струм, як у повітрі). У цьому прикладі транспортний засіб закріплюється за допомогою ременів.</p><p><img src="'+s+'" alt="strap"></p></li><li><p>Увімкніть живлення транспортного засобу та переключіться у режим польоту <a href="./../flight_modes_mc/acro.html">ACRO</a> (використання цього режиму забезпечує, що транспортний засіб не намагатиметься компенсувати рух, що виникає від ременів).</p><ul><li>Збройте транспортний засіб і повільно підніміть оберти двигунів до максимуму.</li><li>Повільно знизьте швидкість обертання двигунів до нуля.</li><li>Звільнити автомобіль</li></ul><p>Проведіть тест обережно і уважно моніторте вібрації.</p></li></ol><p>:::</p><ol start="7"><li><p>Отримайте ulog та скористайтеся Python-скриптом <a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/sensors/vehicle_magnetometer/mag_compensation/python/mag_compensation.py" target="_blank" rel="noreferrer">mag_compensation.py</a>, щоб ідентифікувати параметри компенсації.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mag_compensation.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/path/to/log/logfile.ulg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">typ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [--instance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">numbe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span></code></pre></div><p>де:</p><ul><li><code>&lt;type&gt;</code>: <code>current</code> or <code>thrust</code> (power signal used for compensation)</li><li><code>--instance &lt;number&gt;</code> (optional): The number is <code>0</code> (default) or <code>1</code>, the instance of the current or thrust signal to use.</li></ul><p>Якщо ваш журнал не містить вимірювань поточного заряду батареї, вам потрібно закоментувати відповідні рядки у Python-скрипті, щоб він робив розрахунок тільки для тяги.</p></li></ol><p>:::</p><ol start="8"><li><p>Скрипт поверне ідентифікацію параметрів для тяги, а також для поточного і виведе їх у консоль. Цифри, які з&#39;являються зі скрипту, показують &quot;якість підгонки&quot; для кожного екземпляру компасу, а також те, як виглядатиме дані після компенсації за запропонованими значеннями. Якщо є вимірювання струму, використання компенсації поточного звичайно дає кращі результати. Ось приклад журналу, де відповідність струму добра, але параметри тяги непридатні, оскільки відношення не є лінійним.</p><p><img src="'+e+'" alt="line fit"></p></li><li><p>Після ідентифікації параметрів, компенсацію потужності потрібно ввімкнути, встановивши <a href="./../advanced_config/parameter_reference.html#CAL_MAG_COMP_TYP">CAL_MAG_COMP_TYP</a> на значення 1 (при використанні параметрів тяги) або 2 (при використанні параметрів струму). Додатково, параметри компенсації для кожної вісі кожного компасу повинні бути встановлені.</p><p><img src="'+t+'" alt="comp params"></p></li></ol>',16)]))}const b=p(r,[["render",c]]);export{f as __pageData,b as default};
