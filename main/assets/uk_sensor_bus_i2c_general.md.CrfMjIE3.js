import{_ as a}from"./chunks/i2c_jst-gh_cable.BpD89kCk.js";import{_ as r}from"./chunks/tfi2cext01a_bottom.CWGsKaT2.js";import{_ as t,c as i,a8 as o,o as s}from"./chunks/framework.BDnHobkS.js";const C=JSON.parse('{"title":"Периферійні пристрої шини I2C","description":"","frontmatter":{},"headers":[],"relativePath":"uk/sensor_bus/i2c_general.md","filePath":"uk/sensor_bus/i2c_general.md"}'),l={name:"uk/sensor_bus/i2c_general.md"};function n(c,e,h,p,d,u){return s(),i("div",null,e[0]||(e[0]=[o('<h1 id="периферіині-пристроі-шини-i2c" tabindex="-1">Периферійні пристрої шини I2C <a class="header-anchor" href="#периферіині-пристроі-шини-i2c" aria-label="Permalink to &quot;Периферійні пристрої шини I2C&quot;">​</a></h1><p><a href="https://en.wikipedia.org/wiki/I2C" target="_blank" rel="noreferrer">I2C</a> is a serial communication protocol that is commonly used (at least on smaller drones), for connecting peripheral components like rangefinders, LEDs, Compass, etc.</p><p>Рекомендовано для:</p><ul><li>Connecting offboard components that require low bandwidth and low latency communication, e.g. <a href="./../sensor/rangefinders.html">rangefinders</a>, <a href="./../gps_compass/magnetometer.html">magnetometers</a>, <a href="./../sensor/airspeed.html">airspeed sensors</a> and <a href="./../sensor/tachometers.html">tachometers</a> .</li><li>Сумісність з периферійними пристроями, які підтримують лише I2C.</li><li>Можливість підключення декількох пристроїв до однієї шини, що корисно для збереження портів.</li></ul><p>I2C дозволяє підключати декілька головних пристроїв до декількох рабочих пристроїв, використовуючи лише 2 провідника на підключення (SDA, SCL). Теоретично шина може підтримувати 128 пристроїв, що кожен з них доступний за унікальною адресою.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>UAVCAN would normally be preferred where higher data rates are required, and on larger vehicles where sensors are be mounted further from the flight controller.</p></div><h2 id="підключення" tabindex="-1">Підключення <a class="header-anchor" href="#підключення" aria-label="Permalink to &quot;Підключення&quot;">​</a></h2><p>I2C використовує пару проводів: SDA (серійні дані) та SCL (серійний годинник). Шина є типу відкритого стоку, що означає, що пристрої заземлюють лінію даних. It uses a pullup resistor to push it to <code>log.1</code> (idle state) - every wire has it usually located on the bus terminating devices. Одна шина може підключати до кількох пристроїв I2C. Індивідуальні пристрої підключені без перетину.</p><p>Для підключення (згідно зі стандартом dronecode) використовуються 4-жильні кабелі з роз&#39;ємами JST-GH. To ensure reliable communication and to reduce crosstalk it is advised to apply recommendations concerning <a href="./../assembly/cable_wiring.html#i2c-cables">cable twisting</a> and pullup resistors placement.</p><p><img src="'+a+'" alt="Cable twisting"></p><h2 id="перевірка-статусу-шини-та-пристроів" tabindex="-1">Перевірка статусу шини та пристроїв <a class="header-anchor" href="#перевірка-статусу-шини-та-пристроів" aria-label="Permalink to &quot;Перевірка статусу шини та пристроїв&quot;">​</a></h2><p>A useful tool for bus analysis is <a href="./../modules/modules_command.html#i2cdetect">i2cdetect</a>. Це список доступних пристроїв I2C за їх адресами. Він може бути використаний для визначення доступності пристрою на шині та можливості автопілота спілкуватися з ним.</p><p>Інструмент можна запустити в терміналі PX4 за допомогою наступної команди:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>i2cdetect -b 1</span></span></code></pre></div><p>where the bus number is specified after <code>-b</code> parameter</p><h2 id="поширені-проблеми" tabindex="-1">Поширені проблеми <a class="header-anchor" href="#поширені-проблеми" aria-label="Permalink to &quot;Поширені проблеми&quot;">​</a></h2><h3 id="конфлікти-адрес" tabindex="-1">Конфлікти адрес <a class="header-anchor" href="#конфлікти-адрес" aria-label="Permalink to &quot;Конфлікти адрес&quot;">​</a></h3><p>Якщо два пристрої I2C на шині мають однаковий ідентифікатор, відбудеться конфлікт, і жоден з пристроїв не буде працювати належним чином (або взагалі). Це зазвичай трапляється тому, що користувач повинен підключити два сенсори одного типу до шини, але це також може статися, якщо пристрої використовують однакові адреси за замовчуванням.</p><p>Деякі конкретні пристрої I2C можуть дозволити вибрати нову адресу для одного з пристроїв, щоб уникнути конфлікту. Деякі пристрої не підтримують цю опцію, або не мають широких варіантів адрес, які можна використовувати (тобто не можуть бути використані для уникнення конфлікту).</p><p>If you can&#39;t change the addresses, one option is to use an <a href="#i2c-address-translators">I2C Address Translator</a>.</p><h3 id="недостатня-пропускна-здатність-передачі" tabindex="-1">Недостатня пропускна здатність передачі <a class="header-anchor" href="#недостатня-пропускна-здатність-передачі" aria-label="Permalink to &quot;Недостатня пропускна здатність передачі&quot;">​</a></h3><p>Пропускна здатність, доступна для кожного окремого пристрою, зазвичай зменшується зі збільшенням кількості пристроїв. Точне зменшення залежить від пропускної здатності, використованої кожним окремим пристроєм. Therefore it is possible to connect many low bandwidth devices, like <a href="./../sensor/tachometers.html">tachometers</a>. Якщо додати занадто багато пристроїв, це може призвести до помилок передачі та ненадійності мережі.</p><p>Є кілька способів зменшення проблеми:</p><ul><li>Розподілити пристрої на групи, кожна з приблизно однаковою кількістю пристроїв та підключити кожну групу до одного порту автопілота</li><li>Збільшити ліміт швидкості шини (звичайно встановлений в 100кГц для зовнішнього I2C bus)</li></ul><h3 id="надмірна-ємність-проводки" tabindex="-1">Надмірна ємність проводки <a class="header-anchor" href="#надмірна-ємність-проводки" aria-label="Permalink to &quot;Надмірна ємність проводки&quot;">​</a></h3><p>Електрична ємність шини проводки зростає, коли додаються більше пристроїв/проводів. Точне зменшення залежить від загальної довжини шини проводки та специфічної ємності проводки. Проблему можна проаналізувати за допомогою осцилографа, де ми бачимо, що краї сигналів SDA/SCL вже не гострі.</p><p>Є кілька способів зменшення проблеми:</p><ul><li>Розподілити пристрої на групи, кожна з приблизно однаковою кількістю пристроїв та підключити кожну групу до одного порту автопілота</li><li>Використання найкоротших і найвищої якості кабелів I2C, що можливо</li><li>Відокремлення пристроїв зі слабким відкритим стоковим драйвером до меншої шини з нижчою ємністю</li><li><a href="#i2c-bus-accelerators">I2C Bus Accelerators</a></li></ul><h2 id="прискорювачі-шини-i2c" tabindex="-1">Прискорювачі шини I2C <a class="header-anchor" href="#прискорювачі-шини-i2c" aria-label="Permalink to &quot;Прискорювачі шини I2C&quot;">​</a></h2><p>Посилювачі шини I2C - це окремі схеми, які можуть використовуватися для підтримки більшої довжини проводки на шині I2C. Вони працюють, фізично діливши мережу I2C на 2 частини та використовуючи свої транзистори для підсилення сигналів I2C.</p><p>Доступні прискорювачі включають:</p><ul><li><a href="https://github.com/ThunderFly-aerospace/TFI2CEXT01" target="_blank" rel="noreferrer">Thunderfly TFI2CEXT01</a>: <img src="'+r+'" alt="I2C bus extender"><ul><li>Цей дронекод має з&#39;єднувачі, тому це дуже легко додати до налаштування Pixhawk I2C.</li><li>Модуль не має налаштувань (він працює зразу після встановлення).</li></ul></li></ul><h2 id="перетворювачі-i2c-адрес" tabindex="-1">Перетворювачі I2C адрес <a class="header-anchor" href="#перетворювачі-i2c-адрес" aria-label="Permalink to &quot;Перетворювачі I2C адрес&quot;">​</a></h2><p>Перетворювачі I2C адрес можуть використовуватися для запобігання конфліктів I2C адрес в системах, де немає іншого способу призначення унікальних адрес. Вони працюють, слухаючи I2C комунікацію та трансформуючи адресу, коли викликається пристрій-слейв (згідно з попередньо налаштованим алгоритмом).</p><p>До підтримуваних перетворювачів I2C адрес включають:</p><ul><li><a href="./../sensor_bus/translator_tfi2cadt.html">Thunderfly TFI2CADT01</a></li></ul><h2 id="i2c-bus-splitters" tabindex="-1">I2C Bus Splitters <a class="header-anchor" href="#i2c-bus-splitters" aria-label="Permalink to &quot;I2C Bus Splitters&quot;">​</a></h2><p>I2C Bus Splitters are circuit boards that split the I2C port on your flight controller into multiple ports. They are useful if you want to use multiple I2C peripherals on a flight controller that has only one I2C port (or too few), such as an airspeed sensor and a distance sensor.</p><p>You can find an appropriate board using an internet search.</p><h2 id="i2c-level-converter" tabindex="-1">I2C Level Converter <a class="header-anchor" href="#i2c-level-converter" aria-label="Permalink to &quot;I2C Level Converter&quot;">​</a></h2><p>Some I2C devices have 5V on the data lines, while the Pixhawk connector standard port expects these lines to be 3.3 V. You can use an I2C level converter to connect 5V devices to a Pixhawk I2C port.</p><p>You can find an appropriate covnerter using an internet search.</p><h2 id="розробка-i2c" tabindex="-1">Розробка I2C <a class="header-anchor" href="#розробка-i2c" aria-label="Permalink to &quot;Розробка I2C&quot;">​</a></h2><p>Software development for I2C devices is described in <a href="./../sensor_bus/i2c_development.html">I2C Bus (Development Overview)</a>.</p><h2 id="подальша-інформація" tabindex="-1">Подальша інформація <a class="header-anchor" href="#подальша-інформація" aria-label="Permalink to &quot;Подальша інформація&quot;">​</a></h2><ul><li><a href="https://en.wikipedia.org/wiki/I%C2%B2C" target="_blank" rel="noreferrer">I2C</a> (Wikipedia)</li><li><a href="https://learn.sparkfun.com/tutorials/i2c" target="_blank" rel="noreferrer">I2C Comparative Overview</a> (learn.sparkfun.com)</li><li><a href="./../middleware/drivers.html">Driver Framework</a></li></ul>',46)]))}const I=t(l,[["render",n]]);export{C as __pageData,I as default};
