import{_ as t,c as i,a8 as a,o as n}from"./chunks/framework.BDnHobkS.js";const g=JSON.parse('{"title":"Windows Cygwin Development Environment (Maintenance Instructions)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/dev_setup/dev_env_windows_cygwin_packager_setup.md","filePath":"zh/dev_setup/dev_env_windows_cygwin_packager_setup.md"}'),o={name:"zh/dev_setup/dev_env_windows_cygwin_packager_setup.md"};function s(l,e,r,h,p,c){return n(),i("div",null,e[0]||(e[0]=[a(`<h1 id="windows-cygwin-development-environment-maintenance-instructions" tabindex="-1">Windows Cygwin Development Environment (Maintenance Instructions) <a class="header-anchor" href="#windows-cygwin-development-environment-maintenance-instructions" aria-label="Permalink to &quot;Windows Cygwin Development Environment (Maintenance Instructions)&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>This development environment is <a href="./../advanced/community_supported_dev_env.html">community supported and maintained</a>. It may or may not work with current versions of PX4.</p><p>See <a href="./../dev_setup/dev_env.html">Toolchain Installation</a> for information about the environments and tools supported by the core development team.</p></div><p>This topic explains how to construct and extend the development environment used for the no-longer-supported <a href="./../dev_setup/dev_env_windows_cygwin.html">Cygwin-based Windows Development Environment</a>.</p><h2 id="附加信息" tabindex="-1">附加信息 <a class="header-anchor" href="#附加信息" aria-label="Permalink to &quot;附加信息&quot;">​</a></h2><h3 id="features-issues" tabindex="-1">Features / Issues <a class="header-anchor" href="#features-issues" aria-label="Permalink to &quot;Features / Issues&quot;">​</a></h3><p>The following features are known to work (version 2.0):</p><ul><li>Building and running SITL with jMAVSim with significantly better performance than a VM (it generates a native windows binary <strong>px4.exe</strong>).</li><li>Building and uploading NuttX builds (e.g.: px4_fmu-v2 and px4_fmu-v4)</li><li>Style check with <em>astyle</em> (supports the command: <code>make format</code>)</li><li>Command line auto completion</li><li>Non-invasive installer! The installer does NOT affect your system and global path (it only modifies the selected installation directory e.g. **C:\\PX4** and uses a temporary local path).</li><li>The installer supports updating to a new version keeping your personal changes inside the toolchain folder</li></ul><p>Omissions:</p><ul><li>Simulation: Gazebo and ROS are not supported.</li><li>Only NuttX and JMAVSim/SITL builds are supported.</li><li><a href="https://github.com/orgs/PX4/projects/6" target="_blank" rel="noreferrer">Known problems</a> (Also use to report issues).</li></ul><h3 id="shell-script-installation" tabindex="-1">Shell Script Installation <a class="header-anchor" href="#shell-script-installation" aria-label="Permalink to &quot;Shell Script Installation&quot;">​</a></h3><p>You can also install the environment using shell scripts in the Github project.</p><ol><li><p>Make sure you have <a href="https://git-scm.com/download/win" target="_blank" rel="noreferrer">Git for Windows</a> installed.</p></li><li><p>Clone the repository <a href="https://github.com/PX4/windows-toolchain" target="_blank" rel="noreferrer">https://github.com/PX4/windows-toolchain</a> to the location you want to install the toolchain. Default location and naming is achieved by opening the <code>Git Bash</code> and executing:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /c/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/PX4/windows-toolchain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PX4</span></span></code></pre></div></li><li><p>If you want to install all components navigate to the freshly cloned folder and double click on the script <code>install-all-components.bat</code> located in the folder <code>toolchain</code>. If you only need certain components and want to safe Internet traffic and or disk space you can navigate to the different component folders like e.g. <code>toolchain\\cygwin64</code> and click on the <strong>install-XXX.bat</strong> scripts to only fetch something specific.</p></li><li><p>Continue with <a href="./../dev_setup/dev_env_windows_cygwin.html#getting-started">Getting Started</a>.</p></li></ol><h3 id="manual-installation-for-toolchain-developers" tabindex="-1">Manual Installation (for Toolchain Developers) <a class="header-anchor" href="#manual-installation-for-toolchain-developers" aria-label="Permalink to &quot;Manual Installation (for Toolchain Developers)&quot;">​</a></h3><p>This section describes how to setup the Cygwin toolchain manually yourself while pointing to the corresponding scripts from the script based installation repo. The result should be the same as using the scripts or MSI installer.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The toolchain gets maintained and hence these instructions might not cover every detail of all the future changes.</p></div><ol><li><p>Create the <em>folders</em>: **C:\\PX4**, **C:\\PX4\\toolchain** and **C:\\PX4\\home**</p></li><li><p>Download the <em>Cygwin installer</em> file <a href="https://cygwin.com/setup-x86_64.exe" target="_blank" rel="noreferrer">setup-x86_64.exe</a> from the <a href="https://cygwin.com/install.html" target="_blank" rel="noreferrer">official Cygwin website</a></p></li><li><p>Run the downloaded setup file</p></li><li><p>In the wizard choose to install into the folder: **C:\\PX4\\toolchain\\cygwin64**</p></li><li><p>Select to install the default Cygwin base and the newest available version of the following additional packages:</p><ul><li><strong>Category:Packagename</strong></li><li>Devel:cmake (3.3.2 gives no deprecated warnings, 3.6.2 works but has the warnings)</li><li>Devel:gcc-g++</li><li>Devel:gdb</li><li>Devel:git</li><li>Devel:make</li><li>Devel:ninja</li><li>Devel:patch</li><li>Editors:xxd</li><li>Editors:nano (unless you&#39;re the vim pro)</li><li>Python:python2</li><li>Python:python2-pip</li><li>Python:python2-numpy</li><li>Python:python2-jinja2</li><li>Python:python2-pyyaml</li><li>Python:python2-cerberus</li><li>Archive:unzip</li><li>Utils:astyle</li><li>Shells:bash-completion</li><li>Web:wget</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Do not select as many packages as possible which are not on this list, there are some which conflict and break the builds.</p></div></li></ol><p>:::</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>That&#39;s what <a href="https://github.com/MaEtUgR/PX4Toolchain/blob/master/toolchain/cygwin64/install-cygwin-px4.bat" target="_blank" rel="noreferrer">cygwin64/install-cygwin-px4.bat</a> does.</p></div><ol start="6"><li><p>Write up or copy the <strong>batch scripts</strong> <a href="https://github.com/MaEtUgR/PX4Toolchain/blob/master/run-console.bat" target="_blank" rel="noreferrer"><code>run-console.bat</code></a> and <a href="https://github.com/PX4/windows-toolchain/blob/master/toolchain/scripts/setup-environment.bat" target="_blank" rel="noreferrer"><code>setup-environment.bat</code></a>.</p><p>The reason to start all the development tools through the prepared batch script is they preconfigure the starting program to use the local, portable Cygwin environment inside the toolchain&#39;s folder. This is done by always first calling the script <a href="https://github.com/PX4/windows-toolchain/blob/master/toolchain/scripts/setup-environment.bat" target="_blank" rel="noreferrer"><strong>setup-environment.bat</strong></a> and the desired application like the console after that.</p><p>The script <a href="https://github.com/PX4/windows-toolchain/blob/master/toolchain/scripts/setup-environment.bat" target="_blank" rel="noreferrer">setup-environment.bat</a> locally sets environmental variables for the workspace root directory <code>PX4_DIR</code>, all binary locations <code>PATH</code>, and the home directory of the unix environment <code>HOME</code>.</p></li><li><p>Add necessary <strong>python packages</strong> to your setup by opening the Cygwin toolchain console (double clicking <strong>run-console.bat</strong>) and executing</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> toml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyserial</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyulog</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>That&#39;s what <a href="https://github.com/MaEtUgR/PX4Toolchain/blob/master/toolchain/cygwin64/install-cygwin-python-packages.bat" target="_blank" rel="noreferrer">cygwin64/install-cygwin-python-packages.bat</a> does.</p></div></li></ol><p>:::</p><ol start="8"><li><p>Download the <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads" target="_blank" rel="noreferrer"><strong>ARM GCC compiler</strong></a> as zip archive of the binaries for Windows and unpack the content to the folder <code>C:\\PX4\\toolchain\\gcc-arm</code>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This is what the toolchain does in: <a href="https://github.com/MaEtUgR/PX4Toolchain/blob/master/toolchain/gcc-arm/install-gcc-arm.bat" target="_blank" rel="noreferrer">gcc-arm/install-gcc-arm.bat</a>.</p></div></li></ol><p>:::</p><ol start="9"><li><p>Install the JDK:</p><ul><li>Download Java 14 from <a href="https://www.oracle.com/java/technologies/javase-jdk14-downloads.html" target="_blank" rel="noreferrer">Oracle</a> or <a href="https://adoptopenjdk.net/" target="_blank" rel="noreferrer">AdoptOpenJDK</a>.</li><li>Because sadly there is no portable archive containing the binaries directly you have to install it.</li><li>Find the binaries and move/copy them to <strong>C:\\PX4\\toolchain\\jdk</strong>.</li><li>You can uninstall the Kit from your Windows system again, we only needed the binaries for the toolchain.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This is what the toolchain does in: <a href="https://github.com/MaEtUgR/PX4Toolchain/blob/master/toolchain/jdk/install-jdk.bat" target="_blank" rel="noreferrer">jdk/install-jdk.bat</a>.</p></div></li></ol><p>:::</p><ol start="10"><li><p>Download <a href="https://ant.apache.org/bindownload.cgi" target="_blank" rel="noreferrer"><strong>Apache Ant</strong></a> as zip archive of the binaries for Windows and unpack the content to the folder <code>C:\\PX4\\toolchain\\apache-ant</code>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Make sure you don&#39;t have an additional folder layer from the folder which is inside the downloaded archive.</p></div></li></ol><p>:::</p><pre><code>::: info
This is what the toolchain does in: [apache-ant/install-apache-ant.bat](https://github.com/MaEtUgR/PX4Toolchain/blob/master/toolchain/apache-ant/install-apache-ant.bat).
</code></pre><p>:::</p><ol start="11"><li><p>Download, build and add <em>genromfs</em> to the path:</p><ul><li><p>Clone the source code to the folder <strong>C:\\PX4\\toolchain\\genromfs\\genromfs-src</strong> with</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /c/toolchain/genromfs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/chexum/genromfs.git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> genromfs-src</span></span></code></pre></div></li><li><p>Compile it with:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> genromfs-src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span></span></code></pre></div></li><li><p>Copy the resulting binary <strong>genromfs.exe</strong> one folder level out to: <strong>C:\\PX4\\toolchain\\genromfs</strong></p></li></ul></li><li><p>Make sure all the binary folders of all the installed components are correctly listed in the <code>PATH</code> variable configured by <a href="https://github.com/PX4/windows-toolchain/blob/master/toolchain/scripts/setup-environment.bat" target="_blank" rel="noreferrer"><strong>setup-environment.bat</strong></a>.</p></li></ol>`,29)]))}const u=t(o,[["render",s]]);export{g as __pageData,u as default};
