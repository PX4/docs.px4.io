import{_ as a}from"./chunks/mavlink_camera_settings.DZ9bbt2l.js";import{_ as r,c as l,a8 as t,o as n}from"./chunks/framework.BDnHobkS.js";const k=JSON.parse('{"title":"简单的 MAVLink 摄像头(Camera Protcol v1)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/camera/mavlink_v1_camera.md","filePath":"zh/camera/mavlink_v1_camera.md"}'),o={name:"zh/camera/mavlink_v1_camera.md"};function i(_,e,m,s,h,c){return n(),l("div",null,e[0]||(e[0]=[t('<h1 id="简单的-mavlink-摄像头-camera-protcol-v1" tabindex="-1">简单的 MAVLink 摄像头(Camera Protcol v1) <a class="header-anchor" href="#简单的-mavlink-摄像头-camera-protcol-v1" aria-label="Permalink to &quot;简单的 MAVLink 摄像头(Camera Protcol v1)&quot;">​</a></h1><p>本节说明了如何使用 PX4 的 MAVLink <a href="./../camera/">相机</a>, 实现了 <a href="https://mavlink.io/en/services/camera_v1.html" target="_blank" rel="noreferrer">Camera Protocol v1 (简单触发协议)</a> 的 PX4 和地面站。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><a href="./../camera/mavlink_v2_camera.html">MAVLink 相机</a> 在可能的情况下应该使用 <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">MAVLink Camera Protocol v2</a> 代替！ 此方法保留用于旧的 MAVLink 相机。</p></div><h2 id="综述" tabindex="-1">综述 <a class="header-anchor" href="#综述" aria-label="Permalink to &quot;综述&quot;">​</a></h2><p><a href="https://mavlink.io/zh/services/camera_v1.html" target="_blank" rel="noreferrer">相机协议v1</a> 定义了一小组命令，允许用于触发相机进行拍摄：</p><ul><li>仍然根据时间或距离以频率捕获图像</li><li>视频捕获</li><li>有限的相机配置</li></ul><p>PX4 支持此命令集以触发通过原生支持协议的相机（如本节所述），以及连接到飞控输出的相机。</p><p>地面站和 MAVLink SDK 通常将相机命令发送给自动驾驶仪，然后转发给连接的类型为 &#39;板载&#39; 的 MAVLink 通道。 PX4 还会将其在任务中遇到的任何相机任务项重新发出为相机命令：未被接受的命令将被记录。 在所有情况下，命令都是使用自动驾驶仪的系统 ID 和组件 ID 为0（即发送给所有组件，包括摄像头）。</p><p>每次触发图像捕获时 PX4 也会发出一个 <a href="https://mavlink.io/en/messages/common.html#CAMERA_TRIGGER" target="_blank" rel="noreferrer">CAMERA_TRIGGER</a> (相机本身也可能在触发时发出此消息)。</p><h2 id="控制相机" tabindex="-1">控制相机 <a class="header-anchor" href="#控制相机" aria-label="Permalink to &quot;控制相机&quot;">​</a></h2><h3 id="mavlink-命令和消息" tabindex="-1">MAVLink 命令和消息 <a class="header-anchor" href="#mavlink-命令和消息" aria-label="Permalink to &quot;MAVLink 命令和消息&quot;">​</a></h3><p><a href="https://mavlink.io/en/services/camera_v1.html" target="_blank" rel="noreferrer">相机协议v1（简单触发协议）</a>定义了以下命令：</p><ul><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_TRIGGER_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_DO_TRIGGER_CONTROL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_CMD_DO_DIGICAM_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_NAV_CMD_DO_DIGICAM_CONTROL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_DIST" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_DIST</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_OBLIQUE_SURVEY" target="_blank" rel="noreferrer">MAV_CMD_OBLIQUE_SURVEY</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_CONTROL_VIDEO" target="_blank" rel="noreferrer">MAV_CMD_DO_CONTROL_VIDEO</a></li></ul><p>MAVLink 摄像头将支持这些命令的一些子集。 由于协议没有发现过程的功能，唯一的方法是检查响应中返回的<a href="https://mavlink.io/en/messages/common.html#COMMAND_ACK" target="_blank" rel="noreferrer">COMMAND_ACK</a>。</p><p>相机在每次拍摄图像时也应发出<a href="https://mavlink.io/en/messages/common.html#CAMERA_TRIGGER" target="_blank" rel="noreferrer">CAMERA_TRIGGER</a>。</p><p><a href="https://mavlink.io/zh/services/camera_v1.html" target="_blank" rel="noreferrer">Camera Protocol v1</a> 更详细地描述了协议。</p><h3 id="地面站" tabindex="-1">地面站 <a class="header-anchor" href="#地面站" aria-label="Permalink to &quot;地面站&quot;">​</a></h3><p>地面站可以使用 <a href="https://mavlink.io/en/services/camera_v1.html" target="_blank" rel="noreferrer">Camera Protocol v1（简单触发协议）</a> 中的任何命令，并且应该将这些命令发送给自驾仪组件 id。 如果相机不支持命令，它将返回带有错误结果的<a href="https://mavlink.io/en/messages/common.html#COMMAND_ACK" target="_blank" rel="noreferrer">COMMAND_ACK</a>。</p><p>通常命令是针对自驾仪的，因为这样无论相机是通过 MAVLink 连接还是直接连接飞控都能工作。 如果发送给自驾仪 PX4，每次拍摄图像时 PX4 都会发出<a href="https://mavlink.io/en/messages/common.html#CAMERA_TRIGGER" target="_blank" rel="noreferrer">CAMERA_TRIGGER</a>，并可能记录相机拍摄事件。</p><p>理论上，您也可以直接向相机发送命令。</p><h3 id="camera-commands-in-missions" tabindex="-1">Camera Commands in Missions <a class="header-anchor" href="#camera-commands-in-missions" aria-label="Permalink to &quot;Camera Commands in Missions&quot;">​</a></h3><p>以下<a href="https://mavlink.io/en/services/camera_v1.html" target="_blank" rel="noreferrer">Camera Protocol v1 (简单触发协议)</a>命令可在任务中使用(这与上面的命令列表相同)。</p><ul><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_TRIGGER_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_DO_TRIGGER_CONTROL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_CMD_DO_DIGICAM_CONTROL" target="_blank" rel="noreferrer">MAV_CMD_NAV_CMD_DO_DIGICAM_CONTROL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_DIST" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_DIST</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL" target="_blank" rel="noreferrer">MAV_CMD_DO_SET_CAM_TRIGG_INTERVAL</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_OBLIQUE_SURVEY" target="_blank" rel="noreferrer">MAV_CMD_OBLIQUE_SURVEY</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_DO_CONTROL_VIDEO" target="_blank" rel="noreferrer">MAV_CMD_DO_CONTROL_VIDEO</a></li></ul><p>PX4 重新使用与自驾仪相同的系统 ID 和组件 ID <a href="https://mavlink.io/en/messages/common.html#MAV_COMP_ID_ALL" target="_blank" rel="noreferrer">MAV_COMP_ID_ALL</a> 重新发送它们：</p><h3 id="manual-control" tabindex="-1">Manual Control <a class="header-anchor" href="#manual-control" aria-label="Permalink to &quot;Manual Control&quot;">​</a></h3><p>这些相机不支持手动触发（无论是摇杆还是遥控器）。</p><h2 id="px4-配置" tabindex="-1">PX4 配置 <a class="header-anchor" href="#px4-配置" aria-label="Permalink to &quot;PX4 配置&quot;">​</a></h2><h3 id="mavlink-端口和转发配置" tabindex="-1">MAVLink 端口和转发配置 <a class="header-anchor" href="#mavlink-端口和转发配置" aria-label="Permalink to &quot;MAVLink 端口和转发配置&quot;">​</a></h3><p>将 PX4 连接到您的 MAVLink 相机上，将它连接到您飞控上一个未使用的串口，如<code>TELEM2</code>。 然后，您可以将端口配置为<a href="./../peripherals/mavlink_peripherals.html">MAVLink 外设</a>. 本文件解释了如何做，总的来说：</p><ol><li>修改一个未使用的 <code>MAV_n_CONFIG</code> 参数，例如<a href="./../advanced_config/parameter_reference.html#MAV_2_CONFIG">MAV_2_CONFIG</a>，使其分配给相机连接的端口。</li><li>将对应的 <a href="./../advanced_config/parameter_reference.html#MAV_2_MODE">MAV_2_MODE</a> 设置为 <code>2</code> (板载)。 这确保正确的 MAVLink 消息集被发出和转发。</li><li>您可能需要设置一些其他参数，取决于您的连接 - 例如波特率。</li></ol><p>然后按照其用户指南中的建议连接和配置相机。</p><h3 id="相机模式和触发" tabindex="-1">相机模式和触发 <a class="header-anchor" href="#相机模式和触发" aria-label="Permalink to &quot;相机模式和触发&quot;">​</a></h3><p>配置 PX4 相机驱动器以启用 MAVLink 相机后端，并设置触发模式为在勘测任务中按命令捕获。</p><p>使用 <em>QGroundControl</em>:</p><ul><li><p>打开 <a href="https://docs.qgroundcontrol.com/master/zh/qgc-user-guide/setup_view/camera.html#px4-camera-setup" target="_blank" rel="noreferrer">Vehicle Setup &gt; Camera</a>。</p></li><li><p>按照所示设置数值:</p><p><img src="'+a+'" alt="相机设置界面 - 触发模式和 MAVLink 接口"></p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You can also <a href="./../advanced_config/parameters.html">set the parameters directly</a>:</p><ul><li><a href="./../advanced_config/parameter_reference.html#TRIG_MODE">TRIG_MODE</a> — <code>4</code>: 基于距离，按命令触发 (勘测模式)</li><li><a href="./../advanced_config/parameter_reference.html#TRIG_INTERFACE">TRIG_INTERFACE</a> — <code>3</code>: MAVLink</li></ul></div>',36)]))}const A=r(o,[["render",i]]);export{k as __pageData,A as default};
