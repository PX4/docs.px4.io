import{_ as a,a as e,b as s,c as t,d as l,e as n}from"./chunks/plotjuggler_quaternion_roll_plotted.znJhjash.js";import{_ as o,c as h,a8 as r,o as p}from"./chunks/framework.BDnHobkS.js";const _=JSON.parse('{"title":"Аналіз журналу за допомогою PlotJuggler","description":"","frontmatter":{},"headers":[],"relativePath":"uk/log/plotjuggler_log_analysis.md","filePath":"uk/log/plotjuggler_log_analysis.md"}'),d={name:"uk/log/plotjuggler_log_analysis.md"};function g(c,i,k,u,m,E){return p(),h("div",null,i[0]||(i[0]=[r('<h1 id="аналіз-журналу-за-допомогою-plotjuggler" tabindex="-1">Аналіз журналу за допомогою PlotJuggler <a class="header-anchor" href="#аналіз-журналу-за-допомогою-plotjuggler" aria-label="Permalink to &quot;Аналіз журналу за допомогою PlotJuggler&quot;">​</a></h1><p><a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">PlotJuggler</a> can be used to analyze ULogs for in-depth, development purposes. Це надзвичайно корисно, оскільки кожна тема uORB відкрита / може бути побудована на графіку, а також має власні функції для зміни даних (наприклад, зі значень кватерніону на Крен / Тангаж / Риштування).</p><h2 id="встановлення" tabindex="-1">Встановлення <a class="header-anchor" href="#встановлення" aria-label="Permalink to &quot;Встановлення&quot;">​</a></h2><p>You can find the latest releases of the Plot Juggler <a href="https://github.com/facontidavide/PlotJuggler/releases" target="_blank" rel="noreferrer">here</a>.</p><h4 id="примітки-щодо-розподілу-windows" tabindex="-1">Примітки щодо розподілу Windows <a class="header-anchor" href="#примітки-щодо-розподілу-windows" aria-label="Permalink to &quot;Примітки щодо розподілу Windows&quot;">​</a></h4><p>Остання версія PlotJuggler для Windows може не працювати. In this case fallback to <a href="https://github.com/facontidavide/PlotJuggler/releases/tag/2.8.4" target="_blank" rel="noreferrer">v2.8.4 here</a> (this is known to work with Windows).</p><h4 id="примітки-про-appimage-для-дистрибутивів-linux" tabindex="-1">Примітки про AppImage для дистрибутивів Linux <a class="header-anchor" href="#примітки-про-appimage-для-дистрибутивів-linux" aria-label="Permalink to &quot;Примітки про AppImage для дистрибутивів Linux&quot;">​</a></h4><p>Якщо завантажений AppImage не відкривається, можливо, вам потрібно змінити його налаштування доступу. Це робиться в терміналі за допомогою наступної команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 777</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Path-To-PlotJuggler-AppImag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h2 id="загальне-використання" tabindex="-1">Загальне використання <a class="header-anchor" href="#загальне-використання" aria-label="Permalink to &quot;Загальне використання&quot;">​</a></h2><p>Два найпоширеніші завдання - &quot;Пошук&quot; залогованої теми уORB та &quot;Перетягування та Відпускання&quot; поля в певну тему на графічний вигляд. Це показано на діаграмі нижче.</p><p><img src="'+a+'" alt="Plot Juggler basic usage"></p><h3 id="розбиття-по-горизонталі-вертикалі-багатопанельнии" tabindex="-1">Розбиття по горизонталі / вертикалі: Багатопанельний <a class="header-anchor" href="#розбиття-по-горизонталі-вертикалі-багатопанельнии" aria-label="Permalink to &quot;Розбиття по горизонталі / вертикалі: Багатопанельний&quot;">​</a></h3><p>Одна з найбільш потужних функцій - розділення екрану у горизонтальному або вертикальному положенні та відображення різних графіків одночасно (з синхронізованою панеллю часу зверху, якщо переміщуєте курсор часу внизу).</p><p>Це показано на анімації нижче:</p><p><img src="'+e+'" alt="Plot Juggler Multi panel demonstration"></p><p>In this example, <code>vehicle_local_position</code> topic&#39;s <code>ax</code>, <code>ay</code> and <code>az</code> (Acceleration estimate) components were graphed first by splitting the screen in 3 sections. Then, the <code>vz</code> (Velocity estimate) component was added under right pane, and finally <code>battery_status</code> topic&#39;s <code>current_a</code> (Battery current) was graphed in the lower-mid pane.</p><p>Хоча спочатку це не очевидно, ви можете помітити, що кожного разу, коли автомобіль починає рухатися (значення поточного заряду батареї зростає), значення прискорення та швидкості також починають змінюватися. Це тому, що всі дані відображаються як часова послідовність, яка показує кожне значення на певному міткостемпу.</p><p>Це корисно для отримання загального уявлення про те, що сталося і чому. Часто важко вирішувати проблеми, просто глянувши на один графік, але якщо відображені кілька графіків, набагато легше зрозуміти, що відбувалося в системі.</p><h3 id="відображення-даних-у-2d" tabindex="-1">Відображення даних у 2D <a class="header-anchor" href="#відображення-даних-у-2d" aria-label="Permalink to &quot;Відображення даних у 2D&quot;">​</a></h3><p>Іншою потужною функцією є можливість відображення 2D даних на площині XY (кожні дані на вісі X, Y) у вигляді діаграми розсіювання. This is done by selecting two data points by holding <code>Ctrl</code> key while selecting each of them (e.g. <code>vehicle_local_position</code> topic&#39;s <code>x</code> and <code>y</code> components), and drag &amp; dropping it with the <code>Right mouse cursor</code> pressed.</p><p><img src="'+s+'" alt="Plot Juggler 2D graphing"></p><p>In this example, the estimated vehicle&#39;s position in local coordinate frame is graphed onto a XY-plane which shows a 2D view of the estimated position, and the <code>vx</code> and <code>vy</code> components (Velocity estimate) are graphed on the right, with the <code>vz</code> (Vertical velocity estimate) graphed underneath it in a split view.</p><p>Це в свою чергу показує взаємозв&#39;язок між позицією та швидкістю руху транспортного засобу інтуїтивно. For example, note how when the vehicle moves in the X-axis direction, the <code>vx</code> value goes high, and as the vehicle turns to the Y-axis direction, the <code>vy</code> value starts to change as well.</p><h4 id="використання-кнопки-play" tabindex="-1">Використання кнопки &#39;Play&#39; <a class="header-anchor" href="#використання-кнопки-play" aria-label="Permalink to &quot;Використання кнопки &#39;Play&#39;&quot;">​</a></h4><p>Here the <strong>Play</strong> button is used to play the recorded data in real time (speed factor can be adjusted in the lower-right corner). Це показує детально зв&#39;язок позиції / швидкості, описаний вище.</p><p><img src="'+t+'" alt="Plot Juggler 2D in-depth analysis"></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Try out the boat testing log analysis yourself by downloading the ULog and Layout file used above!</p><ul><li><a href="https://github.com/PX4/PX4-user_guide/raw/main/assets/flight_log_analysis/plot_juggler/sample_log_boat_testing_2022-7-28-13-31-16.ulg" target="_blank" rel="noreferrer">Boat testing ULog</a></li><li><a href="https://raw.githubusercontent.com/PX4/PX4-user_guide/main/assets/flight_log_analysis/plot_juggler/sample_log_boat_testing_layout.xml" target="_blank" rel="noreferrer">Boat testing Analysis Layout</a></li></ul></div><h3 id="шаблони-макетів" tabindex="-1">Шаблони макетів <a class="header-anchor" href="#шаблони-макетів" aria-label="Permalink to &quot;Шаблони макетів&quot;">​</a></h3><p>Існує кілька файлів розташування PlotJuggler, якими діляться розробники PX4. Кожен може бути використаний для конкретної мети (настройка багтрекера, настройка VTOL, налагодження човна і т. Д.):</p><ul><li><a href="https://github.com/PX4/PX4-user_guide/blob/main/assets/flight_log_analysis/plot_juggler/plotjuggler_sample_view.xml" target="_blank" rel="noreferrer">Sample View layout</a> : Template used in the <a href="#splitting-horizontally-vertically-multi-panel">Multi-panel example</a> above.</li></ul><h2 id="розширене-використання" tabindex="-1">Розширене використання <a class="header-anchor" href="#розширене-використання" aria-label="Permalink to &quot;Розширене використання&quot;">​</a></h2><h3 id="створення-власних-часових-рядів-за-допомогою-lua-скрипта" tabindex="-1">Створення власних часових рядів за допомогою LUA скрипта <a class="header-anchor" href="#створення-власних-часових-рядів-за-допомогою-lua-скрипта" aria-label="Permalink to &quot;Створення власних часових рядів за допомогою LUA скрипта&quot;">​</a></h3><p>Plot Juggler підтримує використання LUA скриптів для обробки та відображення даних. Це потужна функція, яка може робити такі речі, як інтегрування кривої, усереднювання двох кривих, видалення зміщень та інше.</p><h4 id="розрахунок-кута-крену-тангажу-риск-з-кватеріону" tabindex="-1">Розрахунок кута крену/тангажу/риск з кватеріону <a class="header-anchor" href="#розрахунок-кута-крену-тангажу-риск-з-кватеріону" aria-label="Permalink to &quot;Розрахунок кута крену/тангажу/риск з кватеріону&quot;">​</a></h4><p><img src="'+l+'" alt="Quaternion to Roll using Lua script"></p><p>To know vehicle&#39;s attitude, PX4 logs the estimated attitude&#39;s quaternion in the <code>vehicle_attitude</code> topic in an array of floating point values (q[4]). Since these values don&#39;t give contextual information (e.g. <code>roll</code>), it needs a transformation involving trigonometric functions.</p><ol><li>Search for <code>vehicle_attitude</code> topic in Timeseries List panel on the left</li><li>Select 4 quaternion members (<code>q.00, q.01, q.02, q.03</code>) by clicking <code>q.00</code> first, then holding Shift + clicking <code>q.03</code>. Вони всі повинні бути вибрані</li><li>Клацніть на символ &#39;+&#39; у нижньому лівому розділі &#39;Користувацькі серії&#39;, щоб створити нову серію</li><li>Виберіть ще 4 члени кватерніона та перетягніть їх на вкладку &#39;Вхідний часовий ряд + Додатковий джереловий часовий ряд&#39; у верхньому лівому куті</li><li>Double click on the <code>quat_to_roll</code> from the Function Library. Тепер ви маєте сюжет на верхній секції</li><li>Assign the name for the plot (e.g. <code>roll</code>) in the text box in upper-right corner</li><li>Клацніть &#39;Створити нову часову послідовність&#39;. Тепер ви маєте сюжет у &#39;Спеціальній серії&#39;</li></ol><p>Here the custom series <code>Roll</code> is displayed along with other timeseries, including it&#39;s original form in Quaternion on the right, which is not human-readable (using PlotJuggler 3.5.0):</p><p><img src="'+n+`" alt="Quaternion Roll plotted"></p><p>The <code>quat_to_roll</code> function looks like this:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dcm21 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dcm22 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">z</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">roll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> math.atan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dcm21, dcm22)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> roll</span></span></code></pre></div>`,42)]))}const f=o(d,[["render",g]]);export{_ as __pageData,f as default};
