import{_ as a,c as t,a8 as r,o as i}from"./chunks/framework.BDnHobkS.js";const m=JSON.parse('{"title":"Приймачі ADS-B/FLARM/UTM: Уникнення повітряного трафіку","description":"","frontmatter":{},"headers":[],"relativePath":"uk/peripherals/adsb_flarm.md","filePath":"uk/peripherals/adsb_flarm.md"}'),o={name:"uk/peripherals/adsb_flarm.md"};function d(n,e,l,c,h,s){return i(),t("div",null,e[0]||(e[0]=[r('<h1 id="приимачі-ads-b-flarm-utm-уникнення-повітряного-трафіку" tabindex="-1">Приймачі ADS-B/FLARM/UTM: Уникнення повітряного трафіку <a class="header-anchor" href="#приимачі-ads-b-flarm-utm-уникнення-повітряного-трафіку" aria-label="Permalink to &quot;Приймачі ADS-B/FLARM/UTM: Уникнення повітряного трафіку&quot;">​</a></h1><p>PX4 supports simple air traffic avoidance in <a href="./../flying/missions.html">missions</a> using <a href="https://en.wikipedia.org/wiki/Automatic_dependent_surveillance_%E2%80%93_broadcast" target="_blank" rel="noreferrer">ADS-B</a>, <a href="https://en.wikipedia.org/wiki/FLARM" target="_blank" rel="noreferrer">FLARM</a>, or <a href="https://www.faa.gov/uas/research_development/traffic_management" target="_blank" rel="noreferrer">UTM</a> transponders that use the standard MAVLink interfaces.</p><p>If a potential collision is detected, PX4 can <em>warn</em>, immediately <a href="./../flight_modes_mc/land.html">land</a>, or <a href="./../flight_modes_mc/return.html">return</a> (depending on the value of <a href="#NAV_TRAFF_AVOID">NAV_TRAFF_AVOID</a>).</p><h2 id="підтримуване-обладнання" tabindex="-1">Підтримуване обладнання <a class="header-anchor" href="#підтримуване-обладнання" aria-label="Permalink to &quot;Підтримуване обладнання&quot;">​</a></h2><p>PX4 traffic avoidance works with ADS-B or FLARM products that supply transponder data using the MAVLink <a href="https://mavlink.io/en/messages/common.html#ADSB_VEHICLE" target="_blank" rel="noreferrer">ADSB_VEHICLE</a> message, and UTM products that supply transponder data using the MAVLink <a href="https://mavlink.io/en/messages/common.html#UTM_GLOBAL_POSITION" target="_blank" rel="noreferrer">UTM_GLOBAL_POSITION</a> message.</p><p>Було протестовано з наступними пристроями:</p><ul><li><a href="https://uavionix.com/product/pingrx-pro/" target="_blank" rel="noreferrer">PingRX ADS-B Receiver</a> (uAvionix)</li><li><a href="https://flarm.com/products/uav/atom-uav-flarm-for-drones/" target="_blank" rel="noreferrer">FLARM</a></li></ul><h2 id="налаштування-програмного-забезпечення" tabindex="-1">Налаштування програмного забезпечення <a class="header-anchor" href="#налаштування-програмного-забезпечення" aria-label="Permalink to &quot;Налаштування програмного забезпечення&quot;">​</a></h2><p>Будь-який з пристроїв може бути підключений до будь-якого вільного/не використаного послідовного порту на контролері польоту. Most commonly they are connected to <code>TELEM2</code> (if this is not being use for some other purpose).</p><h3 id="pingrx" tabindex="-1">PingRX <a class="header-anchor" href="#pingrx" aria-label="Permalink to &quot;PingRX&quot;">​</a></h3><p>Порт PingRX MAVLink використовує роз&#39;єм-матинг JST ZHR-4 з роз&#39;ємом, як показано нижче.</p><table tabindex="0"><thead><tr><th>Pin</th><th>Сигнал</th><th>Вольтаж</th></tr></thead><tbody><tr><td>1 (red)</td><td>RX (IN)</td><td>+5V tolerant</td></tr><tr><td>2 (blk)</td><td>TX (OUT)</td><td></td></tr><tr><td>3 (blk)</td><td>Power</td><td>+4 to 6V</td></tr><tr><td>4 (blk)</td><td>GND</td><td>GND</td></tr></tbody></table><p>The PingRX comes with connector cable that can be attached directly to the TELEM2 port (DF13-6P) on an <a href="./../flight_controller/mro_pixhawk.html">mRo Pixhawk</a>. Для інших портів або плат, вам доведеться отримати свій власний кабель.</p><h2 id="flarm" tabindex="-1">FLARM <a class="header-anchor" href="#flarm" aria-label="Permalink to &quot;FLARM&quot;">​</a></h2><p>FLARM has an on-board DF-13 6 Pin connector that has an identical pinout to the <a href="./../flight_controller/mro_pixhawk.html">mRo Pixhawk</a>.</p><table tabindex="0"><thead><tr><th>Pin</th><th>Сигнал</th><th>Вольтаж</th></tr></thead><tbody><tr><td>1 (red)</td><td>VCC</td><td>+4В до +36В</td></tr><tr><td>2 (blk)</td><td>TX (OUT)</td><td>+3.3V</td></tr><tr><td>3 (blk)</td><td>RX (IN)</td><td>+3.3V</td></tr><tr><td>4 (blk)</td><td>-</td><td>+3.3V</td></tr><tr><td>5 (blk)</td><td>-</td><td>+3.3V</td></tr><tr><td>6 (blk)</td><td>GND</td><td>GND</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The TX and RX on the flight controller must be connected to the RX and TX on the FLARM, respectively.</p></div><h2 id="конфігурація-програмного-забезпечення" tabindex="-1">Конфігурація програмного забезпечення <a class="header-anchor" href="#конфігурація-програмного-забезпечення" aria-label="Permalink to &quot;Конфігурація програмного забезпечення&quot;">​</a></h2><h3 id="конфігурація-порту" tabindex="-1">Конфігурація порту <a class="header-anchor" href="#конфігурація-порту" aria-label="Permalink to &quot;Конфігурація порту&quot;">​</a></h3><p>The recievers are configured in the same way as any other <a href="./../peripherals/mavlink_peripherals.html">MAVLink Peripheral</a>. The only <em>specific</em> setup is that the port baud rate must be set to 57600 and the a low-bandwidth profile (<code>MAV_X_MODE</code>).</p><p>Assuming you have connected the device to the TELEM2 port, <a href="./../advanced_config/parameters.html">set the parameters</a> as shown:</p><ul><li><a href="./../advanced_config/parameter_reference.html#MAV_1_CONFIG">MAV_1_CONFIG</a> = TELEM 2</li><li><a href="./../advanced_config/parameter_reference.html#MAV_1_MODE">MAV_1_MODE</a> = Normal</li><li><a href="./../advanced_config/parameter_reference.html#MAV_1_RATE">MAV_1_RATE</a> = 0 (default sending rate for port).</li><li><a href="./../advanced_config/parameter_reference.html#MAV_1_FORWARD">MAV_1_FORWARD</a> = Enabled</li></ul><p>Перезавантажте пристрій.</p><p>You will now find a new parameter called <a href="./../advanced_config/parameter_reference.html#SER_TEL2_BAUD">SER_TEL2_BAUD</a>, which must be set to 57600.</p><h3 id="налаштування-передачі-трафіку" tabindex="-1">Налаштування передачі трафіку <a class="header-anchor" href="#налаштування-передачі-трафіку" aria-label="Permalink to &quot;Налаштування передачі трафіку&quot;">​</a></h3><p>Налаштуйте дію у випадку потенційної зіткнення за допомогою параметри нижче:</p><table tabindex="0"><thead><tr><th>Параметр</th><th>Опис</th></tr></thead><tbody><tr><td><a id="NAV_TRAFF_AVOID"></a><a href="./../advanced_config/parameter_reference.html#NAV_TRAFF_AVOID">NAV_TRAFF_AVOID</a></td><td>Увімкніть режим уникнення трафіку, вказавши відповідь уникнення. 0: Вимкнути, 1: Лише попередження, 2: Режим повернення, 3: Режим посадки.</td></tr><tr><td><a id="NAV_TRAFF_A_HOR"></a><a href="./../advanced_config/parameter_reference.html#NAV_TRAFF_A_HOR">NAV_TRAFF_A_HOR</a></td><td>Горизонтальний радіус циліндра навколо транспортного засобу, який визначає його повітряний простір (тобто повітряний простір на земельній площині).</td></tr><tr><td><a id="NAV_TRAFF_A_VER"></a><a href="./../advanced_config/parameter_reference.html#NAV_TRAFF_A_VER">NAV_TRAFF_A_VER</a></td><td>Vertical height above and below vehicle of the cylinder that defines its airspace (also see <a href="#NAV_TRAFF_A_HOR">NAV_TRAFF_A_HOR</a>).</td></tr><tr><td><a id="NAV_TRAFF_COLL_T"></a><a href="./../advanced_config/parameter_reference.html#NAV_TRAFF_COLL_T">NAV_TRAFF_COLL_T</a></td><td>Поріг часу зіткнення. Уникнення буде викликати якщо передбачуваний час, поки зіткнення не знизиться нижче цієї вартості (орієнтовний час ґрунтується на відносній швидкості руху та UAV).</td></tr></tbody></table><h2 id="імплементація" tabindex="-1">Імплементація <a class="header-anchor" href="#імплементація" aria-label="Permalink to &quot;Імплементація&quot;">​</a></h2><h3 id="adsb-flarm" tabindex="-1">ADSB/FLARM <a class="header-anchor" href="#adsb-flarm" aria-label="Permalink to &quot;ADSB/FLARM&quot;">​</a></h3><p>PX4 слухає дійсні звіти про транспондери під час місій.</p><p>Якщо отримано дійсний звіт від транспондера, PX4 спочатку використовує інформацію про транспондер руху, щоб оцінити, чи показує напрямок та висота руху, що буде перетинатися з повітряним простором БПЛА. The UAV airspace consists of a surrounding cylinder defined by the radius <a href="#NAV_TRAFF_A_HOR">NAV_TRAFF_A_HOR</a> and height <a href="#NAV_TRAFF_A_VER">NAV_TRAFF_A_VER</a>, with the UAV at it&#39;s center. The traffic detector then checks if the time until intersection with the UAV airspace is below the <a href="#NAV_TRAFF_COLL_T">NAV_TRAFF_COLL_T</a> threshold based on the relative speed. If the both checks are true, the <a href="./../config/safety.html#traffic-avoidance-failsafe">Traffic Avoidance Failsafe</a> action is started, and the vehicle will either warn, land, or return.</p><p>The code can be found in <code>Navigator::check_traffic</code> (<a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/modules/navigator/navigator_main.cpp" target="_blank" rel="noreferrer">/src/modules/navigator/navigator_main.cpp</a>).</p><p>PX4 також передаватиме дані транспондера на GCS, якщо це було налаштовано для екземпляра MAVLink (це рекомендується). Останні 10 цифр GUID відображаються як ідентифіфікація дрона.</p><h3 id="utm" tabindex="-1">UTM <a class="header-anchor" href="#utm" aria-label="Permalink to &quot;UTM&quot;">​</a></h3><p>PX4 listens for <code>UTM_GLOBAL_POSITION</code> MAVLink messages during missions. When a valid message is received, its validity flags, position and heading are mapped into the same <code>transponder_report</code> UORB topic used for <em>ADS-B traffic avoidance</em>.</p><p>The implementation is otherwise <em>exactly</em> as described in the section above.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p><a href="https://mavlink.io/en/messages/common.html#UTM_GLOBAL_POSITION" target="_blank" rel="noreferrer">UTM_GLOBAL_POSITION</a> contains additional fields that are not provided by an ADSB transponder (see <a href="https://mavlink.io/en/messages/common.html#ADSB_VEHICLE" target="_blank" rel="noreferrer">ADSB_VEHICLE</a>). Поточна реалізація просто відкидає додаткові поля (включаючи інформацію про заплановану наступну точку шляху транспортного засобу).</p></div><h2 id="тестування-симульовании-трафік-adsb" tabindex="-1">Тестування/Симульований трафік ADSB <a class="header-anchor" href="#тестування-симульовании-трафік-adsb" aria-label="Permalink to &quot;Тестування/Симульований трафік ADSB&quot;">​</a></h2><p>Ви можете симулювати трафік ADS-B для тестування. Note that this requires that you <a href="./../dev_setup/building_px4.html">Build PX4</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Simulated ADS-B traffic can trigger real failsafe actions. Використовуйте обережно в реальному польоті!</p></div><p>Щоб увімкнути цю функцію:</p><ol><li>Uncomment the code in <code>AdsbConflict::run_fake_traffic()</code>(<a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/lib/adsb/AdsbConflict.cpp#L342C1-L342C1" target="_blank" rel="noreferrer">AdsbConflict.cpp</a>).</li><li>Перебудувати та запустити PX4.</li><li>Execute the <a href="./../modules/modules_controller.html#navigator"><code>navigator fake_traffic</code> command</a> in the <a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/analyze_view/mavlink_console.html" target="_blank" rel="noreferrer">QGroundControl MAVLink Shell</a> (or some other <a href="./../debug/consoles.html">PX4 Console or MAVLink shell</a>, such as the PX4 simulator terminal).</li></ol><p>The code in <code>run_fake_traffic()</code> is then executed. Ви повинні бачити попередження ADS-B в консолі/оболонці MAVLink, і QGC також повинен показувати спливаюче вікно з даними про рух літаків ADS-B.</p><p>By default <code>run_fake_traffic()</code> publishes a number of traffic messages (it calls <a href="#fake-traffic-method"><code>AdsbConflict::fake_traffic()</code></a> to emit each report). Ці симулюють трафік ADS-B там, де може виникнути конфлікт, де конфлікту не буде, а також спамять буфер трафіку.</p><details class="details custom-block"><summary>Details</summary><p>Information about the test methods</p><p>The relevent methods are defined in <a href="https://github.com/PX4/PX4-Autopilot/blob/main/src/lib/adsb/AdsbConflict.cpp#L342C1-L342C1" target="_blank" rel="noreferrer">AdsbConflict.cpp</a>.</p><h4 id="run-fake-traffic-method" tabindex="-1"><code>run_fake_traffic()</code> method <a class="header-anchor" href="#run-fake-traffic-method" aria-label="Permalink to &quot;`run_fake_traffic()` method&quot;">​</a></h4><p>The <code>run_fake_traffic()</code> method is run when the <code>navigator fake_traffic</code> command is called.</p><p>The method calls the <code>fake_traffic()</code> method to generate simulated transponder messages around the current vehicle position. Воно проходить в поточному положенні транспортного засобу, інформація про симульований трафік, такий як виклик, відстані, напрямки, різниці в висоті, швидкості та типи емітерів.</p><p>The (commented out) code in <code>run_fake_traffic()</code> simulates a number of different scenarios, including conflicts and non-conflicts, as well as spamming the traffic buffer.</p><h4 id="fake-traffic-method" tabindex="-1"><code>fake_traffic()</code> method <a class="header-anchor" href="#fake-traffic-method" aria-label="Permalink to &quot;`fake_traffic()` method&quot;">​</a></h4><p><code>AdsbConflict::fake_traffic()</code> is called by the <a href="#run-fake-traffic-method"><code>run_fake_traffic()</code></a> to create individual ADS-B transponder reports.</p><p>Це приймає кілька параметрів, які вказують на характеристики фальшивого трафіку:</p><ul><li><code>callsign</code>: Callsign of the fake transponder.</li><li><code>distance</code>: Horizontal distance to the fake vehicle from the current vehicle.</li><li><code>direction</code>: Direction in NED from this vehicle to the fake in radians.</li><li><code>traffic_heading</code>: Travel direction of the traffic in NED in radians.</li><li><code>altitude_diff</code>: Altitude difference of the fake traffic. Позитив вгору.</li><li><code>hor_velocity</code>: Horizontal velocity of fake traffic, in m/s.</li><li><code>ver_velocity</code>: Vertical velocity of fake traffic, in m/s.</li><li><code>emitter_type</code>: Type of fake vehicle, as an enumerated value.</li><li><code>icao_address</code>: ICAO address.</li><li><code>lat_uav</code>: Lat of this vehicle (used to position fake traffic around vehicle)</li><li><code>on_uav</code>: Lon of this vehicle (used to position fake traffic around vehicle)</li><li><code>alt_uav</code>: Altitude of the vehicle (as reference - used to position fake traffic around vehicle)</li></ul><p>Метод створює симульоване повідомлення транспондера біля транспортного засобу, використовуючи наступні кроки:</p><ul><li>Обчислює широту та довготу трафіку на основі позиції БПЛА, відстані та напрямку.</li><li>Обчислює нову висоту, додавши різницю висоти до висоти БПЛА.</li><li>Populates a <a href="./../msg_docs/TransponderReport.html">TransponderReport</a> topic with the simulated traffic data.</li><li>If the board supports a Universally Unique Identifier (UUID), the method retrieves the UUID using <code>board_get_px4_guid</code> and copies it to the <code>uas_id</code> field of the structure. В іншому випадку воно генерує симульований GUID.</li><li>Publishes the simulated traffic message using <code>orb_publish</code>.</li></ul></details><h2 id="подальша-інформація" tabindex="-1">Подальша інформація <a class="header-anchor" href="#подальша-інформація" aria-label="Permalink to &quot;Подальша інформація&quot;">​</a></h2><ul><li><a href="./../peripherals/mavlink_peripherals.html">MAVLink Peripherals</a></li><li><a href="./../peripherals/serial_configuration.html">Serial Port Configuration</a></li></ul>',47)]))}const p=a(o,[["render",d]]);export{m as __pageData,p as default};
