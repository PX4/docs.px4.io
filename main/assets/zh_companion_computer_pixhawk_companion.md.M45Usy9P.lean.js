import{_ as s,c as a,a8 as t,o as e}from"./chunks/framework.BDnHobkS.js";const F=JSON.parse('{"title":"使用机载计算机与 Pixhawk 控制器","description":"","frontmatter":{},"headers":[],"relativePath":"zh/companion_computer/pixhawk_companion.md","filePath":"zh/companion_computer/pixhawk_companion.md"}'),n={name:"zh/companion_computer/pixhawk_companion.md"};function h(p,i,l,k,r,d){return e(),a("div",null,i[0]||(i[0]=[t(`<h1 id="使用机载计算机与-pixhawk-控制器" tabindex="-1">使用机载计算机与 Pixhawk 控制器 <a class="header-anchor" href="#使用机载计算机与-pixhawk-控制器" aria-label="Permalink to &quot;使用机载计算机与 Pixhawk 控制器&quot;">​</a></h1><p>PX4 running on Pixhawk-series flight controllers can connect to a companion computer using any free configurable serial port, including the Ethernet port (if supported).</p><p>See <a href="./../companion_computer/">Companion Computers</a> for information about supported hardware and general setup.</p><h2 id="机载计算机软件" tabindex="-1">机载计算机软件 <a class="header-anchor" href="#机载计算机软件" aria-label="Permalink to &quot;机载计算机软件&quot;">​</a></h2><p>机载计算机需要运行能与飞控通信的软件，并将消息路由到地面站和云端。</p><p>Common options are listed in <a href="./../companion_computer/#companion-computer-software">Companion Computers &gt; Companion Computer Setup</a>.</p><h2 id="以太网设置" tabindex="-1">以太网设置 <a class="header-anchor" href="#以太网设置" aria-label="Permalink to &quot;以太网设置&quot;">​</a></h2><p>以太网是推荐的连接方式，如果飞行控制器支持的话。 See <a href="./../advanced_config/ethernet_setup.html">Ethernet Setup</a> for instructions.</p><h2 id="serial-port-setup" tabindex="-1">Serial Port Setup <a class="header-anchor" href="#serial-port-setup" aria-label="Permalink to &quot;Serial Port Setup&quot;">​</a></h2><p>These instructions explain how to setup the connection if you&#39;re not using Ethernet.</p><h3 id="pixhawk-configuration" tabindex="-1">Pixhawk Configuration <a class="header-anchor" href="#pixhawk-configuration" aria-label="Permalink to &quot;Pixhawk Configuration&quot;">​</a></h3><p>PX4 expects companion computers to connect via <code>TELEM2</code> for offboard control. The port is configured by default to interface using MAVLink.</p><p>If using MAVLink, no other PX4-side configuration should be required. To use MAVLink on another port, and/or disable it on <code>TELEM2</code>, see <a href="./../peripherals/mavlink_peripherals.html">MAVLink Peripherals (GCS/OSD/Companion)</a> and <a href="./../peripherals/serial_configuration.html">Serial Port Configuration</a>.</p><p>To use <a href="./../ros2/user_guide.html">ROS 2/uXRCE-DDS</a> instead of MAVLink on <code>TELEM2</code>, disable MAVLink on the port and then enable the uXRCE-DDS client on <code>TELEM2</code>(see <a href="./../middleware/uxrce_dds.html#starting-the-client">uXRCE-DDS &gt; Starting the client</a>).</p><h3 id="serial-port-hardware-setup" tabindex="-1">Serial Port Hardware Setup <a class="header-anchor" href="#serial-port-hardware-setup" aria-label="Permalink to &quot;Serial Port Hardware Setup&quot;">​</a></h3><p>If you&#39;re connecting using a serial port, wire the port according to the instructions below. All Pixhawk serial ports operate at 3.3V and are 5V level compatible.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Many modern companion computers only support 1.8V levels on their hardware UART and can be damaged by 3.3V levels. Use a level shifter. In most cases the accessible hardware serial ports already have some function (modem or console) associated with them and need to be <em>reconfigured in Linux</em> before they can be used.</p></div><p>A safe and easy to set up option is to use an FTDI Chip USB-to-serial adapter board to connect from <code>TELEM2</code> on the Pixhawk to the USB port on the companion computer. The <code>TELEM2</code> to FTDI wiring map is shown below.</p><table tabindex="0"><thead><tr><th>TELEM2</th><th></th><th>FTDI</th><th>&amp;nbsp;</th></tr></thead><tbody><tr><td>1</td><td>+ 5v (红色)</td><td></td><td>DO NOT CONNECT!</td></tr><tr><td>2</td><td>2</td><td>5</td><td>5</td></tr><tr><td>3</td><td>3</td><td>4</td><td>4</td></tr><tr><td>4</td><td>CTS（输入）</td><td>6</td><td>6</td></tr><tr><td>5</td><td>RTS（输出）</td><td>2</td><td>2</td></tr><tr><td>6</td><td>GND</td><td>1</td><td>FTDI GND (黑色)</td></tr></tbody></table><p>You may also be able to directly connect <code>TELEM2</code> directly to a companion computer serial port. This is demonstrated for the Raspberry Pi in <a href="./../companion_computer/pixhawk_rpi.html">Raspberry Pi Companion with Pixhawk</a>.</p><h3 id="usb-serial-port-software-setup-on-linux" tabindex="-1">USB Serial Port Software setup on Linux <a class="header-anchor" href="#usb-serial-port-software-setup-on-linux" aria-label="Permalink to &quot;USB Serial Port Software setup on Linux&quot;">​</a></h3><p>On Linux the default name of a USB FTDI would be like <code>\\dev\\ttyUSB0</code>. If you have a second FTDI linked on the USB or an Arduino, it will registered as <code>\\dev\\ttyUSB1</code>. To avoid the confusion between the first plugged and the second plugged, we recommend you to create a symlink from <code>ttyUSBx</code> to a friendly name, depending on the Vendor and Product ID of the USB device.</p><p>Using <code>lsusb</code> we can get the vendor and product IDs.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$lsusb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    总线006</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 设备002：ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0BDA:8153</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Realtek</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 半导体公司</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 006</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 005</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 002:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05e3:0616</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Genesys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Logic,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Inc.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 004:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2341:0042</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Arduino</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mega</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2560</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> R3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (CDC </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ACM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 005:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 26ac:0011</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 002:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 05e3:0610</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Genesys</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Logic,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Inc.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4-port</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 003</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 002:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0bda:8176</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Realtek</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Semiconductor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Corp.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RTL8188CUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 802.11n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WLAN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Adapter</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Bus</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1d6b:0002</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Foundation</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hub</span></span></code></pre></div><p>The Arduino is <code>Bus 003 Device 004: ID 2341:0042 Arduino SA Mega 2560 R3 (CDC ACM)</code></p><p>The Pixhawk is <code>Bus 003 Device 005: ID 26ac:0011</code></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you do not find your device, unplug it, execute <code>lsusb</code>, plug it, execute <code>lsusb</code> again and see the added device.</p></div><p>Therefore, we can create a new UDEV rule in a file called <code>/etc/udev/rules.d/99-pixhawk.rules</code> with the following content, changing the idVendor and idProduct to yours.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SUBSYSTEM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=&quot;tty&quot;,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ATTRS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{idVendor}==</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;2341&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ATTRS{idProduct}==&quot;0042&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SYMLINK+=&quot;ttyArduino&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    SUBSYSTEM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=&quot;tty&quot;,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ATTRS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{idVendor}==</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;26ac&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ATTRS{idProduct}==&quot;0011&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SYMLINK+=&quot;ttyPixhawk&quot;</span></span></code></pre></div><p>Finally, after a <strong>reboot</strong> you can be sure to know which device is what and put <code>/dev/ttyPixhawk</code> instead of <code>/dev/ttyUSB0</code> in your scripts.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Be sure to add yourself in the <code>tty</code> and <code>dialout</code> groups via <code>usermod</code> to avoid to have to execute scripts as root.</p></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ros-user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dialout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ros-user</span></span></code></pre></div>`,32)]))}const c=s(n,[["render",h]]);export{F as __pageData,c as default};
