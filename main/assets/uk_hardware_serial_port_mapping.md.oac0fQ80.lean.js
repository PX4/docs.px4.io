import{_ as t,c as e,a8 as s,o as n}from"./chunks/framework.BDnHobkS.js";const u=JSON.parse('{"title":"Налаштування послідовного порту","description":"","frontmatter":{},"headers":[],"relativePath":"uk/hardware/serial_port_mapping.md","filePath":"uk/hardware/serial_port_mapping.md"}'),p={name:"uk/hardware/serial_port_mapping.md"};function o(i,a,l,r,d,c){return n(),e("div",null,a[0]||(a[0]=[s(`<h1 id="налаштування-послідовного-порту" tabindex="-1">Налаштування послідовного порту <a class="header-anchor" href="#налаштування-послідовного-порту" aria-label="Permalink to &quot;Налаштування послідовного порту&quot;">​</a></h1><p>This topic shows how to determine the mapping between USART/UART serial port device names (e.g. &quot;ttyS0&quot;) and the associated ports on a flight controller, such as <code>TELEM1</code>, <code>TELEM2</code>, <code>GPS1</code>, <code>RC SBUS</code>, <code>Debug console</code>.</p><p>Інструкції використовуються для генерації таблиць відповідності портів серійного зв&#39;язку у документації контролера польоту. For example: <a href="./../flight_controller/pixhawk4.html#serial-port-mapping">Pixhawk 4 &gt; Serial Port Mapping</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The function assigned to each port does not <em>have to</em> match the name (in most cases), and is set using a <a href="./../peripherals/serial_configuration.html">Serial Port Configuration</a>. Usually the port function is configured to match the name, which is why the port labelled <code>GPS1</code> will work with a GPS out of the box.</p></div><h2 id="nuttx-на-stmxxyyy" tabindex="-1">NuttX на STMxxyyy <a class="header-anchor" href="#nuttx-на-stmxxyyy" aria-label="Permalink to &quot;NuttX на STMxxyyy&quot;">​</a></h2><p>У цьому розділі показано, як отримати зіставлення для збірок NuttX на архітектурах STMxxyyy, перевіряючи файли конфігурації плати. Інструкції використовують FMUv5, але можуть бути аналогічно розширені для інших версій FMU або плат NuttX.</p><h3 id="default-px4board" tabindex="-1">default.px4board <a class="header-anchor" href="#default-px4board" aria-label="Permalink to &quot;default.px4board&quot;">​</a></h3><p>The <strong>default.px4board</strong> lists a number of serial port mappings (search for the text &quot;SERIAL_PORTS&quot;).</p><p>From <a href="https://github.com/PX4/PX4-Autopilot/blob/main/boards/px4/fmu-v5/default.px4board" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/default.px4board</a>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CONFIG_BOARD_SERIAL_GPS1=&quot;/dev/ttyS0&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL1=&quot;/dev/ttyS1&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL2=&quot;/dev/ttyS2&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL4=&quot;/dev/ttyS3&quot;</span></span></code></pre></div><p>Alternatively you can launch boardconfig using <code>make px4_fmu-v5 boardconfig</code> and access the serial port menu</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>    Serial ports  ---&gt;</span></span>
<span class="line"><span>        (/dev/ttyS0) GPS1 tty port</span></span>
<span class="line"><span>        ()  GPS2 tty port</span></span>
<span class="line"><span>        ()  GPS3 tty port</span></span>
<span class="line"><span>        ()  GPS4 tty port</span></span>
<span class="line"><span>        ()  GPS5 tty port</span></span>
<span class="line"><span>        (/dev/ttyS1) TEL1 tty port</span></span>
<span class="line"><span>        (/dev/ttyS2) TEL2 tty port</span></span>
<span class="line"><span>        ()  TEL3 tty port</span></span>
<span class="line"><span>        (/dev/ttyS3) TEL4 tty port</span></span>
<span class="line"><span>        ()  TEL5 tty port</span></span></code></pre></div><h3 id="nsh-defconfig" tabindex="-1">nsh/defconfig <a class="header-anchor" href="#nsh-defconfig" aria-label="Permalink to &quot;nsh/defconfig&quot;">​</a></h3><p>The <em>nsh/defconfig</em> allows you to determine which ports are defined, whether they are UART or USARTs, and the mapping between USART/UART and device. You can also determine which port is used for the <a href="./../debug/system_console.html">serial/debug console</a>.</p><p>Open the board&#39;s defconfig file, for example: <a href="https://github.com/PX4/PX4-Autopilot/blob/main/boards/px4/fmu-v5/nuttx-config/nsh/defconfig#L215-L221" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/nuttx-config/nsh/defconfig</a></p><p>Search for the text &quot;ART&quot; until you find a section like with entries formatted like <code>CONFIG_STM32xx_USARTn=y</code> (where <code>xx</code> is a processor type and <code>n</code> is a port number). Наприклад:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CONFIG_STM32F7_UART4=y</span></span>
<span class="line"><span>CONFIG_STM32F7_UART7=y</span></span>
<span class="line"><span>CONFIG_STM32F7_UART8=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART1=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART2=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART3=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART6=y</span></span></code></pre></div><p>Записи показують, які порти визначено, і чи вони є UART або USART.</p><p>Скопіюйте вищенаведений розділ і перегрупуйте його числово за &quot;n&quot;. Increment the device number <em>ttyS<strong>n</strong></em> alongside (zero based) to get the device-to-serial-port mapping.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ttyS0 CONFIG_STM32F7_USART1=y</span></span>
<span class="line"><span>ttyS1 CONFIG_STM32F7_USART2=y</span></span>
<span class="line"><span>ttyS2 CONFIG_STM32F7_USART3=y</span></span>
<span class="line"><span>ttyS3 CONFIG_STM32F7_UART4=y</span></span>
<span class="line"><span>ttyS4 CONFIG_STM32F7_USART6=y</span></span>
<span class="line"><span>ttyS5 CONFIG_STM32F7_UART7=y</span></span>
<span class="line"><span>ttyS6 CONFIG_STM32F7_UART8=y</span></span></code></pre></div><p>To get the DEBUG console mapping we search the <a href="https://github.com/PX4/PX4-Autopilot/blob/main/boards/px4/fmu-v5/nuttx-config/nsh/defconfig#L212" target="_blank" rel="noreferrer">defconfig file</a> for <code>SERIAL_CONSOLE</code>. Нижче ми бачимо, що консоль знаходиться на UART7:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CONFIG_UART7_SERIAL_CONSOLE=y</span></span></code></pre></div><h3 id="board-config-h" tabindex="-1">board_config.h <a class="header-anchor" href="#board-config-h" aria-label="Permalink to &quot;board_config.h&quot;">​</a></h3><p>For flight controllers that have an IO board, determine the PX4IO connection from <strong>board_config.h</strong> by searching for <code>PX4IO_SERIAL_DEVICE</code>.</p><p>For example, <a href="https://github.com/PX4/PX4-Autopilot/blob/main/boards/px4/fmu-v5/src/board_config.h#L59" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/src/board_config.h</a>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#define PX4IO_SERIAL_DEVICE            &quot;/dev/ttyS6&quot;</span></span>
<span class="line"><span>#define PX4IO_SERIAL_TX_GPIO           GPIO_UART8_TX</span></span>
<span class="line"><span>#define PX4IO_SERIAL_RX_GPIO           GPIO_UART8_RX</span></span>
<span class="line"><span>#define PX4IO_SERIAL_BASE              STM32_UART8_BASE</span></span></code></pre></div><p>So the PX4IO is on <code>ttyS6</code> (we can also see that this maps to UART8, which we already knew from the preceding section).</p><h3 id="підсумовуючи-все-це-разом" tabindex="-1">Підсумовуючи все це разом, <a class="header-anchor" href="#підсумовуючи-все-це-разом" aria-label="Permalink to &quot;Підсумовуючи все це разом,&quot;">​</a></h3><p>Остаточне відображення таке:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ttyS0 CONFIG_STM32F7_USART1=y GPS1</span></span>
<span class="line"><span>ttyS1 CONFIG_STM32F7_USART2=y TEL1</span></span>
<span class="line"><span>ttyS2 CONFIG_STM32F7_USART3=y TEL2</span></span>
<span class="line"><span>ttyS3 CONFIG_STM32F7_UART4=y TEL4</span></span>
<span class="line"><span>ttyS4 CONFIG_STM32F7_USART6=y</span></span>
<span class="line"><span>ttyS5 CONFIG_STM32F7_UART7=y DEBUG</span></span>
<span class="line"><span>ttyS6 CONFIG_STM32F7_UART8=y PX4IO</span></span></code></pre></div><p>In the <a href="./../flight_controller/pixhawk4.html#serial-port-mapping">flight controller docs</a> the resulting table is:</p><table tabindex="0"><thead><tr><th>UART</th><th>Пристрій</th><th>Порт</th></tr></thead><tbody><tr><td>UART1</td><td>/dev/ttyS0</td><td>GPS</td></tr><tr><td>USART2</td><td>/dev/ttyS1</td><td>TELEM1 (керування потоком)</td></tr><tr><td>USART3</td><td>/dev/ttyS2</td><td>TELEM2 (керування потоком)</td></tr><tr><td>UART4</td><td>/dev/ttyS3</td><td>TELEM4</td></tr><tr><td>USART6</td><td>/dev/ttyS4</td><td>RC SBUS</td></tr><tr><td>UART7</td><td>/dev/ttyS5</td><td>Debug Console</td></tr><tr><td>UART8</td><td>/dev/ttyS6</td><td>PX4IO</td></tr></tbody></table><h2 id="інші-архітектури" tabindex="-1">Інші архітектури <a class="header-anchor" href="#інші-архітектури" aria-label="Permalink to &quot;Інші архітектури&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Contributions welcome!</p></div><h2 id="дивіться-також" tabindex="-1">Дивіться також <a class="header-anchor" href="#дивіться-також" aria-label="Permalink to &quot;Дивіться також&quot;">​</a></h2><ul><li><a href="./../peripherals/serial_configuration.html">Serial Port Configuration</a></li><li><a href="./../peripherals/mavlink_peripherals.html">MAVLink Telemetry (OSD/GCS)</a></li></ul>`,36)]))}const S=t(p,[["render",o]]);export{u as __pageData,S as default};
