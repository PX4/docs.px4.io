import{_ as a,c as i,a8 as e,o as t}from"./chunks/framework.BDnHobkS.js";const g=JSON.parse('{"title":"Формат файлу ULog","description":"","frontmatter":{},"headers":[],"relativePath":"uk/dev_log/ulog_file_format.md","filePath":"uk/dev_log/ulog_file_format.md"}'),n={name:"uk/dev_log/ulog_file_format.md"};function l(h,s,d,r,p,o){return t(),i("div",null,s[0]||(s[0]=[e(`<h1 id="формат-фаилу-ulog" tabindex="-1">Формат файлу ULog <a class="header-anchor" href="#формат-фаилу-ulog" aria-label="Permalink to &quot;Формат файлу ULog&quot;">​</a></h1><p>ULog - це формат файлу, що використовується для логування повідомлень. The format is self-describing, i.e. it contains the format and <a href="./../middleware/uorb.html">uORB</a> message types that are logged. Цей документ призначений для документації специфікації формату файлу ULog. Це призначено особливо для тих, хто зацікавлений у написанні розбірника / серіалізатора ULog та потребує розкодувати / закодувати файли.</p><p>PX4 використовує ULog для ведення журналу тем uORB як повідомлення, пов&#39;язані з (але не обмежені) наступними джерелами:</p><ul><li><strong>Device inputs:</strong> Sensors, RC input, etc.</li><li><strong>Internal states:</strong> CPU load, attitude, EKF state, etc.</li><li><strong>String messages:</strong> <code>printf</code> statements, including <code>PX4_INFO()</code> and <code>PX4_ERR()</code>.</li></ul><p>The format uses <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noreferrer">little endian</a> memory layout for all binary types (the least significant byte (LSB) of data type is placed at the lowest memory address).</p><h2 id="типи-даних" tabindex="-1">Типи даних <a class="header-anchor" href="#типи-даних" aria-label="Permalink to &quot;Типи даних&quot;">​</a></h2><p>Для ведення журналу використовуються наступні типи двійкових даних. Вони всі відповідають типам у мові програмування C.</p><table tabindex="0"><thead><tr><th>Тип</th><th>Розмір у байтах</th></tr></thead><tbody><tr><td>int8_t, uint8_t</td><td>1</td></tr><tr><td>int16_t, uint16_t</td><td>2</td></tr><tr><td>int32_t, uint32_t</td><td>4</td></tr><tr><td>int64_t, uint64_t</td><td>8</td></tr><tr><td>float</td><td>4</td></tr><tr><td>double</td><td>8</td></tr><tr><td>bool, char</td><td>1</td></tr></tbody></table><p>Additionally the types can be used as a fixed-size array: e.g. <code>float[5]</code>.</p><p>Strings (<code>char[length]</code>) do not contain the termination NULL character <code>&#39;\\0&#39;</code> at the end.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>String comparisons are case sensitive, which should be taken into account when comparing message names when <a href="#a-subscription-message">adding subscriptions</a>.</p></div><h2 id="структура-фаилу-ulog" tabindex="-1">Структура файлу ULog <a class="header-anchor" href="#структура-фаилу-ulog" aria-label="Permalink to &quot;Структура файлу ULog&quot;">​</a></h2><p>Файли ULog мають наступні три розділи:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>----------------------</span></span>
<span class="line"><span>|       Header       |</span></span>
<span class="line"><span>----------------------</span></span>
<span class="line"><span>|    Definitions     |</span></span>
<span class="line"><span>----------------------</span></span>
<span class="line"><span>|        Data        |</span></span>
<span class="line"><span>----------------------</span></span></code></pre></div><p>Опис кожного розділу наведено нижче.</p><h3 id="розділ-заголовка" tabindex="-1">Розділ заголовка <a class="header-anchor" href="#розділ-заголовка" aria-label="Permalink to &quot;Розділ заголовка&quot;">​</a></h3><p>Заголовок є розділом фіксованого розміру та має наступний формат (16 байт):</p><div class="language-plain vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>----------------------------------------------------------------------</span></span>
<span class="line"><span>| 0x55 0x4c 0x6f 0x67 0x01 0x12 0x35 | 0x01         | uint64_t       |</span></span>
<span class="line"><span>| File magic (7B)                    | Version (1B) | Timestamp (8B) |</span></span>
<span class="line"><span>----------------------------------------------------------------------</span></span></code></pre></div><ul><li><strong>File Magic (7 Bytes):</strong> File type indicator that reads &quot;ULogXYZ where XYZ is the magic bytes sequence <code>0x01 0x12 0x35</code>&quot;</li><li><strong>Version (1 Byte):</strong> File format version (currently 1)</li><li><strong>Timestamp (8 Bytes):</strong> <code>uint64_t</code> integer that denotes when the logging started in microseconds.</li></ul><h3 id="definition-data-section-message-header" tabindex="-1">Definition &amp; Data Section Message Header <a class="header-anchor" href="#definition-data-section-message-header" aria-label="Permalink to &quot;Definition &amp; Data Section Message Header&quot;">​</a></h3><p>The <em>Definitions and Data</em> sections contain a number of <strong>messages</strong>. Кожне повідомлення передує цим заголовком:</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_size;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_type;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>msg_size</code> is the size of the message in bytes without the header.</li><li><code>msg_type</code> defines the content, and is a single byte.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Message sections below are prefixed with the character that corresponds to it&#39;s <code>msg_type</code>.</p></div><h3 id="розділ-визначень" tabindex="-1">Розділ визначень <a class="header-anchor" href="#розділ-визначень" aria-label="Permalink to &quot;Розділ визначень&quot;">​</a></h3><p>Розділ визначень містить основну інформацію, таку як версія програмного забезпечення, формат повідомлення, початкові значення параметрів тощо.</p><p>Основні типи повідомлень в цьому розділі є:</p><ol><li><a href="#b-flag-bits-message">Flag Bits</a></li><li><a href="#f-format-message">Format Definition</a></li><li><a href="#i-information-message">Information</a></li><li><a href="#m-multi-information-message">Multi Information</a></li><li><a href="#p-parameter-message">Parameter</a></li><li><a href="#q-default-parameter-message">Default Parameter</a></li></ol><h4 id="b-повідомлення-флагів-бітів" tabindex="-1">&#39;B&#39;: Повідомлення флагів бітів <a class="header-anchor" href="#b-повідомлення-флагів-бітів" aria-label="Permalink to &quot;&#39;B&#39;: Повідомлення флагів бітів&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This message must be the <strong>first message</strong> right after the header section, so that it has a fixed constant offset from the start of the file!</p></div><p>Це повідомлення надає інформацію лог-аналізатору про те, чи можна аналізувати журнал.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_flag_bits_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;B&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> compat_flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> incompat_flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> appended_offsets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // file offset(s) for appended data if appending bit is set</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><p><code>compat_flags</code>: compatible flag bits</p><ul><li>Ці прапорці вказують на наявність функцій у файлі журналу, які сумісні з будь-яким парсером ULog.</li><li><code>compat_flags[0]</code>: <em>DEFAULT_PARAMETERS</em> (Bit 0): if set, the log contains <a href="#q-default-parameter-message">default parameters message</a></li></ul><p>Решта бітів наразі не визначені і повинні бути встановлені на 0. Ці біти можуть бути використані для майбутніх змін ULog, які сумісні з існуючими парсерами. Наприклад, додавання нового типу повідомлення може бути вказане шляхом визначення нового біта у стандарті, а існуючі парсери ігноруватимуть новий тип повідомлення. Це означає, що парсери можуть просто ігнорувати біти, якщо один з невідомих бітів встановлений.</p></li><li><p><code>incompat_flags</code>: incompatible flag bits.</p><ul><li><code>incompat_flags[0]</code>: <em>DATA_APPENDED</em> (Bit 0): if set, the log contains appended data and at least one of the <code>appended_offsets</code> is non-zero.</li></ul><p>Решта бітів наразі не визначені і повинні бути встановлені на 0. Це може бути використано для введення руйнівних змін, які існуючі парсери не можуть обробити. For example, when an old ULog parser that didn&#39;t have the concept of <em>DATA_APPENDED</em> reads the newer ULog, it would stop parsing the log as the log will contain out-of-spec messages / concepts. Якщо парсер виявляє, що будь-який з цих бітів встановлений, що не вказано, він повинен відмовитися від аналізу журналу.</p></li><li><p><code>appended_offsets</code>: File offset (0-based) for appended data. Якщо даних не додається, всі зміщення повинні бути нульовими. Це може бути використано для надійного додавання даних до журналів, які можуть припинитись посеред повідомлення. Наприклад, дампи збоїв.</p><p>Процес додавання даних повинен виконати:</p><ul><li>set the relevant <code>incompat_flags</code> bit</li><li>set the first <code>appended_offsets</code> that is currently 0 to the length of the log file without the appended data, as that is where the new data will start</li><li>додайте будь-який тип повідомлень, які є дійсними для розділу Дані.</li></ul></li></ul><p>Можливо, що у майбутніх специфікаціях ULog буде додано ще декілька полів в кінці цього повідомлення. Це означає, що парсер не повинен припускати фіксовану довжину цього повідомлення. If the <code>msg_size</code> is bigger than expected (currently 40), any additional bytes must be ignored/discarded.</p><h4 id="f-формат-повідомлення" tabindex="-1">&#39;F&#39;: Формат повідомлення <a class="header-anchor" href="#f-формат-повідомлення" aria-label="Permalink to &quot;&#39;F&#39;: Формат повідомлення&quot;">​</a></h4><p>Формат повідомлення визначає одне ім&#39;я повідомлення та його внутрішні поля в одному рядку.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_format_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;F&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>format</code> is a plain-text string with the following format: <code>message_name:field0;field1;</code><ul><li>There can be an arbitrary amount of fields (minimum 1), separated by <code>;</code>.</li><li><code>message_name</code>: an arbitrary non-empty string with these allowed characters: <code>a-zA-Z0-9_-/</code> (and different from any of the <a href="#data-types">basic types</a>).</li></ul></li></ul><p>A <code>field</code> has the format: <code>type field_name</code>, or for an array: <code>type[array_length] field_name</code> is used (only fixed size arrays are supported). <code>field_name</code> must consist of the characters in the set <code>a-zA-Z0-9_</code>.</p><p>A <code>type</code> is one of the <a href="#data-types">basic binary types</a> or a <code>message_name</code> of another format definition (nested usage).</p><ul><li>Тип може бути використаний до того, як він буде визначений. <ul><li>e.g. The message <code>MessageA:MessageB[2] msg_b</code> can come before the <code>MessageB:uint_8[3] data</code></li></ul></li><li>There can be arbitrary nesting but <strong>no circular dependencies</strong><ul><li>e.g. <code>MessageA:MessageB[2] msg_b</code> &amp; <code>MessageB:MessageA[4] msg_a</code></li></ul></li></ul><p>Деякі назви полів є спеціальними:</p><ul><li><code>timestamp</code>: every message format with a <a href="#a-subscription-message">Subscription Message</a> must include a timestamp field (for example a message format only used as part of a nested definition by another format may not include a timestamp field) <ul><li>Its type must be <code>uint64_t</code>.</li><li>Одиниця вимірювання - мікросекунди.</li><li>The timestamp must always be monotonic increasing for a message series with the same <code>msg_id</code> (same subscription).</li></ul></li><li><code>_padding{}</code>: field names that start with <code>_padding</code> (e.g. <code>_padding[3]</code>) should not be displayed and their data must be ignored by a reader. <ul><li>Ці поля можуть бути вставлені письменником для забезпечення правильного вирівнювання.</li><li>Якщо поле відступу є останнім полем, тоді це поле може не бути зареєстроване, щоб уникнути запису непотрібних даних.</li><li>This means the <code>message_data_s.data</code> will be shorter by the size of the padding.</li><li>Однак відступ все ще потрібен, коли повідомлення використовується во вкладеному визначенні.</li></ul></li><li>Загалом, поля повідомлень не обов&#39;язково вирівняні (тобто зсув поля всередині повідомлення не обов&#39;язково є кратним його розміру даних), тому читач завжди повинен використовувати відповідні методи копіювання пам&#39;яті для доступу до окремих полів.</li></ul><h4 id="i-інформаціине-повідомлення" tabindex="-1">&#39;I&#39;: Інформаційне повідомлення <a class="header-anchor" href="#i-інформаціине-повідомлення" aria-label="Permalink to &quot;&#39;I&#39;: Інформаційне повідомлення&quot;">​</a></h4><p>The Information message defines a dictionary type definition <code>key</code> : <code>value</code> pair for any information, including but not limited to Hardware version, Software version, Build toolchain for the software, etc.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_info_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;I&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>key_len</code>: Length of the key value</li><li><code>key</code>: Contains the key string in the form<code>type name</code>, e.g. <code>char[value_len] sys_toolchain_ver</code>. Valid characters for the name: <code>a-zA-Z0-9_-/</code>. The type may be one of the <a href="#data-types">basic types including arrays</a>.</li><li><code>value</code>: Contains the data (with the length <code>value_len</code>) corresponding to the <code>key</code> e.g. <code>9.4.0</code>.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>A key defined in the Information message must be unique. Означає, що не повинно бути більше одного визначення з таким самим ключовим значенням.</p></div><p>Парсери можуть зберігати інформаційні повідомлення у вигляді словника.</p><p>Попередньо визначені інформаційні повідомлення:</p><table tabindex="0"><thead><tr><th>key</th><th>Опис</th><th>Приклад для значення</th></tr></thead><tbody><tr><td><code>char[value_len] sys_name</code></td><td>Назва системи</td><td>&quot;PX4&quot;</td></tr><tr><td><code>char[value_len] ver_hw</code></td><td>Версія апаратного забезпечення (плата)</td><td>&quot;PX4FMU_V4&quot;</td></tr><tr><td><code>char[value_len] ver_hw_subtype</code></td><td>Підстава плати (варіація)</td><td>&quot;V2&quot;</td></tr><tr><td><code>char[value_len] ver_sw</code></td><td>Версія програмного забезпечення (git tag)</td><td>&quot;7f65e01&quot;</td></tr><tr><td><code>char[value_len] ver_sw_branch</code></td><td>git branch</td><td>&quot;master&quot;</td></tr><tr><td><code>uint32_t ver_sw_release</code></td><td>Версія програмного забезпечення (див. нижче)</td><td>0x010401ff</td></tr><tr><td><code>char[value_len] sys_os_name</code></td><td>Назва операційної системи</td><td>&quot;Linux&quot;</td></tr><tr><td><code>char[value_len] sys_os_ve</code>r</td><td>Версія ОС (git tag)</td><td>&quot;9f82919&quot;</td></tr><tr><td><code>uint32_t ver_os_release</code></td><td>Версія ОС (див. нижче)</td><td>0x010401ff</td></tr><tr><td><code>char[value_len] sys_toolchain</code></td><td>Назва набору інструментів</td><td>&quot;GNU GCC&quot;</td></tr><tr><td><code>char[value_len] sys_toolchain_ver</code></td><td>Версія інструментального набору</td><td>&quot;6.2.1&quot;</td></tr><tr><td><code>char[value_len] sys_mcu</code></td><td>Назва мікросхеми та ревізія</td><td>&quot;STM32F42x, rev A&quot;</td></tr><tr><td><code>char[value_len] sys_uuid</code></td><td>Унікальний ідентифікатор для транспортного засобу (наприклад, ідентифікатор MCU)</td><td>&quot;392a93e32fa3&quot;...</td></tr><tr><td><code>char[value_len] log_type</code></td><td>Тип журналу (повний журнал, якщо не вказано)</td><td>&quot;mission&quot;</td></tr><tr><td><code>char[value_len] replay</code></td><td>Ім&#39;я файлу відтвореного журналу, якщо в режимі відтворення</td><td>&quot;log001.ulg&quot;</td></tr><tr><td><code>int32_t time_ref_utc</code></td><td>Зсув часу UTC в секундах</td><td>-3600</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title">INFO</p><p><code>value_len</code> represents the data size of the <code>value</code>. This is described in the <code>key</code>.</p></div><ul><li>The format of <code>ver_sw_release</code> and <code>ver_os_release</code> is: 0xAABBCCTT, where AA is <strong>major</strong>, BB is <strong>minor</strong>, CC is patch and TT is the <strong>type</strong>. <ul><li><strong>Type</strong> is defined as following: <code>&gt;= 0</code>: development, <code>&gt;= 64</code>: alpha version, <code>&gt;= 128</code>: beta version, <code>&gt;= 192</code>: RC version, <code>== 255</code>: release version.</li><li>For example, <code>0x010402FF</code> translates into the release version v1.4.2.</li></ul></li></ul><p>Це повідомлення також може бути використано в розділі Дані (це, однак, переважний розділ).</p><h4 id="m-багатоінформаціине-повідомлення" tabindex="-1">&#39;M&#39;: Багатоінформаційне повідомлення <a class="header-anchor" href="#m-багатоінформаціине-повідомлення" aria-label="Permalink to &quot;&#39;M&#39;: Багатоінформаційне повідомлення&quot;">​</a></h4><p>Повідомлення з багатою інформацією слугує такій же меті, як і повідомлення інформації, але для довгих повідомлень або кількох повідомлень з одним і тим же ключем.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_info_multiple_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;M&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_continued;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // can be used for arrays</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>is_continued</code> can be used for split-up messages: if set to 1, it is part of the previous message with the same key.</li></ul><p>Парсери можуть зберігати всю інформацію про багато повідомлень у вигляді 2D-списку, використовуючи той самий порядок, що й повідомлення в лог-файлі.</p><p>Дійсні імена та типи такі ж, як для повідомлення Інформація.</p><h4 id="p-повідомлення-параметра" tabindex="-1">&#39;P&#39;: Повідомлення параметра <a class="header-anchor" href="#p-повідомлення-параметра" aria-label="Permalink to &quot;&#39;P&#39;: Повідомлення параметра&quot;">​</a></h4><p>Parameter message in the <em>Definitions</em> section defines the parameter values of the vehicle when logging is started. It uses the same format as the <a href="#i-information-message">Information Message</a>.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_info_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;P&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>If a parameter dynamically changes during runtime, this message can also be <a href="#messages-shared-with-the-definitions-section">used in the Data section</a> as well.</p><p>The data type is restricted to <code>int32_t</code> and <code>float</code>. Valid characters for the name: <code>a-zA-Z0-9_-/</code>.</p><h4 id="q-параметр-повідомлення-за-замовчуванням" tabindex="-1">&#39;Q&#39;: Параметр повідомлення за замовчуванням <a class="header-anchor" href="#q-параметр-повідомлення-за-замовчуванням" aria-label="Permalink to &quot;&#39;Q&#39;: Параметр повідомлення за замовчуванням&quot;">​</a></h4><p>Повідомлення параметра за замовчуванням визначає значення параметра для вказаного транспортного засобу та налаштувань.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_parameter_default_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;Q&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> default_types;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>default_types</code> is a bitfield and defines to which group(s) the value belongs to. <ul><li>Принаймні один біт повинен бути встановлений: <ul><li><code>1&lt;&lt;0</code>: system wide default</li><li><code>1&lt;&lt;1</code>: default for the current configuration (e.g. an airframe)</li></ul></li></ul></li></ul><p>Журнал не може містити значень за замовчуванням для всіх параметрів. У цих випадках значення за замовчуванням дорівнює значенню параметра, а різні типи за замовчуванням розглядаються незалежно один від одного.</p><p>Це повідомлення також може бути використане в розділі Дані, і застосовується той самий тип даних та найменування, як і для повідомлення Параметр.</p><p>This section ends before the start of the first <a href="#a-subscription-message">Subscription Message</a> or <a href="#l-logged-string-message">Logging</a> message, whichever comes first.</p><h3 id="розділ-даних" tabindex="-1">Розділ даних <a class="header-anchor" href="#розділ-даних" aria-label="Permalink to &quot;Розділ даних&quot;">​</a></h3><p>The message types in the <em>Data</em> section are:</p><ol><li><a href="#a-subscription-message">Subscription</a></li><li><a href="#r-unsubscription-message">Unsubscription</a></li><li><a href="#d-logged-data-message">Logged Data</a></li><li><a href="#l-logged-string-message">Logged String</a></li><li><a href="#c-tagged-logged-string-message">Tagged Logged String</a></li><li><a href="#s-synchronization-message">Synchronization</a></li><li><a href="#o-dropout-message">Dropout Mark</a></li><li><a href="#i-information-message">Information</a></li><li><a href="#m-multi-information-message">Multi Information</a></li><li><a href="#p-parameter-message">Parameter</a></li><li><a href="#q-default-parameter-message">Default Parameter</a></li></ol><h4 id="a-subscription-message" tabindex="-1"><code>A</code>: Subscription Message <a class="header-anchor" href="#a-subscription-message" aria-label="Permalink to &quot;\`A\`: Subscription Message&quot;">​</a></h4><p>Subscribe a message by name and give it an id that is used in <a href="#d-logged-data-message">Logged data Message</a>. This must come before the first corresponding <a href="#d-logged-data-message">Logged data Message</a>.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_add_logged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;A&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> multi_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>multi_id</code>: the same message format can have multiple instances, for example if the system has two sensors of the same type. Стандартне та перше значення повинно бути 0.</li><li><code>msg_id</code>: unique id to match <a href="#d-logged-data-message">Logged data Message</a> data. Перше використання повинно встановити це на 0, а потім збільшувати його. <ul><li>The same <code>msg_id</code> must not be used twice for different subscriptions.</li></ul></li><li><code>message_name</code>: message name to subscribe to. Must match one of the <a href="#f-format-message">Format Message</a> definitions.</li></ul><h4 id="r-unsubscription-message" tabindex="-1"><code>R</code>: Unsubscription Message <a class="header-anchor" href="#r-unsubscription-message" aria-label="Permalink to &quot;\`R\`: Unsubscription Message&quot;">​</a></h4><p>Відмовитися від повідомлення, щоб позначити, що воно більше не буде реєструватися (зараз не використовується).</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_remove_logged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;R&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="d-повідомлення-про-зареєстровані-дані" tabindex="-1">&#39;D&#39;: Повідомлення про зареєстровані дані <a class="header-anchor" href="#d-повідомлення-про-зареєстровані-дані" aria-label="Permalink to &quot;&#39;D&#39;: Повідомлення про зареєстровані дані&quot;">​</a></h4><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_data_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;D&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>msg_id</code>: as defined by a <a href="#a-subscription-message">Subscription Message</a></li><li><code>data</code> contains the logged binary message as defined by <a href="#f-format-message">Format Message</a></li></ul><p>Див. вище для спеціальної обробки полів відступу.</p><h4 id="l-повідомлення-про-зареєстровании-рядок" tabindex="-1">&#39;L&#39;: Повідомлення про зареєстрований рядок <a class="header-anchor" href="#l-повідомлення-про-зареєстровании-рядок" aria-label="Permalink to &quot;&#39;L&#39;: Повідомлення про зареєстрований рядок&quot;">​</a></h4><p>Logged string message, i.e. <code>printf()</code> output.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_logging_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;L&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> log_level;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>timestamp</code>: in microseconds</li><li><code>log_level</code>: same as in the Linux kernel:</li></ul><table tabindex="0"><thead><tr><th>Назва</th><th>Значення рівня</th><th>Значення</th></tr></thead><tbody><tr><td>EMERG</td><td>&#39;0&#39;</td><td>Система непридатна до використання</td></tr><tr><td>ALERT</td><td>&#39;1&#39;</td><td>Дії повинні бути вжиті негайно</td></tr><tr><td>CRIT</td><td>&#39;2&#39;</td><td>Критичні умови</td></tr><tr><td>ERR</td><td>&#39;3&#39;</td><td>Умови помилки</td></tr><tr><td>WARNING</td><td>&#39;4&#39;</td><td>Умови попередження</td></tr><tr><td>NOTICE</td><td>&#39;5&#39;</td><td>Нормальний, але значущий стан</td></tr><tr><td>INFO</td><td>&#39;6&#39;</td><td>Інформаційний</td></tr><tr><td>DEBUG</td><td>&#39;7&#39;</td><td>Повідомлення рівня налагодження</td></tr></tbody></table><h4 id="c-позначене-зареєстроване-рядкове-повідомлення" tabindex="-1">&#39;C&#39;: позначене зареєстроване рядкове повідомлення <a class="header-anchor" href="#c-позначене-зареєстроване-рядкове-повідомлення" aria-label="Permalink to &quot;&#39;C&#39;: позначене зареєстроване рядкове повідомлення&quot;">​</a></h4><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_logging_tagged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;C&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> log_level;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tag;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><p><code>tag</code>: id representing source of logged message string. Це може представляти процес, потік або клас в залежності від архітектури системи.</p><ul><li>For example, a reference implementation for an onboard computer running multiple processes to control different payloads, external disks, serial devices etc can encode these process identifiers using a <code>uint16_t enum</code> into the <code>tag</code> attribute of struct as follows:</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> class ulog_tag : </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  unassigned,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mavlink_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ppk_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  camera_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ptp_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  serial_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  watchdog,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  io_service,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cbuf,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ulg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li><li><p><code>timestamp</code>: in microseconds</p></li><li><p><code>log_level</code>: same as in the Linux kernel:</p></li></ul><table tabindex="0"><thead><tr><th>Назва</th><th>Значення рівня</th><th>Значення</th></tr></thead><tbody><tr><td>EMERG</td><td>&#39;0&#39;</td><td>Система непридатна до використання</td></tr><tr><td>ALERT</td><td>&#39;1&#39;</td><td>Дії повинні бути вжиті негайно</td></tr><tr><td>CRIT</td><td>&#39;2&#39;</td><td>Критичні умови</td></tr><tr><td>ERR</td><td>&#39;3&#39;</td><td>Умови помилки</td></tr><tr><td>WARNING</td><td>&#39;4&#39;</td><td>Умови попередження</td></tr><tr><td>NOTICE</td><td>&#39;5&#39;</td><td>Нормальний, але значущий стан</td></tr><tr><td>INFO</td><td>&#39;6&#39;</td><td>Інформаційний</td></tr><tr><td>DEBUG</td><td>&#39;7&#39;</td><td>Повідомлення рівня налагодження</td></tr></tbody></table><h4 id="s-повідомлення-синхронізаціі" tabindex="-1">&#39;S&#39;: Повідомлення синхронізації <a class="header-anchor" href="#s-повідомлення-синхронізаціі" aria-label="Permalink to &quot;&#39;S&#39;: Повідомлення синхронізації&quot;">​</a></h4><p>Повідомлення синхронізації, щоб читач міг відновитися від пошкодженого повідомлення, шукаючи наступне повідомлення синхронізації.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_sync_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;S&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sync_magic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>sync_magic</code>: [0x2F, 0x73, 0x13, 0x20, 0x25, 0x0C, 0xBB, 0x12]</li></ul><h4 id="o-повідомлення-про-відключення" tabindex="-1">&#39;O&#39;: Повідомлення про відключення <a class="header-anchor" href="#o-повідомлення-про-відключення" aria-label="Permalink to &quot;&#39;O&#39;: Повідомлення про відключення&quot;">​</a></h4><p>Позначте відсутність (втрачені повідомлення журналювання) заданої тривалості в мс.</p><p>Відключення можуть виникати, наприклад, якщо пристрій не є достатньо швидким.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_dropout_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;O&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> duration;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="повідомлення-розділені-розділом-визначень" tabindex="-1">Повідомлення, розділені розділом визначень <a class="header-anchor" href="#повідомлення-розділені-розділом-визначень" aria-label="Permalink to &quot;Повідомлення, розділені розділом визначень&quot;">​</a></h4><p>Оскільки Розділи Визначень та Дані використовують той же формат заголовка повідомлення, вони також діляться тими ж повідомленнями, які перераховані нижче:</p><ul><li><a href="#i-information-message">Information Message</a>.</li><li><a href="#m-multi-information-message">Multi Information Message</a></li><li><a href="#p-parameter-message">Parameter Message</a><ul><li>For the <em>Data</em> section, the Parameter Message is used when the parameter value changes</li></ul></li><li><a href="#q-default-parameter-message">Default Parameter Message</a></li></ul><h2 id="вимоги-до-parsers" tabindex="-1">Вимоги до Parsers <a class="header-anchor" href="#вимоги-до-parsers" aria-label="Permalink to &quot;Вимоги до Parsers&quot;">​</a></h2><p>Дійсний розбірник ULog повинен відповідати наступним вимогам:</p><ul><li>Повинен ігнорувати невідомі повідомлення (але може вивести попередження)</li><li>Розбирайте майбутні/невідомі версії формату файлу також (але може вивести попередження).</li><li>Must refuse to parse a log which contains unknown incompatibility bits set (<code>incompat_flags</code> of <a href="#b-flag-bits-message">Flag Bits Message</a>), meaning the log contains breaking changes that the parser cannot handle.</li><li>Парсер повинен правильно обробляти журнали, які раптово закінчуються, посеред повідомлення. Недовершене повідомлення слід просто викинути.</li><li>Для доданих даних: парсер може вважати, що секція Даних існує, тобто зміщення вказує на місце після секції Визначень. <ul><li>Додані дані повинні трактуватися так, ніби вони були частиною звичайного розділу даних.</li></ul></li></ul><h2 id="відомі-реалізаціі-парсера" tabindex="-1">Відомі Реалізації Парсера <a class="header-anchor" href="#відомі-реалізаціі-парсера" aria-label="Permalink to &quot;Відомі Реалізації Парсера&quot;">​</a></h2><ul><li>PX4-Autopilot++: C++ <ul><li><a href="https://github.com/PX4/PX4-Autopilot/tree/main/src/modules/logger" target="_blank" rel="noreferrer">logger module</a></li><li><a href="https://github.com/PX4/PX4-Autopilot/tree/main/src/modules/replay" target="_blank" rel="noreferrer">replay module</a></li><li><a href="https://github.com/PX4/PX4-Autopilot/tree/main/src/systemcmds/hardfault_log" target="_blank" rel="noreferrer">hardfault_log module</a>: append hardfault crash data.</li></ul></li><li><a href="https://github.com/PX4/pyulog" target="_blank" rel="noreferrer">pyulog</a>: python, ULog reader and writer library with CLI scripts.</li><li><a href="https://github.com/PX4/ulog_cpp" target="_blank" rel="noreferrer">ulog_cpp</a>: C++, ULog reader and writer library.</li><li><a href="https://github.com/PX4/FlightPlot" target="_blank" rel="noreferrer">FlightPlot</a>: Java, log plotter.</li><li><a href="https://github.com/mavlink/mavlink" target="_blank" rel="noreferrer">MAVLink</a>: Messages for ULog streaming via MAVLink (note that appending data is not supported, at least not for cut off messages).</li><li><a href="https://github.com/mavlink/qgroundcontrol" target="_blank" rel="noreferrer">QGroundControl</a>: C++, ULog streaming via MAVLink and minimal parsing for GeoTagging.</li><li><a href="https://github.com/01org/mavlink-router" target="_blank" rel="noreferrer">mavlink-router</a>: C++, ULog streaming via MAVLink.</li><li><a href="https://github.com/ecmnet/MAVGCL" target="_blank" rel="noreferrer">MAVGAnalysis</a>: Java, ULog streaming via MAVLink and parser for plotting and analysis.</li><li><a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">PlotJuggler</a>: C++/Qt application to plot logs and time series. Підтримує ULog з версії 2.1.3.</li><li><a href="https://github.com/maxsun/ulogreader" target="_blank" rel="noreferrer">ulogreader</a>: Javascript, ULog reader and parser outputs log in JSON object format.</li><li><a href="https://github.com/foxglove/studio" target="_blank" rel="noreferrer">Foxglove Studio</a>: an integrated visualization and diagnosis tool for robotics (Typescript ULog parser: <a href="https://github.com/foxglove/ulog" target="_blank" rel="noreferrer">https://github.com/foxglove/ulog</a>).</li></ul><h2 id="історія-версіи-формату-фаилу" tabindex="-1">Історія версій формату файлу <a class="header-anchor" href="#історія-версіи-формату-фаилу" aria-label="Permalink to &quot;Історія версій формату файлу&quot;">​</a></h2><h3 id="зміни-у-версіі-2" tabindex="-1">Зміни у версії 2 <a class="header-anchor" href="#зміни-у-версіі-2" aria-label="Permalink to &quot;Зміни у версії 2&quot;">​</a></h3><ul><li>Addition of <a href="#m-multi-information-message">Multi Information Message</a> and <a href="#b-flag-bits-message">Flag Bits Message</a> and the ability to append data to a log. <ul><li>Це використовується для додавання даних про збій до існуючого журналу.</li><li>Якщо дані додаються до журналу, який обрізаний посередині повідомлення, їх не можна розбирати з парсерами версії 1.</li></ul></li><li>Крім того, передня та задня сумісність забезпечується, якщо парсери ігнорують невідомі повідомлення.</li></ul>`,114)]))}const k=a(n,[["render",l]]);export{g as __pageData,k as default};
