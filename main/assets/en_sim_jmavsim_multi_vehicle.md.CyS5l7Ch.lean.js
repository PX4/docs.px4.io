import{_ as i,c as t,a8 as s,o as a}from"./chunks/framework.BDnHobkS.js";const m=JSON.parse('{"title":"Multi-Vehicle Simulation with JMAVSim","description":"","frontmatter":{},"headers":[],"relativePath":"en/sim_jmavsim/multi_vehicle.md","filePath":"en/sim_jmavsim/multi_vehicle.md"}'),l={name:"en/sim_jmavsim/multi_vehicle.md"};function o(n,e,h,c,r,p){return a(),t("div",null,e[0]||(e[0]=[s('<h1 id="multi-vehicle-simulation-with-jmavsim" tabindex="-1">Multi-Vehicle Simulation with JMAVSim <a class="header-anchor" href="#multi-vehicle-simulation-with-jmavsim" aria-label="Permalink to &quot;Multi-Vehicle Simulation with JMAVSim&quot;">​</a></h1><p>This topic explains how to simulate multiple UAV (multicopter) vehicles using <a href="./../sim_jmavsim/">JMAVSim</a> and SITL. All vehicle instances are started at the same position in the simulation.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This is the easiest way to simulate multiple vehicles running PX4. It is suitable for testing multi-vehicle support in <em>QGroundControl</em> (or the <a href="https://mavsdk.mavlink.io/" target="_blank" rel="noreferrer">MAVSDK</a>, etc.). <a href="./../simulation/multi-vehicle-simulation.html">Multi-Vehicle Simulation with Gazebo</a> should be used for swarm simulations with many vehicles, or for testing features like computer vision that are only supported by Gazebo.</p></div><h2 id="how-to-start-multiple-instances" tabindex="-1">How to Start Multiple Instances <a class="header-anchor" href="#how-to-start-multiple-instances" aria-label="Permalink to &quot;How to Start Multiple Instances&quot;">​</a></h2><p>To start multiple instances (on separate ports):</p><ol><li><p>Build PX4</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl_default</span></span></code></pre></div></li><li><p>Run <strong>sitl_multiple_run.sh</strong>, specifying the number of instances to start (e.g. 2):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/sitl_multiple_run.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span></code></pre></div></li><li><p>Start the first instance in the same terminal (this will run in the foreground):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/simulation/jmavsim/jmavsim_run.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span></code></pre></div></li><li><p>Open a new terminal for each subsequent instance, specifying the <em>simulation</em> TCP port for the instance:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/simulation/jmavsim/jmavsim_run.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4560</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span></code></pre></div><p>The port should be set to <code>4560+i</code> where <code>i</code> iterates for each instance (from <code>0</code> to <code>N-1</code>)</p></li></ol><p><em>QGroundControl</em> should automatically connect to all the new vehicle instances (all GCS traffic is sent to PX4&#39;s remote UDP port: <code>14550</code> from all instances). The vehicle that is currently being controlled is displayed in the application to bar; you can select this vehicle text to display a selection list of all of the (simulated) connected vehicle instances (<code>Vehicle 1</code>, <code>Vehicle 2</code>, etc.) and choose a new vehicle to control.</p><p>Developer APIs such as <em>MAVSDK</em> or <em>MAVROS</em> can connect to individual instances by listening on sequentially allocated PX4 remote UDP ports from <code>14540</code> (first instance) to <code>14549</code>. Additional instances <em>all</em> connect to port <code>14549</code>.</p><blockquote><p><strong>Tip</strong> The <strong>sitl_multiple_run.sh</strong> script starts a separate process for each vehicle. To restart the simulations after killing one of them, you must call <strong>sitl_multiple_run.sh</strong> again, and also restart each of the individual instances in their own terminals.</p></blockquote><h2 id="additional-resources" tabindex="-1">Additional Resources <a class="header-anchor" href="#additional-resources" aria-label="Permalink to &quot;Additional Resources&quot;">​</a></h2><ul><li>See <a href="./../simulation/">Simulation</a> for more information about the port configuration.</li></ul>',11)]))}const u=i(l,[["render",o]]);export{m as __pageData,u as default};
