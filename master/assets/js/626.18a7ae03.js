(window.webpackJsonp=window.webpackJsonp||[]).push([[626],{2251:function(_,t,e){"use strict";e.r(t);var a=e(18),r=Object(a.a)({},(function(){var _=this,t=_.$createElement,a=_._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[a("h1",{attrs:{id:"精准着陆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#精准着陆"}},[_._v("#")]),_._v(" 精准着陆")]),_._v(" "),a("p",[_._v("PX4 支持多旋翼精准着陆（从 PX4 1.7.4版本），这一功能使用 "),a("a",{attrs:{href:"https://irlock.com/products/ir-lock-sensor-precision-landing-kit",target:"_blank",rel:"noopener noreferrer"}},[_._v("IR-LOCK 传感器"),a("OutboundLink")],1),_._v("和 IR 信标（如 "),a("a",{attrs:{href:"https://irlock.com/collections/markone",target:"_blank",rel:"noopener noreferrer"}},[_._v(" IR-LOCK MarkOne "),a("OutboundLink")],1),_._v(" ）以及朝下的距离传感器。 这使飞行器能以约 10 cm 的精度着陆（相比之下，GPS 的精度可能达到几米）。")]),_._v(" "),a("p",[_._v("精准着陆可由切换至 "),a("em",[_._v("精准着陆")]),_._v(" 飞行模式或作为 "),a("a",{attrs:{href:"#mission"}},[_._v("任务")]),_._v(" 的一部分来启动。")]),_._v(" "),a("h2",{attrs:{id:"设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置"}},[_._v("#")]),_._v(" 设置")]),_._v(" "),a("h3",{attrs:{id:"硬件安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#硬件安装"}},[_._v("#")]),_._v(" 硬件安装")]),_._v(" "),a("p",[_._v("按照官方指南安装 IR-LOCK 传感器。 确保传感器的 x 轴与飞行器的 y 轴对齐，并且传感器的 y 轴与飞行器的 x 方向对齐（如果摄像头从正面朝下倾斜 90 度，则会出现这种情况）。")]),_._v(" "),a("p",[_._v("安装 "),a("RouterLink",{attrs:{to:"/zh/getting_started/sensor_selection.html#distance"}},[_._v("范围/距离传感器")]),_._v("（已发现 * LidarLite v3 * 效果良好）。")],1),_._v(" "),a("blockquote",[a("p",[a("strong",[_._v("Note")]),_._v("许多基于红外线的距离传感器在 IR-LOCK 信标存在的情况下表现不佳。 有关其他兼容传感器，请参阅 IR-LOCK 指南。")])]),_._v(" "),a("h3",{attrs:{id:"固件配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#固件配置"}},[_._v("#")]),_._v(" 固件配置")]),_._v(" "),a("p",[_._v("精确着陆需要模块 "),a("code",[_._v("irlock")]),_._v(" 和 "),a("code",[_._v("landing_target_estimator")]),_._v(" ，默认情况下不包含在 PX4 固件中。 They can be included by adding (or uncommenting) the following lines in the relevant configuration file for your flight controller (e.g. "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/master/boards/px4/fmu-v5/default.cmake",target:"_blank",rel:"noopener noreferrer"}},[_._v("PX4-Autopilot/boards/px4/fmu-v5/default.cmake"),a("OutboundLink")],1),_._v("):")]),_._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[_._v("drivers/irlock\nmodules/landing_target_estimator\n")])])]),a("p",[_._v("这两个模块也应该在系统启动时启动。 有关说明，请参阅："),a("RouterLink",{attrs:{to:"/zh/concept/system_startup.html#customizing-the-system-startup"}},[_._v("自定义系统启动")]),_._v("。")],1),_._v(" "),a("h2",{attrs:{id:"软件配置-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件配置-参数"}},[_._v("#")]),_._v(" 软件配置（参数）")]),_._v(" "),a("p",[_._v("使用"),a("code",[_._v("landing_target_estimator")]),_._v("和"),a("code",[_._v("navigator")]),_._v("参数配置精准着陆，你可以分别在“Landing target estimator”和“Precision land”组中找到这些参数。 最重要的参数将在下面讨论。")]),_._v(" "),a("p",[_._v("参数"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_MODE"}},[_._v(" LTEST_MODE ")]),_._v(" 决定信标是被认为静止的还是移动的。 如果 "),a("LT",[_._v(" LTEST_MODE "),_._v("被设置为移动的（例如，它所安装得多旋翼飞行器将要在运动车辆上着陆），则信标测量仅用于在精准着陆控制器中产生位置设定点。 如果"),a("LT",[_._v(" LTEST_MODE "),_._v(" 被设置为静止得，则飞行器位置估计器（EKF2 或 LPE）也使用信标测量结果。")])],1)],1),_._v(" "),a("p",[_._v("参数"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_SCALE_X"}},[_._v(" LTEST_SCALE_X ")]),_._v(" 和 "),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#LTEST_SCALE_Y"}},[_._v(" LTEST_SCALE_Y ")]),_._v(" 可用于在估计信标相对于飞行器的位置和速度之前对信标测量结果进行缩放。 由于 IR-LOCK 传感器的镜头失真，可能需要进行测量缩放。 注意，在传感器坐标系中考虑"),a("code",[_._v("LTEST_SCALE_X")]),_._v("和"),a("code",[_._v("LTEST_SCALE_Y")]),_._v("，而不是飞行器坐标系。")],1),_._v(" "),a("p",[_._v("要校准这些缩放参数，请将"),a("code",[_._v("LTEST_MODE")]),_._v("设置为移动，将多旋翼飞行器飞行在信标上方，并使飞行器执行前后和左右运动，同时"),a("RouterLink",{attrs:{to:"/zh/dev_log/logging.html#configuration"}},[_._v("记录")]),_._v(" "),a("code",[_._v("landing_target_pose")]),_._v("和"),a("code",[_._v("vehicle_local_position")]),_._v("的日志。 然后，将 "),a("code",[_._v("landing_target_pose.vx_rel")]),_._v(" 和 "),a("code",[_._v("landing_target_pose.vy_rel")]),_._v(" 分别与"),a("code",[_._v("vehicle_local_position.vx")]),_._v(" 和 "),a("code",[_._v("vehicle_local_position.vy")]),_._v(" 进行比较（均在NED坐标系中测量）。 如果估计的信标速度始终小于或大于飞行器速度，则调整缩放参数以进行补偿。")],1),_._v(" "),a("p",[_._v("如果在 "),a("LT",[_._v(" LTEST_MODE "),_._v(" 设置为静止的情况下进行精准着陆时观察到飞行器缓慢侧向振荡，则信标测量可能会缩放得太高，您应该减小相关方向上的缩放参数。")])],1),_._v(" "),a("h2",{attrs:{id:"精准降落模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#精准降落模式"}},[_._v("#")]),_._v(" 精准降落模式")]),_._v(" "),a("p",[_._v("精确着陆可以配置为“必需的”或“随机的”。 模式的选择会影响精准着陆的执行方式。")]),_._v(" "),a("h3",{attrs:{id:"必须的模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#必须的模式"}},[_._v("#")]),_._v(" 必须的模式")]),_._v(" "),a("p",[_._v("在 "),a("em",[_._v("必须的模式")]),_._v(" 中，如果在启动着陆时信标不可见，则飞行器将搜索信标。 如果找到信标，飞行器将执行精准着陆。")]),_._v(" "),a("p",[_._v("搜索过程包括爬到搜索高度（"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_SRCH_ALT"}},[_._v(" PLD_SRCH_ALT ")]),_._v("）。 如果信标在搜索高度仍然不可见并且在搜索超时（"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_SRCH_TOUT"}},[_._v(" PLD_SRCH_TOUT ")]),_._v("）之后，则在当前位置启动正常着陆。")],1),_._v(" "),a("h3",{attrs:{id:"随机的模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#随机的模式"}},[_._v("#")]),_._v(" 随机的模式")]),_._v(" "),a("p",[_._v("在 "),a("em",[_._v("随机的模式")]),_._v(" 中，"),a("em",[_._v("如果")]),_._v("（并且仅当）在启动着陆时信标可见，则飞行器将使用精准着陆<0>。 如果此时不可见，则飞行器立即在当前位置执行正常着陆。")]),_._v(" "),a("h2",{attrs:{id:"执行精准着陆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行精准着陆"}},[_._v("#")]),_._v(" 执行精准着陆")]),_._v(" "),a("blockquote",[a("p",[a("strong",[_._v("Note")]),_._v("由于位置控制器的当前实施方式的限制，只有具有有效的全局位置时才能实现精准着陆。")])]),_._v(" "),a("h3",{attrs:{id:"通过命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过命令"}},[_._v("#")]),_._v(" 通过命令")]),_._v(" "),a("p",[_._v("精准着陆可以通过命令行接口启动：")]),_._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[_._v("commander mode auto:precland\n")])])]),a("p",[_._v("在这种情况下，精准着陆始终被视为“必需的”。")]),_._v(" "),a("p",[a("span",{attrs:{id:"mission"}})]),_._v(" "),a("h3",{attrs:{id:"在任务中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在任务中"}},[_._v("#")]),_._v(" 在任务中")]),_._v(" "),a("p",[_._v("精准着陆可以作为 "),a("RouterLink",{attrs:{to:"/zh/flying/missions.html"}},[_._v("任务")]),_._v(" 的一部分启动，使用 "),a("a",{attrs:{href:"https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_LAND",target:"_blank",rel:"noopener noreferrer"}},[_._v(" MAV_CMD_NAV_LAND "),a("OutboundLink")],1),_._v(" 并适当设置 "),a("code",[_._v("param2")]),_._v(" ：")],1),_._v(" "),a("ul",[a("li",[a("code",[_._v("param2")]),_._v(" = 0: 正常着陆而不使用信标。")]),_._v(" "),a("li",[a("code",[_._v("param2")]),_._v(" = 1："),a("em",[_._v("随机的")]),_._v(" 精准着陆。")]),_._v(" "),a("li",[a("code",[_._v("param2")]),_._v(" = 2："),a("em",[_._v("必需的")]),_._v(" 精准着陆。")])]),_._v(" "),a("h2",{attrs:{id:"仿真"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仿真"}},[_._v("#")]),_._v(" 仿真")]),_._v(" "),a("p",[_._v("在 "),a("RouterLink",{attrs:{to:"/zh/simulation/gazebo.html"}},[_._v("SITL Gazebo")]),_._v(" 中可以使用 IR-LOCK 传感器和信标进行精准着陆仿真。")],1),_._v(" "),a("p",[_._v("可以运行下列命令来开启拥有 IR-LOCK 信标，带测距传感器的飞行器，IR-LOCK 摄像头的仿真世界：")]),_._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[_._v("make px4_sitl gazebo_iris_irlock\n")])])]),a("p",[_._v("你可以通过在 Gazebo GUI 中移动信标或通过改变在 "),a("a",{attrs:{href:"https://github.com/PX4/sitl_gazebo/blob/master/worlds/iris_irlock.world#L42",target:"_blank",rel:"noopener noreferrer"}},[_._v("Gazebo world"),a("OutboundLink")],1),_._v(" 中的位置来改变信标的位置。")]),_._v(" "),a("h2",{attrs:{id:"工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作原理"}},[_._v("#")]),_._v(" 工作原理")]),_._v(" "),a("h3",{attrs:{id:"着陆目标估计器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#着陆目标估计器"}},[_._v("#")]),_._v(" 着陆目标估计器")]),_._v(" "),a("p",[a("code",[_._v("landing_target_estimator")]),_._v(" 从 "),a("code",[_._v("irlock")]),_._v(" 驱动中获取测量结果以及估计的地形高度，来估计信标相对于飞行器的位置。")]),_._v(" "),a("p",[a("code",[_._v("irlock_report")]),_._v(" 中的测量值包含从图像中心到信标的角度的正切值。 换句话说，测量值是指向信标的矢量的 x 和 y 分量，其中 z 分量具有长度“1”。 这意味着将测量结果缩放从摄像头到信标的距离这么多倍，将得到从摄像头到信标的（方向）矢量。 然后根据飞机的姿态估计将相对位置旋转到北对齐，机身水平的坐标系中。 相对位置测量的 x 和 y 分量都在单独的卡尔曼滤波器中滤波，卡尔曼滤波器用作简单的低通滤波器，其也产生速度估计并允许异常值剔除。")]),_._v(" "),a("p",[_._v("每当新的"),a("code",[_._v("irlock_report")]),_._v("融合到估计中时，"),a("code",[_._v("landing_target_estimator")]),_._v("就发布估计的相对位置和速度。 如果未看到信标或信标测量结果被拒绝，则不会发布任何内容。 着陆目标估计发布在"),a("code",[_._v("landing_target_pose")]),_._v(" uORB 消息中。")]),_._v(" "),a("h3",{attrs:{id:"改进的飞行器位置估计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进的飞行器位置估计"}},[_._v("#")]),_._v(" 改进的飞行器位置估计")]),_._v(" "),a("p",[_._v("如果使用参数"),a("code",[_._v("LTEST_MODE")]),_._v("将信标指定为静止，则可以借助信标测量来改善飞行器的位置/速度估计。 这是通过融合信标的速度为飞行器负速度的测量来完成的。")]),_._v(" "),a("h3",{attrs:{id:"精准着陆过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#精准着陆过程"}},[_._v("#")]),_._v(" 精准着陆过程")]),_._v(" "),a("p",[_._v("精准着陆由三个阶段组成：")]),_._v(" "),a("ol",[a("li",[a("p",[_._v("**水平接近：**飞行器在保持其当前高度的同时水平接近信标。 一旦信标相对于车辆的位置差异低于阈值（"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_HACC_RAD"}},[_._v(" PLD_HACC_RAD ")]),_._v("），就进入下一阶段。 如果信标在此阶段丢失（不可见超过时长"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_BTOUT"}},[_._v(" PLD_BTOUT ")]),_._v("），则启动搜索程序（在必须的精准降落模式）或飞行器正常着陆（在随机的精准降落模式）。")],1)]),_._v(" "),a("li",[a("p",[_._v("**信标上方降落：**飞行器下降，同时保持在信标中心上方。 如果信标在此阶段丢失（不可见超过时长"),a("code",[_._v("PLD_BTOUT")]),_._v("），则启动搜索程序（在必须的精准降落模式）或飞行器正常着陆（在随机的精准降落模式）。")])]),_._v(" "),a("li",[a("p",[_._v("**最终接近：**当飞行器接近地面（高度小于"),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_FAPPR_ALT"}},[_._v(" PLD_FAPPR_ALT ")]),_._v("）时，飞行器会下降，同时保持在信标中心上方。 如果信标在此阶段丢失，则会继续下降，与精准着陆的类型无关。")],1)])]),_._v(" "),a("p",[_._v("在步骤 1. 和步骤 2.中 搜索次数最多达 "),a("RouterLink",{attrs:{to:"/zh/advanced_config/parameter_reference.html#PLD_MAX_SRCH"}},[_._v("PLD_MAX_SRCH")]),_._v(" 次。")],1),_._v(" "),a("p",[a("img",{attrs:{src:e(459),alt:"精准着陆流程图"}})])])}),[],!1,null,null,null);t.default=r.exports},459:function(_,t,e){_.exports=e.p+"assets/img/precland-flow-diagram.88e4e6cb.png"}}]);