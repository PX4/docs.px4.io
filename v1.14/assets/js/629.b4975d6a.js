(window.webpackJsonp=window.webpackJsonp||[]).push([[629],{349:function(t,s,a){t.exports=a.p+"assets/img/ref_frames.ec278837.png"},350:function(t,s,a){t.exports=a.p+"assets/img/architecture_xrce-dds_ros2.fed61809.svg"},3832:function(t,s,a){"use strict";a.r(s);var e=a(19),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"ros-2-用户指南"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-用户指南"}},[t._v("#")]),t._v(" ROS 2 用户指南")]),t._v(" "),e("p",[t._v("ROS 2-PX4 架构在ROS 2和PX4之间进行了深度整合。 允许 ROS 2 订阅或发布节点直接使用 PX4 uORB 话题。")]),t._v(" "),e("p",[t._v("本指南介绍了系统架构和应用程序流程，并解释了如何与PX4一起安装和使用ROS2。")]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("From PX4 v1.14, ROS 2 uses "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html"}},[t._v("uXRCE-DDS")]),t._v(" middleware, replacing the "),e("em",[t._v("FastRTPS")]),t._v(" middleware that was used in version 1.13 (v1.13 does not support uXRCE-DDS).")],1),t._v(" "),e("p",[t._v("The "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html#fast-rtps-to-uxrce-dds-migration-guidelines"}},[t._v("migration guide")]),t._v(" explains what you need to do in order to migrate ROS 2 apps from PX4 v1.13 to PX4 v1.14.")],1),t._v(" "),e("p",[t._v("If you're still working on PX4 v1.13, please follow the instructions in the "),e("a",{attrs:{href:"https://docs.px4.io/v1.13/en/ros/ros2_comm.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4 v1.13 Docs"),e("OutboundLink")],1),t._v(".\n")])]),t._v(" "),e("h2",{attrs:{id:"概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),e("p",[t._v("由于使用 "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html"}},[t._v("uXRCE-DDS")]),t._v(" 通信中间件，因此ROS 2的应用程序流程非常简单。")],1),t._v(" "),e("p",[e("img",{attrs:{src:a(350),alt:"Architecture uXRCE-DDS with ROS 2"}})]),t._v(" "),e("p",[t._v("uXRCE-DDS的中间件由运行在PX4上的客户端(Client)和运行在机载计算机上的代理端(Agent)组成， 通过串口、UDP、TCP或其他链路实现双向数据互联。 代理端(Agent)充当客户端(Client)的代理在DDS全局数据空间中发布和订阅话题。")]),t._v(" "),e("p",[t._v("The PX4 "),e("RouterLink",{attrs:{to:"/zh/modules/modules_system.html#uxrce-dds-client"}},[t._v("uxrce_dds_client")]),t._v(" is generated at build time and included in PX4 firmware by default. 它包含“通用”XRCE-DDS客户端(Client)代码和PX4 特定翻译代码以支持用来发布或获取来自uORB的话题 。 为客户端(Client)生成的 uORB 消息的子集在 "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/src/modules/uxrce_dds_client/dds_topics.yaml"),e("OutboundLink")],1),t._v(" 中定义。 生成器使用代码树： "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/release/1.14/msg",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/msg"),e("OutboundLink")],1),t._v(" 中的 uORB 消息定义来创建 ROS 2 消息代码。")],1),t._v(" "),e("p",[t._v("ROS 2 应用程序应该在具有 "),e("em",[t._v("相同的")]),t._v(" 消息定义的工作区中构建，即在 PX4 Firmware 中创建 uXRCE-DDS客户端(Client)模块时使用的消息。 你可以通过克隆接口包 "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),e("OutboundLink")],1),t._v(" 到你的 ROS 2 工作空间中(仓库中的分支对应于不同版本 PX4 消息)。")]),t._v(" "),e("p",[t._v("请注意，micro XRCE-DDS "),e("em",[t._v("代理(Agent)")]),t._v(" 本身并不依赖客户端代码。 可以通过 "),e("a",{attrs:{href:"https://github.com/eProsima/Micro-XRCE-DDS-Agent",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码"),e("OutboundLink")],1),t._v("单独或作为ROS的一部分通过编译生成，也可以通过snap安装。")]),t._v(" "),e("p",[t._v("您通常需要在使用 ROS 2 时同时启动客户端(Client)和代理人(Agent)。 请注意，uXRCE-DDS客户端默认是编译进固件中的，但除模拟器构建外，不会自动启动。")]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("在 PX4v1.13 及之前版本，ROS 2依赖于 "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),e("OutboundLink")],1),t._v(" 中的定义。 该仓库不再需要了，但的确包含了有用的例子。")])]),t._v(" "),e("h2",{attrs:{id:"安装设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装设置"}},[t._v("#")]),t._v(" 安装设置")]),t._v(" "),e("p",[t._v('The supported ROS 2 platforms for PX4 development are ROS 2 "Humble" on Ubuntu 22.04, and ROS 2 "Foxy" on Ubuntu 20.04.')]),t._v(" "),e("p",[t._v('ROS 2 "Humble" is recommended because it is the current ROS 2 LTS distribution. ROS 2 "Foxy" reached end-of-life in May 2023, but is still stable and works with PX4.')]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("PX4 is not as well tested on Ubuntu 22.04 as it is on Ubuntu 20.04 (at time of writing), and Ubuntu 20.04 is needed if you want to use [Gazebo Classic](../sim_gazebo_classic/README.md).")])]),t._v(" "),e("p",[t._v("To setup ROS 2 for use with PX4:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#install-px4"}},[t._v("安装 PX4")]),t._v(" (使用 PX4 模拟器)")]),t._v(" "),e("li",[e("a",{attrs:{href:"#install-ros-2"}},[t._v("安装 ROS 2")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#setup-micro-xrce-dds-agent-client"}},[t._v("安装Micro XRCE-DDS 代理(Agent)& 客户端(Client)")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#build-ros-2-workspace"}},[t._v("构建 & 运行 ROS 2 工作空间")])])]),t._v(" "),e("p",[t._v("框架的其他依赖关系将自动安装，如 "),e("em",[t._v("Fast DDS")]),t._v("。")]),t._v(" "),e("h3",{attrs:{id:"安装px4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装px4"}},[t._v("#")]),t._v(" 安装PX4")]),t._v(" "),e("p",[t._v("您需要安装 PX4 开发工具链才能使用模拟器。")]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("ROS")]),t._v(" "),e("p",[t._v("2 唯一依赖的是 PX4 上定义的消息集，它从 "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),e("OutboundLink")],1),t._v(" 获取。 您只需要安装 PX4 当您需要模拟器时(如我们在本指南中所做的那样)， 或者如果您正在创建一个发布自定义uORB话题。")])]),t._v(" "),e("p",[t._v("通过以下方式在 Ubuntu 上配置一个 PX4 开发环境：")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/PX4-Autopilot.git --recursive\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" ./PX4-Autopilot/Tools/setup/ubuntu.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" PX4-Autopilot/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl\n")])])]),e("p",[t._v("Note that the above commands will install the recommended simulator for your version of Ubuntu. If you want to install PX4 but keep your existing simulator installation, run "),e("code",[t._v("ubuntu.sh")]),t._v(" above with the "),e("code",[t._v("--no-sim-tools")]),t._v(" flag.")]),t._v(" "),e("p",[t._v("For more information and troubleshooting see: "),e("RouterLink",{attrs:{to:"/zh/dev_setup/dev_env_linux_ubuntu.html"}},[t._v("Ubuntu Development Environment")]),t._v(" and "),e("RouterLink",{attrs:{to:"/zh/dev_setup/building_px4.html"}},[t._v("Download PX4 source")]),t._v(".")],1),t._v(" "),e("h3",{attrs:{id:"安装-ros-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装-ros-2"}},[t._v("#")]),t._v(" 安装 ROS 2")]),t._v(" "),e("p",[t._v("安装 ROS 2 及其依赖：")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Install ROS 2.")]),t._v(" "),e("tabs",[e("tab",{attrs:{name:"humble",name:"To",name:"install",name:"ROS",name:"2",name:"Humble",name:"on",name:"Ubuntu",name:"22.04:"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" locales\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" locale-gen en_US en_US.UTF-8\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-locale "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LC_ALL")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8 "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LANG")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("LANG")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("en_US.UTF-8\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" software-properties-common\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository universe\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -y\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deb [arch='),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("dpkg --print-architecture"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" /etc/os-release "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" $UBUNTU_CODENAME"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(' main"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tee")]),t._v(" /etc/apt/sources.list.d/ros2.list "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-humble-desktop\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-dev-tools\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"source /opt/ros/humble/setup.bash"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" .bashrc\n")])])]),e("p",[t._v("The instructions above are reproduced from the official installation guide: "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Install ROS 2 Humble"),e("OutboundLink")],1),t._v(". You can install "),e("em",[t._v("either")]),t._v(" the desktop ("),e("code",[t._v("ros-humble-desktop")]),t._v(") "),e("em",[t._v("or")]),t._v(" bare-bones versions ("),e("code",[t._v("ros-humble-ros-base")]),t._v("), "),e("em",[t._v("and")]),t._v(" the development tools ("),e("code",[t._v("ros-dev-tools")]),t._v(").")])])],1)],1)]),t._v(" "),e("p",[t._v(":::")]),t._v(" "),e("tab",{attrs:{name:"foxy",name:"To",name:"install",name:"ROS",name:"2",name:"Foxy",name:"on",name:"Ubuntu",name:"20.04:"}},[e("ul",[e("li",[t._v("Follow the official installation guide: "),e("a",{attrs:{href:"https://index.ros.org/doc/ros2/Installation/Foxy/Linux-Install-Debians/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Install ROS 2 Foxy"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("p",[t._v("You can install "),e("em",[t._v("either")]),t._v(" the desktop ("),e("code",[t._v("ros-foxy-desktop")]),t._v(") "),e("em",[t._v("or")]),t._v(" bare-bones versions ("),e("code",[t._v("ros-foxy-ros-base")]),t._v("), "),e("em",[t._v("and")]),t._v(" the development tools ("),e("code",[t._v("ros-dev-tools")]),t._v(").")])]),t._v(" "),e("p",[t._v("::::")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("一些Python 依赖关系也必须安装 (使用 "),e("strong",[e("code",[t._v("pip")])]),t._v(" 或 "),e("strong",[e("code",[t._v("apt")])]),t._v("):")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("pip "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --user -U empy pyros-genmsg setuptools\n")])])])])]),t._v(" "),e("h3",{attrs:{id:"安装micro-xrce-dds-代理-agent-客户端-client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装micro-xrce-dds-代理-agent-客户端-client"}},[t._v("#")]),t._v(" 安装Micro XRCE-DDS 代理(Agent)& 客户端(Client)")]),t._v(" "),e("p",[t._v("For ROS 2 to communicate with PX4, "),e("RouterLink",{attrs:{to:"/zh/modules/modules_system.html#uxrce-dds-client"}},[t._v("uXRCE-DDS client")]),t._v(" must be running on PX4, connected to a micro XRCE-DDS agent running on the companion computer.")],1),t._v(" "),e("h4",{attrs:{id:"设置代理-agent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置代理-agent"}},[t._v("#")]),t._v(" 设置代理(Agent)")]),t._v(" "),e("p",[t._v("代理(Agent)可以通过 "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html#micro-xrce-dds-agent-installation"}},[t._v("数种方式")]),t._v(" 安装到任务计算机上。 下面我们将演示如何从源代码构建“独立”代理(Agent)，并连接到在 PX4 模拟器上运行的客户端(Client)。")],1),t._v(" "),e("p",[t._v("设置并启动代理：")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("打开一个终端。")])]),t._v(" "),e("li",[e("p",[t._v("输入以下命令从仓库获取源代码并构建代理(Agent)：")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/eProsima/Micro-XRCE-DDS-Agent.git\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" Micro-XRCE-DDS-Agent\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" build\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" build\ncmake "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ldconfig /usr/local/lib/\n")])])])]),t._v(" "),e("li",[e("p",[t._v("启动代理并设置以连接运行在模拟器上的 uXRCE-DDS客户端(Client)：")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("MicroXRCEAgent udp4 -p "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v("\n")])])])])]),t._v(" "),e("p",[t._v("代理正在运行，但在我们启动PX4 (下一步)之前，您不会看到太多。")]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("您可以让代理(Agent)在这个终端中运行！\n请注意，每个连接端口只允许一个代理(Agent)。")])]),t._v(" "),e("h4",{attrs:{id:"启动客户端-client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动客户端-client"}},[t._v("#")]),t._v(" 启动客户端(Client)")]),t._v(" "),e("p",[t._v("PX4 模拟器自动启动 uXRCE-DDS客户端，连接到本地主机上的 UDP 8888 端口。")]),t._v(" "),e("p",[t._v("启动模拟器(和客户端Client)：")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Open a new terminal in the root of the "),e("strong",[t._v("PX4 Autopilot")]),t._v(" repo that was installed above.")]),t._v(" "),e("tabs",[e("tab",{attrs:{name:"humble"}},[e("ul",[e("li",[e("p",[t._v("Start a PX4 "),e("RouterLink",{attrs:{to:"/zh/sim_gazebo_gz/"}},[t._v("Gazebo")]),t._v(" simulation using:")],1),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gz_x500\n")])])])])])])],1)],1)]),t._v(" "),e("p",[t._v(":::")]),t._v(" "),e("tab",{attrs:{name:"foxy"}},[e("ul",[e("li",[e("p",[t._v("Start a PX4 "),e("RouterLink",{attrs:{to:"/zh/sim_gazebo_classic/"}},[t._v("Gazebo Classic")]),t._v(" simulation using:")],1),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gazebo-classic\n")])])])])])]),t._v(" "),e("p",[t._v("::::")]),t._v(" "),e("p",[t._v("代理(Agent)和客户端(Client)现在将运行并建立连接。")]),t._v(" "),e("p",[t._v("PX4 终端显示 "),e("RouterLink",{attrs:{to:"/zh/debug/system_console.html"}},[t._v("NuttShell/PX4 系统控制台")]),t._v("  PX4 启动和运行。 代理(Agent)连接后输出应该包含 "),e("code",[t._v("INFO")]),t._v(" 显示创建数据写入的消息：")],1),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("...\nINFO  [uxrce_dds_client] synchronized with time offset 1675929429203524us\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/failsafe_flags data writer, topic id: 83\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/sensor_combined data writer, topic id: 168\nINFO  [uxrce_dds_client] successfully created rt/fmu/out/timesync_status data writer, topic id: 188\n...\n")])])]),e("p",[t._v("Micro XRCE-DDS代理(Agent)终端也应开始显示输出，因为DDS网络中创建了相同的主题：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("...\n[1675929445.268957] info     | ProxyClient.cpp    | create_publisher         | publisher created      | client_key: 0x00000001, publisher_id: 0x0DA(3), participant_id: 0x001(1)\n[1675929445.269521] info     | ProxyClient.cpp    | create_datawriter        | datawriter created     | client_key: 0x00000001, datawriter_id: 0x0DA(5), publisher_id: 0x0DA(3)\n[1675929445.270412] info     | ProxyClient.cpp    | create_topic             | topic created          | client_key: 0x00000001, topic_id: 0x0DF(2), participant_id: 0x001(1)\n...\n")])])]),e("h3",{attrs:{id:"build-ros-2-workspace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build-ros-2-workspace"}},[t._v("#")]),t._v(" Build ROS 2 Workspace")]),t._v(" "),e("p",[t._v("本节将展示如何在您的主目录中创建一个 ROS 2 工作空间(将源代码放在别处需要修改相关指令)。")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),e("OutboundLink")],1),t._v(" 软件包克隆到一个工作区文件夹，然后使用 "),e("code",[t._v("colcon")]),t._v(" 工具来构建工作区。 The example is run using "),e("code",[t._v("ros2 launch")]),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("The example builds the "),e("a",{attrs:{href:"#ros-2-listener"}},[t._v("ROS 2 Listener")]),t._v(" example application, located in "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),e("OutboundLink")],1),t._v(". "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),e("OutboundLink")],1),t._v(" is needed too so that the example can interpret PX4 ROS 2 topics.")])]),t._v(" "),e("h4",{attrs:{id:"building-the-workspace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#building-the-workspace"}},[t._v("#")]),t._v(" Building the Workspace")]),t._v(" "),e("p",[t._v("To create and build the workspace:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Open a new terminal.")])]),t._v(" "),e("li",[e("p",[t._v("Create and navigate into a new workspace directory using:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p ~/ws_sensor_combined/src/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/src/\n")])])]),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")])])])]),t._v(" "),e("p",[t._v("A naming convention for workspace folders can make it easier to manage workspaces.\n:::")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Clone the example repository and "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_msgs"),e("OutboundLink")],1),t._v(" to the "),e("code",[t._v("/src")]),t._v(" directory (the "),e("code",[t._v("main")]),t._v(" branch is cloned by default, which corresponds to the version of PX4 we are running):")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/px4_msgs.git\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/PX4/px4_ros_com.git\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Source the ROS 2 development environment into the current terminal and compile the workspace using "),e("code",[t._v("colcon")]),t._v(":")]),t._v(" "),e("tabs",[e("tab",{attrs:{name:"humble"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash\ncolcon build\n")])])])])],1)],1)]),t._v(" "),e("p",[t._v(":::")]),t._v(" "),e("tab",{attrs:{name:"foxy"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/foxy/setup.bash\ncolcon build\n")])])])]),t._v(" "),e("p",[t._v("::::")]),t._v(" "),e("p",[t._v("This builds all the folders under "),e("code",[t._v("/src")]),t._v(" using the sourced toolchain.")]),t._v(" "),e("h4",{attrs:{id:"running-the-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#running-the-example"}},[t._v("#")]),t._v(" Running the Example")]),t._v(" "),e("p",[t._v("To run the executables that you just built, you need to source "),e("code",[t._v("local_setup.bash")]),t._v('. This provides access to the "environment hooks" for the current workspace. In other words, it makes the executables that were just built available in the current terminal.')]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html#source-the-overlay",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS2 beginner tutorials"),e("OutboundLink")],1),t._v(" recommend that you "),e("em",[t._v("open a new terminal")]),t._v(" for running your executables.")])]),t._v(" "),e("p",[t._v("In a new terminal:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v('Navigate into the top level of your workspace directory and source the ROS 2 environment (in this case "Humble"):')]),t._v(" "),e("tabs",[e("tab",{attrs:{name:"humble"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/humble/setup.bash\n")])])])])],1)],1)]),t._v(" "),e("p",[t._v(":::")]),t._v(" "),e("tab",{attrs:{name:"foxy"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ws_sensor_combined/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /opt/ros/foxy/setup.bash\n")])])])]),t._v(" "),e("p",[t._v("::::")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Source the "),e("code",[t._v("local_setup.bash")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" install/local_setup.bash\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Now launch the example. Note here that we use "),e("code",[t._v("ros2 launch")]),t._v(", which is described below.")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ros2 launch px4_ros_com sensor_combined_listener.launch.py\n")])])])])]),t._v(" "),e("p",[t._v("If this is working you should see data being printed on the terminal/console where you launched the ROS listener:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("RECEIVED DATA FROM SENSOR COMBINED\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("\nts: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("870938190")]),t._v("\ngyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00341645")]),t._v("\ngyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00626475")]),t._v("\ngyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -0.000515705\ngyro_integral_dt: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4739")]),t._v("\naccelerometer_timestamp_relative: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\naccelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -0.273381\naccelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0949186")]),t._v("\naccelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": -9.76044\naccelerometer_integral_dt: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4739")]),t._v("\n")])])]),e("h2",{attrs:{id:"controlling-a-vehicle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#controlling-a-vehicle"}},[t._v("#")]),t._v(" Controlling a Vehicle")]),t._v(" "),e("p",[t._v("To control applications, ROS 2 applications:")]),t._v(" "),e("ul",[e("li",[t._v("subscribe to (listen to) telemetry topics published by PX4")]),t._v(" "),e("li",[t._v("publish to topics that cause PX4 to perform some action.")])]),t._v(" "),e("p",[t._v("The topics that you can use are defined in "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),e("OutboundLink")],1),t._v(", and you can get more information about their data in the "),e("RouterLink",{attrs:{to:"/zh/msg_docs/"}},[t._v("uORB Message Reference")]),t._v(". For example, "),e("RouterLink",{attrs:{to:"/zh/msg_docs/VehicleGlobalPosition.html"}},[t._v("VehicleGlobalPosition")]),t._v(" can be used to get the vehicle global position, while "),e("RouterLink",{attrs:{to:"/zh/msg_docs/VehicleCommand.html"}},[t._v("VehicleCommand")]),t._v(" can be used to command actions such as takeoff and land.")],1),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"#ros-2-example-applications"}},[t._v("ROS 2 Example applications")]),t._v(" examples below provide concrete examples of how to use these topics.")]),t._v(" "),e("h2",{attrs:{id:"compatibility-issues"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compatibility-issues"}},[t._v("#")]),t._v(" Compatibility Issues")]),t._v(" "),e("p",[t._v("This section contains information that may affect how you write your ROS code.")]),t._v(" "),e("h3",{attrs:{id:"ros-2-subscriber-qos-settings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-subscriber-qos-settings"}},[t._v("#")]),t._v(" ROS 2 Subscriber QoS Settings")]),t._v(" "),e("p",[t._v("ROS 2 code that subscribes to topics published by PX4 "),e("em",[t._v("must")]),t._v(" specify a appropriate (compatible) QoS setting in order to listen to topics. Specifically, nodes should subscribe using the ROS 2 predefined QoS sensor data (from the "),e("a",{attrs:{href:"#ros-2-listener"}},[t._v("listener example source code")]),t._v("):")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nrmw_qos_profile_t qos_profile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rmw_qos_profile_sensor_data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" qos "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoSInitialization")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("qos_profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos_profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nsubscription_ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_subscription")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/fmu/out/sensor_combined"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),e("p",[t._v("This is needed because the ROS 2 default "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html#qos-profiles",target:"_blank",rel:"noopener noreferrer"}},[t._v("Quality of Service (QoS) settings"),e("OutboundLink")],1),t._v(" are different from the settings used by PX4. Not all combinations of publisher-subscriber "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html#qos-compatibilities",target:"_blank",rel:"noopener noreferrer"}},[t._v("Qos settings are possible"),e("OutboundLink")],1),t._v(", and it turns out that the default ROS 2 settings for subscribing are not! Note that ROS code does not have to set QoS settings when publishing (the PX4 settings are compatible with ROS defaults in this case).")]),t._v(" "),e("h3",{attrs:{id:"ros-2-px4-frame-conventions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-px4-frame-conventions"}},[t._v("#")]),t._v(" ROS 2 & PX4 Frame Conventions")]),t._v(" "),e("p",[t._v("The local/world and body frames used by ROS and PX4 are different.")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Frame")]),t._v(" "),e("th",[t._v("PX4")]),t._v(" "),e("th",[t._v("ROS")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("Body")]),t._v(" "),e("td",[t._v("FRD (X "),e("strong",[t._v("F")]),t._v("orward, Y "),e("strong",[t._v("R")]),t._v("ight, Z "),e("strong",[t._v("D")]),t._v("own)")]),t._v(" "),e("td",[t._v("FLU (X "),e("strong",[t._v("F")]),t._v("orward, Y "),e("strong",[t._v("L")]),t._v("eft, Z "),e("strong",[t._v("U")]),t._v("p)")])]),t._v(" "),e("tr",[e("td",[t._v("World")]),t._v(" "),e("td",[t._v("FRD or NED (X "),e("strong",[t._v("N")]),t._v("orth, Y "),e("strong",[t._v("E")]),t._v("ast, Z "),e("strong",[t._v("D")]),t._v("own)")]),t._v(" "),e("td",[t._v("FLU or ENU (X "),e("strong",[t._v("E")]),t._v("ast, Y "),e("strong",[t._v("N")]),t._v("orth, Z "),e("strong",[t._v("U")]),t._v("p)")])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"http://www.ros.org/reps/rep-0105.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("REP105: Coordinate Frames for Mobile Platforms"),e("OutboundLink")],1),t._v(" for more information about ROS frames.")])]),t._v(" "),e("p",[t._v("Both frames are shown in the image below (FRD on the left/FLU on the right).")]),t._v(" "),e("p",[e("img",{attrs:{src:a(349),alt:"Reference frames"}})]),t._v(" "),e("p",[t._v("The FRD (NED) conventions are adopted on "),e("strong",[t._v("all")]),t._v(" PX4 topics unless explicitly specified in the associated message definition. Therefore, ROS 2 nodes that want to interface with PX4 must take care of the frames conventions.")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("To rotate a vector from ENU to NED two basic rotations must be performed:")]),t._v(" "),e("ul",[e("li",[t._v("first a pi/2 rotation around the "),e("code",[t._v("Z")]),t._v("-axis (up),")]),t._v(" "),e("li",[t._v("then a pi rotation around the "),e("code",[t._v("X")]),t._v("-axis (old East/new North).")])])]),t._v(" "),e("li",[e("p",[t._v("To rotate a vector from NED to ENU two basic rotations must be performed:")])]),t._v(" "),e("li",[e("ul",[e("li",[t._v("first a pi/2 rotation around the "),e("code",[t._v("Z")]),t._v("-axis (down),")]),t._v(" "),e("li",[t._v("then a pi rotation around the "),e("code",[t._v("X")]),t._v("-axis (old North/new East). Note that the two resulting operations are mathematically equivalent.")])])]),t._v(" "),e("li",[e("p",[t._v("To rotate a vector from FLU to FRD a pi rotation around the "),e("code",[t._v("X")]),t._v("-axis (front) is sufficient.")])]),t._v(" "),e("li",[e("p",[t._v("To rotate a vector from FRD to FLU a pi rotation around the "),e("code",[t._v("X")]),t._v("-axis (front) is sufficient.")])])]),t._v(" "),e("p",[t._v("Examples of vectors that require rotation are:")]),t._v(" "),e("ul",[e("li",[t._v("all fields in "),e("RouterLink",{attrs:{to:"/zh/msg_docs/TrajectorySetpoint.html"}},[t._v("TrajectorySetpoint")]),t._v(" message; ENU to NED conversion is required before sending them.")],1),t._v(" "),e("li",[t._v("all fields in "),e("RouterLink",{attrs:{to:"/zh/msg_docs/VehicleThrustSetpoint.html"}},[t._v("VehicleThrustSetpoint")]),t._v(" message; FLU to FRD conversion is required before sending them.")],1)]),t._v(" "),e("p",[t._v("Similarly to vectors, also quanternions representing the attitude of the vehicle (body frame) w.r.t. the world frame require conversion.")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_ros_com"),e("OutboundLink")],1),t._v(" provides the shared library "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/include/px4_ros_com/frame_transforms.h",target:"_blank",rel:"noopener noreferrer"}},[t._v("frame_transforms"),e("OutboundLink")],1),t._v(" to easily perform such conversions.")]),t._v(" "),e("h2",{attrs:{id:"ros-2-example-applications"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-example-applications"}},[t._v("#")]),t._v(" ROS 2 Example Applications")]),t._v(" "),e("h3",{attrs:{id:"ros-2-listener"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-listener"}},[t._v("#")]),t._v(" ROS 2 Listener")]),t._v(" "),e("p",[t._v("The ROS 2 "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/tree/main/src/examples/listeners",target:"_blank",rel:"noopener noreferrer"}},[t._v("listener examples"),e("OutboundLink")],1),t._v(" in the "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com",target:"_blank",rel:"noopener noreferrer"}},[t._v("px4_ros_com"),e("OutboundLink")],1),t._v(" repo demonstrate how to write ROS nodes to listen to topics published by PX4.")]),t._v(" "),e("p",[t._v("Here we consider the "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/src/examples/listeners/sensor_combined_listener.cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("sensor_combined_listener.cpp"),e("OutboundLink")],1),t._v(" node under "),e("code",[t._v("px4_ros_com/src/examples/listeners")]),t._v(", which subscribes to the "),e("RouterLink",{attrs:{to:"/zh/msg_docs/SensorCombined.html"}},[t._v("SensorCombined")]),t._v(" message.")],1),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[e("a",{attrs:{href:"#build-ros-2-workspace"}},[t._v("Build ROS 2 Workspace")]),t._v(" shows how to build and run this example.")])]),t._v(" "),e("p",[t._v("The code first imports the C++ libraries needed to interface with the ROS 2 middleware and the header file for the "),e("code",[t._v("SensorCombined")]),t._v(" message to which the node subscribes:")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token macro property"}},[e("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<rclcpp/rclcpp.hpp>")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token macro property"}},[e("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<px4_msgs/msg/sensor_combined.hpp>")])]),t._v("\n")])])]),e("p",[t._v("Then it creates a "),e("code",[t._v("SensorCombinedListener")]),t._v(" class that subclasses the generic "),e("code",[t._v("rclcpp::Node")]),t._v(" base class.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @brief Sensor Combined uORB topic data callback\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SensorCombinedListener")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token base-clause"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),e("p",[t._v("This creates a callback function for when the "),e("code",[t._v("SensorCombined")]),t._v(" uORB messages are received (now as micro XRCE-DDS messages), and outputs the content of the message fields each time the message is received.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("explicit")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("SensorCombinedListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Node")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sensor_combined_listener"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        rmw_qos_profile_t qos_profile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rmw_qos_profile_sensor_data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" qos "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("QoSInitialization")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("qos_profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("history"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos_profile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        subscription_ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_subscription")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/fmu/out/sensor_combined"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" qos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("UniquePtr msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RECEIVED SENSOR COMBINED DATA"')]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"============================="')]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ts: "')]),t._v("          "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("timestamp    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[0]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[1]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_rad[2]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_rad"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gyro_integral_dt: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("gyro_integral_dt "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_timestamp_relative: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_timestamp_relative "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[0]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[1]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_m_s2[2]: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_m_s2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accelerometer_integral_dt: "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" msg"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("accelerometer_integral_dt "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("The subscription sets a QoS profile based on "),e("code",[t._v("rmw_qos_profile_sensor_data")]),t._v(". This is needed because the default ROS 2 QoS profile for subscribers is incompatible with the PX4 profile for publishers. For more information see: "),e("a",{attrs:{href:"#ros-2-subscriber-qos-settings"}},[t._v("ROS 2 Subscriber QoS Settings")]),t._v(",")])]),t._v(" "),e("p",[t._v("The lines below create a publisher to the "),e("code",[t._v("SensorCombined")]),t._v(" uORB topic, which can be matched with one or more compatible ROS 2 subscribers to the "),e("code",[t._v("fmu/sensor_combined/out")]),t._v(" ROS 2 topic.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("Subscription"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SensorCombined"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr subscription_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("The instantiation of the "),e("code",[t._v("SensorCombinedListener")]),t._v(" class as a ROS node is done on the "),e("code",[t._v("main")]),t._v(" function.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Starting sensor_combined listener node..."')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setvbuf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _IONBF"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BUFSIZ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("spin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SensorCombinedListener"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("This particular example has an associated launch file at "),e("a",{attrs:{href:"https://github.com/PX4/px4_ros_com/blob/main/launch/sensor_combined_listener.launch.py",target:"_blank",rel:"noopener noreferrer"}},[t._v("launch/sensor_combined_listener.launch.py"),e("OutboundLink")],1),t._v(". This allows it to be launched using the "),e("a",{attrs:{href:"#ros2-launch"}},[e("code",[t._v("ros2 launch")])]),t._v(" command.")]),t._v(" "),e("h3",{attrs:{id:"ros-2-advertiser"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros-2-advertiser"}},[t._v("#")]),t._v(" ROS 2 Advertiser")]),t._v(" "),e("p",[t._v("A ROS 2 advertiser node publishes data into the DDS/RTPS network (and hence to the PX4 Autopilot).")]),t._v(" "),e("p",[t._v("Taking as an example the "),e("code",[t._v("debug_vect_advertiser.cpp")]),t._v(" under "),e("code",[t._v("px4_ros_com/src/advertisers")]),t._v(", first we import required headers, including the "),e("code",[t._v("debug_vect")]),t._v(" msg header.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token macro property"}},[e("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<chrono>")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token macro property"}},[e("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<rclcpp/rclcpp.hpp>")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token macro property"}},[e("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<px4_msgs/msg/debug_vect.hpp>")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono_literals"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Then the code creates a "),e("code",[t._v("DebugVectAdvertiser")]),t._v(" class that subclasses the generic "),e("code",[t._v("rclcpp::Node")]),t._v(" base class.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DebugVectAdvertiser")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token base-clause"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),e("p",[t._v("The code below creates a function for when messages are to be sent. The messages are sent based on a timed callback, which sends two messages per second based on a timer.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("DebugVectAdvertiser")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Node")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debug_vect_advertiser"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        publisher_ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_publisher")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("DebugVect"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fmu/debug_vect/in"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" timer_callback "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" debug_vect "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("DebugVect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timestamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("time_point_cast")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("microseconds"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("chrono"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("steady_clock"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("time_since_epoch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("string name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("begin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("begin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("z "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RCLCPP_INFO")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_logger")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\033[97m Publishing debug_vect: time: %llu x: %f y: %f z: %f \\033[0m"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timestamp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("z"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("publisher_"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("publish")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("debug_vect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        timer_ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_wall_timer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v("ms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timer_callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("TimerBase"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr timer_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("Publisher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("px4_msgs"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("DebugVect"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("SharedPtr publisher_"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("The instantiation of the "),e("code",[t._v("DebugVectAdvertiser")]),t._v(" class as a ROS node is done on the "),e("code",[t._v("main")]),t._v(" function.")]),t._v(" "),e("div",{staticClass:"language-cpp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("cout "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Starting debug_vect advertiser node..."')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),t._v("endl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setvbuf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _IONBF"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BUFSIZ"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("spin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("std"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token generic-function"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("DebugVectAdvertiser"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    rclcpp"),e("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"offboard-control"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#offboard-control"}},[t._v("#")]),t._v(" Offboard Control")]),t._v(" "),e("p",[t._v("For a complete reference example on how to use Offboard control with PX4, see: "),e("RouterLink",{attrs:{to:"/zh/ros/ros2_offboard_control.html"}},[t._v("ROS 2 Offboard control example")]),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"using-flight-controller-hardware"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-flight-controller-hardware"}},[t._v("#")]),t._v(" Using Flight Controller Hardware")]),t._v(" "),e("p",[t._v("ROS 2 with PX4 running on a flight controller is almost the same as working with PX4 on the simulator. The only difference is that you need to start both the agent "),e("em",[t._v("and the client")]),t._v(", with settings appropriate for the communication channel.")]),t._v(" "),e("p",[t._v("For more information see "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html#starting-agent-and-client"}},[t._v("Starting uXRCE-DDS")]),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"custom-uorb-topics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#custom-uorb-topics"}},[t._v("#")]),t._v(" Custom uORB Topics")]),t._v(" "),e("p",[t._v("ROS 2 needs to have the "),e("em",[t._v("same")]),t._v(" message definitions that were used to create the uXRCE-DDS client module in the PX4 Firmware in order to interpret the messages. The definition are stored in the ROS 2 interface package "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),e("OutboundLink")],1),t._v(" and they are automatically synchronized by CI on the "),e("code",[t._v("main")]),t._v(" and release branches. Note that all the messages from PX4 source code are present in the repository, but only those listed in "),e("code",[t._v("dds_topics.yaml")]),t._v(" will be available as ROS 2 topics. Therefore,")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("If you're using a main or release version of PX4 you can get the message definitions by cloning the interface package "),e("a",{attrs:{href:"https://github.com/PX4/px4_msgs",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4/px4_msgs"),e("OutboundLink")],1),t._v(" into your workspace.")])]),t._v(" "),e("li",[e("p",[t._v("If you're creating or modifying uORB messages you must manually update the messages in your workspace from your PX4 source tree. Generally this means that you would update "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),e("OutboundLink")],1),t._v(", clone the interface package, and then manually synchronize it by copying the new/modified message definitions from "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/tree/release/1.14/msg",target:"_blank",rel:"noopener noreferrer"}},[t._v("PX4-Autopilot/msg"),e("OutboundLink")],1),t._v(" to its "),e("code",[t._v("msg")]),t._v(" folders. Assuming that PX4-Autopilot is in your home directory "),e("code",[t._v("~")]),t._v(", while "),e("code",[t._v("px4_msgs")]),t._v(" is in "),e("code",[t._v("~/px4_ros_com/src/")]),t._v(", then the command might be:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" ~/px4_ros_com/src/px4_msgs/msg/*.msg\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" ~/PX4-Autopilot/mgs/*.msg ~/px4_ros_com/src/px4_msgs/msg/\n")])])])])]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("Technically, "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),e("OutboundLink")],1),t._v(" completely defines the relationship between PX4 uORB topics and ROS 2 messages. For more information see "),e("RouterLink",{attrs:{to:"/zh/middleware/uxrce_dds.html#dds-topics-yaml"}},[t._v("uXRCE-DDS > DDS Topics YAML")]),t._v(".")],1)]),t._v(" "),e("h2",{attrs:{id:"customizing-the-topic-namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#customizing-the-topic-namespace"}},[t._v("#")]),t._v(" Customizing the Topic Namespace")]),t._v(" "),e("p",[t._v("Custom topic namespaces can be applied at build time (changing "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),e("OutboundLink")],1),t._v(") or at runtime (useful for multi vehicle operations):")]),t._v(" "),e("ul",[e("li",[t._v("One possibility is to use the "),e("code",[t._v("-n")]),t._v(" option when starting the "),e("RouterLink",{attrs:{to:"/zh/modules/modules_system.html#uxrce-dds-client"}},[t._v("uxrce_dds_client")]),t._v(" from command line. This technique can be used both in simulation and real vehicles.")],1),t._v(" "),e("li",[t._v("A custom namespace can be provided for simulations (only) by setting the environment variable "),e("code",[t._v("PX4_UXRCE_DDS_NS")]),t._v(" before starting the simulation.")])]),t._v(" "),e("div",{staticClass:"custom-block note"},[e("p",{staticClass:"custom-block-title"},[t._v("注解")]),t._v(" "),e("p",[t._v("Changing the namespace at runtime will append the desired namespace as a prefix to all "),e("code",[t._v("topic")]),t._v(" fields in "),e("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/release/1.14/src/modules/uxrce_dds_client/dds_topics.yaml",target:"_blank",rel:"noopener noreferrer"}},[t._v("dds_topics.yaml"),e("OutboundLink")],1),t._v(". Therefore, commands like:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("uxrce_dds_client start -n uav_1\n")])])]),e("p",[t._v("or")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PX4_UXRCE_DDS_NS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("uav_1 "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" px4_sitl gz_x500\n")])])]),e("p",[t._v("will generate topics under the namespaces:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("/uav_1/fmu/in/  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for subscribers")]),t._v("\n/uav_1/fmu/out/ "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for publishers")]),t._v("\n")])])])]),t._v(" "),e("h2",{attrs:{id:"ros2-cli"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros2-cli"}},[t._v("#")]),t._v(" ros2 CLI")]),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ros2 CLI"),e("OutboundLink")],1),t._v(" is a useful tool for working with ROS. You can use it, for example, to quickly check whether topics are being published, and also inspect them in detail if you have "),e("code",[t._v("px4_msg")]),t._v(" in the workspace. The command also lets you launch more complex ROS systems via a launch file. A few possibilities are demonstrated below.")]),t._v(" "),e("h3",{attrs:{id:"ros2-topic-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-list"}},[t._v("#")]),t._v(" ros2 topic list")]),t._v(" "),e("p",[t._v("Use "),e("code",[t._v("ros2 topic list")]),t._v(" to list the topics visible to ROS 2:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("ros2 topic list\n")])])]),e("p",[t._v("If PX4 is connected to the agent, the result will be a list of topic types:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("/fmu/in/obstacle_distance\n/fmu/in/offboard_control_mode\n/fmu/in/onboard_computer_status\n...\n")])])]),e("p",[t._v("Note that the workspace does not need to build with "),e("code",[t._v("px4_msgs")]),t._v(" for this to succeed; topic type information is part of the message payload.")]),t._v(" "),e("h3",{attrs:{id:"ros2-topic-echo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-echo"}},[t._v("#")]),t._v(" ros2 topic echo")]),t._v(" "),e("p",[t._v("Use "),e("code",[t._v("ros2 topic echo")]),t._v(" to show the details of a particular topic.")]),t._v(" "),e("p",[t._v("Unlike with "),e("code",[t._v("ros2 topic list")]),t._v(", for this to work you must be in a workspace has built the "),e("code",[t._v("px4_msgs")]),t._v(" and sourced "),e("code",[t._v("local_setup.bash")]),t._v(" so that ROS can interpret the messages.")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("ros2 topic "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" /fmu/out/vehicle_status\n")])])]),e("p",[t._v("The command will echo the topic details as they update.")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("---\ntimestamp: 1675931593364359\narmed_time: 0\ntakeoff_time: 0\narming_state: 1\nlatest_arming_reason: 0\nlatest_disarming_reason: 0\nnav_state_timestamp: 3296000\nnav_state_user_intention: 4\nnav_state: 4\nfailure_detector_status: 0\nhil_state: 0\n...\n---\n")])])]),e("h3",{attrs:{id:"ros2-topic-hz"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros2-topic-hz"}},[t._v("#")]),t._v(" ros2 topic hz")]),t._v(" "),e("p",[t._v("You can get statistics about the rates of messages using "),e("code",[t._v("ros2 topic hz")]),t._v(". For example, to get the rates for "),e("code",[t._v("SensorCombined")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ros2 topic hz /fmu/out/sensor_combined\n")])])]),e("p",[t._v("The output will look something like:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("average rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("248.187")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00147s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2724")]),t._v("\naverage rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("248.006")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00147s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2972")]),t._v("\naverage rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.330")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00148s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3212")]),t._v("\naverage rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.497")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00149s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3464")]),t._v("\naverage rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.458")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00149s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3712")]),t._v("\naverage rate: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("247.485")]),t._v("\n  min: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".000s max: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".012s std dev: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".00148s window: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3960")]),t._v("\n")])])]),e("h3",{attrs:{id:"ros2-launch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ros2-launch"}},[t._v("#")]),t._v(" ros2 launch")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("ros2 launch")]),t._v(" command is used to start a ROS 2 launch file. For example, above we used "),e("code",[t._v("ros2 launch px4_ros_com sensor_combined_listener.launch.py")]),t._v(" to start the listener example.")]),t._v(" "),e("p",[t._v("You don't need to have a launch file, but they are very useful if you have a complex ROS 2 system that needs to start several components.")]),t._v(" "),e("p",[t._v("For information about launch files see "),e("a",{attrs:{href:"https://docs.ros.org/en/humble/Tutorials/Intermediate/Launch/Creating-Launch-Files.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS 2 Tutorials > Creating launch files"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"troubleshooting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),e("h3",{attrs:{id:"missing-dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#missing-dependencies"}},[t._v("#")]),t._v(" Missing dependencies")]),t._v(" "),e("p",[t._v("The standard installation should include all the tools needed by ROS 2.")]),t._v(" "),e("p",[t._v("If any are missing, they can be added separately:")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[e("code",[t._v("colcon")])]),t._v(" build tools should be in the development tools. It can be installed using:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" python3-colcon-common-extensions\n")])])])]),t._v(" "),e("li",[e("p",[t._v("The Eigen3 library used by the transforms library should be in the both the desktop and base packages. It should be installed as shown:")]),t._v(" "),e("tabs",[e("tab",{attrs:{name:"humble"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-humble-eigen3-cmake-module\n")])])])])],1)],1)]),t._v(" "),e("p",[t._v(":::")]),t._v(" "),e("tab",{attrs:{name:"foxy"}},[e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ros-foxy-eigen3-cmake-module\n")])])])]),t._v(" "),e("p",[t._v("::::")]),t._v(" "),e("h2",{attrs:{id:"additional-information"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#additional-information"}},[t._v("#")]),t._v(" Additional information")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.youtube.com/watch?v=F5oelooT67E",target:"_blank",rel:"noopener noreferrer"}},[t._v("ROS 2 in PX4: Technical Details of a Seamless Transition to XRCE-DDS"),e("OutboundLink")],1),t._v(" - Pablo Garrido & Nuno Marques (youtube)")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/ros2/ros2/wiki/DDS-and-ROS-middleware-implementations",target:"_blank",rel:"noopener noreferrer"}},[t._v("DDS and ROS middleware implementations"),e("OutboundLink")],1)])])],1)}),[],!1,null,null,null);s.default=n.exports}}]);