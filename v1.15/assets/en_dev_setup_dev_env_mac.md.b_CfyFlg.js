import{_ as a,c as e,o as t,ab as i,m as s}from"./chunks/framework.CUflZczI.js";const y=JSON.parse('{"title":"MacOS Development Environment","description":"","frontmatter":{},"headers":[],"relativePath":"en/dev_setup/dev_env_mac.md","filePath":"en/dev_setup/dev_env_mac.md"}'),n={name:"en/dev_setup/dev_env_mac.md"},l=i('<h1 id="macos-development-environment" tabindex="-1">MacOS Development Environment <a class="header-anchor" href="#macos-development-environment" aria-label="Permalink to &quot;MacOS Development Environment&quot;">​</a></h1><p>The following instructions set up a PX4 development environment for macOS. This environment can be used to build PX4 for:</p><ul><li>Pixhawk and other NuttX-based hardware</li><li><a href="./../sim_gazebo_classic/">Gazebo Classic Simulation</a></li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This setup is supported by the PX4 dev team. To build other targets you will need to use a <a href="./../dev_setup/dev_env.html#supported-targets">different OS</a> (or an <a href="./../advanced/community_supported_dev_env.html">unsupported development environment</a>).</p></div><h2 id="video-guide" tabindex="-1">Video Guide <a class="header-anchor" href="#video-guide" aria-label="Permalink to &quot;Video Guide&quot;">​</a></h2>',5),h=s("p",null,[s("div",{class:"embed-responsive embed-responsive-16by9"},[s("iframe",{class:"embed-responsive-item youtube-player",type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/tMbMGiMs1cQ",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""})])],-1),p=i(`<h2 id="base-setup" tabindex="-1">Base Setup <a class="header-anchor" href="#base-setup" aria-label="Permalink to &quot;Base Setup&quot;">​</a></h2><p>The &quot;base&quot; macOS setup installs the tools needed for building firmware, and includes the common tools that will be needed for installing/using the simulators.</p><h3 id="environment-setup" tabindex="-1">Environment Setup <a class="header-anchor" href="#environment-setup" aria-label="Permalink to &quot;Environment Setup&quot;">​</a></h3><details class="details custom-block"><summary>Apple M1 Macbook users!</summary><p>If you have an Apple M1 Macbook, make sure to run the terminal as x86 by setting up an x86 terminal:</p><ol><li>Locate the Terminal application within the Utilities folder (<strong>Finder &gt; Go menu &gt; Utilities</strong>)</li><li>Select <em>Terminal.app</em> and right-click on it, then choose <strong>Duplicate</strong>.</li><li>Rename the duplicated Terminal app, e.g. to <em>x86 Terminal</em></li><li>Now select the renamed <em>x86 Terminal</em> app and right-click and choose *<em>Get Info</em></li><li>Check the box for <strong>Open using Rosetta</strong>, then close the window</li><li>Run the <em>x86 Terminal</em> as usual, which will fully support the current PX4 toolchain</li></ol></details><p>First set up the environment</p><ol><li><p>Enable more open files by appending the following line to the <code>~/.zshenv</code> file (creating it if necessary):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ulimit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2048</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.zshenv</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you don&#39;t do this, the build toolchain may report the error: <code>&quot;LD: too many open files&quot;</code></p></div></li><li><p>Enforce Python 3 by appending the following lines to <code>~/.zshenv</code></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Point pip3 to MacOS system python 3 pip</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pip3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/usr/bin/pip3</span></span></code></pre></div></li></ol><h3 id="common-tools" tabindex="-1">Common Tools <a class="header-anchor" href="#common-tools" aria-label="Permalink to &quot;Common Tools&quot;">​</a></h3><p>To setup the environment to be able to build for Pixhawk/NuttX hardware (and install the common tools for using simulators):</p><ol><li><p>Install Homebrew by following these <a href="https://brew.sh" target="_blank" rel="noreferrer">installation instructions</a>.</p></li><li><p>Run these commands in your shell to install the common tools:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PX4/px4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4-dev</span></span></code></pre></div></li><li><p>Install the required Python packages:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># install required packages using pip3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyserial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> toml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> numpy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pandas</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jinja2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyyaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyros-genmsg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packaging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kconfiglib</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> future</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jsonschema</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># if this fails with a permissions error, your Python install is in a system path - use this command instead:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyserial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> empty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> toml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> numpy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pandas</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jinja2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyyaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyros-genmsg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packaging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kconfiglib</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> future</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jsonschema</span></span></code></pre></div></li></ol><h2 id="gazebo-classic-simulation" tabindex="-1">Gazebo Classic Simulation <a class="header-anchor" href="#gazebo-classic-simulation" aria-label="Permalink to &quot;Gazebo Classic Simulation&quot;">​</a></h2><p>To setup the environment for <a href="./../sim_gazebo_classic/">Gazebo Classic</a> simulation:</p><ol><li><p>Run the following commands in your shell:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tbb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i.bak</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/disable! date:/s/^/  /; /disable! date:/s/./#/3&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --prefix</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)/Library/Taps/homebrew/homebrew-core/Formula/tbb@2020.rb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tbb@2020</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> link</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tbb@2020</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>September 2021: The commands above are a workaround to this bug: <a href="https://github.com/PX4/PX4-Autopilot/issues/17644" target="_blank" rel="noreferrer">PX4-Autopilot#17644</a>. They can be removed once it is fixed (along with this note).</p></div></li><li><p>To install SITL simulation with Gazebo Classic:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cask</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> temurin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cask</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xquartz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4-sim-gazebo</span></span></code></pre></div></li><li><p>Run the macOS setup script: <code>PX4-Autopilot/Tools/setup/macos.sh</code> The easiest way to do this is to clone the PX4 source, and then run the script from the directory, as shown:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/PX4/PX4-Autopilot.git</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recursive</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PX4-Autopilot/Tools/setup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> macos.sh</span></span></code></pre></div></li></ol><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><p>Once you have finished setting up the command-line toolchain:</p><ul><li><p>Install <a href="./../dev_setup/vscode.html">VSCode</a> (if you prefer using an IDE to the command line).</p></li><li><p>Install the <a href="./../dev_setup/qgc_daily_build.html">QGroundControl Daily Build</a></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The <em>daily build</em> includes development tools that are hidden in release builds. It may also provide access to new PX4 features that are not yet supported in release builds.</p></div></li><li><p>Continue to the <a href="./../dev_setup/building_px4.html">build instructions</a>.</p></li></ul>`,15),o=[l,h,p];function r(k,d,c,F,u,g){return t(),e("div",null,o)}const b=a(n,[["render",r]]);export{y as __pageData,b as default};
