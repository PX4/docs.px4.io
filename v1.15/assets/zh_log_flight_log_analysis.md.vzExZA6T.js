import{_ as s,a as i,b as a,c as l,d as t,e}from"./chunks/data_comets_overview.BoCX1W2Y.js";import{_ as n,c as h,o as p,ab as o}from"./chunks/framework.CUflZczI.js";const _=JSON.parse('{"title":"飞行日志分析","description":"","frontmatter":{},"headers":[],"relativePath":"zh/log/flight_log_analysis.md","filePath":"zh/log/flight_log_analysis.md"}'),r={name:"zh/log/flight_log_analysis.md"},k=o('<h1 id="飞行日志分析" tabindex="-1">飞行日志分析 <a class="header-anchor" href="#飞行日志分析" aria-label="Permalink to &quot;飞行日志分析&quot;">​</a></h1><p>This topic provide an overview of the tools and methods that can be used to analyze PX4 flight logs (more detailed topics are linked below in some cases).</p><div class="info custom-block"><p class="custom-block-title">INFO <a href="./../getting_started/flight_reporting.html">Flight Reporting</a> explains how to download a log and report/discuss issues about a flight with the development team.</p></div><h2 id="结构化分析" tabindex="-1">结构化分析 <a class="header-anchor" href="#结构化分析" aria-label="Permalink to &quot;结构化分析&quot;">​</a></h2><p>在分析飞行日志之前，重要的是建立它的上下文：</p><ul><li>如果分析是在故障发生之后进行的，那么日志是捕捉到了这次故障还是在半空中停止了记录呢？</li><li>所有的控制器都跟踪到了它的设定值吗？ 最简单的方法是将的横滚和俯仰的角速度与它们的设定值进行比较。</li><li>传感器数据看起来有效吗？ Was there very strong vibration (a reasonable threshold for strong vibration is anything with a peak-to-peak of more than 2-3 m/s/s).</li><li>If the root cause is not specific to the vehicle make sure to report it with a link to the log file (and video if one exists) on the <a href="https://github.com/PX4/PX4-Autopilot/issues/new" target="_blank" rel="noreferrer">PX4 issue tracker</a>.</li></ul><h2 id="排除电力故障" tabindex="-1">排除电力故障 <a class="header-anchor" href="#排除电力故障" aria-label="Permalink to &quot;排除电力故障&quot;">​</a></h2><p>If a log file ends mid-air, two main causes are possible: a power failure <em>or</em> a hard fault of the operating system.</p><p>On autopilots based on the <a href="http://www.st.com/en/microcontrollers/stm32-32-bit-arm-cortex-mcus.html" target="_blank" rel="noreferrer">STM32 series</a>, hard faults are logged to the SD card. These are located on the top level of the SD card and named <em>fault_date.log</em>, e.g. <strong>fault_2017_04_03_00_26_05.log</strong>. You should check for the presence of this file if a flight log ends abruptly.</p><h2 id="分析工具" tabindex="-1">分析工具 <a class="header-anchor" href="#分析工具" aria-label="Permalink to &quot;分析工具&quot;">​</a></h2><h3 id="flight-review-在线工具" tabindex="-1">Flight Review（在线工具） <a class="header-anchor" href="#flight-review-在线工具" aria-label="Permalink to &quot;Flight Review（在线工具）&quot;">​</a></h3><p><a href="http://logs.px4.io" target="_blank" rel="noreferrer">Flight Review</a> is the successor of <em>Log Muncher</em>. 他能与新的 <a href="./../dev_log/ulog_file_format.html">ULog</a> 日志格式结合使用。</p><p>主要特性：</p><ul><li>基于 web，非常适合终端用户。</li><li>Users can upload logs through the web interface, and then share report with others (bulk upload is supported using the <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/Tools/upload_log.py" target="_blank" rel="noreferrer">upload_log.py</a> script)</li><li>交互式绘图。</li></ul><p><img src="'+s+'" alt="Flight Review Charts"></p><p>See <a href="./../log/flight_review.html">Log Analysis using Flight Review</a> for an introduction.</p><h3 id="plotjugler" tabindex="-1">PlotJugler <a class="header-anchor" href="#plotjugler" aria-label="Permalink to &quot;PlotJugler&quot;">​</a></h3><p><a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">PlotJuggler</a> is a desktop application that allows users to easily visualize and analyze data expressed in the form of time series. This is one of the best ULog analysis tools as it exposes all information in the log (<a href="#flight-review-online-tool">Flight Review</a>, by comparison, only shows a small subset of the data).</p><p>It supports ULog files (.ulg) since version 2.1.4.</p><p>主要特性：</p><ul><li>Intuitive drag &amp; drop interface.</li><li>可以将数据安排在多个图表、选项卡或窗口中。</li><li>All uORB topics are shown and can be graphed.</li><li>整理好数据后，将其保存到“布局”文件中，这样支持多次重新加载。</li><li>Process your data inside <em>PlotJuggler</em> itself, using custom &quot;data transformations&quot;.</li></ul><p>Source code and downloads are available on <a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">Github</a>.</p><p><img src="'+i+`" alt="PlotJugler"></p><p>See <a href="./../log/plotjuggler_log_analysis.html">Log Analysis using Plot Juggler</a> for an introduction.</p><h3 id="pyulog" tabindex="-1">pyulog <a class="header-anchor" href="#pyulog" aria-label="Permalink to &quot;pyulog&quot;">​</a></h3><p><a href="https://github.com/PX4/pyulog" target="_blank" rel="noreferrer">pyulog</a> 是用于分析 ulog 文件的 python 包，以及一组用于提取/显示 ulog 信息并转换为其他文件格式的命令行脚本。</p><p>主要特性：</p><ul><li>用于分析 ulog 文件的 python 库。 许多其他 ULog 分析和可视化工具使用的基本库。</li><li>提取/显示 ulog 信息的脚本： <ul><li><em>ulog_info</em>: display information from an ULog file.</li><li><em>ulog_messages</em>: display logged messages from an ULog file.</li><li><em>ulog_params</em>: extract parameters from an ULog file.</li></ul></li><li>转换 ulog 文件为其他格式的脚本： <ul><li><em>ulog2csv</em>: convert ULog to (several) CSV files.</li><li><em>ulog2kml</em>: convert ULog to (several) KML files.</li></ul></li></ul><p>所有脚本都作为系统范围的应用程序安装 (例如，在命令行上调用它们-前提是安装了 Python)，并支持 <code>-h</code> 标志来获取使用说明。 例如：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ulog_info</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">usage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ulog_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-h] [-v] file.ulg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Display</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> information</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ULog</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">positional</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  file.ulg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       ULog</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 输入文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optional</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     显示这个帮助信息然后退出</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -v,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --verbose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  详细输出</span></span></code></pre></div><p>Below we see the kind of information exported from a sample file using <em>ulog_info</em>.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ulog_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sample.ulg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Logging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0:01:52,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duration:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0:01:08</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Dropouts:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> duration:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> max:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 62</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mean:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ms</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Messages:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sys_name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PX4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> time_ref_utc:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ver_hw:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AUAV_X21</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ver_sw:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fd483321a5cf50ead91164356d15aa474643aa73</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (multi </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">id,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    number of data points, total bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> actuator_controls_0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">48</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                 3269     156912</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> actuator_outputs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">76</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                    1311      99636</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> commander_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                       678       6102</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> control_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">122</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                      3268     398696</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cpuload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                               69       1104</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ekf2_innovations</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">140</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                   3271     457940</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> estimator_status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">309</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                   1311     405099</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sensor_combined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">72</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                    17070    1229040</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sensor_preflight</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                   17072     273152</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> telemetry_status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">36</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                      70       2520</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vehicle_attitude</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">36</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                    6461     232596</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vehicle_attitude_setpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)           3272     179960</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vehicle_local_position</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)              678      83394</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vehicle_rates_setpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)              6448     154752</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vehicle_status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                       294      13230</span></span></code></pre></div><h3 id="flightplot" tabindex="-1">FlightPlot <a class="header-anchor" href="#flightplot" aria-label="Permalink to &quot;FlightPlot&quot;">​</a></h3><p><a href="https://github.com/PX4/FlightPlot" target="_blank" rel="noreferrer">FlightPlot</a> is a desktop based tool for log analysis. It can be downloaded from <a href="https://github.com/PX4/FlightPlot/releases" target="_blank" rel="noreferrer">FlightPlot Downloads</a> (Linux, MacOS, Windows).</p><p>主要特性：</p><ul><li>基于 Java 的，跨平台的</li><li>直观的图形用户界面，不需要编程知识</li><li>支持新的和旧的 PX4 日志格式 (比如 .px4log，.ulg，.bin)</li><li>允许保存图形为图像</li></ul><p><img src="`+a+'" alt="FlightPlot Charts"></p><h3 id="px4tools" tabindex="-1">PX4Tools <a class="header-anchor" href="#px4tools" aria-label="Permalink to &quot;PX4Tools&quot;">​</a></h3><p><a href="https://github.com/dronecrew/px4tools" target="_blank" rel="noreferrer">PX4Tools</a> is a log analysis toolbox for the PX4 autopilot written in Python. The recommended installation procedure is to use <a href="https://conda.io/docs/index.html" target="_blank" rel="noreferrer">anaconda3</a>. See <a href="https://github.com/dronecrew/px4tools" target="_blank" rel="noreferrer">px4tools github page</a> for details.</p><p>主要特性：</p><ul><li>Easy to share, users can view notebooks on Github (e.g. <a href="https://github.com/jgoppert/lpe-analysis/blob/master/15-09-30%20Kabir%20Log.ipynb" target="_blank" rel="noreferrer">15-09-30 Kabir Log.ipynb</a>)</li><li>Python based, cross platform, works with anaconda 2 and anaconda3</li><li>使用 iPython/jupyter notebooks 可以方便地共享分析</li><li>高级绘图功能，允许进行详细分析</li></ul><p><img src="'+l+'" alt="PX4Tools-based analysis"></p><h3 id="mavgcl" tabindex="-1">MAVGCL <a class="header-anchor" href="#mavgcl" aria-label="Permalink to &quot;MAVGCL&quot;">​</a></h3><p><a href="https://github.com/ecmnet/MAVGCL" target="_blank" rel="noreferrer">MAVGCL</a> is an in-flight log analyzer for PX4. It can also be used in offline mode with downloaded uLog files.</p><p>主要特性：</p><ul><li>基于 MAVLink 消息或 MAVLink 上 ULOG 数据的实时数据采集( 50 ms 采样，100 ms 滚动显示)</li><li>由消息( MAVLink 和 ULog) 和参数更改(仅 MAVLink) 注释的时间图</li><li>选定的关键指标的 XY 分析</li><li>3D 视图 (飞行器和观察者视角)</li><li>MAVLink inspector 面板(报告原始 MAVLink 消息)</li><li>离线模式：从 PX4Log/ULog 导入关键指标(通过 WiFi 从设备上获取文件或最后一次日志)</li><li>基于 Java 在 MacOS 和 Ubuntu 上运行。</li><li>更多……</li></ul><p><img src="'+t+'" alt="MAVGCL"></p><h3 id="data-comets" tabindex="-1">Data Comets <a class="header-anchor" href="#data-comets" aria-label="Permalink to &quot;Data Comets&quot;">​</a></h3><p><a href="https://github.com/dsaffo/DataComets" target="_blank" rel="noreferrer">Data Comets</a> is a interactive PX4 flight log analysis tool that allows you to encode flight data onto the flight path, filter and brush the data by time - and much more!</p><p>You can use the online version of the tool for small log files (&lt; 32Mb), or run it locally in order to analyze longer flights.</p><p><img src="'+e+'" alt="Data Comets"></p>',51),g=[k];function d(F,c,u,y,E,m){return p(),h("div",null,g)}const b=n(r,[["render",d]]);export{_ as __pageData,b as default};
