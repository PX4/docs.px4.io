import{_ as e,c as a,o as r,ab as t}from"./chunks/framework.CUflZczI.js";const k=JSON.parse('{"title":"Камери MAVLink (Протокол камери v2)","description":"","frontmatter":{},"headers":[],"relativePath":"uk/camera/mavlink_v2_camera.md","filePath":"uk/camera/mavlink_v2_camera.md"}'),i={name:"uk/camera/mavlink_v2_camera.md"},n=t('<h1 id="камери-mavlink-протокол-камери-v2" tabindex="-1">Камери MAVLink (Протокол камери v2) <a class="header-anchor" href="#камери-mavlink-протокол-камери-v2" aria-label="Permalink to &quot;Камери MAVLink (Протокол камери v2)&quot;">​</a></h1><p>Ця тема пояснює, як використовувати PX4 з MAVLink <a href="./../camera/">камера</a>, що реалізує [MAVLink Camera Protocol v2] (<a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">https://mavlink.io/en/services/camera.html</a>) з PX4 та Наземною Станцією.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Це рекомендований спосіб інтеграції камери з PX4!</p></div><h2 id="огляд" tabindex="-1">Огляд <a class="header-anchor" href="#огляд" aria-label="Permalink to &quot;Огляд&quot;">​</a></h2><p><a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">Протокол камери MAVLink v2</a> дозволяє запитувати, які функції підтримуються камерою, і надає команди для керування захопленням зображень та відео, передачі відео, встановлення зуму та фокусу, вибору між інфрачервоними та видимими потоками світла, встановлення місця, куди зберігаються зібрані дані, та інше.</p><p>Камера може реалізувати протокол на рівні системи, але більшість налаштувань камер MAVLink передбачають взаємодію PX4 з <a href="#camera-managers">менеджером камер</a>, що працює на супутниковому комп&#39;ютері, який потім взаємодіє між MAVLink та вихідним протоколом камери.</p><p>Загалом можна сказати, що &quot;інтеграція&quot; PX4 з камерою полягає в повторному відтворенні команд камери, знайдених у місіях за допомогою протоколу команд. В іншому випадку вона може діяти як міст, пересилаючи команди між земною станцією та камерою, якщо немає прямого каналу MAVLink.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>PX4 не підтримує використання команд <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">MAVLink Протокол Камери v2</a> для управління камерами, які підключені до виходів контролера польоту. Хоча це технічно можливо, це вимагатиме від PX4 реалізації інтерфейсу керування камерою.</p></div><h2 id="керування-камерою" tabindex="-1">Керування камерою <a class="header-anchor" href="#керування-камерою" aria-label="Permalink to &quot;Керування камерою&quot;">​</a></h2><h3 id="команди-та-повідомлення-mavlink" tabindex="-1">Команди та повідомлення MAVLink <a class="header-anchor" href="#команди-та-повідомлення-mavlink" aria-label="Permalink to &quot;Команди та повідомлення MAVLink&quot;">​</a></h3><p>Камери виявлені за допомогою протоколу підключення MAVLink (<a href="https://mavlink.io/en/services/heartbeat.html" target="_blank" rel="noreferrer">https://mavlink.io/en/services/heartbeat.html</a>), заснованого на їх <a href="https://mavlink.io/en/messages/common.html#HEARTBEAT" target="_blank" rel="noreferrer">HEARTBEAT.type</a>, заснованими на MAV_TYPE_CAMERA (<a href="https://mavlink.io/en/messages/common.html#MAV_TYPE_CAMERA" target="_blank" rel="noreferrer">https://mavlink.io/en/messages/common.html#MAV_TYPE_CAMERA</a>).</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Камери також повинні використовувати ID компонента в рекомендованому діапазоні, такому як <a href="https://mavlink.io/en/messages/common.html#MAV_COMP_ID_CAMERA" target="_blank" rel="noreferrer">MAV_COMP_ID_CAMERA</a>, але, як правило, на це не можна покладатися для перевірки того, що компонент MAVLink є камерою.</p></div><p>Якщо камера виявлена, можна подивитися її властивості та можливості за допомогою <a href="https://mavlink.io/en/messages/common.html#MAV_CMD_REQUEST_MESSAGE" target="_blank" rel="noreferrer">MAV_CMD_REQUEST_MESSAGE</a>, щоб запросити повідомлення <a href="https://mavlink.io/en/messages/common.html#CAMERA_INFORMATION" target="_blank" rel="noreferrer">CAMERA_INFORMATION</a>, а потім інспектувати поле <code>flags</code>, щоб визначити, які стандартні функції в <a href="https://mavlink.io/en/messages/common.html#CAMERA_CAP_FLAGS" target="_blank" rel="noreferrer">CAMERA_CAP_FLAGS</a> підтримуються.</p><p>На основі прапорців ви можете визначити, які інші команди та повідомлення підтримуються камерою. Повний набір повідомлень, команд та констант <a href="https://mavlink.io/en/services/camera.html#messagecommandenum-summary" target="_blank" rel="noreferrer">узагальнено тут</a>.</p><p>Додаткові параметри камери_можуть_бути викриті у <a href="https://mavlink.io/en/services/camera_def.html" target="_blank" rel="noreferrer">файлі-визначенні камери</a>, який зв&#39;язаний з <code>CAMERA_INFORMATION.cam_definition_uri</code>. GCS або SDK можуть відкрити ці параметри через загальний інтерфейс користувача, не маючи розуміння будь-якого контексту. Ці параметри не можуть бути встановлені безпосередньо в місіях і не мають конкретних команд-встановлювачів.</p><p><a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">Протокол камери MAVLink v2</a> описує всі взаємодії більш детально.</p><h3 id="наземні-станціі-mavlink-sdks" tabindex="-1">Наземні станції &amp; MAVLink SDKS <a class="header-anchor" href="#наземні-станціі-mavlink-sdks" aria-label="Permalink to &quot;Наземні станції &amp; MAVLink SDKS&quot;">​</a></h3><p>Наземні станції та MAVLink SDK виявляють камери та їх можливості, як описано в попередньому розділі.</p><p>Наземна станція може використовувати будь-яку функцію, яку надає камера. PX4 не має жодної ролі в цій взаємодії, крім пересилання трафіку MAVLink між камерою та наземною станцією або SDK, якщо потрібно.</p><h3 id="команди-камери-у-місіях" tabindex="-1">Команди камери у місіях <a class="header-anchor" href="#команди-камери-у-місіях" aria-label="Permalink to &quot;Команди камери у місіях&quot;">​</a></h3><p>PX4 дозволяє використовувати наступний піднабір команд <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">Camera Protocol v2</a> під час місій:</p><ul><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_IMAGE_START_CAPTURE" target="_blank" rel="noreferrer">MAV_CMD_IMAGE_START_CAPTURE</a></li><li><a href="https://mavlink.io/en/messages/common.html#MMAV_CMD_IMAGE_STOP_CAPTURE" target="_blank" rel="noreferrer">MAV_CMD_IMAGE_STOP_CAPTURE</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_VIDEO_START_CAPTURE" target="_blank" rel="noreferrer">MAV_CMD_VIDEO_START_CAPTURE</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_VIDEO_STOP_CAPTURE" target="_blank" rel="noreferrer">MAV_CMD_VIDEO_STOP_CAPTURE</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_SET_CAMERA_MODE" target="_blank" rel="noreferrer">MAV_CMD_SET_CAMERA_MODE</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_CMD_SET_CAMERA_ZOOM" target="_blank" rel="noreferrer">MAV_CMD_CMD_SET_CAMERA_ZOOM</a></li><li><a href="https://mavlink.io/en/messages/common.html#MAV_CMD_SET_CAMERA_FOCUS" target="_blank" rel="noreferrer">MAV_CMD_SET_CAMERA_FOCUS</a></li></ul><p>PX4 відновлює команди камери, знайдені в місіях, як команди MAVLink. Системний ідентифікатор випущених команд співпадає з ідентифікатором автопілота. Ідентифікатор компонента команд може відрізнятися. Перші чотири команди адресовані <a href="https://mavlink.io/en/messages/common.html#MAV_COMP_ID_CAMERA" target="_blank" rel="noreferrer">MAV_COMP_ID_CAMERA (100)</a> (якщо у камери є цей ідентифікатор компонента, вона виконає вказану команду). Режим камери, зум та фокусування, команди надсилаються до компонента з ідентифікатором <a href="https://mavlink.io/en/messages/common.html#MAV_COMP_ID_ALL" target="_blank" rel="noreferrer">MAV_COMP_ID_ALL</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>PX4 в даний час ігнорує ідентифікатор цілі камери <code>id</code> в <a href="https://mavlink.io/en/messages/common.html#MAV_CMD_IMAGE_START_CAPTURE" target="_blank" rel="noreferrer">MAV_CMD_IMAGE_START_CAPTURE</a> та інших повідомленнях камери. Див. <a href="https://github.com/PX4/PX4-Autopilot/issues/23083" target="_blank" rel="noreferrer">PX4-Autopilot#23083</a>.</p></div><h3 id="ручне-керування" tabindex="-1">Ручне керування <a class="header-anchor" href="#ручне-керування" aria-label="Permalink to &quot;Ручне керування&quot;">​</a></h3><p>Стіки джойстика можуть бути налаштовані на спрацьовування захоплення зображення або перемикання захоплення відео.</p><p>PX4 видає команди <a href="https://mavlink.io/en/services/camera.html" target="_blank" rel="noreferrer">MAVLink Camera Protocol v2</a>, такі як <code>MAV_CMD_IMAGE_START_CAPTURE</code>, коли натиснута відповідна кнопка джойстика. Ця функція працює лише для цього типу камери та джойстика - підтримки для радіокерованних-контролерів немає.</p><h2 id="конфігурація-px4" tabindex="-1">Конфігурація PX4 <a class="header-anchor" href="#конфігурація-px4" aria-label="Permalink to &quot;Конфігурація PX4&quot;">​</a></h2><h3 id="налаштування-порту-перенаправлення-mavlink" tabindex="-1">Налаштування порту &amp; перенаправлення MAVLink <a class="header-anchor" href="#налаштування-порту-перенаправлення-mavlink" aria-label="Permalink to &quot;Налаштування порту &amp; перенаправлення MAVLink&quot;">​</a></h3><p>Вам потрібно буде надати канал MAVLink для будь-яких підключених камер, щоб PX4 міг висилати будь-які команди камери, знайдені в місіях. Якщо ваша мережа MAVLink така, що PX4 є &quot;між&quot; вашою камерою та наземною станцією, вам також потрібно буде пересилати комунікації, щоб вони могли спілкуватися.</p><p>Спочатку під&#39;єднайте камеру до не використаного послідовного порту на контролері польоту, такого як <code>TELEM2</code> (ви також можете використовувати порт Ethernet, якщо він присутній як на контролері польоту, так і на камері). Потім налаштуйте обраний порт як <a href="./../peripherals/mavlink_peripherals.html">MAVLink Peripheral</a>.</p><p>Документ пояснює, як, але коротко:</p><ol><li>Змініть невикористаний параметр <code>MAV_n_CONFIG</code>, такий як <a href="./../advanced_config/parameter_reference.html#MAV_2_CONFIG">MAV_2_CONFIG</a>, щоб він був присвоєний порту, до якого підключена ваша камера/компаньйонський комп&#39;ютер.</li><li>Встановіть відповідний <a href="./../advanced_config/parameter_reference.html#MAV_2_MODE">MAV_2_MODE</a> на <code>2</code> (На борту). Це забезпечує, що правильний набір повідомлень MAVLink випромінюється для супутнього комп&#39;ютера (або камери).</li><li>Встановіть <a href="./../advanced_config/parameter_reference.html#MAV_2_FORWARD">MAV_2_FORWARD</a>, щоб дозволити пересилання комунікацій з порту на інші порти, такі як той, що підключений до наземної станції.</li><li>Можливо, вам доведеться встановити деякі інші параметри, залежно від типу підключення та будь-яких конкретних вимог камери щодо очікуваної швидкості передачі даних і т. д.</li></ol><h3 id="ручне-керування-1" tabindex="-1">Ручне керування <a class="header-anchor" href="#ручне-керування-1" aria-label="Permalink to &quot;Ручне керування&quot;">​</a></h3><p>Кнопки джойстика можуть бути налаштовані для захоплення зображень та перемикання запису відео включено/виключено.</p><ul><li><a href="./../config/joystick.html#enabling-px4-joystick-support">Joystick</a> пояснює, як увімкнути джойстики на PX4.</li><li><a href="https://docs.qgroundcontrol.com/master/en/qgc-user-guide/setup_view/joystick.html" target="_blank" rel="noreferrer">QGroundControl &gt; Налаштування джойстика</a> пояснює, як задати кнопки на функції стеку польоту</li></ul><h2 id="менеджери-камер" tabindex="-1">Менеджери камер <a class="header-anchor" href="#менеджери-камер" aria-label="Permalink to &quot;Менеджери камер&quot;">​</a></h2><p>Якщо ви хочете використовувати камеру, яка не підтримує протокол камери MAVLink за замовчуванням, вам знадобиться менеджер камери MAVLink. Менеджер камери працює на супутниковому комп&#39;ютері та з&#39;єднує інтерфейс протоколу камери MAVLink і нативний інтерфейс камери.</p><p>Існують &quot;розширювані&quot; менеджери камер, якими можна користуватися з багатьма різними камерами, менеджери камер, розроблені для роботи з певною камерою, а також ви можете написати свій власний (наприклад, використовуючи додатки сервера MAVSDK).</p><p>Загальні/розширені менеджери камер:</p><ul><li><a href="https://github.com/mavlink/mavlink-camera-manager" target="_blank" rel="noreferrer">Менеджер камери MAVLink</a> - Розширюваний крос-платформенний сервер камери MAVLink, побудований на базі GStreamer та Rust-MAVLink.</li><li><a href="https://camera-manager.dronecode.org/en/" target="_blank" rel="noreferrer">Менеджер камери Dronecode</a> - Додає інтерфейс протоколу камери для камер, підключених до комп&#39;ютера з Linux.</li></ul><p>Специфічні менеджери камери:</p><ul><li><p><a href="https://github.com/julianoes/siyi-a8-mini-camera-manager" target="_blank" rel="noreferrer">Менеджер камери SIYI A8 mini</a> - Менеджер камери на основі плагіна MAVSDK для [SIYI A8 mini] (включає навчальний посібник).</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Це добрий приклад того, як MAVSDK може бути використаний для створення інтерфейсу протоколу камери MAVLink для певної камери.</p></div></li></ul><p>:::</p><p>Під час використання менеджера камери ви підключаєте компаньйон-комп&#39;ютер до контролера польоту (замість прямого підключення до камери), і вам знадобиться додаткове програмне забезпечення на комп&#39;ютері для направлення трафіку MAVLink до менеджера камери на компаньйон-комп&#39;ютері, таке як <a href="https://github.com/mavlink-router/mavlink-router" target="_blank" rel="noreferrer">mavlink-router</a>.</p><p>Додаткову інформацію щодо камерного менеджера та налаштувань компаньйона можна знайти в:</p><ul><li><a href="https://github.com/julianoes/siyi-a8-mini-camera-manager" target="_blank" rel="noreferrer">Менеджер камери SIYI A8 mini</a> - Навчальний посібник з інтеграції з <a href="https://shop.siyi.biz/products/siyi-a8-mini" target="_blank" rel="noreferrer">SIYI A8 mini</a>, використовуючи менеджер камери на основі MAVSDK, який працює на комп&#39;ютері-компаньйоні Raspberry Pi.</li><li><a href="./../companion_computer/pixhawk_companion.html">Використання комп&#39;ютера-компаньйона з контролерами Pixhawk</a></li><li><a href="./../companion_computer/#companion-computer-software">Компаньйони комп&#39;ютери &gt; Програмне забезпечення комп&#39;ютера-компаньйона</a>: Зауважте <a href="https://github.com/mavlink-router/mavlink-router" target="_blank" rel="noreferrer">MAVLink-Router</a>, який можна налаштувати для маршрутизації трафіку MAVLink між послідовним портом та IP-лінком (або іншим інтерфейсом керування камерою).</li></ul>',47),l=[n];function o(m,s,_,h,c,A){return r(),a("div",null,l)}const M=e(i,[["render",o]]);export{k as __pageData,M as default};
