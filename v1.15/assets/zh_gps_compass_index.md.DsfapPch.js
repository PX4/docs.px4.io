import{_ as t,a as e,b as a}from"./chunks/qgc_serial_baudrate_example._5moIQth.js";import{_ as r,c as o,o as n,ab as l}from"./chunks/framework.CUflZczI.js";const _=JSON.parse('{"title":"GPS&罗盘","description":"","frontmatter":{},"headers":[],"relativePath":"zh/gps_compass/index.md","filePath":"zh/gps_compass/index.md"}'),s={name:"zh/gps_compass/index.md"},i=l('<h1 id="gps-罗盘" tabindex="-1">GPS&amp;罗盘 <a class="header-anchor" href="#gps-罗盘" aria-label="Permalink to &quot;GPS&amp;罗盘&quot;">​</a></h1><p>任务模式以及一些其他的自动和手工/辅助模式会用到GPS。 PX4支持全球导航卫星系统（GNSS），如GPS、格罗纳斯、伽利略、北斗、QZSS和SBAS等。 其通过u-blox、MTK Ashtech 或 Emlid 协议或UAVCAN进行通信。</p><p>Up to two GPS modules can be connected using either a UART or the CAN bus:</p><ul><li>A primary <a href="./../gps_compass/#supported-gnss">GNSS module</a> that usually also includes a <a href="./../gps_compass/magnetometer.html">compass/magnetometer</a>, <a href="./../getting_started/px4_basic_concepts.html#buzzer">buzzer</a>, <a href="./../getting_started/px4_basic_concepts.html#safety-switch">safety switch</a>, and <a href="./../getting_started/led_meanings.html#ui-led">UI LED</a>.</li><li>An optional secondary GNSS/compass module that is used as a fallback. This may include a buzzer, safety switch, LEDs, but these are not used by PX4.</li></ul><p><img src="'+t+'" alt="GPS + Compass"></p><div class="info custom-block"><p class="custom-block-title">PX4 also supports <a href="./../gps_compass/rtk_gps.html">Real Time Kinematic (RTK)</a> and <strong>Post-Processing Kinematic (PPK)</strong> GNSS Receivers, which extend GNSS systems to centimetre-level precision.</p></div><h2 id="支持的gps模块" tabindex="-1">支持的GPS模块 <a class="header-anchor" href="#支持的gps模块" aria-label="Permalink to &quot;支持的GPS模块&quot;">​</a></h2><p>任何运行在PX4的元件应通过u-blox、MTK Ashtech 或 Emlid 协议或UAVCAN进行通信。</p><p>下表包括了一些无RTK的GPS模块（其中大部分也有指南针）。 下面的设备PX4开发团队测试过了，或者是在PX4社区中受欢迎的。</p><table><thead><tr><th style="text-align:left;">Device</th><th style="text-align:center;">GPS</th><th style="text-align:center;">Compass</th><th style="text-align:center;"><a href="./../dronecan/">CAN</a></th><th style="text-align:center;">Buzzer / SafeSw / LED</th><th style="text-align:left;">备注</th></tr></thead><tbody><tr><td style="text-align:left;"><a href="https://arkelectron.com/product/ark-gps/" target="_blank" rel="noreferrer">ARK GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">ICM42688p</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:left;">+ Baro, IMU</td></tr><tr><td style="text-align:left;"><a href="https://www.tindie.com/products/avionicsanonymous/uavcan-gps-magnetometer/" target="_blank" rel="noreferrer">Avionics Anonymous UAVCAN GNSS/Mag</a></td><td style="text-align:center;">SAM-M8Q</td><td style="text-align:center;">MMC5983MA</td><td style="text-align:center;">✓</td><td style="text-align:center;">✗</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_cuav_neo_3.html">CUAV NEO 3 GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">IST8310</td><td style="text-align:center;"></td><td style="text-align:center;">✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_cuav_neo_3pro.html">CUAV NEO 3 Pro GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">RM3100</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:left;">+ Baro</td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_cuav_neo_3x.html">CUAV NEO 3X GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">RM3100</td><td style="text-align:center;">✓</td><td style="text-align:center;">✗✓✓</td><td style="text-align:left;">+ Baro.</td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_hex_here2.html">CubePilot Here2 GNSS GPS (M8N)</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">ICM20948</td><td style="text-align:center;"></td><td style="text-align:center;">✓</td><td style="text-align:left;">Superseded by HERE3</td></tr><tr><td style="text-align:left;"><a href="https://emlid.com/reach/" target="_blank" rel="noreferrer">Emlid Reach M+</a></td><td style="text-align:center;">✓</td><td style="text-align:center;">✗</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;">Supports PPK. RTK expected.</td></tr><tr><td style="text-align:left;"><a href="./../dronecan/holybro_m8n_gps.html">Holybro DroneCAN M8N GPS</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">BMM150</td><td style="text-align:center;">✓</td><td style="text-align:center;">✗</td><td style="text-align:left;">+ Baro</td></tr><tr><td style="text-align:left;"><a href="https://holybro.com/products/micro-m8n-gps" target="_blank" rel="noreferrer">Holybro Micro M8N GPS</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">IST8310</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="https://holybro.com/products/nano-m8-5883-gps-module" target="_blank" rel="noreferrer">Holybro Nano Ublox M8 5883 GPS</a></td><td style="text-align:center;">UBX-M8030</td><td style="text-align:center;">QMC5883</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_holybro_m8n_m9n.html">Holybro M8N GPS</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">IST8310</td><td style="text-align:center;"></td><td style="text-align:center;">✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_holybro_m8n_m9n.html">Holybro M9N GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">IST8310</td><td style="text-align:center;"></td><td style="text-align:center;">✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="https://holybro.com/products/dronecan-m9n-gps" target="_blank" rel="noreferrer">Holybro DroneCAN M9N GPS</a></td><td style="text-align:center;">M9N</td><td style="text-align:center;">BMM150</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="https://hobbyking.com/en_us/ublox-neo-m8n-gps-with-compass.html" target="_blank" rel="noreferrer">Hobbyking u-blox Neo-M8N GPS with Compass</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">✓</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_locosys_hawk_a1.html">LOCOSYS Hawk A1 GNSS receiver</a></td><td style="text-align:center;">MC-1612-V2b</td><td style="text-align:center;">optional</td><td style="text-align:center;"></td><td style="text-align:center;">✗✗✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/rtk_gps_locosys_r1.html">LOCOSYS Hawk R1</a></td><td style="text-align:center;">MC-1612-V2b</td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">✗✗✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/rtk_gps_locosys_r2.html">LOCOSYS Hawk R2</a></td><td style="text-align:center;">MC-1612-V2b</td><td style="text-align:center;">IST8310</td><td style="text-align:center;"></td><td style="text-align:center;">✗✗✓</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="https://store.mrobotics.io/product-p/m10034-8308.htm" target="_blank" rel="noreferrer">mRo GPS u-blox Neo-M8N Dual Compass</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">LIS3MDL, IST8308</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><a href="./../gps_compass/gps_smartap.html">Sky-Drones SmartAP GPS</a></td><td style="text-align:center;">M8N</td><td style="text-align:center;">HMC5983, IST8310, LIS3MDL</td><td style="text-align:center;"></td><td style="text-align:center;">✓</td><td style="text-align:left;">+ Baro</td></tr><tr><td style="text-align:left;"><a href="https://zubax.com/products/gnss_2" target="_blank" rel="noreferrer">Zubax GNSS 2</a></td><td style="text-align:center;">MAX-M8Q</td><td style="text-align:center;">LIS3MDL</td><td style="text-align:center;"></td><td style="text-align:center;">✗</td><td style="text-align:left;">+ Baro</td></tr></tbody></table><p>Notes:</p><ul><li>✓ or a specific part number indicate that a features is supported, while ✗ or empty show that the feature is not supported. &quot;?&quot; indicates &quot;unknown&quot;.</li><li>Where possible and relevant the part name is used (i.e. ✓ in the GPS column indicates that a GPS module is present but the part is not known).</li><li>The list may omit some discontinued hardware that is still supported (check earlier versions for info about discontinued modules). Removed items include: <ul><li><em>Here</em> GPS</li><li>Drotek DP0804</li></ul></li></ul><h2 id="mounting-the-gnss-compass" tabindex="-1">Mounting the GNSS/Compass <a class="header-anchor" href="#mounting-the-gnss-compass" aria-label="Permalink to &quot;Mounting the GNSS/Compass&quot;">​</a></h2><p>大多数GPS模块还包含一个 <a href="./../gps_compass/magnetometer.html">指南针/磁力计</a> （校准/安装信息见链接）。 我们建议GPS模块的安装尽可能远离电机/电调的电源线 - 通常在支座或机翼（固定翼）上。</p><p><a href="./../assembly/mount_gps_compass.html">Mounting the Compass</a> explains how to mount a GNSS module that has a compass.</p><h2 id="hardware-setup" tabindex="-1">Hardware Setup <a class="header-anchor" href="#hardware-setup" aria-label="Permalink to &quot;Hardware Setup&quot;">​</a></h2><p>The hardware setup depends on the flight controller, the GNSS module, and the connection bus it supports - UART/I2C or CAN.</p><h3 id="pixhawk-standard-connectors" tabindex="-1">Pixhawk Standard Connectors <a class="header-anchor" href="#pixhawk-standard-connectors" aria-label="Permalink to &quot;Pixhawk Standard Connectors&quot;">​</a></h3><p>Connecting GNSS/Compass modules is easiest when using a flight controller that supports the <a href="https://github.com/pixhawk/Pixhawk-Standards/blob/master/DS-009%20Pixhawk%20Connector%20Standard.pdf" target="_blank" rel="noreferrer">Pixhawk connector standard</a>. All flight controllers that follow this standard, including most <a href="./../flight_controller/autopilot_pixhawk_standard.html">Pixhawk Standard</a> controllers (and many others) use the same port connectors and wiring for connecting GNSS modules. Because of this standardization, many popular GNSS/Compass modules plug directly into the flight controller &quot;out of the box&quot;.</p><p>If you&#39;re using GNSS/Compass modules that connect via generic UARTs and serial protocols like I2C:</p><ul><li>The primary GNSS/Compass module should be connected to the 10-pin port labelled <code>GPS1</code>, <code>GPS&amp;SAFETY</code>, or <code>GPS</code> (this is port described as &quot;Full GPS + Safety Switch Port&quot; in the connector standard). The GPS should incorporate a <a href="./../getting_started/px4_basic_concepts.html#buzzer">buzzer</a>, <a href="./../getting_started/px4_basic_concepts.html#safety-switch">safety switch</a>, and <a href="./../getting_started/led_meanings.html#ui-led">UI LED</a>.</li><li>An (optional) secondary module can be connected to the 6-pin <code>GPS2</code> port, if present (this is &quot;Basic GPS Port&quot; in the standard).</li><li>The ports are generally plug-n-play for u-blox modules (only).</li></ul><div class="info custom-block"><p class="custom-block-title">The ports include a UART for the GNSS and an I2C port for connecting the Compass. The &quot;Full GPS + Safety Switch Port&quot; includes additional I2C connectors for LEDs, buzzer and safety switch. There is nothing to stop you from connecting the GPS pins to any other free UART as a GNSS port, and the compass or buzzer to an I2C port. However if you do this then you will need to <a href="./../peripherals/serial_configuration.html">configure the ports</a>.</p></div><p>For <a href="./../dronecan/#supported-hardware">DroneCAN</a> GNSS/compass modules:</p><ul><li>DroneCan GPS modules are connected to CAN-bus ports, which are 4-pin ports labeled <code>CAN1</code> or <code>CAN2</code>.</li></ul><h3 id="other-flight-controllers-gnss-modules" tabindex="-1">Other Flight Controllers/GNSS Modules <a class="header-anchor" href="#other-flight-controllers-gnss-modules" aria-label="Permalink to &quot;Other Flight Controllers/GNSS Modules&quot;">​</a></h3><p>If you&#39;re working with a flight controller and GNSS module combination that does not comply with the Pixhawk connector standard then you will need to pay particular attention to the connector pinouts on the flight controller and the module. You may need to rewire/solder the connectors.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Some flight controllers use ports that are software-compatible but not connector compatible (even if they use the same connector!) because they use different pin orderings.</p></div><p>The pinouts for the connector standard are documented in the standard. Pinouts for other controllers and the GNSS modules should be included in their manufacturer documentation.</p><h2 id="gnss-configuration" tabindex="-1">GNSS Configuration <a class="header-anchor" href="#gnss-configuration" aria-label="Permalink to &quot;GNSS Configuration&quot;">​</a></h2><p>The default configuration for GPS module connected via the GPS serial port is provided below. Additional device-specific configuration may be provided in PX4 or manufacturer device documentation (e.g. <a href="./../gps_compass/rtk_gps_trimble_mb_two.html#configuration">Trimble MB-Two &gt; Configuration</a>).</p><h3 id="primary-gps-configuration-uart" tabindex="-1">Primary GPS Configuration (UART) <a class="header-anchor" href="#primary-gps-configuration-uart" aria-label="Permalink to &quot;Primary GPS Configuration (UART)&quot;">​</a></h3><p>Primary GPS configuration on Pixhawk is handled transparently for U-Blox GPS modules — simply connect the GPS module to the port labeled <code>GPS1</code>, <code>GPS&amp;SAFETY</code>, or <code>GPS</code> (if there is only one GPS port), and everything should work.</p><p>The default <a href="./../peripherals/serial_configuration.html#default_port_mapping">Serial Port Configuration</a> configures <code>GPS1</code> as a GPS port using <a href="./../advanced_config/parameter_reference.html#GPS_1_CONFIG">GPS_1_CONFIG</a>, sets the protocol to <code>u-blox</code> with <a href="./../advanced_config/parameter_reference.html#GPS_1_PROTOCOL">GPS_1_PROTOCOL</a>, and a baud rate of <code>0: Auto</code> with <a href="./../advanced_config/parameter_reference.html#SER_GPS1_BAUD">SER_GPS1_BAUD</a>.</p><p>For GPS types like Trimble, Emlid, MTK, you will need to change the <code>GPS_1_PROTOCOL</code> appropriately. For <em>Trimble MB-Two</em> you will also need to modify <code>SER_GPS1_BAUD</code> to set the rate to 115200 baud.</p><p><a id="dual_gps"></a></p><h3 id="secondary-gps-configuration-uart" tabindex="-1">Secondary GPS Configuration (UART) <a class="header-anchor" href="#secondary-gps-configuration-uart" aria-label="Permalink to &quot;Secondary GPS Configuration (UART)&quot;">​</a></h3><p>To use a secondary GPS, you will generally attach it to the port named <code>GPS2</code>, if present, and otherwise attach it to any free UART port. The port may be pre-configured, but unlike the primary port, this is not guaranteed.</p><p>To ensure the port is set up correctly perform a <a href="./../peripherals/serial_configuration.html">Serial Port Configuration</a> to assign <a href="./../advanced_config/parameter_reference.html#GPS_2_CONFIG">GPS_2_CONFIG</a> to the selected port.</p><p>The following steps show how to configure a secondary GPS on the <code>GPS 2</code> port in <em>QGroundControl</em>:</p><ol><li><p><a href="./../advanced_config/parameters.html">Find and set</a> the parameter <a href="./../advanced_config/parameter_reference.html#GPS_2_CONFIG">GPS_2_CONFIG</a> to <strong>GPS 2</strong>.</p><ul><li><p>Open <em>QGroundControl</em> and navigate to the <strong>Vehicle Setup &gt; Parameters</strong> section.</p></li><li><p>Select the <strong>GPS</strong> tab, then open the <a href="./../advanced_config/parameter_reference.html#GPS_2_CONFIG">GPS_2_CONFIG</a> parameter and select <code>GPS 2</code> from the dropdown list.</p><p><img src="'+e+'" alt="QGC 串口实例"></p></li></ul></li><li><p>Reboot the vehicle in order to make the other parameters visible.</p></li><li><p>Select the <strong>Serial</strong> tab, and open the <a href="./../advanced_config/parameter_reference.html#SER_GPS2_BAUD">SER_GPS2_BAUD</a> parameter (<code>GPS 2</code> port baud rate): set it to <em>Auto</em> (or 115200 for the Trimble).</p><p><img src="'+a+'" alt="QGC 串口波特率实例"></p></li></ol><p>After setting up the second GPS port:</p><ol><li>Configure the ECL/EKF2 estimator to blend data from both GPS systems. For detailed instructions see: <a href="./../advanced_config/tuning_the_ecl_ekf.html#dual-receivers">Using the ECL EKF &gt; Dual Receivers</a>.</li></ol><h3 id="dronecan-gnss-configuration" tabindex="-1">DroneCAN GNSS Configuration <a class="header-anchor" href="#dronecan-gnss-configuration" aria-label="Permalink to &quot;DroneCAN GNSS Configuration&quot;">​</a></h3><p><a href="./../dronecan/#supported-hardware">DroneCAN</a> GNSS configuration is covered in the linked document (and in the documentation for specific modules).</p><h3 id="configuring-gps-as-yaw-heading-source" tabindex="-1">Configuring GPS as Yaw/Heading Source <a class="header-anchor" href="#configuring-gps-as-yaw-heading-source" aria-label="Permalink to &quot;Configuring GPS as Yaw/Heading Source&quot;">​</a></h3><p>GPS can be used as a source for yaw fusion when using modules where <em>yaw output is supported by the device</em>. This is documented in <a href="./../gps_compass/rtk_gps.html#configuring-gps-as-yaw-heading-source">RTK GPS &gt; Configuring GPS as Yaw/Heading Source</a>.</p><h2 id="compass-configuration" tabindex="-1">Compass Configuration <a class="header-anchor" href="#compass-configuration" aria-label="Permalink to &quot;Compass Configuration&quot;">​</a></h2><p>Compass calibration for an included compass part is covered in: <a href="./../config/compass.html">Compass Configuration</a>.</p><h2 id="developer-information" tabindex="-1">Developer Information <a class="header-anchor" href="#developer-information" aria-label="Permalink to &quot;Developer Information&quot;">​</a></h2><ul><li>GPS/RTK-GPS <ul><li><a href="./../advanced/rtk_gps.html">RTK-GPS</a></li><li><a href="./../modules/modules_driver.html#gps">GPS driver</a></li><li><a href="./../dronecan/">DroneCAN Example</a></li></ul></li><li>Compass <ul><li><a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/src/drivers/magnetometer" target="_blank" rel="noreferrer">Driver source code</a> (Compasses)</li></ul></li></ul>',50),d=[i];function c(h,p,g,u,m,f){return n(),o("div",null,d)}const x=r(s,[["render",c]]);export{_ as __pageData,x as default};
