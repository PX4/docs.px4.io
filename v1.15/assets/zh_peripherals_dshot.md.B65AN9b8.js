import{_ as a,c as s,o as e,ab as t}from"./chunks/framework.CUflZczI.js";const v=JSON.parse('{"title":"DShot 电调","description":"","frontmatter":{},"headers":[],"relativePath":"zh/peripherals/dshot.md","filePath":"zh/peripherals/dshot.md"}'),p={name:"zh/peripherals/dshot.md"},o=t(`<h1 id="dshot-电调" tabindex="-1">DShot 电调 <a class="header-anchor" href="#dshot-电调" aria-label="Permalink to &quot;DShot 电调&quot;">​</a></h1><p>DShot 是一种更高级的电调协议，相比 <a href="./../peripherals/pwm_escs_and_servo.html">PWM</a> 或 <a href="./../peripherals/oneshot.html">OneShot</a> 具有几个优势：</p><ul><li>低延迟</li><li>通过校验提高鲁棒性</li><li>由于协议使用数字编码，因此无需电调校准</li><li>很多电调支持数传反馈。</li><li>可以通过命令反转电机方向（而不是物理调换两根线/重新焊接）。</li><li>支持其他好用的命令。</li></ul><p>本章介绍了如何连接和配置 DShot 电调。</p><p><a id="wiring"></a></p><h2 id="接线和连接" tabindex="-1">接线和连接 <a class="header-anchor" href="#接线和连接" aria-label="Permalink to &quot;接线和连接&quot;">​</a></h2><p>DShot 电调与<a href="./pwm_escs_and_servo.html">PWM 电调</a>的接线方式相同。 唯一的区别在于它们只能连接到FMU，通常只能连接到某些引脚的子集。</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>在接线之前，您可能需要检查执行器配置屏幕来查看飞控上可用于 DShot 的引脚！</p></div><p>通常带有FMU和IO板的Pixhawk飞控将它们分别标记为<code>AUX</code>（连接到FMU）和<code>MAIN</code>（连接到IO控制器）。 <code>PWM AUX</code> 和 <code>PWM MAIN</code> 的输出选项卡在执行器配置屏幕上。 对于这些飞控来说，DShot 电调连接到 <code>AUX</code> 端口。</p><p>没有IO板的飞控通常将输出端口标记为 <code>MAIN</code>， 并且这是您连接 DShot 电调的地方。 如果那些没有IO控制器的飞控有自己的固件，执行器分配将匹配到相应的<code>PWM MAIN</code>输出。 然而，如果无论有没有IO板都用的是同一个固件，如Pixhawk 4和 Pixhawk 4Mini, 那么在这种情况下使用的执行器选项是相同的： <code>PWM AUX</code> （比如：不匹配端口标签 <code>MAIN</code> 在“mini”案例中）。</p><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>更改电调配置参数之前，请先拆下螺旋桨！</p></div><p>在<a href="./../config/actuators.html">执行器配置</a>中为所需要的输出启用 DShot。</p><p>DShot 具有不同的速度选项：<em>DShot150</em>，<em>DShot300</em>，<em>DShot600</em> 和 <em>DShot1200</em>，其中的数字表示千比特每秒。 您应该将参数设置为您的电调支持的最高速度（根据其说明书）。</p><p>然后连接电池并解锁无人机。 电调应该初始化，电机应该按照正确的方向转动。</p><ul><li>如果电机未按照正确方向旋转（适用于<a href="./../airframes/airframe_reference.html">所选机架</a>），您可以在UI中使用<strong>设置旋转方向</strong>选项来反转它们（此选项在您选择DShot并分配电机后出现）。 您也可以通过发送<a href="#commands">ESC命令</a>来反转电机。</li></ul><p><a id="commands"></a></p><h2 id="关于电调的指令" tabindex="-1">关于电调的指令 <a class="header-anchor" href="#关于电调的指令" aria-label="Permalink to &quot;关于电调的指令&quot;">​</a></h2><p>可以通过 <a href="./../debug/mavlink_shell.html">MAVLink shell</a> 向电调发送命令。 查看<a href="./../modules/modules_driver.html#dshot">这里</a>以获取完整的参考命令。</p><p>其中最重要的是：</p><ul><li><p>使第一个电机哔哔一下（有助于识别电机）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>dshot beep1 -m 1</span></span></code></pre></div></li><li><p>检索电调信息（需要TELE功能，请参见下文）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>nsh&gt; dshot esc_info -m 2</span></span>
<span class="line"><span>INFO  [dshot] ESC Type: #TEKKO32_4in1#</span></span>
<span class="line"><span>INFO  [dshot] MCU Serial Number: xxxxxx-xxxxxx-xxxxxx-xxxxxx</span></span>
<span class="line"><span>INFO  [dshot] Firmware version: 32.60</span></span>
<span class="line"><span>INFO  [dshot] Rotation Direction: normal</span></span>
<span class="line"><span>INFO  [dshot] 3D Mode: off</span></span>
<span class="line"><span>INFO  [dshot] Low voltage Limit: off</span></span>
<span class="line"><span>INFO  [dshot] Current Limit: off</span></span>
<span class="line"><span>INFO  [dshot] LED 0: unsupported</span></span>
<span class="line"><span>INFO  [dshot] LED 1: unsupported</span></span>
<span class="line"><span>INFO  [dshot] LED 2: unsupported</span></span>
<span class="line"><span>INFO  [dshot] LED 3: unsupported</span></span></code></pre></div><ul><li>永久性反转第一个电机的旋转方向：</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>dshot reverse -m 1</span></span>
<span class="line"><span>dshot save -m 1</span></span></code></pre></div><p>在执行<code>dshot reverse -m 1</code>命令后而没有执行<code>dshot save -m 1</code>命令会显示电调信息的检索结果。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Rotation Direction: reversed</span></span></code></pre></div><p>使用 <code>dshot save -m 1</code> 命令保存后，反向方向将变为新的正常方向：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Rotation Direction: normal</span></span></code></pre></div><p>如果要再次改变方向，需要发送新的 <code>dshot reverse -m 1</code> 命令。</p></li></ul><h2 id="telemetry" tabindex="-1">Telemetry <a class="header-anchor" href="#telemetry" aria-label="Permalink to &quot;Telemetry&quot;">​</a></h2><p>有些电调能够向飞控发送Telemetry数据，包括：</p><ul><li>温度</li><li>电压</li><li>电流</li><li>累计消耗的电量</li><li>转速值</li></ul><p>这些DShot 电调会有一条额外的连接线。</p><p>开启遥测数据功能（仅对于能支持遥测数据的电调）:</p><ol><li>把电调上的TELE端口连接到飞控上空的串口的 RX 端。</li><li>使用 <a href="./../advanced_config/parameter_reference.html#DSHOT_TEL_CFG">DSHOT_TEL_CFG</a> 命令在该串行端口启用遥测。</li></ol><p>重启后，您可以检查TELE数据传输是否正常工作（确保电池已连接），方法如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>dshot esc_info -m 1</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>您可能需要配置<a href="./../advanced_config/parameter_reference.html#MOT_POLE_COUNT">MOT_POLE_COUNT</a>以获取正确的转速（RPM值）。</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>并非所有支持DSHOT的电调都支持<code>[esc_info]</code>（例如APD 80F3x），就算支持并且开启了TELE功能。 显示的错误是：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ERROR [dshot] No data received. If telemetry is setup correctly, try again.</span></span></code></pre></div><p>查看制造商文档以获取详细信息。</p></div>`,31),i=[o];function n(l,c,d,h,r,m){return e(),s("div",null,i)}const g=a(p,[["render",n]]);export{v as __pageData,g as default};
