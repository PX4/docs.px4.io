import{_ as i,c as e,o as t,ab as a,m as s}from"./chunks/framework.CUflZczI.js";const F=JSON.parse('{"title":"Симуляція Gazebo","description":"","frontmatter":{},"headers":[],"relativePath":"uk/sim_gazebo_gz/index.md","filePath":"uk/sim_gazebo_gz/index.md"}'),l={name:"uk/sim_gazebo_gz/index.md"},h=a('<h1 id="симуляція-gazebo" tabindex="-1">Симуляція Gazebo <a class="header-anchor" href="#симуляція-gazebo" aria-label="Permalink to &quot;Симуляція Gazebo&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Gazebo раніше була відома як &quot;Gazebo Ignition&quot; (тоді як <em>Gazebo Classic</em> раніше відома як Gazebo). Дивіться <a href="https://www.openrobotics.org/blog/2022/4/6/a-new-era-for-gazebo" target="_blank" rel="noreferrer">запис в офіційному блозі</a> для додаткової інформації.</p></div><p><a href="https://gazebosim.org/home" target="_blank" rel="noreferrer">Gazebo</a> - це робототехнічний симулятор з відкритим кодом. Він замінює старий симулятор <a href="./../sim_gazebo_classic/README.html">Gazebo Classic</a> та є єдиною версією Gazebo, що підтримується для Ubuntu 22.04 і далі.</p><p><strong>Засоби що підтримуються:</strong> Квадрокоптер, Літак, ВЗІП</p>',4),o=s("p",null,[s("div",{class:"embed-responsive embed-responsive-16by9"},[s("iframe",{class:"embed-responsive-item youtube-player",type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/eRzdGD2vgkU",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""})])],-1),p=a(`<p>:::note Дивіться <a href="./../simulation/README.html">Симуляція</a> для загальної інформації про симуляцію, середовище симуляції та налаштування симуляції (наприклад засоби, що підтримуються). :::</p><h2 id="встановлення-ubuntu-linux" tabindex="-1">Встановлення (Ubuntu Linux) <a class="header-anchor" href="#встановлення-ubuntu-linux" aria-label="Permalink to &quot;Встановлення (Ubuntu Linux)&quot;">​</a></h2><p>Gazebo is installed by default on Ubuntu 22.04 as part of the normal <a href="./../dev_setup/dev_env_linux_ubuntu.html#simulation-and-nuttx-pixhawk-targets">development environment setup</a>.</p><p>If you want to use Gazebo on Ubuntu 20.04 you can install it manually, after first following the normal setup process (installing <code>gz-garden</code> will uninstall Gazebo-Classic!):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://packages.osrfoundation.org/gazebo.gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;deb [arch=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --print-architecture</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) main&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/sources.list.d/gazebo-stable.list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz-garden</span></span></code></pre></div><h2 id="запуск-симуляціі" tabindex="-1">Запуск симуляції <a class="header-anchor" href="#запуск-симуляціі" aria-label="Permalink to &quot;Запуск симуляції&quot;">​</a></h2><p>Симуляцію Gazebo SITL можна легко запустити за допомогою команди <code>make</code> як показано нижче:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/PX4-Autopilot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><p>Це запускає як екземпляр PX4 SITL, так і клієнт Gazebo.</p><p>Рухомі засоби, що підтримуються, а також команди <code>make</code> перелічені нижче. Зверніть увагу, що усі цілі збірки make для gazebo мають префікс <code>gz_</code>.</p><table><thead><tr><th>Рухомий засіб</th><th>Команда</th><th><code>PX4_SYS_AUTOSTART</code></th></tr></thead><tbody><tr><td><a href="./../sim_gazebo_gz/vehicles.html#x500-quadrotor">Квадрокоптер (x500)</a></td><td><code>make px4_sitl gz_x500</code></td><td>4001</td></tr><tr><td><a href="./../sim_gazebo_gz/vehicles.html#x500-quadrotor-with-depth-camera">Квадрокоптер (x500) з камерою глибини</a></td><td><code>make px4_sitl gz_x500_depth</code></td><td>4002</td></tr><tr><td><a href="./../sim_gazebo_gz/vehicles.html#x500-quadrotor-with-visual-odometry">Квадрокоптер (x500) з візуальною одометрією</a></td><td><code>make px4_sitl gz_x500_vision</code></td><td>4005</td></tr><tr><td><a href="./../sim_gazebo_gz/vehicles.html#standard-vtol">ВЗІП</a></td><td><code>make px4_sitl gz_standard_vtol</code></td><td>4004</td></tr><tr><td><a href="./../sim_gazebo_gz/vehicles.html#standard-plane">Літак</a></td><td><code>make px4_sitl gz_rc_cessna</code></td><td>4003</td></tr><tr><td><a href="./../sim_gazebo_gz/vehicles.html#advanced-plane">Покращений літак</a></td><td><code>make px4_sitl gz_advanced_plane</code></td><td>4008</td></tr></tbody></table><p>Усі <a href="./../sim_gazebo_gz/vehicles.html">моделі засобів</a> (та <a href="#specify-world">світів</a>) включені як підмодуль з репозиторію <a href="./../sim_gazebo_gz/gazebo_models.html">Моделі Gazebo</a>.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Плагін &quot;Удосконалена піднімна сила&quot;, що необхідний для запуску Покращеного літака поки що не є частиною дистрибутиву Gazebo, тому Покращений літак поки що не полетить: <a href="https://github.com/PX4/PX4-Autopilot/issues/22337" target="_blank" rel="noreferrer">PX4-Autopilot#22337</a>.</p><p>Щоб увімкнути Покращений літак, в якості обхідного шляху ви можете зібрати бібліотеку gz-sim з <a href="https://github.com/gazebosim/gz-sim" target="_blank" rel="noreferrer">вихідного коду Gazebo</a>, перейти до каталогу <code>build/lib</code>, скопіювати файл плагіну удосконаленої піднімної сили <code>.so</code> (в залежності від певної версії Gazebo він називається чимось на зразок <code>libgz-sim7-advanced-lift-drag-system.so</code>), та вставити у директорію <code>~/.gz/sim/plugins</code>.</p></div><p>Вищенаведені команди запускають єдиний засіб з повним користувацьким інтерфейсом. <em>QGroundControl</em> повинна автоматично підключатися до симульованого транспортного засобу.</p><h3 id="автономнии-режим" tabindex="-1">Автономний режим <a class="header-anchor" href="#автономнии-режим" aria-label="Permalink to &quot;Автономний режим&quot;">​</a></h3><p>Інший спосіб як Gazebo SITL може бути під&#39;єднано - в <em>автономному режимі</em>. У цьому режимі PX4 SITL і Gazebo запускаються окремо у своїх власних терміналах. За замовчуванням ці термінали знаходяться на одному й тому ж комп&#39;ютері, але ви можете також під&#39;єднати екземпляри SITL та Gazebo, які працюють на будь-яких двох пристроях в мережі (або навіть різних мережах, якщо ви використовуєте VPN для їх з&#39;єднання).</p><p>Запустити PX4 в автономному режимі можна додавши перед командою <code>make</code> <code>PX4_GZ_STANDALONE=1</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/PX4-Autopilot</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_GZ_STANDALONE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><p>PX4 SITL тоді буде очікувати поки не виявить екземпляру <em>gz-server</em> та не під&#39;єднається до нього.</p><p>:::note Якщо ви досі не запустили <em>gz-server</em> коли виконали команду <code>make</code>, ви побачите наступне попередження допоки gazebo не запуститься та екземпляр <em>gz-server</em> не буде виявлено PX4:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WARN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [gz </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">bridge]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> call</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Gazebo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> been</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> detected</span></span></code></pre></div><p>:::</p><p>Найпростіший спосіб запустити симуляцію - використати Python скрипт <a href="https://github.com/PX4/PX4-gazebo-models/blob/main/simulation-gazebo" target="_blank" rel="noreferrer">simulation-gazebo</a>, що можна знайти у репозиторії <a href="./../sim_gazebo_gz/gazebo_models.html">Моделі Gazebo</a>. Його можна використати, щоб запустити екземпляр <em>gz-server</em> з будь-яким світом і рухомим засобом, що підтримується.</p><p>Скрипт можна використати без встановлення додаткових залежностей, він отримає моделі та світи PX4 що підтримуються при першому використанні (за замовчуванням) та збереже їх у <code>~/.simulation-gazebo</code>. При повторному запуску цей скрипт використає цю директорію для отримання моделей та світів. Тому якщо ви бажаєте використати власну модель та запустити її в автономному режимі, вам потрібно покласти її вихідний код у <code>~/.simulation-gazebo</code>.</p><p>Ви можете отримати цей скрипт локально використовуючи будь-який спосіб який вам до вподоби, наприклад <code>wget</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/PX4/PX4-gazebo-models/main/simulation-gazebo</span></span></code></pre></div><p>Скрипт може бути запущено так:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/script/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simulation-gazebo</span></span></code></pre></div><p>Для додаткової інформації та аргументів, дивіться <a href="./../sim_gazebo_gz/gazebo_models.html">Моделі Gazebo</a>.</p><p>:::note Якщо <code>make px4_sitl gz_x500</code> дає помилку <code>ninja: error: unknown target &#39;gz_x500&#39;</code> тоді запустіть <code>make distclean</code>, щоб почати з чистого аркуша, та спробуйте запустити <code>make px4_sitl gz_x500</code> ще раз. :::</p><h3 id="режим-без-інтерфеису" tabindex="-1">Режим без інтерфейсу <a class="header-anchor" href="#режим-без-інтерфеису" aria-label="Permalink to &quot;Режим без інтерфейсу&quot;">​</a></h3><p>Можливо ви забажаєте запустити Gazebo у &quot;режимі без інтерфейсу&quot; (без графічного інтерфейсу Gazebo) оскільки він використовує менше ресурсів та не покладається на те, що ваша система має відеокарту яка належним чином підтримує рендеринг OpenGL. Це пришвидшує завантаження та запуск, та для багатьох простих випадків це може бути все що вам потрібно.</p><p>Симуляція може бути запущено у режимі без інтерфейсу додаванням перед командою змінної середовища <code>HEADLESS=1</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HEADLESS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><h3 id="вказання-світу" tabindex="-1">Вказання світу <a class="header-anchor" href="#вказання-світу" aria-label="Permalink to &quot;Вказання світу&quot;">​</a></h3><p>Симуляція може бути запущена в певному світі додаванням бажаного світу до імені бажаного рухомого засобу. Наприклад, щоб запустити вітряний світ із засобом <code>x500</code> ви можете вказати:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500_windy</span></span></code></pre></div><p>Ви також можете вказати світ використовуючи змінну середовища <code>PX4_GZ_WORLD</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_GZ_WORLD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">windy</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><p>Світи що підтримуються перераховані нижче.</p><table><thead><tr><th>Світ</th><th>Команда</th><th>Опис</th></tr></thead><tbody><tr><td><code>default</code></td><td><code>make px4_sitl *</code></td><td>Порожній світ (сіра площина)</td></tr><tr><td><code>windy</code></td><td><code>make px4_sitl *_windy</code></td><td>Порожній світ з увімкненим вітром</td></tr><tr><td><code>baylands</code></td><td><code>make px4_sitl *_baylands</code></td><td>Світ Baylands оточений водою</td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Зверніть увагу, якщо ніякого світу не вказано, PX4 використає світ <code>default</code>. Однак ви не повинні <em>явно</em> вказувати <code>_default</code> у назві моделі тоді як це перешкодить запуску PX4. Іншими словами, використовуйте <code>make px4_sitl gz_x500</code> замість <code>make px4_sitl gz_x500_default</code> для світу за замовчуванням.</p></div><p>:::note Baylands викидає наступну помилку, що можна ігнорувати:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>[Err] [SDFFeatures.cc:843] The geometry element of collision [collision] couldn&#39;t be created</span></span></code></pre></div><p>Це трапляється тому що Baylands має багато сіток. Однак це не ламає Gazebo та ця помилка була знижена до попередження у Gazebo Harmonic: <a href="https://github.com/gazebosim/gz-physics/pull/531" target="_blank" rel="noreferrer">gz-physics/pull/531</a>. Також можна замінити помилку на попередження <a href="https://gazebosim.org/docs/garden/install_ubuntu_src" target="_blank" rel="noreferrer">встановивши gz-garden з вихідного коду</a>. :::</p><h2 id="використання-та-варіанти-налаштування" tabindex="-1">Використання та варіанти налаштування <a class="header-anchor" href="#використання-та-варіанти-налаштування" aria-label="Permalink to &quot;Використання та варіанти налаштування&quot;">​</a></h2><p>Конвеєр запуску дозволяє дуже гнучке налаштування. Зокрема можливо:</p><ul><li>Почати нову симуляцію з довільним світом або під&#39;єднатись до вже запущеної симуляції.</li><li>Додати новий засіб до симуляції або поєднати новий екземпляр PX4 з вже наявним.</li></ul><p>Ці сценарії керуються встановленням відповідних змінних середовища.</p><h3 id="синтаксис" tabindex="-1">Синтаксис <a class="header-anchor" href="#синтаксис" aria-label="Permalink to &quot;Синтаксис&quot;">​</a></h3><p>Синтаксис запуску набирає форми:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ARGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div><p>де <code>ARGS</code> - це список змінних середовища, включаючи:</p><ul><li><p><code>PX4_SYS_AUTOSTART</code> (<strong>обов&#39;язковий</strong>): встановлює <a href="./../dev_airframes/adding_a_new_frame.html">ідентифікатор автостарту планеру</a> PX4 для запуску.</p></li><li><p><code>PX4_GZ_MODEL_NAME</code>: встановлює ім&#39;я <em>наявної</em> моделі в симуляції gazebo. Якщо вказано, скрипт запуску намагається прив&#39;язати новий екземпляр PX4 до ресурсу Gazebo, що відповідає точно такому імені.</p><ul><li>Налаштування є взаємозаперечним з <code>PX4_SIM_MODEL</code>.</li></ul></li><li><p><code>PX4_SIM_MODEL</code>: встановлює ім&#39;я нової моделі Gazebo для відтворення в симуляторі. Якщо вказано, скрипт запуску шукає модель у шляху ресурсів Gazebo, що відповідає даній змінній, відтворює її й пов&#39;язує новий екземпляр PX4 з нею.</p><ul><li>Налаштування є взаємозаперечним з <code>PX4_GZ_MODEL_NAME</code>.</li></ul></li></ul><p>:::note Змінна середовища <code>PX4_GZ_MODEL</code> застаріла та її функціональність об&#39;єднана з <code>PX4_SIM_MODEL</code>. :::</p><ul><li><p><code>PX4_GZ_MODEL_POSE</code>: встановлює позицію відтворення та орієнтацію моделі коли вжито <code>PX4_SIM_MODEL</code>. Якщо вказано, скрипт запуску відтворює модель у положенні, що дотримується синтаксису <code>&quot;x,y,z,roll,pitch,yaw&quot;</code>, де позиції надаються в метрах, а кути - в радіанах.</p><ul><li>Якщо опущено, використовується нульове положення <code>[0,0,0,0,0,0]</code>.</li><li>Якщо надано менше ніж 6 значень, то відсутні фіксуються на нулі.</li><li>Можна використовувати лише зі змінною <code>PX4_SIM_MODEL</code> (не <code>PX4_GZ_MODEL_NAME</code>).</li></ul></li><li><p><code>PX4_GZ_WORLD</code>: встановлює файл світу Gazebo для нової симуляції. Якщо не вказано, тоді використовується <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/Tools/simulation/gz/worlds/default.sdf" target="_blank" rel="noreferrer">default</a>.</p><ul><li>Ця змінна ігнорується, якщо наявна модель вже запущена.</li><li>Це значення повинно бути <a href="#adding-new-worlds-and-models">вказано для обраного планера</a>, але може бути перевизначено використовуючи цей аргумент.</li></ul></li><li><p><code>PX4_SIMULATOR=GZ</code>: встановлює симулятор, для Gazebo це повинно бути <code>gz</code>.</p><ul><li>Це значення має бути <a href="#adding-new-worlds-and-models">встановлено для обраного планера</a>, і в цьому випадку не повинно бути вказано як аргумент.</li></ul></li><li><p><code>PX4_GZ_STANDALONE</code>: Дозволяє PX4 зрозуміти що він не повинен запускати екземпляр Gazebo. Gazebo потрібно буде запустити окремо, як описано в <a href="#standalone-mode">Автономному режимі</a>.</p></li><li><p><code>PX4_GZ_SIM_RENDER_ENGINE</code>: Встановлює рушій рендерингу, який буде використовуватися в Gazebo.</p><p>Рушій рендерингу за замовчуванням (OGRE 2) погано підтримується на деяких платформах/середовищах. Вкажіть <code>PX4_GZ_SIM_RENDER_ENGINE=ogre</code>, щоб встановити рушій рендерингу на OGRE 1, якщо у вас виникають проблеми з рендерингом при запуску PX4 на віртуальній машині.</p></li></ul><p>Світи PX4 Gazebo та бази даних моделей <a href="https://github.com/PX4/PX4-gazebo-models" target="_blank" rel="noreferrer">можна знайти на Github тут</a>.</p><p>:::note <code>gz_env.sh.in</code> скомпільовано і зроблено доступним у <code>$PX4_DIR/build/px4_sitl_default/rootfs/gz_env.sh</code> :::</p><h3 id="приклади" tabindex="-1">Приклади <a class="header-anchor" href="#приклади" aria-label="Permalink to &quot;Приклади&quot;">​</a></h3><p>Ось кілька прикладів різних сценаріїв, описаних вище.</p><ol><li><p><strong>Запуск симулятора + світ за замовчуванням + відтворення засобу у позиції за замовчуванням</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_SYS_AUTOSTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_SIM_MODEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gz_x500</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div></li><li><p><strong>Запуск симулятора + світ за замовчуванням + відтворення засобу у довільній позиції (y=2 м)</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_SYS_AUTOSTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_GZ_MODEL_POSE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0,2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_SIM_MODEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gz_x500</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div></li><li><p><strong>Запуск симулятора + світ за замовчуванням + зв&#39;язування з наявним засобом</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_SYS_AUTOSTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_GZ_MODEL_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">x500</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div></li><li><p><strong>Запуск симулятора в автономному режимі + під&#39;єднання до екземпляра Gazebo що виконує світ за замовчуванням</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_GZ_STANDALONE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_SYS_AUTOSTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_SIM_MODEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gz_x500</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div><p>В окремому терміналі запустіть:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/simulation-gazebo</span></span></code></pre></div></li></ol><h2 id="додавання-нових-світів-та-моделеи" tabindex="-1">Додавання нових світів та моделей <a class="header-anchor" href="#додавання-нових-світів-та-моделеи" aria-label="Permalink to &quot;Додавання нових світів та моделей&quot;">​</a></h2><p>SDF файли, файли сіток, текстури та будь-що інше, що пов&#39;язано з функціоналом та зовнішнім виглядом Gazebo для світів та моделей може бути розміщено у відповідних директоріях <code>/worlds</code> та <code>/models</code> у <a href="https://github.com/PX4/PX4-gazebo-models" target="_blank" rel="noreferrer">PX4-gazebo-models</a>.</p><p>В межах PX4 дотримуйтесь наступних кроків, щоб додати моделі та світи.</p><h3 id="додавання-моделі" tabindex="-1">Додавання моделі <a class="header-anchor" href="#додавання-моделі" aria-label="Permalink to &quot;Додавання моделі&quot;">​</a></h3><p>Щоб додати нову модель:</p><ol><li><p>Визначте <a href="./../dev_airframes/adding_a_new_frame.html">конфігураційний файл планера</a>.</p></li><li><p>Визначте параметри за замовчуванням для Gazebo у файлі конфігурації планера (цей приклад взято з <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/ROMFS/px4fmu_common/init.d-posix/airframes/4001_gz_x500" target="_blank" rel="noreferrer">квадрокоптера x500</a>):</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PX4_SIMULATOR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=\${PX4_SIMULATOR:=gz}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PX4_GZ_WORLD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=\${PX4_GZ_WORLD:=default}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PX4_SIM_MODEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=\${PX4_SIM_MODEL:=&lt;your model name&gt;}</span></span></code></pre></div><ul><li><p><code>PX4_SIMULATOR=\${PX4_SIMULATOR:=gz}</code> встановлює симулятор за замовчуванням (Gz) для цього конкретного планера.</p></li><li><p><code>PX4_GZ_WORLD=\${PX4_GZ_WORLD:=default}</code> встановлює <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/Tools/simulation/gz/worlds/default.sdf" target="_blank" rel="noreferrer">світ за замовчуванням</a> для цього конкретного планера.</p></li><li><p>Встановлення значення за замовчуванням для <code>PX4_SIM_MODEL</code> дозволить запустити симуляцію лише з:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_SYS_AUTOSTART</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> airframe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./build/px4_sitl_default/bin/px4</span></span></code></pre></div></li></ul></li><li><p>Додайте ціль CMake для <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/ROMFS/px4fmu_common/init.d-posix/airframes/CMakeLists.txt" target="_blank" rel="noreferrer">планера</a>.</p><ul><li>Якщо плануєте використовувати &quot;звичайний&quot; режим, додайте файл SDF вашої моделі у <code>Tools/simulation/gz/models/</code>.</li><li>Якщо плануєте використовувати <em>автономний</em> режим, додайте SDF файл вашої моделі у<code>~/.simulation-gazebo/models/</code></li></ul><p>Ви звичайно також можете використовувати обидва варіанти.</p></li></ol><h3 id="додавання-світу" tabindex="-1">Додавання світу <a class="header-anchor" href="#додавання-світу" aria-label="Permalink to &quot;Додавання світу&quot;">​</a></h3><p>Щоб додати новий світ:</p><ol><li><p>Додайте ваш світ до переліку світів знайдений у <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/simulation/gz_bridge/CMakeLists.txt" target="_blank" rel="noreferrer"><code>CMakeLists.txt</code> тут</a>. Це необхідно, щоб <code>CMake</code> зміг згенерувати правильні цілі збірки.</p><ul><li>Якщо плануєте використовувати &quot;звичайний&quot; режим, додайте файл SDF вашого світу у <code>Tools/simulation/gz/worlds/</code>.</li><li>Якщо плануєте використовувати <em>автономний</em> режим, додайте файл SDF вашого світу у <code>~/.simulation-gazebo/worlds/</code></li></ul></li></ol><p>:::note Допоки файл світу та моделі у шляху пошуку Gazebo (<code>GZ_SIM_RESOURCE_PATH</code>) немає потреби додавати їх у директорії world та model PX4. Однак <code>make px4_sitl gz_&lt;model&gt;_&lt;world&gt;</code> не працюватиме з ними. :::</p><h2 id="синхронізація-часу-px4-gazebo" tabindex="-1">Синхронізація часу PX4-Gazebo <a class="header-anchor" href="#синхронізація-часу-px4-gazebo" aria-label="Permalink to &quot;Синхронізація часу PX4-Gazebo&quot;">​</a></h2><p>На відміну від симуляторів Gazebo Classic та jMAVSim, PX4 та Gazebo не реалізують механізм синхронізації.</p><p>Під час симуляцій Gazebo PX4 підписується на рубрику Gazebo <code>\\clock</code> та використовує її як джерело синхронізації. Це гарантує, що PX4 завжди чекатиме Gazebo перед тим як рухатися вперед у часі, навіть якщо Gazebo працює з фактором реального часу відмінним від 1.</p><p>Зауважте, однак, оскільки синхронізація відсутня, Gazebo ніколи не чекатиме завершення обчислень PX4. У найгіршому випадку, PX4 може повністю відключитися, а Gazebo продовжить виконання з очевидними аваріями дронів, що симулюються.</p><h2 id="симуляція-кількох-рухомих-засобів" tabindex="-1">Симуляція кількох рухомих засобів <a class="header-anchor" href="#симуляція-кількох-рухомих-засобів" aria-label="Permalink to &quot;Симуляція кількох рухомих засобів&quot;">​</a></h2><p>Симуляція кількох засобів підтримується на комп&#39;ютерах з Linux.</p><p>Для додаткової інформації дивіться: <a href="./../sim_gazebo_gz/multi_vehicle_simulation.html">Симуляція кількох засобів з Gazebo</a></p><h2 id="додаткова-інформація" tabindex="-1">Додаткова інформація <a class="header-anchor" href="#додаткова-інформація" aria-label="Permalink to &quot;Додаткова інформація&quot;">​</a></h2><ul><li><a href="https://github.com/Auterion/px4-simulation-ignition" target="_blank" rel="noreferrer">px4-simulation-ignition</a></li></ul>`,80),n=[h,o,p];function d(r,k,c,g,u,b){return t(),e("div",null,n)}const m=i(l,[["render",d]]);export{F as __pageData,m as default};
