import{_ as t,a as e,b as i,c as a,d as l,e as s,f as r,g as n,h as p,i as d,j as h,k as g,l as o,m as k,n as c}from"./chunks/stlinkv3_minie_p15.CkaCUe5j.js";import{_ as m,c as u,o as x,ab as f}from"./chunks/framework.CUflZczI.js";const L=JSON.parse('{"title":"Зонд налагодження STLink","description":"","frontmatter":{},"headers":[],"relativePath":"uk/debug/probe_stlink.md","filePath":"uk/debug/probe_stlink.md"}'),b={name:"uk/debug/probe_stlink.md"},y=f(`<h1 id="зонд-налагодження-stlink" tabindex="-1">Зонд налагодження STLink <a class="header-anchor" href="#зонд-налагодження-stlink" aria-label="Permalink to &quot;Зонд налагодження STLink&quot;">​</a></h1><p><a href="https://www.st.com/en/development-tools/stlink-v3minie.html" target="_blank" rel="noreferrer">STLinkv3-MINIE</a> дешевий, швидкий та високоякісний зонд для налагодження який може працювати як самостійний консольний та налагоджувальний передавач для розробника PX4:</p><ul><li>Тільки єдине USB-C з&#39;єднання для Reset, SWD, SWO та послідовного входу у дуже компактному виконанні!</li><li>З&#39;єднання по протоколах SWD та SWO - до 24 МГц. Послідовне з&#39;єднання - до 16 мега бод. Цільова напруга від 1.65В до 3.6В. З&#39;єднання по високошвидкісному протоколу USB2 до 480 Мбіт/c.</li><li>Керований програмним забезпеченням STLink або OpenOCD із широкою підтримкою пристроїв.</li><li>Набагато дешевше (&lt;15€) ніж адаптер налагодження Pixhawk (~20€) з JLink EDU mini (~55€) або JLink BASE (~400€) при кращих апаратних характеристиках.</li></ul><p>Зонд STLink постачається без адаптера для роботи з контролерами польоту Pixhawk. Розділ <a href="#pixhawk-debug-port-adapter">Адаптер порту налагодження Pixhawk</a> пояснює як можна створити власний (потрібно трохи паяння).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The <a href="./../debug/swd_debug.html#cuav-c-adb-pixhawk-debug-adapter">Адаптер налагодження CUAV C-ADB Pixhawk</a> (~65€) постачається з STLinkv3-MINIE! Він має роз&#39;єм для <a href="./../debug/swd_debug.html#pixhawk-debug-full">Pixhawk Debug Full</a> SH порту з 10 контактами (але не для порту <a href="./../debug/swd_debug.html#pixhawk-debug-mini">Pixhawk Debug Mini</a>).</p></div><h2 id="налаштування-налагодження" tabindex="-1">Налаштування налагодження <a class="header-anchor" href="#налаштування-налагодження" aria-label="Permalink to &quot;Налаштування налагодження&quot;">​</a></h2><p>STLink надає <a href="https://openocd.org/doc-release/html/index.html" target="_blank" rel="noreferrer">GDB сервер за допомогою OpenOCD</a>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ubuntu</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openocd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open-ocd</span></span></code></pre></div><p>Ви можете запустити сервер GDB в новому терміналі:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openocd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> interface/stlink.cfg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> target/stm32f7x.cfg</span></span></code></pre></div><p>Файл налаштувань повинен бути:</p><ul><li>FMUv2-v4: <code>-f target/stm32f4x.cfg</code></li><li>FMUv5: <code>-f target/stm32f7x.cfg</code></li><li>FMUv6: <code>-f target/stm32h7x.cfg</code></li></ul><p>Потім можна під&#39;єднатися до порту 3333 через GDB:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arm-none-eabi-gdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/px4_fmu-v5x_default/px4_fmu-v5x_default.elf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target extended-remote :3333&quot;</span></span></code></pre></div><p>Дивіться <a href="https://pypi.org/project/emdbg/" target="_blank" rel="noreferrer">Вбудовані інструменти налагодження</a> для розширених варіантів налаштування налагодження.</p><h2 id="адаптер-порту-налагодження-pixhawk" tabindex="-1">Адаптер порту налагодження Pixhawk <a class="header-anchor" href="#адаптер-порту-налагодження-pixhawk" aria-label="Permalink to &quot;Адаптер порту налагодження Pixhawk&quot;">​</a></h2><p>Для з&#39;єднання з портом налагодження Pixhawk, потрібно спаяти адаптер (якщо не використовуєте <a href="./../debug/swd_debug.html#cuav-c-adb-pixhawk-debug-adapter">адаптер налагодження CUAV</a>).</p><p>Для цієї інструкції паяння вам знадобиться:</p><ul><li><p>1x <a href="https://www.st.com/en/development-tools/stlink-v3minie.html" target="_blank" rel="noreferrer">STLinkv3-MINIE</a>.</p></li><li><p>1x роз&#39;єм кабелю для сполучення з <a href="https://www.digikey.com/products/en?keywords=A10SR10SR30K203A" target="_blank" rel="noreferrer">JST SM10B (Full)</a> або <a href="https://www.digikey.com/products/en?keywords=A06SR06SR30K152A" target="_blank" rel="noreferrer">JST SM06B (Mini)</a>.</p><p>Рекомендуємо купувати повністю зібрані кабелі з двома роз&#39;ємами з обох боків.</p></li><li><p>1x паяльник та припій.</p></li><li><p>Щипці, плоскогубці та пінцет.</p></li></ul><p><a href="https://github.com/pixhawk/Pixhawk-Standards/blob/master/DS-009%20Pixhawk%20Connector%20Standard.pdf" target="_blank" rel="noreferrer">Порт налагодження Pixhawk стандартизовано у документі DS-009</a> та повинен бути з&#39;єднаний з роз&#39;ємом CN2 плати з&#39;єднання STLinkv3-MINIE Board-To-Board (BTB). Зіставлення контактів описано тут:</p><table><thead><tr><th style="text-align:right;">№ контакту SM10B (Full)</th><th style="text-align:right;">№ контакту SM06B (Mini)</th><th style="text-align:left;">Порт Pixhawk</th><th style="text-align:left;">STLinkv3</th><th style="text-align:right;">№ контакту BTB</th></tr></thead><tbody><tr><td style="text-align:right;">1</td><td style="text-align:right;">1</td><td style="text-align:left;"><strong>VREF</strong></td><td style="text-align:left;">VCC</td><td style="text-align:right;">10</td></tr><tr><td style="text-align:right;">2</td><td style="text-align:right;">2</td><td style="text-align:left;">TX консолі (вихід)</td><td style="text-align:left;">TX (вхід)</td><td style="text-align:right;">8</td></tr><tr><td style="text-align:right;">3</td><td style="text-align:right;">3</td><td style="text-align:left;">RX консолі (вхід)</td><td style="text-align:left;">RX (вихід)</td><td style="text-align:right;">7</td></tr><tr><td style="text-align:right;">4</td><td style="text-align:right;">4</td><td style="text-align:left;"><strong>SWDIO</strong></td><td style="text-align:left;">TMS</td><td style="text-align:right;">3</td></tr><tr><td style="text-align:right;">5</td><td style="text-align:right;">5</td><td style="text-align:left;"><strong>SWCLK</strong></td><td style="text-align:left;">CLK</td><td style="text-align:right;">4</td></tr><tr><td style="text-align:right;">6</td><td style="text-align:right;"></td><td style="text-align:left;">SWO</td><td style="text-align:left;">TDO</td><td style="text-align:right;">5</td></tr><tr><td style="text-align:right;">7</td><td style="text-align:right;"></td><td style="text-align:left;">GPIO1</td><td style="text-align:left;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">8</td><td style="text-align:right;"></td><td style="text-align:left;">GPIO2</td><td style="text-align:left;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">9</td><td style="text-align:right;"></td><td style="text-align:left;">nRST</td><td style="text-align:left;">RST</td><td style="text-align:right;">9</td></tr><tr><td style="text-align:right;">10</td><td style="text-align:right;">6</td><td style="text-align:left;"><strong>GND</strong></td><td style="text-align:left;">GND</td><td style="text-align:right;">6</td></tr></tbody></table><p>Контакти GPIO1/2 не підтримуються STLinkv3 та ми рекомендуємо користуватись цифровим ITM профілюванням через SWO що є найбільш гнучким та підтримує точний вимір часу між циклами.</p><p>Ви можете спаяти короткий або довгий кабель для BTB роз&#39;єму. Короткий кабель краще підходить для високошвидкісного зв&#39;язку, але його складніше паяти. Ми рекомендуємо спочатку спаяти довгий кабель і перевірити, наскільки швидким буде з&#39;єднання з цільовим об&#39;єктом.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Ця інструкція написана для 10-контактного порту налагодження. Якщо ви хочете спаяти мініверсію з 6 контактами, просто пропустіть сигнали, яких у вас немає. STLink підтримує будь-який інтерфейс налагодження на основі SWD/JTAG, тому ви можете адаптувати цю інструкцію для будь-якого роз&#39;єму, який у вас є. Зонди налагодження настільки дешеві, що ви можете мати по одному на кожен роз&#39;єм замість використання адаптерів.</p></div><p>STLinkv3-MINIE постачається ось таким чином.</p><p><img src="`+t+'" alt=""></p><p>Розпакуйте плату і перевірте її на наявність пошкоджень. Під&#39;єднайте її до живлення та переконайтеся, що вона вмикається правильно.</p><p><img src="'+e+'" alt=""></p><h3 id="короткии-кабель" tabindex="-1">Короткий кабель <a class="header-anchor" href="#короткии-кабель" aria-label="Permalink to &quot;Короткий кабель&quot;">​</a></h3><p>Короткий кабель потребує інструмент для обрізання та зачистки кабелю та трохи більше навичок пайки. Однак це робить увесь зонд налагодження ще меншим.</p><p>Зберіть 10-контактний роз&#39;єм без GPIO1/2. Якщо у вас вже є зібраний кабель, обережно видаліть два дроти GPIO1/2 за допомогою пінцета, піднімаючи штирі, які утримують їх на місці. Відріжте дроти на невелику довжину у приблизно 2 см (1 дюйм) та зачистить їх.</p><p><img src="'+i+'" alt=""></p><p>Залудіть як роз&#39;єм BTB на STLink так і кабелі.</p><p><img src="'+a+'" alt=""></p><p>Спочатку припаяйте сигнальні дроти для GND та VCC, щоб вирівняти роз&#39;єм паралельно до краю. Потім припаяйте контакти TX та RX. Припаяйте з&#39;єднання RST останнім.</p><p><img src="'+l+'" alt=""></p><p>Переверніть STLink і припаяйте три дроти, що залишились. Почніть з SWDIO-&gt;TMS, потім SWCLK-&gt;CLK, і нарешті SWO-&gt;TDO.</p><p><img src="'+s+'" alt=""></p><h3 id="довгии-кабель" tabindex="-1">Довгий кабель <a class="header-anchor" href="#довгии-кабель" aria-label="Permalink to &quot;Довгий кабель&quot;">​</a></h3><p>Довгий кабель особливо корисний, якщо ви використовуєте вже зібрані кабелі, оскільки він усуває потребу в обрізанні або знятті ізоляції з проводів.</p><p>Обережно вийміть два дроти GPIO1/2 з одного роз&#39;єму кабелю. Потім від&#39;єднайте всі дроти від іншого роз&#39;єму. У вас залишилось вісім обжатих роз&#39;ємів на кінці дротів.</p><p><img src="'+r+'" alt=""></p><p>Залудіть обжаті роз&#39;єми та роз&#39;єм BTB та припаяйте обжаті роз&#39;єми безпосередньо до STLinkv3. Будьте обережні, щоб не створити коротке замикання між дротами, оскільки обжаті роз&#39;єми досить великі.</p><p><img src="'+n+'" alt=""></p><h3 id="перевірка" tabindex="-1">Перевірка <a class="header-anchor" href="#перевірка" aria-label="Permalink to &quot;Перевірка&quot;">​</a></h3><p>Тепер слід протестувати зонд для налагодження, щоб переконатися, що немає жодних коротких замикань.</p><ol><li>Під&#39;єднайте зонд до цілі через роз&#39;єм налагодження Pixhawk.</li><li>Перевірте послідовний порт за допомогою програми за вибором.</li><li>Перевірте з&#39;єднання SWD та RST за допомогою програмного забезпечення [OpenOCD][<a href="https://openocd.org" target="_blank" rel="noreferrer">https://openocd.org</a>] або <a href="https://www.st.com/en/development-tools/stsw-link004.html" target="_blank" rel="noreferrer">STLink</a>.</li><li>Перевірте підключення SWO за допомогою [Orbuculum][<a href="https://github.com/orbcode/orbuculum%5C" target="_blank" rel="noreferrer">https://github.com/orbcode/orbuculum\\</a>].</li></ol><p>Дивіться <a href="https://pypi.org/project/emdbg/" target="_blank" rel="noreferrer">Вбудовані інструменти налагодження</a> для отримання додаткової інформації про програмну підтримку контролерів польоту PX4 FMUv5 та FMUv6.</p><h3 id="зменшення-зонду" tabindex="-1">Зменшення зонду <a class="header-anchor" href="#зменшення-зонду" aria-label="Permalink to &quot;Зменшення зонду&quot;">​</a></h3><p>Цей крок видаляє 14-контактний інтерфейс для налагодження на задній частині STLinkv3-MINIE та додає термоусадку навколо всього пристрою для поліпшення поводження та запобігання короткому замиканню STLink на металеві деталі або плати. Цей крок є виключно необов&#39;язковим та потребує:</p><ul><li>1x Термоусадка діаметром 20 мм та довжиною приблизно 5 см.</li><li>1x плаский затискач для утримання STLinkv3 за порт USB-C.</li><li>1x дрібні плоскогубці або паяльник.</li><li>1x паяльний фен.</li></ul><p>Використайте плоскогубці, щоб обережно витягнути пластикову частину роз&#39;єму STDC14. Залишаться тільки контакти роз&#39;єму.</p><p><img src="'+p+'" alt=""></p><p>За допомогою дрібних плоскогубців відріжте контакти роз&#39;єму дуже обережно, щоб не пошкодити плату або будь-які компоненти на платі. Або ж ви можете випаяти ці контакти роз&#39;єму з плати, але це може зайняти більше часу.</p><p><img src="'+d+'" alt=""></p><p>Поверніть STLinkv3, щоб обрізати інший ряд контактів, знову дуже обережно, щоб нічого не пошкодити.</p><p><img src="'+h+'" alt=""></p><p>Відріжте кусок термоусадки довжиною приблизно 5 см (2 дюйми). Він повинен бути вирівняний з роз&#39;ємом USB-C і трохи виступати за межі краю.</p><p><img src="'+g+'" alt=""></p><p>Утримуйте плату та термоусадку за допомогою плаского затискача за <strong>нижню</strong> металеву частину роз&#39;єму USB-C. Будьте обережні, щоб помилково не стиснути середню пластикову частину роз&#39;єму USB-C!</p><p><img src="'+o+'" alt=""></p><p>За допомогою фену зменште термоусадку навколо зонду налагодження. Переконайтеся, що усадка рівномірно стиснута і захищає всю плату.</p><p><img src="'+k+'" alt=""></p><p>За бажанням, ви можете додати логотип за вибором, надрукований на папері та обрізаний за розміром. Зверніть увагу, що нагрів може призвести до плину чорнил, тому може знадобитися поекспериментувати з налаштуваннями фену, які працюють з вашим принтером.</p><p><img src="'+c+'" alt=""></p><h2 id="дивіться-також" tabindex="-1">Дивіться також <a class="header-anchor" href="#дивіться-також" aria-label="Permalink to &quot;Дивіться також&quot;">​</a></h2><ul><li><a href="https://www.st.com/resource/en/user_manual/um2910-stlinkv3minie-debuggerprogrammer-tiny-probe-for-stm32-microcontrollers-stmicroelectronics.pdf" target="_blank" rel="noreferrer">Міні-зонд для відлагодження/програмування STLINK-V3MINIE для мікроконтролерів STM32</a> (Посібник користувача)</li></ul>',67),_=[y];function S(T,F,C,v,w,B){return x(),u("div",null,_)}const I=m(b,[["render",S]]);export{L as __pageData,I as default};
