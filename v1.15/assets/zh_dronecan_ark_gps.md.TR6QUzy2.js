import{_ as e}from"./chunks/ark_gps.BZpKphjf.js";import{_ as a,c as r,o as i,ab as n}from"./chunks/framework.CUflZczI.js";const g=JSON.parse('{"title":"ARK GPS (DroneCAN)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/dronecan/ark_gps.md","filePath":"zh/dronecan/ark_gps.md"}'),o={name:"zh/dronecan/ark_gps.md"},t=n('<h1 id="ark-gps-dronecan" tabindex="-1">ARK GPS (DroneCAN) <a class="header-anchor" href="#ark-gps-dronecan" aria-label="Permalink to &quot;ARK GPS (DroneCAN)&quot;">​</a></h1><p>ARK GPS is an open source <a href="./">DroneCAN</a> <a href="./../gps_compass/">GNSS/GPS</a>, magnetometer, IMU, barometer, buzzer, and safety switch module.</p><p><img src="'+e+'" alt="ARK GPS"></p><h2 id="where-to-buy" tabindex="-1">Where to Buy <a class="header-anchor" href="#where-to-buy" aria-label="Permalink to &quot;Where to Buy&quot;">​</a></h2><p>Order this module from:</p><ul><li><a href="https://arkelectron.com/product/ark-gps/" target="_blank" rel="noreferrer">ARK Electronics</a> (US)</li></ul><h2 id="hardware-specifications" tabindex="-1">Hardware Specifications <a class="header-anchor" href="#hardware-specifications" aria-label="Permalink to &quot;Hardware Specifications&quot;">​</a></h2><ul><li><a href="https://github.com/ARK-Electronics/ARK_GPS" target="_blank" rel="noreferrer">Open Source Schematic and BOM</a></li><li>Sensors <ul><li>Ublox M9N GPS <ul><li>Ultra-robust meter-level GNSS positioning</li><li>Maximum position availability with concurrent reception of 4 GNSS</li><li>Advanced spoofing and jamming detection</li><li>Excellent RF interference mitigation</li></ul></li><li>Bosch BMM150 Magnetometer</li><li>Bosch BMP388 Barometer</li><li>Invensense ICM-42688-P 6-Axis IMU</li></ul></li><li>STM32F412CEU6 MCU</li><li>Safety Button</li><li>Buzzer</li><li>Two Pixhawk Standard CAN Connectors (4 Pin JST GH)</li><li>Pixhawk Standard Debug Connector (6 Pin JST SH)</li><li>Small Form Factor <ul><li>5cm x 5cm x 1cm</li></ul></li><li>LED Indicators <ul><li>Safety LED</li><li>GPS Fix</li><li>RGB System Status</li></ul></li><li>USA Built</li><li>Power Requirements <ul><li>5V</li><li>110mA Average</li><li>117mA Max</li></ul></li></ul><h2 id="hardware-setup" tabindex="-1">Hardware Setup <a class="header-anchor" href="#hardware-setup" aria-label="Permalink to &quot;Hardware Setup&quot;">​</a></h2><h3 id="wiring" tabindex="-1">Wiring <a class="header-anchor" href="#wiring" aria-label="Permalink to &quot;Wiring&quot;">​</a></h3><p>The ARK GPS is connected to the CAN bus using a Pixhawk standard 4 pin JST GH cable. For more information, refer to the <a href="./../can/#wiring">CAN Wiring</a> instructions.</p><h3 id="mounting" tabindex="-1">Mounting <a class="header-anchor" href="#mounting" aria-label="Permalink to &quot;Mounting&quot;">​</a></h3><p>The recommended mounting orientation is with the connectors on the board pointing towards the <strong>back of vehicle</strong>.</p><p>The sensor can be mounted anywhere on the frame, but you will need to specify its position, relative to vehicle centre of gravity, during <a href="#px4-configuration">PX4 configuration</a>.</p><h2 id="firmware-setup" tabindex="-1">Firmware Setup <a class="header-anchor" href="#firmware-setup" aria-label="Permalink to &quot;Firmware Setup&quot;">​</a></h2><p>ARK GPS runs the <a href="./px4_cannode_fw.html">PX4 DroneCAN Firmware</a>. As such, it supports firmware update over the CAN bus and <a href="./../dronecan/#node-id-allocation">dynamic node allocation</a>.</p><p>ARK GPS boards ship with recent firmware pre-installed, but if you want to build and flash the latest firmware yourself see <a href="./px4_cannode_fw.html#building-the-firmware">PX4 DroneCAN Firmware &gt; Building the Firmware</a>.</p><ul><li>Firmware target: <code>ark_can-gps_default</code></li><li>Bootloader target: <code>ark_can-gps_canbootloader</code></li></ul><h2 id="px4-configuration" tabindex="-1">PX4 Configuration <a class="header-anchor" href="#px4-configuration" aria-label="Permalink to &quot;PX4 Configuration&quot;">​</a></h2><p>You need to set necessary <a href="./">DroneCAN</a> parameters and define offsets if the sensor is not centred within the vehicle. The required settings are outlined below.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The ARK GPS will not boot if there is no SD card in the flight controller when powered on.</p></div><h3 id="enable-dronecan" tabindex="-1">Enable DroneCAN <a class="header-anchor" href="#enable-dronecan" aria-label="Permalink to &quot;Enable DroneCAN&quot;">​</a></h3><p>In order to use the ARK GPS board, connect it to the Pixhawk CAN bus and enable the DroneCAN driver by setting parameter <a href="./../advanced_config/parameter_reference.html#UAVCAN_ENABLE">UAVCAN_ENABLE</a> to <code>2</code> for dynamic node allocation (or <code>3</code> if using <a href="./../dronecan/escs.html">DroneCAN ESCs</a>).</p><p>The steps are:</p><ul><li>In <em>QGroundControl</em> set the parameter <a href="./../advanced_config/parameter_reference.html#UAVCAN_ENABLE">UAVCAN_ENABLE</a> to <code>2</code> or <code>3</code> and reboot (see <a href="./../advanced_config/parameters.html">Finding/Updating Parameters</a>).</li><li>Connect ARK GPS CAN to the Pixhawk CAN.</li></ul><p>Once enabled, the module will be detected on boot. GPS data should arrive at 10Hz.</p><p>DroneCAN configuration in PX4 is explained in more detail in <a href="./../dronecan/#enabling-dronecan">DroneCAN &gt; Enabling DroneCAN</a>.</p><h3 id="sensor-position-configuration" tabindex="-1">Sensor Position Configuration <a class="header-anchor" href="#sensor-position-configuration" aria-label="Permalink to &quot;Sensor Position Configuration&quot;">​</a></h3><p>If the sensor is not centred within the vehicle you will also need to define sensor offsets:</p><ul><li>Enable GPS yaw fusion by setting bit 3 of <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_CTRL">EKF2_GPS_CTRL</a> to true.</li><li>Enable <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_GPS">UAVCAN_SUB_GPS</a>, <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_MAG">UAVCAN_SUB_MAG</a>, and <a href="./../advanced_config/parameter_reference.html#UAVCAN_SUB_BARO">UAVCAN_SUB_BARO</a>.</li><li>Set <a href="./../advanced_config/parameter_reference.html#CANNODE_TERM">CANNODE_TERM</a> to <code>1</code> if this is that last node on the CAN bus.</li><li>The parameters <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_X">EKF2_GPS_POS_X</a>, <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_Y">EKF2_GPS_POS_Y</a> and <a href="./../advanced_config/parameter_reference.html#EKF2_GPS_POS_Z">EKF2_GPS_POS_Z</a> can be set to account for the offset of the ARK GPS from the vehicles centre of gravity.</li></ul><h2 id="led-meanings" tabindex="-1">LED Meanings <a class="header-anchor" href="#led-meanings" aria-label="Permalink to &quot;LED Meanings&quot;">​</a></h2><p>You will see green, blue and red LEDs on the ARK GPS when it is being flashed, and a blinking green LED if it is running properly.</p><p>If you see a red LED there is an error and you should check the following:</p><ul><li>Make sure the flight controller has an SD card installed.</li><li>Make sure the ARK GPS has <code>ark_can-gps_canbootloader</code> installed prior to flashing <code>ark_can-gps_default</code>.</li><li>Remove binaries from the root and ufw directories of the SD card and try to build and flash again.</li></ul>',34),l=[t];function c(s,d,h,f,u,p){return i(),r("div",null,l)}const S=a(o,[["render",c]]);export{g as __pageData,S as default};
