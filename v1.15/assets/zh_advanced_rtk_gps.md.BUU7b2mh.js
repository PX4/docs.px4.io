import{_ as s,c as i,o as a,ab as n}from"./chunks/framework.CUflZczI.js";const g=JSON.parse('{"title":"RTK GPS (PX4 集成)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/advanced/rtk_gps.md","filePath":"zh/advanced/rtk_gps.md"}'),t={name:"zh/advanced/rtk_gps.md"},l=n(`<h1 id="rtk-gps-px4-集成" tabindex="-1">RTK GPS (PX4 集成) <a class="header-anchor" href="#rtk-gps-px4-集成" aria-label="Permalink to &quot;RTK GPS (PX4 集成)&quot;">​</a></h1><p><a href="https://en.wikipedia.org/wiki/Real_Time_Kinematic" target="_blank" rel="noreferrer">实时载波相位差分定位</a> （RTK）能够提供厘米级的定位信息。 这一章节将介绍 RTK 是如何集成到 PX4 中的。</p><div class="tip custom-block"><p class="custom-block-title">RTK</p><p>GNSS 的_使用说明_在 <a href="./../gps_compass/rtk_gps.html">硬件部分 &gt; RTK GPS</a>. 多个移动的用户可以共用同一个差分基准站发播的差分修正信息，移动用户离差分基准站的距离越近，差分定位更精确。</p><h2 id="综述" tabindex="-1">综述 <a class="header-anchor" href="#综述" aria-label="Permalink to &quot;综述&quot;">​</a></h2><p>RTK是使用导航信号的载波相位来进行测距的，而不是使用导航信号所搭载的信息。 它依靠一个单一的参考基站站实时校正，这种校正可以与多个流动站一起工作。</p><p>PX4 配置 RTK 需要两个 RTK GPS 模块和一个数传。 固定在地面上的GPS模块称为_基站端_，搭载在无人机上的称为_移动端_。 基站端通过USB连接到_QGroundControl_，然后通过数传将RTCM校正传输给无人机（使用MavLink的<a href="https://mavlink.io/en/messages/common.html#GPS_RTCM_DATA" target="_blank" rel="noreferrer">GPS_RTCM_DATA</a>消息）。 在自驾仪上，MAVLink消息包被解包得到RTCM的修正信息，并把这些信息发送给移动站，移动站结合修正信息最终解算得到 RTK 解。</p><p>数据链通常能够处理上行数据率为300字节每秒的数据（更详细的信息参考下面的<a href="#uplink-datarate">上行数据速率</a>章节）。</p><h2 id="支持的-rtk-gps-模块" tabindex="-1">支持的 RTK GPS 模块 <a class="header-anchor" href="#支持的-rtk-gps-模块" aria-label="Permalink to &quot;支持的 RTK GPS 模块&quot;">​</a></h2><p>下面列举的这些设备是经过我们测试的可以在 <a href="./../gps_compass/rtk_gps.html#supported-rtk-devices">用户手册</a> 找到。</p><p>:::note 大多数设备都有两个变体, 一个基站和一个移动站。 确保选择正确的变体。</p></div><h2 id="自动配置" tabindex="-1">自动配置 <a class="header-anchor" href="#自动配置" aria-label="Permalink to &quot;自动配置&quot;">​</a></h2><p>PX4会自动设置GPS 模块，并通过UART或USB发送和接收正确的消息，具体取决于模块连接到 <em>QGroundControl</em> 还是飞控。</p><p>一旦飞控接收到<code>GPS_RTCM_DATA</code> MAVLink 消息，它就会自动将 RTCM 数据通过现有数据通道转发到连接的 GPS 模块（不需要专用的校正数据通道）</p><p>::: note u-blox U-Center RTK 模块配置工具不需要/使用！ :::</p><div class="info custom-block"><p class="custom-block-title">_QGroundControl_和飞控固件共享相同的<a href="https://github.com/PX4/GpsDrivers" target="_blank" rel="noreferrer">PX4 GPS driver stack</a>。 实际上，这意味着只需要将新协议和/或消息添加到一个地方。</p></div><h3 id="rtcm-报文" tabindex="-1">RTCM 报文 <a class="header-anchor" href="#rtcm-报文" aria-label="Permalink to &quot;RTCM 报文&quot;">​</a></h3><p>QGroundControl 配置RTK 基地站输出以下 RTCM3.2 帧, 每个帧均为 1 Hz, 除非另有说明：</p><ul><li><strong>1005</strong> - 天线参考点的站坐标 XYZ (基站位置), 0.2 Hz。</li><li><strong>1077</strong> - 完整的 GPS 伪距、载波相、多普勒和信号强度(高分辨率)。</li><li><strong>1087</strong> - 所有 GLONASS 伪距、载波相、多普勒和信号强度(高分辨率)。</li><li><strong>1230</strong> - GLONASS 代码相位差。</li><li><strong>1097</strong> - 完整伽利略伪距、运载相、多普勒和信号强度(高分辨率)</li><li><strong>1127</strong> - 完整的北斗伪距，载波相位，多普勒和信号强度(高分辨率)</li></ul><h2 id="上行数据速率" tabindex="-1">上行数据速率 <a class="header-anchor" href="#上行数据速率" aria-label="Permalink to &quot;上行数据速率&quot;">​</a></h2><p>来自基础的原始 RTCM 消息被打包到一个 MAVLink <code>GPS_RTCM_DATA</code> 消息，并且通过数据链接发送。 MAVLink 消息的最大长度是182字节。 根据RTCM的信息类型，MAVLink信息是不会填满的。</p><p>RTCM 基础位置消息(1005)长度为 22 字节， 而其他卫星的长度则因可见卫星的数量和卫星信号的数量而异（M8P等L1单元只有一个）。 在真实环境中，对于任一时刻，任何一个导航系统的可用卫星个数不超过12个，因此 300 B/s的上行速率就足够了。</p><p>如果使用 <em>MAVLink 1</em> ，则不论其长度，每条 RTCM 消息都会发送182字节 <code>GPS_RTCM_DATA</code> 消息。 因此，大约每秒上行需求是700多个字节。 这可能导致低带宽半双轨遥测模块 (如3DR Telemetry Radios) 连接的饱和。</p><p>如果使用 <em>MAVLink 2</em>，则 <code>GPS_RTCM_DATA消息</code> 中的所有的空将被删除。 由此产生的上行链路需求与理论值 (约 300 字节/秒) 大致相同。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>PX4 自动切换到 MAVLink 2，如果GCS 和遥测模块支持。</p></div><p>MAVLink 2 必须用于低带宽链接以保证 RTK 性能。 必须注意确保数传链在整个过程中使用 MAVLink 2。 您可以使用系统控制台上的 <code>mavlink status</code> 命令验证协议版本：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nsh&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">instance</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        GCS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> heartbeat:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  593486</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> us</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ago</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chan:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:           </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3DR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RADIO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txbuf:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          94</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          61</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   58</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> errors:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        fixed:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        flow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ON</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rates:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        tx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.285</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txerr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mult:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.366</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        accepting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commands:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        MAVLink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        transport</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protocol:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (/dev/ttyS1 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@57600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,19),p=[l];function h(e,k,r,F,d,o){return a(),i("div",null,p)}const C=s(t,[["render",h]]);export{g as __pageData,C as default};
