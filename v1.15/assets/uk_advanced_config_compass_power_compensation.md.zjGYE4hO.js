import{_ as a,a as e,b as i,c as p}from"./chunks/comp_params.u_TZpdZZ.js";import{_ as t,c as o,o as s,ab as l}from"./chunks/framework.CUflZczI.js";const P=JSON.parse('{"title":"Компенсація потужності компасу","description":"","frontmatter":{},"headers":[],"relativePath":"uk/advanced_config/compass_power_compensation.md","filePath":"uk/advanced_config/compass_power_compensation.md"}'),n={name:"uk/advanced_config/compass_power_compensation.md"},r=l('<h1 id="компенсація-потужності-компасу" tabindex="-1">Компенсація потужності компасу <a class="header-anchor" href="#компенсація-потужності-компасу" aria-label="Permalink to &quot;Компенсація потужності компасу&quot;">​</a></h1><p>Компаси (магнітометри) повинні бути встановлені якнайдалі від кабелів, які переносять великі струми, оскільки вони створюють магнітні поля, які можуть вплинути на показання компасу.</p><p>Ця тема пояснює, як компенсувати виниклі магнітні поля у випадках, коли переміщення компасу нереалістичне.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Переміщення компасу подалі від кабелів, що переносять потужність, є найпростішим і найефективнішим способом вирішення цієї проблеми, оскільки сила магнітних полів зменшується квадратично з відстані від кабелю.</p></div><p>:::note Процес продемонстрований для багатороторного вертольота, але є так само ефективним для інших типів транспортних засобів. :::</p><p><a id="when"></a></p><h2 id="коли-застосовна-компенсація-потужності" tabindex="-1">Коли застосовна компенсація потужності? <a class="header-anchor" href="#коли-застосовна-компенсація-потужності" aria-label="Permalink to &quot;Коли застосовна компенсація потужності?&quot;">​</a></h2><p>Виконання компенсації потужності рекомендується лише у випадку, якщо виконуються всі наступні умови:</p><ol><li><p>Компас не може бути віддалений від кабелів, які переносять потужність.</p></li><li><p>Існує сильна кореляція між показаннями компасу та встановленим значенням тяги та/або поточним зарядом батареї.</p><p><img src="'+a+'" alt="Corrupted mag"></p></li><li><p>Кабелі дрона всі закріплені на місці / не рухаються (розраховані параметри компенсації будуть недійсними, якщо кабелі, які переносять струм, можуть рухатися).</p></li></ol><p><a id="how"></a></p><h2 id="як-компенсувати-компас" tabindex="-1">Як компенсувати компас <a class="header-anchor" href="#як-компенсувати-компас" aria-label="Permalink to &quot;Як компенсувати компас&quot;">​</a></h2><ol><li><p>Переконайтеся, що ваш дрон працює на версії прошивки, що підтримує компенсацію потужності (поточний майстер або версії від v.1.11.0).</p></li><li><p>Виконайте <a href="./../config/compass.html#compass-calibration">стандартну калібрування компасу</a>.</p></li><li><p>Встановіть параметр <a href="./../advanced_config/parameter_reference.html#SDLOG_MODE">SDLOG_MODE</a> на 2, щоб увімкнути журналювання даних після завантаження.</p></li><li><p>Встановіть прапорець параметра <a href="./../advanced_config/parameter_reference.html#SDLOG_PROFILE">SDLOG_PROFILE</a> для <em>Порівняння датчиків</em> (біт 6), щоб отримати більше точок даних.</p></li><li><p>Закріпіть дрон таким чином, щоб він не міг рухатися, та прикріпіть пропелери (щоб двигуни могли витягувати такий самий струм, як у повітрі). У цьому прикладі транспортний засіб закріплюється за допомогою ременів.</p><p><img src="'+e+'" alt="strap"></p></li><li><p>Увімкніть живлення транспортного засобу та переключіться у режим польоту <a href="./../flight_modes_mc/acro.html">ACRO</a> (використання цього режиму забезпечує, що транспортний засіб не намагатиметься компенсувати рух, що виникає від ременів).</p><ul><li>Збройте транспортний засіб і повільно підніміть оберти двигунів до максимуму.</li><li>Повільно знизьте швидкість обертання двигунів до нуля.</li><li>Звільнити автомобіль</li></ul><p>:::note Проведіть тест обережно і уважно моніторте вібрації. :::</p></li><li><p>Отримайте ulog та скористайтеся Python-скриптом <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/sensors/vehicle_magnetometer/mag_compensation/python/mag_compensation.py" target="_blank" rel="noreferrer">mag_compensation.py</a>, щоб ідентифікувати параметри компенсації.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mag_compensation.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/path/to/log/logfile.ulg</span></span></code></pre></div><p>:::note Якщо ваш журнал не містить вимірювань поточного заряду батареї, вам потрібно закоментувати відповідні рядки у Python-скрипті, щоб він робив розрахунок тільки для тяги. :::</p></li><li><p>Скрипт поверне ідентифікацію параметрів для тяги, а також для поточного і виведе їх у консоль. Цифри, які з&#39;являються зі скрипту, показують &quot;якість підгонки&quot; для кожного екземпляру компасу, а також те, як виглядатиме дані після компенсації за запропонованими значеннями. Якщо є вимірювання струму, використання компенсації поточного звичайно дає кращі результати. Ось приклад журналу, де відповідність струму добра, але параметри тяги непридатні, оскільки відношення не є лінійним.</p><p><img src="'+i+'" alt="line fit"></p></li><li><p>Після ідентифікації параметрів, компенсацію потужності потрібно ввімкнути, встановивши <a href="./../advanced_config/parameter_reference.html#CAL_MAG_COMP_TYP">CAL_MAG_COMP_TYP</a> на значення 1 (при використанні параметрів тяги) або 2 (при використанні параметрів струму). Додатково, параметри компенсації для кожної вісі кожного компасу повинні бути встановлені.</p><p><img src="'+p+'" alt="comp params"></p></li></ol>',12),c=[r];function _(m,h,d,g,f,u){return s(),o("div",null,c)}const v=t(n,[["render",_]]);export{P as __pageData,v as default};
