import{_ as s,c as i,o as a,ab as n}from"./chunks/framework.CUflZczI.js";const c=JSON.parse('{"title":"uORB 메시징","description":"","frontmatter":{},"headers":[],"relativePath":"ko/middleware/uorb.md","filePath":"ko/middleware/uorb.md"}'),t={name:"ko/middleware/uorb.md"},h=n(`<h1 id="uorb-메시징" tabindex="-1">uORB 메시징 <a class="header-anchor" href="#uorb-메시징" aria-label="Permalink to &quot;uORB 메시징&quot;">​</a></h1><h2 id="소개" tabindex="-1">소개 <a class="header-anchor" href="#소개" aria-label="Permalink to &quot;소개&quot;">​</a></h2><p>uORB는 스레드 간/프로세스 간 통신에 사용되는 비동기식 <code>publish()</code> / <code>subscribe()</code> 메시징 API입니다.</p><p>C++에서의 사용 방법은 <a href="./../modules/hello_sky.html">자습서</a>를 참고하십시오.</p><p>많은 응용 프로그램이 uORB에 의존하므로 uORB는 부팅시에 자동으로 시작됩니다. <code>uorb start</code> 로 시작합니다. 단위 테스트는 <code>uorb_tests</code>로 시작합니다.</p><h2 id="새로운-토픽-추가하기" tabindex="-1">새로운 토픽 추가하기 <a class="header-anchor" href="#새로운-토픽-추가하기" aria-label="Permalink to &quot;새로운 토픽 추가하기&quot;">​</a></h2><p>새로운 uORB 토픽은 메인 PX4/PX4-Autopilot 저장소에 추가하거나 트리 외부 메시지 정의에 추가할 수 있습니다. 트리 외부 uORB 메시지 정의 추가에 대한 정보는 <a href="./../advanced/out_of_tree_modules.html#out-of-tree-uorb-message-definitions">이 섹션</a>을 참고하십시오.</p><p>새 토픽을 추가하려면, <code>msg/</code> 디렉터리에 새 <strong>.msg</strong> 파일을 만들고 파일 이름을 <code>msg/CMakeLists.txt</code> 목록에 추가합니다. 이렇게 하면, 필요한 C/C++ 코드가 자동으로 생성됩니다.</p><p>지원되는 유형에 대한 기존 <code>msg</code> 파일을 살펴보십시오. 메시지는 다른 메시지에 중첩되어 사용될 수 있습니다.</p><p>생성된 각 C/C++ 구조체에 <code>uint64_t timestamp</code> 필드가 추가됩니다. 이것은 로거에 사용되며, 메시지 게시시에 입력하여야 합니다.</p><p>코드에서 주제를 사용하려면 헤더를 포함하십시오.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>#include &lt;uORB/topics/topic_name.h&gt;</span></span></code></pre></div><p><code>.msg</code> 파일에 다음과 같은 줄을 추가하여, 여러 개의 독립적인 토픽의 단일 메시지 정의를 사용할 수 있습니다.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># TOPICS mission offboard_mission onboard_mission</span></span></code></pre></div><p>그런 다음 코드에서 토픽 ID로 사용합니다. <code>ORB_ID(offboard_mission)</code>.</p><h2 id="퍼블리시-게시" tabindex="-1">퍼블리시(게시) <a class="header-anchor" href="#퍼블리시-게시" aria-label="Permalink to &quot;퍼블리시(게시)&quot;">​</a></h2><p>토픽 게시는 인터럽트 컨텍스트(<code>hrt_call</code> API에 의해 호출되는 함수)를 포함하여 시스템의 어디에서나 수행할 수 있습니다. However, the topic needs to be advertised and published outside of an interrupt context (at least once) before it can be published in an interrupt context.</p><h2 id="토픽-나열-및-듣기" tabindex="-1">토픽 나열 및 듣기 <a class="header-anchor" href="#토픽-나열-및-듣기" aria-label="Permalink to &quot;토픽 나열 및 듣기&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">The <code>listener</code> command is only available on Pixracer (FMUv4) and Linux / OS X.</p></div><p>모든 토픽을 나열하려면, 파일 핸들을 나열하십시오.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /obj</span></span></code></pre></div><p>5개의 메시지에 대해 한 토픽의 내용을 들으려면, 리스너를 실행하십시오.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listener</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sensor_accel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre></div><p>출력은 주제 내용의 n배입니다.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TOPIC:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sensor_accel</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">timestamp:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 84978861</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integral_dt:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4044</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error_count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">x:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">y:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">z:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">x_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">y_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">z_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">temperature:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 46</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">range_m_s2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 78</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scaling:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TOPIC:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sensor_accel</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">timestamp:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 85010833</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">integral_dt:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3980</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error_count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">x:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">y:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">z:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">x_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">y_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">z_integral:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">temperature:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 46</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">range_m_s2:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 78</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scaling:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>NuttX 기반 시스템(Pixhawk, Pixracer 등)에서 <em>QGroundControl</em> MAVLink 콘솔 내에서 <code>listener</code> 명령을 호출하여 센서 및 기타 주제의 값을 검사할 수 있습니다. 이것은 QGC가 무선 틍신으로 연결된 경우에도(예: 차량이 비행 중일 때) 사용할 수 있는 강력한 디버깅 도구입니다. 자세한 내용은 <a href="./../debug/sensor_uorb_topic_debugging.html">센서/주제 디버깅</a>을 참고하십시오.</p></div><h3 id="uorb-top-명령어" tabindex="-1">uorb top 명령어 <a class="header-anchor" href="#uorb-top-명령어" aria-label="Permalink to &quot;uorb top 명령어&quot;">​</a></h3><p><code>uorb top</code> 명령은 실시간으로 각 주제의 게시 빈도를 나타냅니다.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1s,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> num</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> topics:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 77</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TOPIC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        INST</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #SUB #MSG #LOST #QSIZE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">actuator_armed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">actuator_controls_0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1044</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">battery_status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  500</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2694</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commander_state</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   98</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    89</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">control_state</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   433</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ekf2_innovations</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   223</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ekf2_timestamps</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    23</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">estimator_status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   488</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mc_att_ctrl_status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sensor_accel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                         0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sensor_accel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                         1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  249</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    43</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sensor_baro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                          0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sensor_combined</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  242</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   636</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div><p>각 칼럼은 주제 이름, 다중 인스턴스 인덱스, 구독자 수, 게시 빈도(Hz), 초당 손실된 메시지 수(모든 구독자가 결합된 경우) 및 대기열 크기입니다.</p><h2 id="다중-인스턴스" tabindex="-1">다중 인스턴스 <a class="header-anchor" href="#다중-인스턴스" aria-label="Permalink to &quot;다중 인스턴스&quot;">​</a></h2><p>uORB는 <code>orb_advertise_multi</code>로 동일한 주제의 여러 독립 인스턴스를 게시하는 메커니즘을 제공합니다. 게시자에게 인스턴스 인덱스를 반환합니다. 그러면, 구독자는 <code>orb_subscribe_multi</code>를 사용하여, 구독할 인스턴스를 선택하여야 합니다(<code>orb_subscribe</code>는 첫 번째 인스턴스에 구독). 예를 들어, 시스템에 동일 유형의 센서가 여러 개 있는 경우에는 인스턴스가 여러 개 있으면 유용합니다.</p><p>동일한 주제에 대하여 <code>orb_advertise_multi</code>와 <code>orb_advertise</code>를 혼용하지 마십시오.</p><p>전체 API는 <a href="https://github.com/PX4/PX4-Autopilot/blob/master/platforms/common/uORB/uORBManager.hpp" target="_blank" rel="noreferrer">platforms/common/uORB/uORBManager.hpp</a>를 참고하십시오.</p><p><a id="deprecation"></a></p><h2 id="메시지-필드-지원-중단" tabindex="-1">메시지/필드 지원 중단 <a class="header-anchor" href="#메시지-필드-지원-중단" aria-label="Permalink to &quot;메시지/필드 지원 중단&quot;">​</a></h2><p><a href="https://github.com/PX4/flight_review" target="_blank" rel="noreferrer">비행 검토</a>와 같이 로그 파일의 uORB 메시지를 사용하는 외부 도구가 있으므로, 기존 메시지를 업데이트할 때 다음과 같은 측면을 고려하여야 합니다.</p><ul><li>업데이트에 대한 타당한 이유가 있는 경우에는, 외부 도구가 의존하는 기존 필드 또는 메시지를 변경하는 것이 일반적으로 허용됩니다. 특히 <em>비행 검토</em>에 대한 주요 변경사항의 경우에는, 코드가 <code>마스터</code>에 병합되기 전에 <em>비행 검토</em>를 업데이트하여야 합니다.</li><li>외부 도구가 두 메시지 버전을 확실하게 구별하려면, 다음 단계를 따라야 합니다. <ul><li>제거되거나 이름이 변경된 메시지는 <a href="https://github.com/PX4/PX4-Autopilot/blob/c5a6a60903455c3600f47e3c45ecaa48614559c8/msg/CMakeLists.txt#L189" target="_blank" rel="noreferrer">msg/CMakeLists.txt</a>의 <code>deprecated_msgs</code> 목록에 추가하여야 하며, <strong>.msg</strong> 파일을 삭제하여야 합니다.</li><li>제거되거나 이름이 변경된 필드는 주석을 달고 더 이상 사용되지 않는 것으로 표시하여야 합니다. 예를 들어, <code>uint8 quat_reset_counter</code>는 <code># DEPRECATED: uint8 quat_reset_counter</code>가 됩니다. 이것은 제거된 필드(또는 메시지)가 다시 추가되지 않도록 하기 위한 것입니다.</li><li>의미 변경의 경우(예: 단위가 도에서 라디안으로 변경) 필드 이름도 변경하여야 하며, 이전 필드도 위와 같이 더 이상 사용되지 않는 것으로 표시되어야 합니다.</li></ul></li></ul>`,38),l=[h];function e(p,k,r,d,F,o){return a(),i("div",null,l)}const g=s(t,[["render",e]]);export{c as __pageData,g as default};
