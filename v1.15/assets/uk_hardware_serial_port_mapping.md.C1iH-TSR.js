import{_ as a,c as s,o as t,ab as n}from"./chunks/framework.CUflZczI.js";const S=JSON.parse('{"title":"Зіставлення послідовних портів","description":"","frontmatter":{},"headers":[],"relativePath":"uk/hardware/serial_port_mapping.md","filePath":"uk/hardware/serial_port_mapping.md"}'),e={name:"uk/hardware/serial_port_mapping.md"},p=n(`<h1 id="зіставлення-послідовних-портів" tabindex="-1">Зіставлення послідовних портів <a class="header-anchor" href="#зіставлення-послідовних-портів" aria-label="Permalink to &quot;Зіставлення послідовних портів&quot;">​</a></h1><p>Ця тема показує, як визначити відповідність між іменами пристроїв серійного порту USART/UART (наприклад, &quot;ttyS0&quot;) та пов&#39;язаними портами на контролері польоту, такими як <code>TELEM1</code>, <code>TELEM2</code>, <code>GPS1</code>, <code>RC SBUS</code>, <code>Debug console(Консоль відладки)</code>.</p><p>Інструкції використовуються для генерації таблиць відповідності портів серійного зв&#39;язку у документації контролера польоту. Наприклад: <a href="./../flight_controller/pixhawk4.html#serial-port-mapping">Pixhawk 4 &gt; Serial Port mapping</a>.</p><div class="info custom-block"><p class="custom-block-title">Функція, призначена для кожного порту, не обов&#39;язково <em>повинна</em> відповідати його імені (у більшості випадків), і встановлюється за допомогою <a href="./../peripherals/serial_configuration.html">Конфігурації Серійного Порту</a>. Зазвичай функція порту налаштована так, щоб відповідати імені, тому порт, позначений як <code>GPS1</code>, буде працювати з GPS без будь-яких додаткових налаштувань.</p></div><h2 id="nuttx-на-stmxxyyy" tabindex="-1">NuttX на STMxxyyy <a class="header-anchor" href="#nuttx-на-stmxxyyy" aria-label="Permalink to &quot;NuttX на STMxxyyy&quot;">​</a></h2><p>У цьому розділі показано, як отримати зіставлення для збірок NuttX на архітектурах STMxxyyy, перевіряючи файли конфігурації плати. Інструкції використовують FMUv5, але можуть бути аналогічно розширені для інших версій FMU або плат NuttX.</p><h3 id="default-px4board" tabindex="-1">default.px4board <a class="header-anchor" href="#default-px4board" aria-label="Permalink to &quot;default.px4board&quot;">​</a></h3><p>Файл <strong>default.px4board</strong> містить список зіставлень номерів портів UART з функціями (шукайте текст &quot;SERIAL_PORTS&quot;).</p><p>З <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/boards/px4/fmu-v5/default.px4board" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/default.px4board</a>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>CONFIG_BOARD_SERIAL_GPS1=&quot;/dev/ttyS0&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL1=&quot;/dev/ttyS1&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL2=&quot;/dev/ttyS2&quot;</span></span>
<span class="line"><span>CONFIG_BOARD_SERIAL_TEL4=&quot;/dev/ttyS3&quot;</span></span></code></pre></div><p>Крім того, ви можете запустити boardconfig за допомогою <code>make px4_fmu-v5 boardconfig</code> і отримати доступ до меню послідовного порту</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>    Serial ports  ---&gt;</span></span>
<span class="line"><span>        (/dev/ttyS0) GPS1 tty port</span></span>
<span class="line"><span>        ()  GPS2 tty port</span></span>
<span class="line"><span>        ()  GPS3 tty port</span></span>
<span class="line"><span>        ()  GPS4 tty port</span></span>
<span class="line"><span>        ()  GPS5 tty port</span></span>
<span class="line"><span>        (/dev/ttyS1) TEL1 tty port</span></span>
<span class="line"><span>        (/dev/ttyS2) TEL2 tty port</span></span>
<span class="line"><span>        ()  TEL3 tty port</span></span>
<span class="line"><span>        (/dev/ttyS3) TEL4 tty port</span></span>
<span class="line"><span>        ()  TEL5 tty port</span></span></code></pre></div><h3 id="nsh-defconfig" tabindex="-1">nsh/defconfig <a class="header-anchor" href="#nsh-defconfig" aria-label="Permalink to &quot;nsh/defconfig&quot;">​</a></h3><p>Файл <em>nsh/defconfig</em> дозволяє визначити, які порти визначені, чи вони є UART або USART, і відображення між USART/UART та пристроєм. Ви також можете визначити, який порт використовується для <a href="./../debug/system_console.html">serial/debug console</a>.</p><p>Відкрийте файл defconfig плати, наприклад: <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/boards/px4/fmu-v5/nuttx-config/nsh/defconfig#L215-L221" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/nuttx-config/nsh/defconfig</a></p><p>Шукайте текст &quot;ART&quot; до тих пір, поки ви не знайдете розділ з записами у форматі <code>CONFIG_STM32xx_USARTn=y</code> (де <code>xx</code> - це тип процесора, а <code>n</code> - номер порту). Наприклад:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>CONFIG_STM32F7_UART4=y</span></span>
<span class="line"><span>CONFIG_STM32F7_UART7=y</span></span>
<span class="line"><span>CONFIG_STM32F7_UART8=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART1=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART2=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART3=y</span></span>
<span class="line"><span>CONFIG_STM32F7_USART6=y</span></span></code></pre></div><p>Записи показують, які порти визначено, і чи вони є UART або USART.</p><p>Скопіюйте вищенаведений розділ і перегрупуйте його числово за &quot;n&quot;. Збільшуйте номер пристрою <em>ttyS<strong>n</strong></em> поруч (із нуля), щоб отримати відображення пристрою на послідовний порт.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ttyS0 CONFIG_STM32F7_USART1=y</span></span>
<span class="line"><span>ttyS1 CONFIG_STM32F7_USART2=y</span></span>
<span class="line"><span>ttyS2 CONFIG_STM32F7_USART3=y</span></span>
<span class="line"><span>ttyS3 CONFIG_STM32F7_UART4=y</span></span>
<span class="line"><span>ttyS4 CONFIG_STM32F7_USART6=y</span></span>
<span class="line"><span>ttyS5 CONFIG_STM32F7_UART7=y</span></span>
<span class="line"><span>ttyS6 CONFIG_STM32F7_UART8=y</span></span></code></pre></div><p>Для отримання зв&#39;язку DEBUG консолі шукаємо файл конфігурації за замовчуванням <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/boards/px4/fmu-v5/nuttx-config/nsh/defconfig#L212" target="_blank" rel="noreferrer">defconfig</a> і шукаємо &lt;0&gt;SERIAL_CONSOLE&lt;/0&gt;. Нижче ми бачимо, що консоль знаходиться на UART7:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>CONFIG_UART7_SERIAL_CONSOLE=y</span></span></code></pre></div><h3 id="board-config-h" tabindex="-1">board_config.h <a class="header-anchor" href="#board-config-h" aria-label="Permalink to &quot;board_config.h&quot;">​</a></h3><p>Для контролерів польоту, що мають IO плату, визначте з&#39;єднання PX4IO з файлу <strong>board_config.h</strong>, шляхом пошуку <code>PX4IO_SERIAL_DEVICE</code>.</p><p>Наприклад, <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/boards/px4/fmu-v5/src/board_config.h#L59" target="_blank" rel="noreferrer">/boards/px4/fmu-v5/src/board_config.h</a>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>#define PX4IO_SERIAL_DEVICE            &quot;/dev/ttyS6&quot;</span></span>
<span class="line"><span>#define PX4IO_SERIAL_TX_GPIO           GPIO_UART8_TX</span></span>
<span class="line"><span>#define PX4IO_SERIAL_RX_GPIO           GPIO_UART8_RX</span></span>
<span class="line"><span>#define PX4IO_SERIAL_BASE              STM32_UART8_BASE</span></span></code></pre></div><p>Отже, PX4IO знаходиться на <code>ttyS6</code> (ми також бачимо, що це відповідає UART8, що ми вже знали з попереднього розділу).</p><h3 id="підсумовуючи-все-це-разом" tabindex="-1">Підсумовуючи все це разом, <a class="header-anchor" href="#підсумовуючи-все-це-разом" aria-label="Permalink to &quot;Підсумовуючи все це разом,&quot;">​</a></h3><p>Остаточне відображення таке:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ttyS0 CONFIG_STM32F7_USART1=y GPS1</span></span>
<span class="line"><span>ttyS1 CONFIG_STM32F7_USART2=y TEL1</span></span>
<span class="line"><span>ttyS2 CONFIG_STM32F7_USART3=y TEL2</span></span>
<span class="line"><span>ttyS3 CONFIG_STM32F7_UART4=y TEL4</span></span>
<span class="line"><span>ttyS4 CONFIG_STM32F7_USART6=y</span></span>
<span class="line"><span>ttyS5 CONFIG_STM32F7_UART7=y DEBUG</span></span>
<span class="line"><span>ttyS6 CONFIG_STM32F7_UART8=y PX4IO</span></span></code></pre></div><p>У <a href="./../flight_controller/pixhawk4.html#serial-port-mapping">flight controller docs</a> результуюча таблиця виглядає так:</p><table><thead><tr><th>UART</th><th>Пристрій</th><th>Порт</th></tr></thead><tbody><tr><td>UART1</td><td>/dev/ttyS0</td><td>GPS</td></tr><tr><td>USART2</td><td>/dev/ttyS1</td><td>TELEM1 (керування потоком)</td></tr><tr><td>USART3</td><td>/dev/ttyS2</td><td>TELEM2 (керування потоком)</td></tr><tr><td>UART4</td><td>/dev/ttyS3</td><td>TELEM4</td></tr><tr><td>USART6</td><td>/dev/ttyS4</td><td>RC SBUS</td></tr><tr><td>UART7</td><td>/dev/ttyS5</td><td>Debug Console</td></tr><tr><td>UART8</td><td>/dev/ttyS6</td><td>PX4IO</td></tr></tbody></table><h2 id="інші-архітектури" tabindex="-1">Інші архітектури <a class="header-anchor" href="#інші-архітектури" aria-label="Permalink to &quot;Інші архітектури&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Внески від контрибюторів вітаються!</p></div><h2 id="дивіться-також" tabindex="-1">Дивіться також <a class="header-anchor" href="#дивіться-також" aria-label="Permalink to &quot;Дивіться також&quot;">​</a></h2><ul><li><a href="./../peripherals/serial_configuration.html">Налаштування послідовних портів</a></li><li><a href="./../peripherals/mavlink_peripherals.html">Телеметрія MAVLink (OSD/GCS)</a></li></ul>`,36),o=[p];function l(i,d,r,c,h,_){return t(),s("div",null,o)}const g=a(e,[["render",l]]);export{S as __pageData,g as default};
