import{_ as r}from"./chunks/architecture_xrce-dds_ros2.5IQPlBJ0.js";import{_ as o,E as l,c as d,J as a,m as s,w as e,a as i,ab as n,o as c}from"./chunks/framework.CUflZczI.js";const w=JSON.parse('{"title":"uXRCE-DDS (PX4-ROS 2/DDS Bridge)","description":"","frontmatter":{},"headers":[],"relativePath":"uk/middleware/uxrce_dds.md","filePath":"uk/middleware/uxrce_dds.md"}'),k={name:"uk/middleware/uxrce_dds.md"},g=s("h1",{id:"uxrce-dds-px4-ros-2-dds-bridge",tabindex:"-1"},[i("uXRCE-DDS (PX4-ROS 2/DDS Bridge) "),s("a",{class:"header-anchor",href:"#uxrce-dds-px4-ros-2-dds-bridge","aria-label":'Permalink to "uXRCE-DDS (PX4-ROS 2/DDS Bridge)"'},"​")],-1),u=n('<div class="info custom-block"><p class="custom-block-title">INFO</p><p>uXRCE-DDS замінює <a href="https://docs.px4.io/v1.13/en/middleware/micrortps.html#rtps-dds-interface-px4-fast-rtps-dds-bridge" target="_blank" rel="noreferrer">Fast-RTPS Bridge</a>, який використовувався в PX4 v1.13. Якщо ви використовували Fast-RTPS Bridge, будь ласка, дотримуйтесь <a href="#fast-rtps-to-uxrce-dds-migration-guidelines"> інструкцій з міграції</a>.</p></div><p>PX4 uses uXRCE-DDS middleware to allow <a href="./../middleware/uorb.html">uORB messages</a> to be published and subscribed on a companion computer as though they were <a href="./../ros2/user_guide.html">ROS 2</a> topics. Це забезпечує швидку та надійну інтеграцію між PX4 та ROS 2, а також значно спрощує для додатків ROS 2 отримання інформації про транспортний засіб та надсилання команд.</p><p>PX4 використовує реалізацію XRCE-DDS, яка використовує <a href="https://micro-xrce-dds.docs.eprosima.com/en/stable/introduction.html" target="_blank" rel="noreferrer">eProsima Micro XRCE-DDS</a>.</p><p>У цьому посібнику описано архітектуру та різні варіанти налаштування клієнта та агента. Зокрема, він охоплює опції, які є найбільш важливими для користувачів PX4.</p><h2 id="архітектура" tabindex="-1">Архітектура <a class="header-anchor" href="#архітектура" aria-label="Permalink to &quot;Архітектура&quot;">​</a></h2><p>Проміжне програмне забезпечення uXRCE-DDS складається з клієнта, що працює на PX4, і агента, що працює на комп&#39;ютері-компаньйоні, з двостороннім обміном даними між ними по послідовному або UDP каналу. Агент діє як проксі-сервер для клієнта, дозволяючи йому публікувати та підписуватися на теми в глобальному просторі даних DDS.</p><p><img src="'+r+`" alt="Architecture uXRCE-DDS with ROS 2"></p><p>Для того, щоб теми PX4 uORB можна було поширювати у мережі DDS, вам знадобиться <em>uXRCE-DDS клієнт</em>, запущений на PX4, підключений до <em>micro XRCE-DDS агента</em>, запущеного на комп&#39;ютері-компаньйоні.</p><p>PX4 <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a> публікує до/з визначеного набору тем uORB до глобального простору даних DDS.</p><p><a href="https://github.com/eProsima/Micro-XRCE-DDS-Agent" target="_blank" rel="noreferrer">eProsima micro XRCE-DDS <em>agent</em></a> працює на комп&#39;ютері-компаньйоні і виконує роль проксі-сервера для клієнта в мережі DDS/ROS 2.</p><p>Сам агент не залежить від коду на стороні клієнта і може бути побудований та/або встановлений незалежно від PX4 або ROS.</p><p>Код, який хоче підписатися/публікувати до PX4, залежить від коду на стороні клієнта; йому потрібні визначення повідомлень uORB, які збігаються з тими, що були використані для створення клієнта PX4 uXRCE-DDS, щоб він міг інтерпретувати повідомлення.</p><h2 id="генерація-коду" tabindex="-1">Генерація коду <a class="header-anchor" href="#генерація-коду" aria-label="Permalink to &quot;Генерація коду&quot;">​</a></h2><p>PX4 <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a> генерується під час збирання і входить до складу прошивки PX4 за замовчуванням. Агент не залежить від клієнтського коду. Він може бути побудований окремо або в робочому просторі ROS 2, або встановлений як snap пакет в Ubuntu.</p><p>Під час збирання PX4 генератор коду використовує визначення повідомлень uORB у дереві вихідних текстів (<a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/msg" target="_blank" rel="noreferrer">PX4-Autopilot/msg</a>) для компіляції підтримки підмножини тем uORB у <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">PX4-Autopilot/src/modules/uxrce_dds_client/dds_topics.yaml</a> у <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a>.</p><p>Основні або релізні збірки PX4 автоматично експортують набір визначень повідомлень uORB у збірці до відповідної гілки у <a href="https://github.com/PX4/px4_msgs" target="_blank" rel="noreferrer">PX4/px4_msgs</a>.</p><p>Додатки ROS 2 потрібно створювати у робочій області, яка містить <em>такі самі</em> визначення повідомлень, які були використані для створення клієнтського модуля uXRCE-DDS у прошивці PX4. Їх можна включити до робочого простору шляхом клонування інтерфейсного пакунка <a href="https://github.com/PX4/px4_msgs" target="_blank" rel="noreferrer">PX4/px4_msgs</a> до вашого робочого простору ROS 2 і переходу до відповідної гілки. Зауважте, що вся генерація коду, пов&#39;язана з повідомленнями, обробляється ROS 2.</p><h2 id="встановлення-micro-xrce-dds-agent" tabindex="-1">Встановлення Micro XRCE-DDS Agent <a class="header-anchor" href="#встановлення-micro-xrce-dds-agent" aria-label="Permalink to &quot;Встановлення Micro XRCE-DDS Agent&quot;">​</a></h2><p>Micro XRCE-DDS Agent може бути встановлений на комп&#39;ютер за допомогою бінарного пакета, зібраний і встановлений з вихідного коду, або зібраний і запущений з робочого простору ROS 2. Всі ці методи отримують <em>всі</em> залежності, необхідні для зв&#39;язку з клієнтом (наприклад, FastCDR)</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Офіційним (і більш повним) посібником зі встановлення є Eprosima: <a href="https://micro-xrce-dds.docs.eprosima.com/en/latest/installation.html" target="_blank" rel="noreferrer">micro XRCE-DDS Installation Guide</a>. У цьому розділі узагальнено варіанти, які були протестовані за допомогою PX4 під час створення цієї документації.</p></div><h3 id="окреме-встановлення-з-вихідного-коду" tabindex="-1">Окреме встановлення з вихідного коду <a class="header-anchor" href="#окреме-встановлення-з-вихідного-коду" aria-label="Permalink to &quot;Окреме встановлення з вихідного коду&quot;">​</a></h3><p>В Ubuntu ви можете зібрати з вихідного коду і встановити Агент окремо за допомогою наступних команд:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/eProsima/Micro-XRCE-DDS-Agent.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Micro-XRCE-DDS-Agent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/lib/</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Існують різні варіанти конфігурації збірки, посилання на які можна знайти у відповідній темі <a href="https://micro-xrce-dds.docs.eprosima.com/en/latest/installation.html#installing-the-agent-standalone" target="_blank" rel="noreferrer">офіційного посібника</a>, але вони не були протестовані.</p></div><p>Запустити агент з налаштуваннями для підключення до клієнта uXRCE-DDS, запущеного у симуляторі:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MicroXRCEAgent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span></span></code></pre></div><h3 id="встановлення-з-snap-пакунку" tabindex="-1">Встановлення з Snap пакунку <a class="header-anchor" href="#встановлення-з-snap-пакунку" aria-label="Permalink to &quot;Встановлення з Snap пакунку&quot;">​</a></h3><p>Встановіть з пакунка snap на Ubuntu за допомогою наступної команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> snap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> micro-xrce-dds-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --edge</span></span></code></pre></div><p>Запустити агента з налаштуваннями для підключення до клієнта uXRCE-DDS, запущеного у симуляторі (зверніть увагу, що назва команди відрізняється від назви, яку ви збираєте локально):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">micro-xrce-dds-agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>На момент написання статті стабільна версія, встановлена з snap, підключається до PX4, але повідомляє про помилки при створенні тем. Версія для розробки, отримана за допомогою <code>--edge</code> вище, працює.</p></div><h3 id="збірка-запуск-у-межах-робочого-простору-ros-2" tabindex="-1">Збірка/Запуск у межах робочого простору ROS 2 <a class="header-anchor" href="#збірка-запуск-у-межах-робочого-простору-ros-2" aria-label="Permalink to &quot;Збірка/Запуск у межах робочого простору ROS 2&quot;">​</a></h3><p>Агент може бути створений і запущений в робочому просторі ROS 2 (або створений окремо і запущений з робочого простору. You must already have installed ROS 2 following the instructions in: <a href="./../ros2/user_guide.html#install-ros-2">ROS 2 User Guide &gt; Install ROS 2</a>.</p><p>Створити агента в межах ROS:</p>`,35),m=n(`<li><p>Створіть директорію робочого простору для агента:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/px4_ros_uxrce_dds_ws/src</span></span></code></pre></div></li><li><p>Клонуйте вихідний код eProsima <a href="https://github.com/eProsima/Micro-XRCE-DDS-Agent" target="_blank" rel="noreferrer">Micro-XRCE-DDS-Agent</a> до каталогу <code>/src</code> (за замовчуванням клонується гілка <code>main</code>):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/px4_ros_uxrce_dds_ws/src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/eProsima/Micro-XRCE-DDS-Agent.git</span></span></code></pre></div></li>`,2),F=s("p",null,[i("Зберіть середовище розробки ROS 2 і скомпілюйте робочу область за допомогою "),s("code",null,"colcon"),i(":")],-1),_=s("div",{class:"language-sh vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sh"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/ros/humble/setup.bash")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"colcon"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," build")])])])],-1),E=s("p",null,":::",-1),y=s("div",{class:"language-sh vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sh"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/ros/foxy/setup.bash")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"colcon"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," build")])])])],-1),b=s("p",null,": :::",-1),C=s("p",null,[i("У результаті буде зібрано усі каталоги у "),s("code",null,"/src"),i(" за допомогою вихідного набору інструментів.")],-1),f=s("p",null,"Для запуску агента micro XRCE-DDS в робочому просторі:",-1),D=s("p",null,[i("Виконайте "),s("code",null,"local_setup.bash"),i(", щоб зробити виконувані файли доступними у терміналі (також "),s("code",null,"setup.bash"),i(", якщо ви використовуєте новий термінал).")],-1),v=s("div",{class:"language-sh vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sh"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/ros/humble/setup.bash")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install/local_setup.bash")])])])],-1),S=s("p",null,":::",-1),R=s("div",{class:"language-sh vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sh"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/ros/foxy/setup.bash")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"source"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install/local_setup.bash")])])])],-1),P=n(`<p>: :::</p><ol><li><p>Запустіть агент з налаштуваннями для підключення до клієнта uXRCE-DDS, запущеного на симуляторі:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MicroXRCEAgent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span></span></code></pre></div></li></ol><h2 id="запуск-агента-та-клієнта" tabindex="-1">Запуск агента та клієнта <a class="header-anchor" href="#запуск-агента-та-клієнта" aria-label="Permalink to &quot;Запуск агента та клієнта&quot;">​</a></h2><h3 id="запуск-агента" tabindex="-1">Запуск агента <a class="header-anchor" href="#запуск-агента" aria-label="Permalink to &quot;Запуск агента&quot;">​</a></h3><p>Агент використовується для підключення до клієнта через конкретний канал, такий як UDP або послідовне з&#39;єднання. The channel settings are specified when the agent is started, using command line options. Вони задокументовані в посібнику користувача eProsima: <a href="https://micro-xrce-dds.docs.eprosima.com/en/latest/agent.html#agent-cli" target="_blank" rel="noreferrer">Micro XRCE-DDS Agent &gt; Agent CLI</a>. Зверніть увагу, що агент підтримує багато варіантів каналів, але PX4 підтримує тільки UDP і послідовні з&#39;єднання.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Ви повинні створити один екземпляр агента для кожного каналу, через який ви хочете підключитися.</p></div><p>Наприклад, симулятор PX4 запускає клієнт uXRCE-DDS через UDP на порт 8888, тому для підключення до симулятора потрібно запустити агент за допомогою команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MicroXRCEAgent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span></span></code></pre></div><p>При роботі з реальним обладнанням налаштування залежить від апаратного забезпечення, операційної системи та каналу. For example, if you&#39;re using the RasPi <code>UART0</code> serial port, you might connect using this command (based on the information in <a href="https://www.raspberrypi.com/documentation/computers/configuration.html#configuring-uarts" target="_blank" rel="noreferrer">Raspberry Pi Documentation &gt; Configuring UARTS</a>):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MicroXRCEAgent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serial</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/AMA0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 921600</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Для отримання додаткової інформації про налаштування каналів зв&#39;язку див. <a href="./../companion_computer/pixhawk_companion.html#serial-port-setup">Налаштування Pixhawk + Companion &gt; Налаштування послідовного порту</a>, а також пов&#39;язану документацію.</p></div><h3 id="запуск-клієнта" tabindex="-1">Запуск клієнта <a class="header-anchor" href="#запуск-клієнта" aria-label="Permalink to &quot;Запуск клієнта&quot;">​</a></h3><p>Клієнтський модуль uXRCE-DDS (<a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a>) за замовчуванням включено до всіх прошивок та симулятора. This must be started with appropriate settings for the communication channel that you wish to use to communicate with the agent.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Симулятор автоматично запускає клієнта на localhost UDP порту <code>8888</code>, використовуючи за замовчуванням простір імен uxrce-dds.</p></div><p>Конфігурацію можна виконати за допомогою параметрів <a href="./../advanced_config/parameter_reference.html#uxrce-dds-client">UXRCE-DDS</a>:</p><ul><li><p><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_CFG">UXRCE_DDS_CFG</a>: вкажіть порт для підключення, наприклад <code>TELEM2</code>, <code>Ethernet</code> або <code>Wifi</code>.</p></li><li><p>Якщо використовується Ethernet-підключення:</p><ul><li><p><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_PRT">UXRCE_DDS_PRT</a>: Використовуйте цей параметр, щоб вказати порт прослуховування агента UDP. Значення за замовчуванням <code>8888</code>.</p></li><li><p><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_AG_IP">UXRCE_DDS_AG_IP</a>: Використовуйте цей параметр, щоб вказати IP адресу агента. IP-адрес повинен бути наданий у форматі <code>int32</code>, оскільки PX4 не підтримує рядкові параметри. Значенням за замовчуванням є <code>2130706433</code>, що відповідає <em>localhost</em> <code>127.0.0.1</code>.</p><p>Ви можете скористатися <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/Tools/convert_ip.py" target="_blank" rel="noreferrer">Tools/convert_ip.py</a> для конвертації між форматами:</p><ul><li><p>Для отримання версії IP у вигляді <code>int32</code> у десятковій системі числення виконується команда:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./PX4-Autopilot/Tools/convert_ip.py</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> decimal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> notatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></li><li><p>Щоб отримати IP-адресу у десятковій системі числення з версії <code>int32</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./PX4-Autopilot/Tools/convert_ip.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> int32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> notatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></li></ul></li></ul></li><li><p>Якщо використовується послідовне підключення:</p><ul><li><a href="./../advanced_config/parameter_reference.html#SER_TEL2_BAUD">SER_TEL2_BAUD</a>, <a href="./../advanced_config/parameter_reference.html#SER_URT6_BAUD">SER_URT6_BAUD</a> (і так далі): Використовуйте параметр <code>_BAUD</code>, пов&#39;язаний з послідовним портом, для встановлення швидкості передачі даних. Наприклад, ви встановите значення для <code>SER_TEL2_BAUD</code>, якщо ви підключаєтеся до комп&#39;ютера-компаньйона за допомогою <code>TELEM2</code>. Докладнішу інформацію наведено у розділі <a href="./../peripherals/serial_configuration.html#serial-port-configuration">Конфігурація послідовного порту</a>.</li></ul></li><li><p>Деякі налаштування можуть також потребувати встановлення цих параметрів:</p><ul><li><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_KEY">UXRCE_DDS_KEY</a>: Ключ uXRCE-DDS. Якщо ви працюєте в мультиклієнтській конфігурації з одним агентом, кожен клієнт повинен мати унікальний ненульовий ключ. Це насамперед важливо для симуляцій з кількома транспортними засобами, де всі клієнти під&#39;єднані до UDP одного агента. (Див. <a href="https://micro-xrce-dds.docs.eprosima.com/en/stable/client_api.html#session" target="_blank" rel="noreferrer">офіційну документацію eprosima</a> , <code>uxr_init_session</code>.)</li><li><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_DOM_ID">UXRCE_DDS_DOM_ID</a>: ідентифікатор домену DDS. Це забезпечує логічне розділення мереж DDS і може бути використано для розділення клієнтів на різні мережі. За замовчуванням, ROS 2 працює з ID 0.</li><li><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_PTCFG">UXRCE_DDS_PTCFG</a>: Конфігурація учасника uXRCE-DDS. Це дозволяє обмежити видимість тем DDS лише для <em>localhost</em> і використовувати користувацькі конфігураційні файли учасників, що зберігаються на стороні агента.</li><li><a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_SYNCT">UXRCE_DDS_SYNCT</a>: увімкнути синхронізацію часу мосту. Клієнтський модуль uXRCE-DDS може синхронізувати мітку часу повідомлень, якими обмінюються через міст. Це стандартна конфігурація. In certain situations, for example during <a href="./../ros2/user_guide.html#ros-gazebo-and-px4-time-synchronization">simulations</a>, this feature may be disabled.</li></ul></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Багато портів вже мають конфігурацію за замовчуванням. Щоб використовувати ці порти, спочатку вимкніть існуючу конфігурацію:</p><ul><li><code>TELEM1</code> і <code>TELEM2</code> за замовчуванням налаштовані на підключення через MAVLink до GCS і комп&#39;ютера-компаньйона (відповідно). Вимкніть, встановивши <a href="./../advanced_config/parameter_reference.html#MAV_0_CONFIG">MAV_0_CONFIG=0</a> або <a href="./../advanced_config/parameter_reference.html#MAV_1_CONFIG">MAV_1_CONFIG=0</a> на нуль. Докладнішу інформацію див. у розділі <a href="./../peripherals/mavlink_peripherals.html">Периферійні пристрої MAVLink</a>.</li><li>Інші порти можуть бути налаштовані аналогічним чином. Дивіться <a href="./../peripherals/serial_configuration.html#serial-port-configuration">Конфігурація послідовного порту</a>.</li></ul></div><p>Після встановлення можливо знадобиться перезавантаження PX4, щоб параметри набрали чинності. Після цього вони зберігатимуться під час наступних перезавантажень.</p><p>Ви також можете запустити <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a> за допомогою командного рядка. Його можна викликати як частину <a href="./../concept/system_startup.html">System Startup</a> або за допомогою <a href="./../debug/mavlink_shell.html">Оболонки MAVLink</a> (або системної консолі). Цей метод корисний, коли вам потрібно встановити власний простір імен клієнта, оскільки для цього не передбачено жодного параметра. Наприклад, наступна команда може бути використана для підключення через Ethernet до віддаленого хоста за адресою <code>192.168.0.100:8888</code> і встановлення простору імен клієнта на <code>/drone/</code>.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uxrce_dds_client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> drone</span></span></code></pre></div><p>Параметри <code>-p</code> або <code>-h</code> використовуються для обходу <code>UXRCE_DDS_PRT</code> і <code>UXRCE_DDS_AG_IP</code>.</p><h4 id="запуск-клієнта-в-симуляціі" tabindex="-1">Запуск клієнта в симуляції <a class="header-anchor" href="#запуск-клієнта-в-симуляціі" aria-label="Permalink to &quot;Запуск клієнта в симуляції&quot;">​</a></h4><p>The simulator <a href="./../concept/system_startup.html">startup logic</a> (<a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/ROMFS/px4fmu_common/init.d-posix/rcS" target="_blank" rel="noreferrer">init.d-posix/rcS</a>) uses the client startup commands for single and <a href="./../ros2/multi_vehicle.html">multi vehicle simulations</a>, enabling the setting of appropriate instance ids and DDS namespaces. За замовчуванням клієнт запускається на локальному хості через UDP-порт <code>8888</code> без додаткового простору імен.</p><p>Надаються змінні середовища, які перевизначають деякі <a href="./../advanced_config/parameter_reference.html#uxrce-dds-client">параметри UXRCE-DDS</a>. Це дозволяє користувачам створювати власні файли запуску для своїх симуляцій:</p><ul><li><code>PX4_UXRCE_DDS_NS</code>: Використовуйте це, щоб вказати тему <a href="#customizing-the-topic-namespace">простір імен</a>.</li><li><code>ROS_DOMAIN_ID</code>: Використовуйте це для заміни <a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_DOM_ID">UXRCE_DDS_DOM_ID</a>.</li><li><code>PX4_UXRCE_DDS_PORT</code>: Використовуйте це для заміни <a href="./../advanced_config/parameter_reference.html#UXRCE_DDS_PRT">UXRCE_DDS_PRT</a>.</li></ul><p>Наприклад, наступну команду можна використовувати для запуску симуляції Gazebo з клієнтом, який працює в DDS домені <code>3</code>, портом <code>9999</code> та простором імен теми <code>drone</code>.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ROS_DOMAIN_ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_UXRCE_DDS_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PX4_UXRCE_DDS_NS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">drone</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><h2 id="підтримувані-повідомлення-uorb" tabindex="-1">Підтримувані повідомлення uORB <a class="header-anchor" href="#підтримувані-повідомлення-uorb" aria-label="Permalink to &quot;Підтримувані повідомлення uORB&quot;">​</a></h2><p>Набір <a href="./../msg_docs/">PX4 uORB тем</a>, які використовуються через клієнт, встановлені в <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a>.</p><p>Теми є специфічними для релізу (підтримка компілюється в <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a> на етапі збірки). Хоча більшість випусків мають підтримувати дуже схожий набір повідомлень, щоб бути впевненими, вам слід перевірити файл yaml для вашого конкретного релізу.</p><p>Зауважте, що для інтерпретації повідомлень ROS 2/DDS повинен мати <em>такі самі</em> визначення повідомлень, які були використані для створення клієнтського модуля uXRCE-DDS у прошивці PX4. Визначення повідомлень зберігаються в пакеті інтерфейсу ROS 2 <a href="https://github.com/PX4/px4_msgs" target="_blank" rel="noreferrer">PX4/px4_msgs</a>, і вони автоматично синхронізуються CI у гілках <code>main</code> та release. Зверніть увагу, що всі повідомлення з вихідного коду PX4 присутні в репозиторії, але лише ті, які перелічені в <code>dds_topics.yaml</code>, будуть доступні як теми ROS 2. Тому,</p><ul><li><p>Якщо ви використовуєте основну або релізну версію PX4, ви можете отримати визначення повідомлень, клонуючи пакет інтерфейсу <a href="https://github.com/PX4/px4_msgs" target="_blank" rel="noreferrer">PX4/px4_msgs</a> у вашу робочу область.</p></li><li><p>Якщо ви створюєте або змінюєте повідомлення uORB, вам потрібно вручну оновити повідомлення у вашому робочому просторі з вихідного дерева PX4. Загалом це означає, що вам слід оновити <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a>, клонувати пакет інтерфейсу, а потім вручну синхронізувати його, скопіювавши нові/змінені визначення повідомлень з <a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/msg" target="_blank" rel="noreferrer">PX4-Autopilot/msg</a> до його папки <code>msg</code>. Якщо припустити, що PX4-Autopilot знаходиться у вашому домашньому каталозі <code>~</code>, а <code>px4_msgs</code> - у <code>~/px4_ros_com/src/</code>, то команда може бути такою:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/px4_ros_com/src/px4_msgs/msg/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.msg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/PX4-Autopilot/mgs/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.msg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/px4_ros_com/src/px4_msgs/msg/</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Технічно, <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a> повністю визначає зв&#39;язок між темами PX4 uORB і повідомленнями ROS 2. Для отримання додаткової інформації див. <a href="#dds-topics-yaml">DDS Topics YAML</a> нижче.</p></div></li></ul><p>:::</p><h2 id="налаштування-простору-імен-теми" tabindex="-1">Налаштування простору імен теми <a class="header-anchor" href="#налаштування-простору-імен-теми" aria-label="Permalink to &quot;Налаштування простору імен теми&quot;">​</a></h2><p>Власні простори імен тем можна застосовувати під час збирання (змінюючи <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a>) або під час виконання (що є корисним для роботи з декількома транспортними засобами):</p><ul><li>Однією з можливостей є використання опції <code>-n</code> при запуску <a href="./../modules/modules_system.html#uxrce-dds-client">uxrce_dds_client</a> з командного рядка. Ця техніка може бути використана як у симуляторах, так і на реальних транспортних засобах.</li><li>Користувацький простір імен можна створити (лише) для симуляцій, встановивши змінну оточення <code>PX4_UXRCE_DDS_NS</code> перед початком симуляції.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Зміна простору імен під час виконання додасть потрібний простір імен як префікс до всіх полів <code>topic</code> у <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a>. Отже, команди, подібні до:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uxrce_dds_client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uav_1</span></span></code></pre></div><p>або</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PX4_UXRCE_DDS_NS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">uav_1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gz_x500</span></span></code></pre></div><p>will generate topics under the namespaces:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/uav_1/fmu/in/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # for subscribers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/uav_1/fmu/out/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # for publishers</span></span></code></pre></div></div><h2 id="налаштування-px4-ros-2-qos" tabindex="-1">Налаштування PX4 ROS 2 QoS <a class="header-anchor" href="#налаштування-px4-ros-2-qos" aria-label="Permalink to &quot;Налаштування PX4 ROS 2 QoS&quot;">​</a></h2><p>Налаштування QoS PX4 для видавців несумісні з налаштуваннями QoS за замовчуванням для підписників ROS 2. Таким чином, якщо код ROS 2 потрібно підписатися на тему uORB, йому потрібно використовувати сумісні налаштування QoS. One example of which is shown in <a href="./../ros2/user_guide.html#ros-2-subscriber-qos-settings">ROS 2 User Guide &gt; ROS 2 Subscriber QoS Settings</a>.</p><p>PX4 використовує наступні параметри QoS для видавців:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uxrQoS_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> qos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .durability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_DURABILITY_TRANSIENT_LOCAL,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .reliability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_RELIABILITY_BEST_EFFORT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .history </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_HISTORY_KEEP_LAST,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>PX4 використовує наступні параметри QoS для підписників:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uxrQoS_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> qos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .durability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_DURABILITY_VOLATILE,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .reliability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_RELIABILITY_BEST_EFFORT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .history </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> UXR_HISTORY_KEEP_LAST,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> queue_depth,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>ROS 2 використовує наступні налаштування QoS (за замовчуванням) для видавців та підписок: «зберігати останніми» для історії з розміром черги 10, «reliable» для надійності, «volatile» для тривалості і «system default» для життєздатності. Дедлайн, тривалість життя та оренда також налаштовані на &quot;за замовчуванням&quot;.</p><h2 id="dds-теми-yaml" tabindex="-1">DDS теми YAML <a class="header-anchor" href="#dds-теми-yaml" aria-label="Permalink to &quot;DDS теми YAML&quot;">​</a></h2><p>Файл PX4 yaml <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topics.yaml</a> визначає набір тем PX4 uORB, які вбудовано у прошивку та опубліковано. Точніше, він повністю визначає взаємозв&#39;язок/сполучення між повідомленнями PX4 uORB і ROS 2.</p><p>Файл структурований наступним чином:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">publications</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/out/collision_constraints</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::CollisionConstraints</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/out/vehicle_odometry</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::VehicleOdometry</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/out/vehicle_status</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::VehicleStatus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/out/vehicle_trajectory_waypoint_desired</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::VehicleTrajectoryWaypoint</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">subscriptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/in/offboard_control_mode</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::OffboardControlMode</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/in/vehicle_trajectory_waypoint</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::VehicleTrajectoryWaypoint</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">subscriptions_multi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">topic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/fmu/in/vehicle_optical_flow_vel</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">px4_msgs::msg::VehicleOpticalFlowVel</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  ...</span></span></code></pre></div><p>Кожна пара (<code>topic</code>,<code>type</code>) визначає:</p><ol><li>Нова <code>publication</code>, <code>subscription</code>, або <code>subscriptions_multi</code>, залежно від списку, до якого її додано.</li><li>Назва теми <em>base name</em>, яка <strong>повинна</strong> збігатися з бажаною назвою теми uORB, яку ви хочете опублікувати/підписатися. Він ідентифікується за останнім токеном у <code>topic:</code>, який починається з <code>/</code> і не містить жодного <code>/</code> у своєму складі. <code>vehicle_odometry</code>, <code>vehicle_status</code> та <code>offboard_control_mode</code> - це приклади базових імен.</li><li><a href="https://design.ros2.org/articles/topic_and_service_names.html#namespaces" target="_blank" rel="noreferrer">простір імен</a> теми. За замовчуванням встановлено ​​на: <ul><li><code>/fmu/out/</code> для тем, які <em>публікуються</em> PX4.</li><li><code>/fmu/in/</code> для тем, які <em>підписані</em> PX4.</li></ul></li><li>Тип повідомлення (<code>VehicleOdometry</code>, <code>VehicleStatus</code>, <code>OffboardControlMode</code> тощо) та пакет ROS 2 (<code>px4_msgs</code>), який очікує для надання визначення повідомлення.</li></ol><p><code>subscriptions</code> і <code>subscriptions_multi</code> дозволяють нам вибрати екземпляр теми uORB, до якого надсилатимуться теми ROS 2: або спільний екземпляр, який також може отримувати оновлення від внутрішніх видавців uORB PX4, або окремий екземпляр, зарезервований для публікацій ROS2 відповідно. Без цього механізму всі повідомлення ROS 2 перенаправлятимуться до <em>одного і того ж</em> екземпляра теми uORB (оскільки у ROS 2 немає поняття <a href="./../middleware/uorb.html#multi-instance">кількох екземплярів тем</a>), і підписники PX4 не зможуть розрізняти потоки від видавців ROS 2 або PX4.</p><p>Додайте тему до розділу <code>subscriptions</code> для:</p><ul><li>Створіть односпрямований маршрут від теми ROS2 до екземпляра <em>default</em> (екземпляр 0) пов&#39;язаної з нею теми uORB. Наприклад, він створює підписника ROS2 <code>/fmu/in/vehicle_odometry</code> та видавця uORB <code>vehicle_odometry</code>.</li><li>Якщо інші (внутрішні) модулі PX4 вже публікують у тому ж екземплярі теми uORB, що й публікатор ROS2, підписники цього екземпляра будуть отримувати всі потоки повідомлень. Підписник uORB не зможе визначити, чи вхідне повідомлення було опубліковане PX4 або ROS2.</li><li>Це бажана поведінка, коли очікується, що ROS2-видавець буде єдиним видавцем у екземплярі теми (наприклад, для заміни внутрішнього видавця теми під час автономного керування), або коли джерело декількох потоків публікацій не має значення.</li></ul><p>Додайте тему до розділу <code>subscriptions_multi</code> для:</p><ul><li>Створіть односпрямований маршрут від теми ROS2 до <em>нового</em> екземпляра пов&#39;язаної з нею теми uORB. Наприклад, якщо <code>vehicle_odometry</code> вже має <code>2</code> екземплярів, він створює підписника ROS2 на <code>/fmu/in/vehicle_odometry</code> і видавця uORB на екземплярі <code>3</code> з <code>vehicle_odometry</code>.</li><li>Це гарантує, що жоден інший внутрішній модуль PX4 не публікуватиметься на тому самому екземплярі, що використовується uXRCE-DDS. Підписники зможуть підписатися на потрібний екземпляр і розрізняти видавців.</li><li>Зауважте, однак, що це гарантує розділення між видавцями PX4 і ROS2, а не між кількома видавцями ROS2. У цьому випадку їхні повідомлення все одно будуть перенаправлені на той самий екземпляр.</li><li>Це бажана поведінка, наприклад, коли ви хочете, щоб PX4 реєстрував показання двох однакових датчиків; вони обидва публікуватимуться в одній темі, але один з них використовуватиме екземпляр 0, а інший - екземпляр 1.</li></ul><p>Ви можете довільно змінювати конфігурацію. Наприклад, ви можете використовувати різні простори імен за замовчуванням або використовувати власний пакет для зберігання визначень повідомлень.</p><h2 id="посібник-міграціі-з-fast-rtps-на-uxrce-dds" tabindex="-1">Посібник міграції з Fast-RTPS на uXRCE-DDS <a class="header-anchor" href="#посібник-міграціі-з-fast-rtps-на-uxrce-dds" aria-label="Permalink to &quot;Посібник міграції з Fast-RTPS на uXRCE-DDS&quot;">​</a></h2><p>Ці настанови пояснюють, як перейти від використання проміжного програмного забезпечення PX4 v1.13 <a href="./../middleware/micrortps.html">Fast-RTPS</a> до проміжного програмного забезпечення PX4 v1.14 <code>uXRCE-DDS</code>. Вони корисні, якщо у вас є <a href="https://docs.px4.io/v1.13/en/ros/ros2_comm.html" target="_blank" rel="noreferrer">ROS 2 додатки, написані для PX4 v1.13</a>, або ви використовували Fast-RTPS для інтерфейсу ваших додатків з PX4 <a href="https://docs.px4.io/v1.13/en/middleware/micrortps.html#agent-in-an-offboard-fast-dds-interface-ros-independent" target="_blank" rel="noreferrer">безпосередньо</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Цей розділ містить інформацію, що стосується міграції. Вам також слід прочитати решту цієї сторінки, щоб правильно зрозуміти uXRCE-DDS.</p></div><h4 id="залежності-не-потрібно-видаляти" tabindex="-1">Залежності не потрібно видаляти <a class="header-anchor" href="#залежності-не-потрібно-видаляти" aria-label="Permalink to &quot;Залежності не потрібно видаляти&quot;">​</a></h4><p>uXRCE-DDS не потребує залежностей, які були потрібні для Fast-RTPS, зокрема тих, що встановлюються за допомогою статті <a href="https://docs.px4.io/v1.13/en/dev_setup/fast-dds-installation.html" target="_blank" rel="noreferrer">Встановлення Fast DDS</a>. Ви можете зберегти їх, якщо хочете, не впливаючи на ваші додатки uXRCE-DDS.</p><p>Якщо ви вирішили видалити залежності, будьте обережні, щоб не видалити нічого, що використовується програмами (наприклад, Java).</p><h4 id="rtps-targets-have-been-removed" tabindex="-1"><code>_rtps</code> targets have been removed <a class="header-anchor" href="#rtps-targets-have-been-removed" aria-label="Permalink to &quot;\`_rtps\` targets have been removed&quot;">​</a></h4><p>Якщо ви раніше використовували ціль збірки з розширенням <code>_rtps</code>, наприклад, <code>px4_fmu-v5_rtps</code> або <code>px4_sitl_rtps</code>, тепер ви можете використовувати еквівалентну ціль за замовчуванням (для цих випадків <code>px4_fmu-v5_default</code> і <code>px4_sitl_default</code>).</p><p>Цілі make з розширенням <code>_rtps</code> було використано для створення прошивки, яка містила код RTPS на стороні клієнта. Проміжне програмне забезпечення uXRCE-DDS за замовчуванням включено до збірок для більшості плат, тому вам більше не потрібна спеціальна прошивка для роботи з ROS 2.</p><p>Щоб перевірити, чи має ваша плата проміжне програмне забезпечення, знайдіть <code>CONFIG_MODULES_UXRCE_DDS_CLIENT=y</code> у файлі <code>.px4board</code> вашої плати. Ці файли вкладено до каталогу <a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/boards" target="_blank" rel="noreferrer">PX4-Autopilot/boards</a>.</p><p>Якщо його немає, або якщо він має значення <code>n</code>, то вам доведеться клонувати репозиторій PX4, змінити конфігурацію плати і вручну <a href="./../dev_setup/building_px4.html">скомпілювати</a> прошивку.</p><h4 id="новии-модуль-клієнта-та-нові-параметри-запуску" tabindex="-1">Новий модуль клієнта та нові параметри запуску <a class="header-anchor" href="#новии-модуль-клієнта-та-нові-параметри-запуску" aria-label="Permalink to &quot;Новий модуль клієнта та нові параметри запуску&quot;">​</a></h4><p>Оскільки клієнт реалізовано новим модулем PX4, тепер у вас є нові параметри для його запуску. Перегляньте розділ <a href="#starting-the-client">запуску клієнта</a>, щоб дізнатися, як це робиться.</p><h4 id="новии-фаил-для-налаштування-того-які-теми-публікуються" tabindex="-1">Новий файл для налаштування того, які теми публікуються <a class="header-anchor" href="#новии-фаил-для-налаштування-того-які-теми-публікуються" aria-label="Permalink to &quot;Новий файл для налаштування того, які теми публікуються&quot;">​</a></h4><p>Перелік тем, які публікуються і на які здійснюється підписка для певної прошивки, тепер керується конфігураційним файлом <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topic.yaml</a>, який замінює <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.13/msg/tools/urtps_bridge_topics.yaml" target="_blank" rel="noreferrer">urtps_bridge_topics.yaml</a></p><p>Дивіться розділи <a href="#supported-uorb-messages">Підтримувані повідомлення uORB</a> та <a href="#dds-topics-yaml">DDS Теми YAML</a> для отримання додаткової інформації.</p><h4 id="теми-більше-не-потрібно-синхронізувати-між-клієнтом-і-агентом" tabindex="-1">Теми більше не потрібно синхронізувати між клієнтом і агентом. <a class="header-anchor" href="#теми-більше-не-потрібно-синхронізувати-між-клієнтом-і-агентом" aria-label="Permalink to &quot;Теми більше не потрібно синхронізувати між клієнтом і агентом.&quot;">​</a></h4><p>Список проміжних тем між агентом і клієнтом більше не потрібно синхронізувати для ROS 2, тому скрипт <code>update_px4_ros2_bridge.sh</code> більше не потрібен.</p><h4 id="налаштування-назви-теми-за-замовчуванням-змінено" tabindex="-1">Налаштування назви теми за замовчуванням змінено <a class="header-anchor" href="#налаштування-назви-теми-за-замовчуванням-змінено" aria-label="Permalink to &quot;Налаштування назви теми за замовчуванням змінено&quot;">​</a></h4><p>Змінився формат назв тем:</p><ul><li>Опубліковані теми: <code>/fmu/topic-name/out</code> (Fast-RTPS) до <code>/fmu/out/topic-name</code> (XRCE-DDS).</li><li>Підписані теми: <code>/fmu/topic-name/in</code>(Fast-RTPS) до <code>/fmu/in/topic-name</code> (XRCE-DDS).</li></ul><p>Вам слід оновити свій додаток відповідно до нової конвенції.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Ви також можете відредагувати <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topic.yaml</a>, щоб повернутися до старої конвенції. Це не рекомендується, оскільки це означає, що вам доведеться завжди використовувати кастомну прошивку.</p></div><h4 id="xrce-dds-agent" tabindex="-1">XRCE-DDS-Agent <a class="header-anchor" href="#xrce-dds-agent" aria-label="Permalink to &quot;XRCE-DDS-Agent&quot;">​</a></h4><p>Агент XRCE-DDS є &quot;загальним&quot; і не залежить від PX4: <a href="https://micro-xrce-dds.docs.eprosima.com/en/latest/agent.html" target="_blank" rel="noreferrer">micro-xrce-dds-agent</a>. Існує багато способів встановити його на ваш ПК / комп&#39;ютер-компаньйон - для отримання додаткової інформації див. <a href="#micro-xrce-dds-agent-installation">відповідний розділ</a>.</p><h4 id="зміни-що-стосуються-конкретних-додатків" tabindex="-1">Зміни, що стосуються конкретних додатків <a class="header-anchor" href="#зміни-що-стосуються-конкретних-додатків" aria-label="Permalink to &quot;Зміни, що стосуються конкретних додатків&quot;">​</a></h4><p>Якщо ви не використовуєте ROS 2 разом з агентом (<a href="https://docs.px4.io/v1.13/en/middleware/micrortps.html#agent-in-an-offboard-fast-dds-interface-ros-independent" target="_blank" rel="noreferrer">Fast DDS Interface ROS-Independent</a>), вам потрібно перейти на <a href="https://fast-dds.docs.eprosima.com/en/latest/index.html" target="_blank" rel="noreferrer">eProsima Fast DDS</a>.</p><p>Програми ROS 2, як і раніше, мають компілюватися разом із повідомленнями PX4, для чого вам слід додати до робочого простору пакунок <a href="https://github.com/PX4/px4_msgs" target="_blank" rel="noreferrer">px4_msgs</a>. Ви можете вилучити пакунок <a href="https://github.com/PX4/px4_ros_com" target="_blank" rel="noreferrer">px4_ros_com</a>, оскільки він більше не потрібен, окрім як для прикладу коду.</p><p>У ваших вузлах ROS 2 вам знадобиться:</p><ul><li><p>Оновіть <a href="#px4-ros-2-qos-settings">QoS</a> ваших видавців і підписників, оскільки PX4 не використовує налаштування ROS 2 за замовчуванням.</p></li><li><p>Змініть назви своїх тем, якщо ви не редагували <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/src/modules/uxrce_dds_client/dds_topics.yaml" target="_blank" rel="noreferrer">dds_topic.yaml</a>.</p></li><li><p>Видаліть все, що стосується синхронізації часу, оскільки XRCE-DDS автоматично піклується про синхронізацію часу агента/клієнта.</p><p>У додатках C++ ви можете встановити поле <code>timestamp</code> вашого повідомлення таким чином:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg.timestamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get_clock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nanoseconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>У додатках Python ви можете встановити поле <code>timestamp</code> для ваших повідомлень таким чином:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg.timestamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.get_clock().now().nanoseconds </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li></ul><h2 id="корисні-ресурси" tabindex="-1">Корисні ресурси <a class="header-anchor" href="#корисні-ресурси" aria-label="Permalink to &quot;Корисні ресурси&quot;">​</a></h2><ul><li><a href="https://www.youtube.com/watch?v=F5oelooT67E" target="_blank" rel="noreferrer">ROS 2 in PX4: Technical Details of a Seamless Transition to XRCE-DDS</a> - Pablo Garrido &amp; Nuno Marques (youtube)</li><li><a href="https://gist.github.com/julianoes/adbf76408663829cd9aed8d14c88fa29" target="_blank" rel="noreferrer">PX4 ROS 2 offboard tutorial</a> (Github gist - JulianOes)</li><li><a href="https://github.com/Jaeyoung-Lim/px4-offboard/blob/2d784532fd323505ac8a6e53bb70145600d367c4/doc/ROS2_PX4_Offboard_Tutorial.md" target="_blank" rel="noreferrer">ROS 2 PX4 Offboard Tutorial</a> (Jaeyoung-Lim).&lt;!--- Some of this might be useful. I&#39;d like to see a real example first.</li></ul><h2 id="setting-up-the-bridge-with-real-hardware" tabindex="-1">Setting up the bridge with real hardware <a class="header-anchor" href="#setting-up-the-bridge-with-real-hardware" aria-label="Permalink to &quot;Setting up the bridge with real hardware&quot;">​</a></h2><p>This section is work-in-progress.</p><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="client-reports-that-selected-uart-port-is-busy" tabindex="-1">Client reports that selected UART port is busy <a class="header-anchor" href="#client-reports-that-selected-uart-port-is-busy" aria-label="Permalink to &quot;Client reports that selected UART port is busy&quot;">​</a></h3><p>If the selected UART port is busy, it&#39;s possible that the MAVLink application is already being used. If both MAVLink and RTPS connections are required you will have to either move the connection to use another port or using the available protocol splitter for PX4 and companion computers.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>A quick/temporary fix to allow bridge testing during development is to stop MAVLink from <em>NuttShell</em>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop-all</span></span></code></pre></div></div><h3 id="enable-uart-on-a-companion-computer" tabindex="-1">Enable UART on a companion computer <a class="header-anchor" href="#enable-uart-on-a-companion-computer" aria-label="Permalink to &quot;Enable UART on a companion computer&quot;">​</a></h3><p>For UART transport on a Raspberry Pi or any other companion computer you will have to enable the serial port:</p><ol><li><p>Make sure the <code>userid</code> (default is pi on a Raspberry Pi) is a member of the <code>dialout</code> group:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">groups</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dialout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pi</span></span></code></pre></div></li><li><p>For the Raspberry Pi in particular, you need to stop the GPIO serial console that is using the port:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspi-config</span></span></code></pre></div><p>In the menu showed go to <strong>Interfacing options &gt; Serial</strong>. Select <strong>NO</strong> for <em>Would you like a login shell to be accessible over serial?</em>. Valid and reboot.</p></li><li><p>Check UART in kernel:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/config.txt</span></span></code></pre></div><p>And make sure that the <code>enable_uart</code> value is set to 1:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span> enable_uart=1</span></span></code></pre></div></li></ol><p>--&gt;</p>`,98);function B(X,x,A,O,T,q){const h=l("Badge"),t=l("tab"),p=l("tabs");return c(),d("div",null,[g,a(h,{type:"tip",text:"PX4 v1.14"}),u,s("ol",null,[m,s("li",null,[F,a(p,null,{default:e(()=>[a(t,{name:"humble"},{default:e(()=>[_]),_:1})]),_:1})])]),E,a(t,{name:"foxy"},{default:e(()=>[y]),_:1}),b,C,f,s("ol",null,[s("li",null,[D,a(p,null,{default:e(()=>[a(t,{name:"humble"},{default:e(()=>[v]),_:1})]),_:1})])]),S,a(t,{name:"foxy"},{default:e(()=>[R]),_:1}),P])}const M=o(k,[["render",B]]);export{w as __pageData,M as default};
