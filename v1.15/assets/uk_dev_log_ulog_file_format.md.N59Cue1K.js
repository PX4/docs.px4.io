import{_ as s,c as a,o as i,ab as e}from"./chunks/framework.CUflZczI.js";const E=JSON.parse('{"title":"Формат файлу ULog","description":"","frontmatter":{},"headers":[],"relativePath":"uk/dev_log/ulog_file_format.md","filePath":"uk/dev_log/ulog_file_format.md"}'),t={name:"uk/dev_log/ulog_file_format.md"},l=e(`<h1 id="формат-фаилу-ulog" tabindex="-1">Формат файлу ULog <a class="header-anchor" href="#формат-фаилу-ulog" aria-label="Permalink to &quot;Формат файлу ULog&quot;">​</a></h1><p>ULog - це формат файлу, що використовується для логування повідомлень. Формат самоописуючий, тобто містить формат та типи повідомлень <a href="./../middleware/uorb.html">uORB</a>, які реєструються. Цей документ призначений для документації специфікації формату файлу ULog. Це призначено особливо для тих, хто зацікавлений у написанні розбірника / серіалізатора ULog та потребує розкодувати / закодувати файли.</p><p>PX4 використовує ULog для ведення журналу тем uORB як повідомлення, пов&#39;язані з (але не обмежені) наступними джерелами:</p><ul><li><strong>Пристрій входу:</strong> датчики, RC, вхід тощо.</li><li><strong>Внутрішні стани:</strong> Завантаження ЦП, ставлення, стан EKF тощо.</li><li><strong>Рядкові повідомлення:</strong> оператори <code>printf</code>, включаючи <code>PX4_INFO()</code> та <code>PX4_ERR()</code>.</li></ul><p>Формат використовує пам&#39;ять з <a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noreferrer">маленьким кінцем</a> для всіх бінарних типів (найменш значущий байт (LSB) типу даних розміщений за найнижчою адресою пам&#39;яті).</p><h2 id="типи-даних" tabindex="-1">Типи даних <a class="header-anchor" href="#типи-даних" aria-label="Permalink to &quot;Типи даних&quot;">​</a></h2><p>Для ведення журналу використовуються наступні типи двійкових даних. Вони всі відповідають типам у мові програмування C.</p><table><thead><tr><th>Тип</th><th>Розмір у байтах</th></tr></thead><tbody><tr><td>int8_t, uint8_t</td><td>1</td></tr><tr><td>int16_t, uint16_t</td><td>2</td></tr><tr><td>int32_t, uint32_t</td><td>4</td></tr><tr><td>int64_t, uint64_t</td><td>8</td></tr><tr><td>float</td><td>4</td></tr><tr><td>double</td><td>8</td></tr><tr><td>bool, char</td><td>1</td></tr></tbody></table><p>Додатково типи можуть бути використані як масив фіксованого розміру: наприклад, <code>float[5]</code>.</p><p>Рядки (<code>char[length]</code>) не містять завершуючий нульовий символ <code>&#39;\\0&#39;</code> в кінці.</p><div class="info custom-block"><p class="custom-block-title">Порівняння рядків чутливе до регістру, що слід враховувати при порівнянні імен повідомлень під час <a href="#a-subscription-message">додавання підписок</a>.</p></div><h2 id="структура-фаилу-ulog" tabindex="-1">Структура файлу ULog <a class="header-anchor" href="#структура-фаилу-ulog" aria-label="Permalink to &quot;Структура файлу ULog&quot;">​</a></h2><p>Файли ULog мають наступні три розділи:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>----------------------</span></span>
<span class="line"><span>|       Header       |</span></span>
<span class="line"><span>----------------------</span></span>
<span class="line"><span>|    Definitions     |</span></span>
<span class="line"><span>----------------------</span></span>
<span class="line"><span>|        Data        |</span></span>
<span class="line"><span>----------------------</span></span></code></pre></div><p>Опис кожного розділу наведено нижче.</p><h3 id="розділ-заголовка" tabindex="-1">Розділ заголовка <a class="header-anchor" href="#розділ-заголовка" aria-label="Permalink to &quot;Розділ заголовка&quot;">​</a></h3><p>Заголовок є розділом фіксованого розміру та має наступний формат (16 байт):</p><div class="language-plain vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>----------------------------------------------------------------------</span></span>
<span class="line"><span>| 0x55 0x4c 0x6f 0x67 0x01 0x12 0x35 | 0x01         | uint64_t       |</span></span>
<span class="line"><span>| File magic (7B)                    | Version (1B) | Timestamp (8B) |</span></span>
<span class="line"><span>----------------------------------------------------------------------</span></span></code></pre></div><ul><li><strong>Файлова магія (7 байт):</strong> Індикатор типу файлу, який читає &quot;ULogXYZ де XYZ - це послідовність магічних байтів <code>0x01 0x12 0x35</code>&quot;</li><li><strong>Версія (1 байт):</strong> Версія формату файлу (наразі 1)</li><li><strong>Мітка часу (8 байтів):</strong> <code>uint64_t</code> ціле число, що вказує на початок реєстрації в мікросекундах.</li></ul><h3 id="заголовок-повідомлення-розділу-визначення-та-даних" tabindex="-1">Заголовок повідомлення розділу визначення та даних <a class="header-anchor" href="#заголовок-повідомлення-розділу-визначення-та-даних" aria-label="Permalink to &quot;Заголовок повідомлення розділу визначення та даних&quot;">​</a></h3><p>Секції <em>Визначення та Дані</em> містять кілька <strong>повідомлень</strong>. Кожне повідомлення передує цим заголовком:</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_size;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_type;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>msg_size</code> є розміром повідомлення в байтах без заголовка.</li><li><code>msg_type</code> визначає вміст і є одним байтом.</li></ul><div class="info custom-block"><p class="custom-block-title">Розділи повідомлення нижче передуються символом, який відповідає його <code>msg_type</code>.</p></div><h3 id="розділ-визначень" tabindex="-1">Розділ визначень <a class="header-anchor" href="#розділ-визначень" aria-label="Permalink to &quot;Розділ визначень&quot;">​</a></h3><p>Розділ визначень містить основну інформацію, таку як версія програмного забезпечення, формат повідомлення, початкові значення параметрів тощо.</p><p>Основні типи повідомлень в цьому розділі є:</p><ol><li><a href="#b-flag-bits-message">Flag Bits</a></li><li><a href="#f-format-message">Визначення формату</a></li><li><a href="#i-information-message">Інформація</a></li><li><a href="#m-multi-information-message">Multi Information</a></li><li><a href="#p-parameter-message">Параметр</a></li><li><a href="#q-default-parameter-message">Параметр за замовчуванням</a></li></ol><h4 id="b-повідомлення-флагів-бітів" tabindex="-1">&#39;B&#39;: Повідомлення флагів бітів <a class="header-anchor" href="#b-повідомлення-флагів-бітів" aria-label="Permalink to &quot;&#39;B&#39;: Повідомлення флагів бітів&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">Це повідомлення повинно бути <strong>першим повідомленням</strong> одразу після розділу заголовка, щоб мати постійний фіксований зсув від початку файлу!</p></div><p>Це повідомлення надає інформацію лог-аналізатору про те, чи можна аналізувати журнал.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_flag_bits_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;B&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> compat_flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> incompat_flags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> appended_offsets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // file offset(s) for appended data if appending bit is set</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><p><code>compat_flags</code>: біти сумісності прапорців</p><ul><li>Ці прапорці вказують на наявність функцій у файлі журналу, які сумісні з будь-яким парсером ULog.</li><li><code>compat_flags[0]</code>: <em>DEFAULT_PARAMETERS</em> (Біт 0): якщо встановлено, журнал містить <a href="#q-default-parameter-message">повідомлення про типові параметри</a></li></ul><p>Решта бітів наразі не визначені і повинні бути встановлені на 0. Ці біти можуть бути використані для майбутніх змін ULog, які сумісні з існуючими парсерами. Наприклад, додавання нового типу повідомлення може бути вказане шляхом визначення нового біта у стандарті, а існуючі парсери ігноруватимуть новий тип повідомлення. Це означає, що парсери можуть просто ігнорувати біти, якщо один з невідомих бітів встановлений.</p></li><li><p><code>incompat_flags</code>: несумісні біти прапорців.</p><ul><li><code>incompat_flags[0]</code>: <em>DATA_APPENDED</em> (Біт 0): якщо встановлено, журнал містить додані дані та щонайменше один з <code>appended_offsets</code> не є нульовим.</li></ul><p>Решта бітів наразі не визначені і повинні бути встановлені на 0. Це може бути використано для введення руйнівних змін, які існуючі парсери не можуть обробити. Наприклад, коли старий парсер ULog, який не мав поняття <em>DATA_APPENDED</em>, читає новий ULog, він припинить розбір журналу, оскільки журнал міститиме повідомлення / концепції, які не відповідають специфікації. Якщо парсер виявляє, що будь-який з цих бітів встановлений, що не вказано, він повинен відмовитися від аналізу журналу.</p></li><li><p><code>appended_offsets</code>: Зсув файлу (0-основний) для додаваних даних. Якщо даних не додається, всі зміщення повинні бути нульовими. Це може бути використано для надійного додавання даних до журналів, які можуть припинитись посеред повідомлення. Наприклад, дампи збоїв.</p><p>Процес додавання даних повинен виконати:</p><ul><li>встановити відповідний біт <code>incompat_flags</code></li><li>встановіть перший <code>appended_offsets</code>, який наразі дорівнює 0, до довжини файлу журналу без доданих даних, оскільки саме там почнуться нові дані</li><li>додайте будь-який тип повідомлень, які є дійсними для розділу Дані.</li></ul></li></ul><p>Можливо, що у майбутніх специфікаціях ULog буде додано ще декілька полів в кінці цього повідомлення. Це означає, що парсер не повинен припускати фіксовану довжину цього повідомлення. Якщо розмір <code>msg_size</code> більший, ніж очікувалося (зараз 40), будь-які додаткові байти повинні бути проігноровані / відкинуті.</p><h4 id="f-формат-повідомлення" tabindex="-1">&#39;F&#39;: Формат повідомлення <a class="header-anchor" href="#f-формат-повідомлення" aria-label="Permalink to &quot;&#39;F&#39;: Формат повідомлення&quot;">​</a></h4><p>Формат повідомлення визначає одне ім&#39;я повідомлення та його внутрішні поля в одному рядку.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_format_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;F&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>format</code> - це рядок звичайного тексту із наступним форматом: <code>message_name:field0;field1;</code><ul><li>Може бути довільна кількість полів (мінімум 1), розділених за допомогою <code>;</code>.</li><li><code>message_name</code>: довільний непорожній рядок з цими допустимими символами: <code>a-zA-Z0-9_-/</code> (і відмінний від будь-якого з <a href="#data-types">основних типів</a>).</li></ul></li></ul><p>Поле має формат: <code>тип назва_поля</code>, або для масиву: <code>тип[довжина_масиву] назва_поля</code> використовується (підтримуються лише масиви фіксованого розміру). <code>field_name</code> повинен складатися з символів у наборі <code>a-zA-Z0-9_</code>.</p><p><code>Тип</code> - один із <a href="#data-types">основних бінарних типів</a> або <code>message_name</code> іншого визначення формату (вкладене використання).</p><ul><li>Тип може бути використаний до того, як він буде визначений. <ul><li>наприклад, Повідомлення <code>MessageA:MessageB[2] msg_b</code> може прийти до <code>MessageB:uint_8[3] data</code></li></ul></li><li>Може бути довільне вкладення, але <strong>без циклічних залежностей</strong><ul><li>e.g. <code>MessageA:MessageB[2] msg_b</code> &amp; <code>MessageB:MessageA[4] msg_a</code></li></ul></li></ul><p>Деякі назви полів є спеціальними:</p><ul><li><code>відмітка часу</code>: кожен формат повідомлення з <a href="#a-subscription-message">Повідомленням про підписку</a> повинен містити поле відмітки часу (наприклад, формат повідомлення, який використовується лише як частина вкладеного визначення іншим форматом, може не містити поля відмітки часу) <ul><li>Його тип повинен бути <code>uint64_t</code>.</li><li>Одиниця вимірювання - мікросекунди.</li><li>Часовий позначення завжди повинно бути монотонно зростаючим для серії повідомлень з тим самим <code>msg_id</code> (тією самою підпискою).</li></ul></li><li><code>_padding{}</code>: імена полів, які починаються з <code>_padding</code> (наприклад, <code>_padding[3]</code>), не повинні відображатися, і їх дані повинні бути ігноровані читачем. <ul><li>Ці поля можуть бути вставлені письменником для забезпечення правильного вирівнювання.</li><li>Якщо поле відступу є останнім полем, тоді це поле може не бути зареєстроване, щоб уникнути запису непотрібних даних.</li><li>Це означає, що <code>message_data_s.data</code> буде коротшим на розмір відступу.</li><li>Однак відступ все ще потрібен, коли повідомлення використовується во вкладеному визначенні.</li></ul></li><li>Загалом, поля повідомлень не обов&#39;язково вирівняні (тобто зсув поля всередині повідомлення не обов&#39;язково є кратним його розміру даних), тому читач завжди повинен використовувати відповідні методи копіювання пам&#39;яті для доступу до окремих полів.</li></ul><h4 id="i-інформаціине-повідомлення" tabindex="-1">&#39;I&#39;: Інформаційне повідомлення <a class="header-anchor" href="#i-інформаціине-повідомлення" aria-label="Permalink to &quot;&#39;I&#39;: Інформаційне повідомлення&quot;">​</a></h4><p>Повідомлення про інформацію визначає типове визначення словника <code>key</code> : <code>value</code> пари для будь-якої інформації, включаючи, але не обмежуючись, версію апаратного забезпечення, версію програмного забезпечення, засіб збірки для програмного забезпечення тощо.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_info_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;I&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>key_len</code>: Довжина значення ключа</li><li><code>key</code>: Містить рядок ключа у формі <code>type name</code>, наприклад, <code>char[value_len] sys_toolchain_ver</code>. Допустимі символи для імені: <code>a-zA-Z0-9_-/</code>. Тип може бути одним з <a href="#data-types">основних типів, включаючи масиви</a>.</li><li><code>значення</code>: Містить дані (з довжиною <code>value_len</code>), що відповідають ключу <code>key</code>, наприклад <code>9.4.0</code>.</li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Ключ, визначений у повідомленні Інформації, повинен бути унікальним. Означає, що не повинно бути більше одного визначення з таким самим ключовим значенням.</p></div><p>Парсери можуть зберігати інформаційні повідомлення у вигляді словника.</p><p>Попередньо визначені інформаційні повідомлення:</p><table><thead><tr><th>key</th><th>Опис</th><th>Приклад для значення</th></tr></thead><tbody><tr><td><code>char[value_len] sys_name</code></td><td>Назва системи</td><td>&quot;PX4&quot;</td></tr><tr><td><code>char[value_len] ver_hw</code></td><td>Версія апаратного забезпечення (плата)</td><td>&quot;PX4FMU_V4&quot;</td></tr><tr><td><code>char[value_len] ver_hw_subtype</code></td><td>Підстава плати (варіація)</td><td>&quot;V2&quot;</td></tr><tr><td><code>char[value_len] ver_sw</code></td><td>Версія програмного забезпечення (git tag)</td><td>&quot;7f65e01&quot;</td></tr><tr><td><code>char[value_len] ver_sw_branch</code></td><td>git branch</td><td>&quot;master&quot;</td></tr><tr><td><code>uint32_t ver_sw_release</code></td><td>Версія програмного забезпечення (див. нижче)</td><td>0x010401ff</td></tr><tr><td><code>char[value_len] sys_os_name</code></td><td>Назва операційної системи</td><td>&quot;Linux&quot;</td></tr><tr><td><code>char[value_len] sys_os_ve</code>r</td><td>Версія ОС (git tag)</td><td>&quot;9f82919&quot;</td></tr><tr><td><code>uint32_t ver_os_release</code></td><td>Версія ОС (див. нижче)</td><td>0x010401ff</td></tr><tr><td><code>char[value_len] sys_toolchain</code></td><td>Назва набору інструментів</td><td>&quot;GNU GCC&quot;</td></tr><tr><td><code>char[value_len] sys_toolchain_ver</code></td><td>Версія інструментального набору</td><td>&quot;6.2.1&quot;</td></tr><tr><td><code>char[value_len] sys_mcu</code></td><td>Назва мікросхеми та ревізія</td><td>&quot;STM32F42x, rev A&quot;</td></tr><tr><td><code>char[value_len] sys_uuid</code></td><td>Унікальний ідентифікатор для транспортного засобу (наприклад, ідентифікатор MCU)</td><td>&quot;392a93e32fa3&quot;...</td></tr><tr><td><code>char[value_len] log_type</code></td><td>Тип журналу (повний журнал, якщо не вказано)</td><td>&quot;mission&quot;</td></tr><tr><td><code>char[value_len] replay</code></td><td>Ім&#39;я файлу відтвореного журналу, якщо в режимі відтворення</td><td>&quot;log001.ulg&quot;</td></tr><tr><td><code>int32_t time_ref_utc</code></td><td>Зсув часу UTC в секундах</td><td>-3600</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title"><code>value_</code> відображає розмір даних <code>значення</code>. Це описано у <code>key</code>.</p></div><ul><li>Формат <code>ver_sw_release</code> та <code>ver_os_release</code> становить: 0xAABBCCTT, де AA - <strong>major</strong>, BB - ** minor **, CC - патч, а TT - <strong>type</strong>. <ul><li><strong>Тип</strong> визначається наступним чином: <code>&gt;= 0</code>: розробка, <code>&gt;= 64</code>: альфа-версія, <code>&gt;= 128</code>: бета-версія, <code>&gt;= 192</code>: RC-версія, <code>== 255</code>: версія релізу.</li><li>Наприклад, <code>0x010402FF</code> перекладається у випуск версії v1.4.2.</li></ul></li></ul><p>Це повідомлення також може бути використано в розділі Дані (це, однак, переважний розділ).</p><h4 id="m-багатоінформаціине-повідомлення" tabindex="-1">&#39;M&#39;: Багатоінформаційне повідомлення <a class="header-anchor" href="#m-багатоінформаціине-повідомлення" aria-label="Permalink to &quot;&#39;M&#39;: Багатоінформаційне повідомлення&quot;">​</a></h4><p>Повідомлення з багатою інформацією слугує такій же меті, як і повідомлення інформації, але для довгих повідомлень або кількох повідомлень з одним і тим же ключем.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_info_multiple_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;M&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_continued;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // can be used for arrays</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>is_continued</code> може бути використаний для розділення повідомлень: якщо встановлено 1, це частина попереднього повідомлення з тим самим ключем.</li></ul><p>Парсери можуть зберігати всю інформацію про багато повідомлень у вигляді 2D-списку, використовуючи той самий порядок, що й повідомлення в лог-файлі.</p><p>Дійсні імена та типи такі ж, як для повідомлення Інформація.</p><h4 id="p-повідомлення-параметра" tabindex="-1">&#39;P&#39;: Повідомлення параметра <a class="header-anchor" href="#p-повідомлення-параметра" aria-label="Permalink to &quot;&#39;P&#39;: Повідомлення параметра&quot;">​</a></h4><p>Повідомлення параметра в розділі <em>Визначення</em> визначає значення параметрів транспортного засобу при початку реєстрації. Він використовує той самий формат, що і <a href="#i-information-message">Повідомлення інформації</a>.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_info_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;P&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>Якщо параметр динамічно змінюється під час виконання, це повідомлення також може бути <a href="#messages-shared-with-the-definitions-section">використано в розділі Дані</a> також.</p><p>Тип даних обмежений <code>int32_t</code> та <code>float</code>. Допустимі символи для імені: <code>a-zA-Z0-9_-/</code>.</p><h4 id="q-параметр-повідомлення-за-замовчуванням" tabindex="-1">&#39;Q&#39;: Параметр повідомлення за замовчуванням <a class="header-anchor" href="#q-параметр-повідомлення-за-замовчуванням" aria-label="Permalink to &quot;&#39;Q&#39;: Параметр повідомлення за замовчуванням&quot;">​</a></h4><p>Повідомлення параметра за замовчуванням визначає значення параметра для вказаного транспортного засобу та налаштувань.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ulog_message_parameter_default_header_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;Q&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> default_types;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key_len;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[key_len];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key_len]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>default_types</code> є бітовим полем і визначає, до якої (яких) групи(ів) належить значення. <ul><li>Принаймні один біт повинен бути встановлений: <ul><li><code>1&lt;&lt;0</code>: системний стандарт за замовчуванням</li><li><code>1&lt;&lt;1</code>: за замовчуванням для поточної конфігурації (наприклад, конструкція повітряного корпусу)</li></ul></li></ul></li></ul><p>Журнал не може містити значень за замовчуванням для всіх параметрів. У цих випадках значення за замовчуванням дорівнює значенню параметра, а різні типи за замовчуванням розглядаються незалежно один від одного.</p><p>Це повідомлення також може бути використане в розділі Дані, і застосовується той самий тип даних та найменування, як і для повідомлення Параметр.</p><p>Цей розділ закінчується до початку першого <a href="#a-subscription-message">Повідомлення про підписку</a> або повідомлення <a href="#l-logged-string-message">Логування</a>, яке спочатку.</p><h3 id="розділ-даних" tabindex="-1">Розділ даних <a class="header-anchor" href="#розділ-даних" aria-label="Permalink to &quot;Розділ даних&quot;">​</a></h3><p>Основні типи повідомлень в розділі <em>Дані</em> є:</p><ol><li><a href="#a-subscription-message">Підписка</a></li><li><a href="#r-unsubscription-message">Відписка</a></li><li><a href="#d-logged-data-message">Зареєстровані дані</a></li><li><a href="#l-logged-string-message">Зареєстрована рядок</a></li><li><a href="#c-tagged-logged-string-message">Позначений Зареєстрована рядок</a></li><li><a href="#s-synchronization-message">Синхронізація</a></li><li><a href="#o-dropout-message">Відмова відмови</a></li><li><a href="#i-information-message">Інформація</a></li><li><a href="#m-multi-information-message">Multi Information</a></li><li><a href="#p-parameter-message">Параметр</a></li><li><a href="#q-default-parameter-message">Параметр за замовчуванням</a></li></ol><h4 id="a-повідомлення-про-підписку" tabindex="-1"><code>A</code>: Повідомлення про підписку <a class="header-anchor" href="#a-повідомлення-про-підписку" aria-label="Permalink to &quot;\`A\`: Повідомлення про підписку&quot;">​</a></h4><p>Підписати повідомлення за назвою та надати йому ідентифікатор, який використовується в <a href="#d-logged-data-message">Зареєстрованому повідомленні Даних</a>. Це повинно бути перед першим відповідним <a href="#d-logged-data-message">Повідомленням про зареєстровані дані</a>.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_add_logged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;A&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> multi_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>multi_id</code>: той самий формат повідомлення може мати кілька екземплярів, наприклад, якщо система має два датчики одного типу. Стандартне та перше значення повинно бути 0.</li><li><code>msg_id</code>: унікальний ідентифікатор для відповідності даним <a href="#d-logged-data-message">Повідомлення про зареєстровані дані</a>. Перше використання повинно встановити це на 0, а потім збільшувати його. <ul><li>Той же <code>msg_id</code> не повинен використовуватися двічі для різних підписок.</li></ul></li><li><code>message_name</code>: назва повідомлення для підписки. Повинно відповідати одному з визначень <a href="#f-format-message">Форматованого повідомлення</a>.</li></ul><h4 id="r-повідомлення-про-відписку" tabindex="-1"><code>R</code>: Повідомлення про відписку <a class="header-anchor" href="#r-повідомлення-про-відписку" aria-label="Permalink to &quot;\`R\`: Повідомлення про відписку&quot;">​</a></h4><p>Відмовитися від повідомлення, щоб позначити, що воно більше не буде реєструватися (зараз не використовується).</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_remove_logged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;R&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="d-повідомлення-про-зареєстровані-дані" tabindex="-1">&#39;D&#39;: Повідомлення про зареєстровані дані <a class="header-anchor" href="#d-повідомлення-про-зареєстровані-дані" aria-label="Permalink to &quot;&#39;D&#39;: Повідомлення про зареєстровані дані&quot;">​</a></h4><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_data_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;D&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> msg_id;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>msg_id</code>: як визначено у <a href="#a-subscription-message">Повідомленні підписки</a></li><li><code>дані</code> містять зареєстроване бінарне повідомлення, визначене за допомогою <a href="#f-format-message">Форматування повідомлення</a></li></ul><p>Див. вище для спеціальної обробки полів відступу.</p><h4 id="l-повідомлення-про-зареєстровании-рядок" tabindex="-1">&#39;L&#39;: Повідомлення про зареєстрований рядок <a class="header-anchor" href="#l-повідомлення-про-зареєстровании-рядок" aria-label="Permalink to &quot;&#39;L&#39;: Повідомлення про зареєстрований рядок&quot;">​</a></h4><p>Зареєстрований рядковий повідомлення, тобто вихід <code>printf()</code>.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_logging_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;L&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> log_level;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>часовий_відміток</code>: у мікросекундах</li><li><code>log_level</code>: те саме, що і в ядрі Linux:</li></ul><table><thead><tr><th>Назва</th><th>Значення рівня</th><th>Значення</th></tr></thead><tbody><tr><td>EMERG</td><td>&#39;0&#39;</td><td>Система непридатна до використання</td></tr><tr><td>ALERT</td><td>&#39;1&#39;</td><td>Дії повинні бути вжиті негайно</td></tr><tr><td>CRIT</td><td>&#39;2&#39;</td><td>Критичні умови</td></tr><tr><td>ERR</td><td>&#39;3&#39;</td><td>Умови помилки</td></tr><tr><td>WARNING</td><td>&#39;4&#39;</td><td>Умови попередження</td></tr><tr><td>NOTICE</td><td>&#39;5&#39;</td><td>Нормальний, але значущий стан</td></tr><tr><td>INFO</td><td>&#39;6&#39;</td><td>Інформаційний</td></tr><tr><td>DEBUG</td><td>&#39;7&#39;</td><td>Повідомлення рівня налагодження</td></tr></tbody></table><h4 id="c-позначене-зареєстроване-рядкове-повідомлення" tabindex="-1">&#39;C&#39;: позначене зареєстроване рядкове повідомлення <a class="header-anchor" href="#c-позначене-зареєстроване-рядкове-повідомлення" aria-label="Permalink to &quot;&#39;C&#39;: позначене зареєстроване рядкове повідомлення&quot;">​</a></h4><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_logging_tagged_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;C&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> log_level;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tag;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint64_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[header.msg_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><p><code>tag</code>: id представляє джерело записаного рядка повідомлення. Це може представляти процес, потік або клас в залежності від архітектури системи.</p><ul><li>Наприклад, референсна реалізація для бортового комп&#39;ютера, що виконує кілька процесів для керування різними навантаженнями, зовнішніми дисками, послідовними пристроями тощо, може кодувати ідентифікатори цих процесів, використовуючи <code>uint16_t enum</code> у атрибуті <code>tag</code> структури наступним чином:</li></ul><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> class ulog_tag : </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  unassigned,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mavlink_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ppk_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  camera_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ptp_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  serial_handler,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  watchdog,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  io_service,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cbuf,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ulg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div></li><li><p><code>часовий_відміток</code>: у мікросекундах</p></li><li><p><code>log_level</code>: те саме, що і в ядрі Linux:</p></li></ul><table><thead><tr><th>Назва</th><th>Значення рівня</th><th>Значення</th></tr></thead><tbody><tr><td>EMERG</td><td>&#39;0&#39;</td><td>Система непридатна до використання</td></tr><tr><td>ALERT</td><td>&#39;1&#39;</td><td>Дії повинні бути вжиті негайно</td></tr><tr><td>CRIT</td><td>&#39;2&#39;</td><td>Критичні умови</td></tr><tr><td>ERR</td><td>&#39;3&#39;</td><td>Умови помилки</td></tr><tr><td>WARNING</td><td>&#39;4&#39;</td><td>Умови попередження</td></tr><tr><td>NOTICE</td><td>&#39;5&#39;</td><td>Нормальний, але значущий стан</td></tr><tr><td>INFO</td><td>&#39;6&#39;</td><td>Інформаційне</td></tr><tr><td>DEBUG</td><td>&#39;7&#39;</td><td>Повідомлення рівня налагодження</td></tr></tbody></table><h4 id="s-повідомлення-синхронізаціі" tabindex="-1">&#39;S&#39;: Повідомлення синхронізації <a class="header-anchor" href="#s-повідомлення-синхронізаціі" aria-label="Permalink to &quot;&#39;S&#39;: Повідомлення синхронізації&quot;">​</a></h4><p>Повідомлення синхронізації, щоб читач міг відновитися від пошкодженого повідомлення, шукаючи наступне повідомлення синхронізації.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_sync_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;S&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint8_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> sync_magic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><ul><li><code>sync_magic</code>: [0x2F, 0x73, 0x13, 0x20, 0x25, 0x0C, 0xBB, 0x12]</li></ul><h4 id="o-повідомлення-про-відключення" tabindex="-1">&#39;O&#39;: Повідомлення про відключення <a class="header-anchor" href="#o-повідомлення-про-відключення" aria-label="Permalink to &quot;&#39;O&#39;: Повідомлення про відключення&quot;">​</a></h4><p>Позначте відсутність (втрачені повідомлення журналювання) заданої тривалості в мс.</p><p>Відключення можуть виникати, наприклад, якщо пристрій не є достатньо швидким.</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_dropout_s {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message_header_s header;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // msg_type = &#39;O&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  uint16_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> duration;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h4 id="повідомлення-розділені-розділом-визначень" tabindex="-1">Повідомлення, розділені розділом визначень <a class="header-anchor" href="#повідомлення-розділені-розділом-визначень" aria-label="Permalink to &quot;Повідомлення, розділені розділом визначень&quot;">​</a></h4><p>Оскільки Розділи Визначень та Дані використовують той же формат заголовка повідомлення, вони також діляться тими ж повідомленнями, які перераховані нижче:</p><ul><li><a href="#i-information-message">Інформаційне повідомлення</a>.</li><li><a href="#m-multi-information-message">Мульти-інформаційне повідомлення</a></li><li><a href="#p-parameter-message">Повідомлення параметра</a><ul><li>Для розділу <em>Дані</em>, Повідомлення Параметра використовується, коли змінюється значення параметра</li></ul></li><li><a href="#q-default-parameter-message">Повідомлення параметра за замовчуванням</a></li></ul><h2 id="вимоги-до-parsers" tabindex="-1">Вимоги до Parsers <a class="header-anchor" href="#вимоги-до-parsers" aria-label="Permalink to &quot;Вимоги до Parsers&quot;">​</a></h2><p>Дійсний розбірник ULog повинен відповідати наступним вимогам:</p><ul><li>Повинен ігнорувати невідомі повідомлення (але може вивести попередження)</li><li>Розбирайте майбутні/невідомі версії формату файлу також (але може вивести попередження).</li><li>Повинен відмовитися від аналізу журналу, який містить невідомі біти несумісності (<code>incompat_flags</code> у <a href="#b-flag-bits-message">Повідомлення про біти прапорців</a>), що означає, що журнал містить руйнівні зміни, які парсер не може обробити.</li><li>Парсер повинен правильно обробляти журнали, які раптово закінчуються, посеред повідомлення. Недовершене повідомлення слід просто викинути.</li><li>Для доданих даних: парсер може вважати, що секція Даних існує, тобто зміщення вказує на місце після секції Визначень. <ul><li>Додані дані повинні трактуватися так, ніби вони були частиною звичайного розділу даних.</li></ul></li></ul><h2 id="відомі-реалізаціі-парсера" tabindex="-1">Відомі Реалізації Парсера <a class="header-anchor" href="#відомі-реалізаціі-парсера" aria-label="Permalink to &quot;Відомі Реалізації Парсера&quot;">​</a></h2><ul><li>PX4-Autopilot++: C++ <ul><li><a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/src/modules/logger" target="_blank" rel="noreferrer">logger module</a></li><li><a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/src/modules/replay" target="_blank" rel="noreferrer">replay module</a></li><li><a href="https://github.com/PX4/PX4-Autopilot/tree/release/1.15/src/systemcmds/hardfault_log" target="_blank" rel="noreferrer">Модуль hardfault_log</a>: додайте дані про аварійне завершення.</li></ul></li><li><a href="https://github.com/PX4/pyulog" target="_blank" rel="noreferrer">pyulog</a>: бібліотека python, ULog для зчитування та запису з CLI скриптами.</li><li><a href="https://github.com/PX4/ulog_cpp" target="_blank" rel="noreferrer">ulog_cpp</a>: C++, бібліотека читання та запису ULog на C++.</li><li><a href="https://github.com/PX4/FlightPlot" target="_blank" rel="noreferrer">FlightPlot</a>: Java, log plotter.</li><li><a href="https://github.com/mavlink/mavlink" target="_blank" rel="noreferrer">MAVLink</a>: Повідомлення для потокового відображення ULog через MAVLink (зауважте, що додавання даних не підтримується, принаймні не для відсічених повідомлень).</li><li><a href="https://github.com/mavlink/qgroundcontrol" target="_blank" rel="noreferrer">QGroundControl</a>: C++, потік ULog через MAVLink та мінімальний розбір для геознаходження.</li><li><a href="https://github.com/01org/mavlink-router" target="_blank" rel="noreferrer">mavlink-router</a>: C++, потік ULog через MAVLink.</li><li><a href="https://github.com/ecmnet/MAVGCL" target="_blank" rel="noreferrer">MAVGAnalysis</a>: Java, ULog streaming через MAVLink та парсер для побудови графіків та аналізу.</li><li><a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">PlotJuggler</a>: C++/Qt додаток для побудови графіків і часових рядів. Підтримує ULog з версії 2.1.3.</li><li><a href="https://github.com/maxsun/ulogreader" target="_blank" rel="noreferrer">ulogreader</a>: Javascript, ULog читач і парсер виводить журнал у форматі об&#39;єкта JSON.</li><li><a href="https://github.com/foxglove/studio" target="_blank" rel="noreferrer">Foxglove Studio</a>: інтегрований інструмент візуалізації та діагностики для робототехніки (Парсер ULog на Typescript: <a href="https://github.com/foxglove/ulog" target="_blank" rel="noreferrer">https://github.com/foxglove/ulog</a>).</li></ul><h2 id="історія-версіи-формату-фаилу" tabindex="-1">Історія версій формату файлу <a class="header-anchor" href="#історія-версіи-формату-фаилу" aria-label="Permalink to &quot;Історія версій формату файлу&quot;">​</a></h2><h3 id="зміни-у-версіі-2" tabindex="-1">Зміни у версії 2 <a class="header-anchor" href="#зміни-у-версіі-2" aria-label="Permalink to &quot;Зміни у версії 2&quot;">​</a></h3><ul><li>Додавання <a href="#m-multi-information-message">Повідомлення з багатою інформацією</a> та <a href="#b-flag-bits-message">Прапорці Повідомлення</a> та можливість додавання даних до журналу. <ul><li>Це використовується для додавання даних про збій до існуючого журналу.</li><li>Якщо дані додаються до журналу, який обрізаний посередині повідомлення, їх не можна розбирати з парсерами версії 1.</li></ul></li><li>Крім того, передня та задня сумісність забезпечується, якщо парсери ігнорують невідомі повідомлення.</li></ul>`,114),n=[l];function h(p,d,r,k,o,c){return i(),a("div",null,n)}const u=s(t,[["render",h]]);export{E as __pageData,u as default};
