import{_ as a,a as s,b as i,c as l,d as e,e as t}from"./chunks/plotjuggler_quaternion_roll_plotted.CJGUXW66.js";import{_ as n,c as h,o as p,ab as o}from"./chunks/framework.CUflZczI.js";const f=JSON.parse('{"title":"Аналіз журналу за допомогою PlotJuggler","description":"","frontmatter":{},"headers":[],"relativePath":"uk/log/plotjuggler_log_analysis.md","filePath":"uk/log/plotjuggler_log_analysis.md"}'),r={name:"uk/log/plotjuggler_log_analysis.md"},d=o('<h1 id="аналіз-журналу-за-допомогою-plotjuggler" tabindex="-1">Аналіз журналу за допомогою PlotJuggler <a class="header-anchor" href="#аналіз-журналу-за-допомогою-plotjuggler" aria-label="Permalink to &quot;Аналіз журналу за допомогою PlotJuggler&quot;">​</a></h1><p><a href="https://github.com/facontidavide/PlotJuggler" target="_blank" rel="noreferrer">PlotJuggler</a> може бути використаний для аналізу ULogs для більш глибоких розробок. Це надзвичайно корисно, оскільки кожна тема uORB відкрита / може бути побудована на графіку, а також має власні функції для зміни даних (наприклад, зі значень кватерніону на Крен / Тангаж / Риштування).</p><h2 id="встановлення" tabindex="-1">Встановлення <a class="header-anchor" href="#встановлення" aria-label="Permalink to &quot;Встановлення&quot;">​</a></h2><p>Ви можете знайти останні версії Plot Juggler <a href="https://github.com/facontidavide/PlotJuggler/releases" target="_blank" rel="noreferrer">тут</a>.</p><h4 id="примітки-щодо-розподілу-windows" tabindex="-1">Примітки щодо розподілу Windows <a class="header-anchor" href="#примітки-щодо-розподілу-windows" aria-label="Permalink to &quot;Примітки щодо розподілу Windows&quot;">​</a></h4><p>Остання версія PlotJuggler для Windows може не працювати. У цьому випадку використовуйте <a href="https://github.com/facontidavide/PlotJuggler/releases/tag/2.8.4" target="_blank" rel="noreferrer">v2.8.4 тут</a> (відомо, що це працює з Windows).</p><h4 id="примітки-про-appimage-для-дистрибутивів-linux" tabindex="-1">Примітки про AppImage для дистрибутивів Linux <a class="header-anchor" href="#примітки-про-appimage-для-дистрибутивів-linux" aria-label="Permalink to &quot;Примітки про AppImage для дистрибутивів Linux&quot;">​</a></h4><p>Якщо завантажений AppImage не відкривається, можливо, вам потрібно змінити його налаштування доступу. Це робиться в терміналі за допомогою наступної команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 777</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Path-To-PlotJuggler-AppImag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h2 id="загальне-використання" tabindex="-1">Загальне використання <a class="header-anchor" href="#загальне-використання" aria-label="Permalink to &quot;Загальне використання&quot;">​</a></h2><p>Два найпоширеніші завдання - &quot;Пошук&quot; залогованої теми уORB та &quot;Перетягування та Відпускання&quot; поля в певну тему на графічний вигляд. Це показано на діаграмі нижче.</p><p><img src="'+a+'" alt="Plot Juggler basic usage"></p><h3 id="розбиття-по-горизонталі-вертикалі-багатопанельнии" tabindex="-1">Розбиття по горизонталі / вертикалі: Багатопанельний <a class="header-anchor" href="#розбиття-по-горизонталі-вертикалі-багатопанельнии" aria-label="Permalink to &quot;Розбиття по горизонталі / вертикалі: Багатопанельний&quot;">​</a></h3><p>Одна з найбільш потужних функцій - розділення екрану у горизонтальному або вертикальному положенні та відображення різних графіків одночасно (з синхронізованою панеллю часу зверху, якщо переміщуєте курсор часу внизу).</p><p>Це показано на анімації нижче:</p><p><img src="'+s+'" alt="Plot Juggler Multi panel demonstration"></p><p>У цьому прикладі складові <code>ax</code>, <code>ay</code> та <code>az</code> (Оцінка прискорення) теми <code>vehicle_local_position</code> були спочатку графічно відобразжені, ділячи екран на 3 секції. Потім компонент <code>vz</code> (оцінка швидкості) був доданий під праву панель, і наостанок графік <code>current_a</code> (струм акумулятора) теми <code>battery_status</code> був побудований у нижній середній панелі.</p><p>Хоча спочатку це не очевидно, ви можете помітити, що кожного разу, коли автомобіль починає рухатися (значення поточного заряду батареї зростає), значення прискорення та швидкості також починають змінюватися. Це тому, що всі дані відображаються як часова послідовність, яка показує кожне значення на певному міткостемпу.</p><p>Це корисно для отримання загального уявлення про те, що сталося і чому. Часто важко вирішувати проблеми, просто глянувши на один графік, але якщо відображені кілька графіків, набагато легше зрозуміти, що відбувалося в системі.</p><h3 id="відображення-даних-у-2d" tabindex="-1">Відображення даних у 2D <a class="header-anchor" href="#відображення-даних-у-2d" aria-label="Permalink to &quot;Відображення даних у 2D&quot;">​</a></h3><p>Іншою потужною функцією є можливість відображення 2D даних на площині XY (кожні дані на вісі X, Y) у вигляді діаграми розсіювання. Це робиться шляхом вибору двох точок даних, утримуючи клавішу <code>Ctrl</code> під час вибору кожної з них (наприклад, компоненти <code>x</code> та <code>y</code> теми <code>vehicle_local_position</code>), і перетягуючи їх з натиснутою правою клавішею миші.</p><p><img src="'+i+'" alt="Plot Juggler 2D graphing"></p><p>У цьому прикладі положення оціненого транспортного засобу в локальній координатній системі графічно відображено на площині XY, яка показує двовимірний вид оціненого положення, а компоненти <code>vx</code> та <code>vy</code> (оцінка швидкості) графічно відображено справа, і <code>vz</code> (оцінка вертикальної швидкості) відображено під ним на розділеному вигляді.</p><p>Це в свою чергу показує взаємозв&#39;язок між позицією та швидкістю руху транспортного засобу інтуїтивно. Наприклад, зверніть увагу, що коли транспортний засіб рухається в напрямку X-осі, значення <code>vx</code> зростає, і коли транспортний засіб повертається у напрямку Y-осі, значення <code>vy</code> також починає змінюватись.</p><h4 id="використання-кнопки-play" tabindex="-1">Використання кнопки &#39;Play&#39; <a class="header-anchor" href="#використання-кнопки-play" aria-label="Permalink to &quot;Використання кнопки &#39;Play&#39;&quot;">​</a></h4><p>Тут кнопка <strong>Відтворити</strong> використовується для програвання записаних даних в реальному часі (коефіцієнт швидкості можна налаштувати в правому нижньому куті). Це показує детально зв&#39;язок позиції / швидкості, описаний вище.</p><p><img src="'+l+'" alt="Plot Juggler 2D in-depth analysis"></p><div class="info custom-block"><p class="custom-block-title">Спробуйте самі аналізувати журнал тестування човна, завантаживши вищезазначений файл ULog та макет!</p><ul><li><a href="https://github.com/PX4/PX4-user_guide/raw/v1.15/assets/flight_log_analysis/plot_juggler/sample_log_boat_testing_2022-7-28-13-31-16.ulg" target="_blank" rel="noreferrer">Тестування човна ULog</a></li><li><a href="https://raw.githubusercontent.com/PX4/PX4-user_guide/v1.15/assets/flight_log_analysis/plot_juggler/sample_log_boat_testing_layout.xml" target="_blank" rel="noreferrer">Макет аналізу тестування човна</a></li></ul></div><h3 id="шаблони-макетів" tabindex="-1">Шаблони макетів <a class="header-anchor" href="#шаблони-макетів" aria-label="Permalink to &quot;Шаблони макетів&quot;">​</a></h3><p>Існує кілька файлів розташування PlotJuggler, якими діляться розробники PX4. Кожен може бути використаний для конкретної мети (настройка багтрекера, настройка VTOL, налагодження човна і т. Д.):</p><ul><li><a href="https://github.com/PX4/PX4-user_guide/blob/v1.15/assets/flight_log_analysis/plot_juggler/plotjuggler_sample_view.xml" target="_blank" rel="noreferrer">Зразок макету перегляду</a> : Шаблон, який використовується у <a href="#splitting-horizontally-vertically-multi-panel">прикладі з декількома панелями</a> вище.</li></ul><h2 id="розширене-використання" tabindex="-1">Розширене використання <a class="header-anchor" href="#розширене-використання" aria-label="Permalink to &quot;Розширене використання&quot;">​</a></h2><h3 id="створення-власних-часових-рядів-за-допомогою-lua-скрипта" tabindex="-1">Створення власних часових рядів за допомогою LUA скрипта <a class="header-anchor" href="#створення-власних-часових-рядів-за-допомогою-lua-скрипта" aria-label="Permalink to &quot;Створення власних часових рядів за допомогою LUA скрипта&quot;">​</a></h3><p>Plot Juggler підтримує використання LUA скриптів для обробки та відображення даних. Це потужна функція, яка може робити такі речі, як інтегрування кривої, усереднювання двох кривих, видалення зміщень та інше.</p><h4 id="розрахунок-кута-крену-тангажу-риск-з-кватеріону" tabindex="-1">Розрахунок кута крену/тангажу/риск з кватеріону <a class="header-anchor" href="#розрахунок-кута-крену-тангажу-риск-з-кватеріону" aria-label="Permalink to &quot;Розрахунок кута крену/тангажу/риск з кватеріону&quot;">​</a></h4><p><img src="'+e+'" alt="Quaternion to Roll using Lua script"></p><p>Щоб знати ставлення транспортного засобу, PX4 реєструє оцінку кватерніону ставлення в темі <code>vehicle_attitude</code> у масиві значень з плаваючою комою (q[4]). Оскільки ці значення не надають контекстної інформації (наприклад, <code>roll</code>), вони потребують перетворення за допомогою тригонометричних функцій.</p><ol><li>Пошукати тему <code>vehicle_attitude</code> у панелі списку часових рядів зліва</li><li>Виберіть 4 кватерніони (<code>q.00, q.01, q.02, q.03</code>) , натиснувши спершу <code>q.00</code>, а потім утримуючи Shift + натискайте <code>q.03</code>. Вони всі повинні бути вибрані</li><li>Клацніть на символ &#39;+&#39; у нижньому лівому розділі &#39;Користувацькі серії&#39;, щоб створити нову серію</li><li>Виберіть ще 4 члени кватерніона та перетягніть їх на вкладку &#39;Вхідний часовий ряд + Додатковий джереловий часовий ряд&#39; у верхньому лівому куті</li><li>Подвійне клацання на <code>quat_to_roll</code> у бібліотеці функцій. Тепер ви маєте сюжет на верхній секції</li><li>Призначте назву для графіку (наприклад, <code>roll</code>) у полі вводу в верхньому правому куті</li><li>Клацніть &#39;Створити нову часову послідовність&#39;. Тепер ви маєте сюжет у &#39;Спеціальній серії&#39;</li></ol><p>Тут серія власної <code>Roll</code> відображається разом з іншими часовими рядами, включаючи його початкову форму в кватерніоні справа, яка не є придатною для сприйняття людиною (використовуючи PlotJuggler 3.5.0):</p><p><img src="'+t+`" alt="Quaternion Roll plotted"></p><p>Функція <code>quat_to_roll</code> виглядає так:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dcm21 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dcm22 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">z</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">roll </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> math.atan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dcm21, dcm22)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> roll</span></span></code></pre></div>`,42),k=[d];function g(c,u,E,_,y,m){return p(),h("div",null,k)}const q=n(r,[["render",g]]);export{f as __pageData,q as default};
