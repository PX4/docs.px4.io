import{_ as l,c as t,o as e,ab as i,m as s,a}from"./chunks/framework.CUflZczI.js";const v=JSON.parse('{"title":"Симуляція кількох рухомих засобів з Gazebo Classic","description":"","frontmatter":{},"headers":[],"relativePath":"uk/sim_gazebo_classic/multi_vehicle_simulation.md","filePath":"uk/sim_gazebo_classic/multi_vehicle_simulation.md"}'),n={name:"uk/sim_gazebo_classic/multi_vehicle_simulation.md"},h=i('<h1 id="симуляція-кількох-рухомих-засобів-з-gazebo-classic" tabindex="-1">Симуляція кількох рухомих засобів з Gazebo Classic <a class="header-anchor" href="#симуляція-кількох-рухомих-засобів-з-gazebo-classic" aria-label="Permalink to &quot;Симуляція кількох рухомих засобів з Gazebo Classic&quot;">​</a></h1><p>Цей розділ пояснює як моделювати кілька безпілотних ЛА використовуючи <a href="./../sim_gazebo_classic/README.html">Gazebo Classic</a> та SITL (тільки для Linux). Різний підхід використовуються для симуляції з та без ROS.</p><h2 id="кілька-рухомих-засобів-з-gazebo-classic" tabindex="-1">Кілька рухомих засобів з Gazebo Classic <a class="header-anchor" href="#кілька-рухомих-засобів-з-gazebo-classic" aria-label="Permalink to &quot;Кілька рухомих засобів з Gazebo Classic&quot;">​</a></h2><p>Щоб змоделювати кілька засобів типу iris або літаків в Gazebo Classic використовуйте наступні команди в терміналі (з кореня дерева вихідного коду <em>Прошивки</em>):</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Tools/simulation/gazebo-classic/sitl_multiple_run.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">number_of_vehicle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">worl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-s </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">scrip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">targe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">labe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span></span></code></pre></div><ul><li><p><code>&lt;model&gt;</code>: <a href="./../sim_gazebo_classic/vehicles.html">Тип/модель засобу</a> для відтворення, наприклад: <code>iris</code> (за замовчуванням), <code>plane</code>, <code>standard_vtol</code>, <code>rover</code>, <code>r1_rover</code> <code>typhoon_h480</code>.</p></li><li><p><code>&lt;number_of_vehicles&gt;</code>: Кількість рухомих засобів для відтворення. Значення за замовчуванням - 3. Максимум - 254.</p></li><li><p><code>&lt;world&gt;</code>: <a href="./../sim_gazebo_classic/worlds.html">Світ</a> в якому потрібно відтворити засоби, наприклад: <code>empty</code> (за замовчуванням)</p></li><li><p><code>&lt;script&gt;</code>: Відтворити кілька засобів різних типів (замінюючи значення в <code>-m</code> та <code>-n</code>). Наприклад:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;iris:3,plane:2,standard_vtol:3&quot;</span></span></code></pre></div><ul><li>Типи засобів що підтримуються: <code>iris</code>, <code>plane</code>, <code>standard_vtol</code>, <code>rover</code>, <code>r1_rover</code> <code>typhoon_h480</code>.</li><li>Число після двокрапки вказує на кількість рухомих засобів (цього типу) для відтворення.</li><li>Максимальна кількість засобів - 254.</li></ul></li><li><p><code>&lt;target&gt;</code>: ціль збірки, наприклад: <code>px4_sitl_default</code> (за замовчуванням), <code>px4_sitl_nolockstep</code></p></li><li><p><code>&lt;label&gt;</code> : певна мітка для моделі, наприклад: <code>rplidar</code></p></li></ul><p>Кожному екземпляру рухомого засобу виділяється унікальний системний ідентифікатор MAVLink (2, 3, 4 тощо). MAVLink system id 1 is skipped in order to have consistency among <a href="./../ros2/multi_vehicle.html#principle-of-operation">namespaces</a>. Екземпляри засобів доступні з послідовно виділених віддалених UDP портів PX4: <code>14541</code> - <code>14548</code> (усі додаткові екземпляри доступні по тому ж самому UDP порту <code>14549</code>).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Обмеження на 254 засоби з&#39;явилось тому що системний ідентифікатор mavlink <code>MAV_SYS_ID</code> підтримує тільки 255 засобів в одній мережі (а перша мережа пропускається). <code>MAV_SYS_ID</code> виділяється у SITL rcS: <a href="https://github.com/PX4/PX4-Autopilot/blob/release/1.15/ROMFS/px4fmu_common/init.d-posix/rcS#L131" target="_blank" rel="noreferrer">init.d-posix/rcS</a></p></div><h3 id="відео-кілька-мультикоптерів-iris" tabindex="-1">Відео: кілька мультикоптерів (Iris) <a class="header-anchor" href="#відео-кілька-мультикоптерів-iris" aria-label="Permalink to &quot;Відео: кілька мультикоптерів (Iris)&quot;">​</a></h3>',9),p=s("p",null,[s("div",{class:"embed-responsive embed-responsive-16by9"},[s("iframe",{class:"embed-responsive-item youtube-player",type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/Mskx_WxzeCk",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""})])],-1),k=s("h3",{id:"відео-кілька-літаків",tabindex:"-1"},[a("Відео: кілька літаків "),s("a",{class:"header-anchor",href:"#відео-кілька-літаків","aria-label":'Permalink to "Відео: кілька літаків"'},"​")],-1),o=s("p",null,[s("div",{class:"embed-responsive embed-responsive-16by9"},[s("iframe",{class:"embed-responsive-item youtube-player",type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/aEzFKPMEfjc",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""})])],-1),d=s("h3",{id:"відео-кілька-взіп",tabindex:"-1"},[a("Відео: кілька ВЗІП "),s("a",{class:"header-anchor",href:"#відео-кілька-взіп","aria-label":'Permalink to "Відео: кілька ВЗІП"'},"​")],-1),r=s("p",null,[s("div",{class:"embed-responsive embed-responsive-16by9"},[s("iframe",{class:"embed-responsive-item youtube-player",type:"text/html",width:"640",height:"390",src:"https://www.youtube.com/embed/lAjjTFFZebI",frameborder:"0",webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""})])],-1),c=i(`<h3 id="збірка-та-тестування-xrce-dds" tabindex="-1">Збірка та тестування (XRCE-DDS) <a class="header-anchor" href="#збірка-та-тестування-xrce-dds" aria-label="Permalink to &quot;Збірка та тестування (XRCE-DDS)&quot;">​</a></h3><p><code>Tools/simulation/gazebo-classic/sitl_multiple_run.sh</code> може бути використано для симуляції кількох засобів, з&#39;єднаних за допомогою XRCE-DDS в Gazebo Classic.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Потрібно буде встановити залежності XRCE-DDS. For more information see: <a href="./../ros2/user_guide.html">ROS 2 User Guide (PX4-ROS 2 Bridge)</a>, for interfacing with ROS 2 nodes.</p></div><p>Для збірки прикладу установки дотримуйтесь наступних кроків:</p><ol><li><p>Клонуйте код PX4/Прошивки і зберіть код SITL:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Firmware_clone</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submodule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recursive</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DONT_RUN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gazebo-classic</span></span></code></pre></div></li><li><p>Build the <code>micro xrce-dds agent</code> and the interface package following the <a href="./../ros2/user_guide.html">instructions here</a>.</p></li><li><p>Запустіть <code>Tools/simulation/gazebo-classic/sitl_multiple_run.sh</code>. Наприклад, для відтворення 4 рухомих засобів виконайте:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/simulation/gazebo-classic/sitl_multiple_run.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iris</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p></div></li></ol><p>Кожному екземпляру рухомого засобу виділяється унікальний системний ідентифікатор MAVLink (2, 3, 4 тощо). Системний ідентифікатор MAVLink 1 пропускається. :::</p><ol><li><p>Запустіть <code>MicroXRCEAgent</code>. Він автоматично під&#39;єднається до усіх чотирьох рухомих засобів:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MicroXRCEAgent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> udp4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8888</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">The simulator startup script automatically assigns a <a href="./../ros2/multi_vehicle.html">unique namespace</a> to each vehicle.</p></div></li></ol><p>:::</p><h2 id="кілька-рухомих-засобів-з-mavros-та-gazebo-classic" tabindex="-1">Кілька рухомих засобів з MAVROS та Gazebo Classic <a class="header-anchor" href="#кілька-рухомих-засобів-з-mavros-та-gazebo-classic" aria-label="Permalink to &quot;Кілька рухомих засобів з MAVROS та Gazebo Classic&quot;">​</a></h2><p>Цей приклад демонструє установку, яка відкриває клієнтський графічний інтерфейс Gazebo Classic, показуючи два засоби типу Iris у порожньому світі. Можна керувати засобами за допомогою <em>QGroundControl</em> та MAVROS подібним способом до того як керувати одним засобом.</p><h3 id="вимоги" tabindex="-1">Вимоги <a class="header-anchor" href="#вимоги" aria-label="Permalink to &quot;Вимоги&quot;">​</a></h3><ul><li>Current <a href="./../ros/mavros_installation.html">PX4 ROS/Gazebo development environment</a> (which includes the <a href="http://wiki.ros.org/mavros" target="_blank" rel="noreferrer">MAVROS package</a>).</li><li>Клонований вихідний код <a href="https://github.com/PX4/PX4-Autopilot" target="_blank" rel="noreferrer">PX4/PX4-Autopilot</a></li></ul><h3 id="збірка-та-тестування" tabindex="-1">Збірка та тестування <a class="header-anchor" href="#збірка-та-тестування" aria-label="Permalink to &quot;Збірка та тестування&quot;">​</a></h3><p>Для збірки прикладу установки дотримуйтесь наступних кроків:</p><ol><li><p>Клонуйте код PX4/PX4-Autopilot і зберіть код SITL</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Firmware_clone</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submodule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recursive</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DONT_RUN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_sitl_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gazebo-classic</span></span></code></pre></div></li><li><p>Виконайте команду source у вашому середовищі:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Tools/simulation/gazebo-classic/setup_gazebo.bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)/build/px4_sitl_default</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ROS_PACKAGE_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ROS_PACKAGE_PATH:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/Tools/simulation/gazebo-classic/sitl_gazebo</span></span></code></pre></div></li><li><p>Виконайте файл запуску:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">roslaunch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi_uav_mavros_sitl.launch</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Можна вказати <code>gui:=false</code> в команді <em>roslaunch</em> вище для запуску Gazebo Classic без інтерфейсу.</p></div></li></ol><p>:::</p><p>Навчальний приклад відкриває клієнтський графічний інтерфейс Gazebo Classic, показуючи два засоби типу Iris у порожньому світі.</p><p>Можна керувати засобами за допомогою <em>QGroundControl</em> та MAVROS подібним способом до того як керувати одним засобом:</p><ul><li><em>QGroundControl</em> матиме список, що випадає для вибору засобу, який буде &quot;у фокусі&quot;</li><li>MAVROS потребує включити правильний простір імен перед рубрікою/шляхом до сервісу (наприклад для <code>&lt;group ns=&quot;uav1&quot;&gt;</code> потрібно використати <em>/uav1/mavros/mission/push</em>).</li></ul><h3 id="що-відбувається" tabindex="-1">Що відбувається? <a class="header-anchor" href="#що-відбувається" aria-label="Permalink to &quot;Що відбувається?&quot;">​</a></h3><p>Для кожного змодельованого засобу необхідно наступне:</p><ul><li><p><strong>Модель Gazebo Classic</strong>: визначена як файл <code>xacro</code> у <code>PX4-Autopilot/Tools/simulation/gazebo-classic/sitl_gazebo-classic/models/rotors_description/urdf/&lt;model&gt;_base.xacro</code> дивіться <a href="https://github.com/PX4/PX4-SITL_gazebo-classic/tree/02060a86652b736ca7dd945a524a8bf84eaf5a05/models/rotors_description/urdf" target="_blank" rel="noreferrer">тут</a>. На цей момент, <code>xacro</code> файл моделі передбачається завершувати з <strong>base.xacro</strong>. Ця модель повинна мати аргумент під назвою <code>mavlink_udp_port</code> який визначає UDP-порт, на якому Gazebo Classic буде спілкуватися з вузлом PX4. <code>xacro</code> файл моделі буде використаний для генерації <code>urdf</code> моделі, яка містить UDP-порт, який ви обрали. Для визначення порту UDP, вкажіть <code>mavlink_udp_port</code> у файлі запуску для кожного рухомого засобу, як приклад дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/launch/multi_uav_mavros_sitl.launch#L37" target="_blank" rel="noreferrer">тут</a>.</p><div class="info custom-block"><p class="custom-block-title">Якщо ви використовуєте одну і ту саму модель засобу, не потрібно відокремлювати <strong><code>xacro</code></strong> файл для кожного засобу. Той самий <strong><code>xacro</code></strong> файл підходить.</p></div></li></ul><p>:::</p><ul><li><p><strong>Вузол PX4</strong>: це застосунок SITL PX4. Він спілкується з симулятором Gazebo Classic через той самий UDP порт, що визначено в моделі засобу Gazebo Classic, тобто у <code>mavlink_udp_port</code>. Для налаштування UDP порту на стороні застосунку PX4 SITL, потрібно встановити параметр <code>SITL_UDP_PRT</code> у файлі запуску який збігається з <code>mavlink_udp_port</code>, що обговорювався раніше, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/posix-configs/SITL/init/ekf2/iris_2#L46" target="_blank" rel="noreferrer">тут</a>. Шлях стартового файлу у файлі запуску генерується на основі аргументів <code>vehicle</code> та <code>ID</code>, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/launch/multi_uav_mavros_sitl.launch#L36" target="_blank" rel="noreferrer">тут</a>. <code>MAV_SYS_ID</code> для кожного засобу в стартовому файлі, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/posix-configs/SITL/init/ekf2/iris_2#L4" target="_blank" rel="noreferrer">тут</a>, повинен збігатися з <code>ID</code> для цього засобу у файлі запуску <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/launch/multi_uav_mavros_sitl.launch#L25" target="_blank" rel="noreferrer">тут</a>. Це допоможе переконатися, що ви тримаєте налаштування узгоджено між файлом запуску та стартовим файлом.</p></li><li><p><strong>Вузол MAVROS</strong> (не обов&#39;язково): окремий вузол MAVROS може бути запущено у файлі запуску, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/launch/multi_uav_mavros_sitl.launch#L41" target="_blank" rel="noreferrer">тут</a>, для того щоб під&#39;єднатися до застосунку PX4 SITL, якщо ви бажаєте керувати своїм засобом через ROS. Ви повинні запустити потік MAVLink на індивідуальному наборі портів у стартовому файлі, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/posix-configs/SITL/init/ekf2/iris_1#L68" target="_blank" rel="noreferrer">тут</a>. Цей набір портів повинен збігатися з тими, що у файлі запуску для вузла MAVROS, дивіться <a href="https://github.com/PX4/PX4-Autopilot/blob/4d0964385b84dc91189f377aafb039d10850e5d6/launch/multi_uav_mavros_sitl.launch#L26" target="_blank" rel="noreferrer">тут</a>.</p></li></ul><p>Файл запуску <code>multi_uav_mavros_sitl.launch</code>робить наступне,</p><ul><li><p>завантажує світ у Gazebo Classic,</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- Gazebo sim --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gui&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg gui)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;world_name&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg world)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;debug&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg debug)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;verbose&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg verbose)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;paused&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg paused)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><p>для кожного рухомого засобу,</p><ul><li><p>створює модель urdf із xacro, завантажує модель gazebo classic і запускає екземпляр застосунку PX4 SITL</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- PX4 SITL and vehicle spawn --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(find px4)/launch/single_vehicle_spawn.launch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;y&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;z&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;R&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;P&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Y&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vehicle&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg vehicle)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rcS&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(find px4)/posix-configs/SITL/init/$(arg est)/$(arg vehicle)_$(arg ID)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mavlink_tcp_port&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4560&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ID&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg ID)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><p>запускає вузол Mavros</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- MAVROS --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(find mavros)/launch/px4.launch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fcu_url&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg fcu_url)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gcs_url&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tgt_system&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$(arg ID)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arg</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tgt_component&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li></ul><div class="info custom-block"><p class="custom-block-title">Повний блок налаштувань для кожного засобу обернений в набір тегів <code>&lt;group&gt;</code> для відокремлення простору імен ROS для рухомих засобів.</p></div></li></ul><p>:::</p><p>Щоб додати третій засіб типу iris до цієї симуляції потрібно врахувати два основні компоненти:</p><ul><li><p>додати <code>UAV3</code> до <strong>multi_uav_mavros_sitl.launch</strong></p><ul><li>скопіювати групу наявного засобу (<code>UAV1</code> або <code>UAV2</code>)</li><li>збільшити аргумент <code>ID</code> до <code>3</code></li><li>обрати інший порт для аргументу <code>mavlink_udp_port</code> для спілкування з Gazebo Classic</li><li>обрати порти для спілкування з MAVROS шляхом модифікації обох номерів портів в аргументі <code>fcu_url</code></li></ul></li><li><p>створити стартовий файл і змінити файл наступним чином:</p><ul><li><p>створити копію наявного стартового файлу rcS для iris (<code>iris_1</code> або <code>iris_2</code>) та перейменувати його <code>iris_3</code></p></li><li><p>встановити значення <code>MAV_SYS_ID</code> у <code>3</code></p></li><li><p>значення <code>SITL_UDP_PRT</code> узгодити з аргументом <code>mavlink_udp_port</code> у файлі запуску</p></li><li><p>перші значення порту <code>mavlink start</code> та порту <code>mavlink stream</code> встановити в такі ж значення, що використовуються для спілкування з QGC</p></li><li><p>другі порти <code>mavlink start</code> потрібно узгодити з тими, що використовуються в аргументі <code>fcu_url</code> файлу запуску</p><div class="info custom-block"><p class="custom-block-title">Будьте уважні який порт <code>src</code> і <code>dst</code> для різних кінцевих точок.</p></div></li></ul></li></ul><p>:::</p><h2 id="кілька-рухомих-засобів-з-використанням-моделеи-sdf" tabindex="-1">Кілька рухомих засобів з використанням моделей SDF <a class="header-anchor" href="#кілька-рухомих-засобів-з-використанням-моделеи-sdf" aria-label="Permalink to &quot;Кілька рухомих засобів з використанням моделей SDF&quot;">​</a></h2><p>Цей розділ показує, як розробнику симулювати декілька засобів за допомогою моделей рухомих засобів, визначених у SDF файлах Gazebo Classic (замість використання моделей, визначених у ROS Xacro файлах, як обговорювалося у решті цієї теми).</p><p>Кроки наступні:</p><ol><li><p>Встановіть <em>xmlstarlet</em> з термінала Linux:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmlstarlet</span></span></code></pre></div></li><li><p>Використовуйте <em>roslaunch</em> з файлом <strong>multi_uav_mavros_sitl_sdf.launch</strong>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">roslaunch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi_uav_mavros_sitl_sdf.launch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vehicle:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">model_file_nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\`\`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:::</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Note</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> that the vehicle model file name argument is optional (\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vehicle:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=&lt;model_file_name&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`); if omitted the [plane model](https://github.com/PX4/PX4-SITL_gazebo-classic/tree/master/models/plane) will be used by default.</span></span></code></pre></div></li></ol><p>:::</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Цей метод подібний до використання xacro моделі за винятком того, що номери портів SITL/Gazebo Classic автоматично додаються _xmstarlet_ для кожного відтвореного засобу і його не потрібно вказувати у SDF файлі.</span></span>
<span class="line"><span>Щоб додати новий рухомий засіб, вам потрібно переконатися, що модель можна знайти (для відтворення у Gazebo Classic) та PX4 повинен мати відповідний скрипт запуску.</span></span>
<span class="line"><span>1. Можна обрати зробити щось одне з:</span></span>
<span class="line"><span>- змінити **single_vehicle_spawn_sdf.launch**, щоб він вказував на розташування моделі, змінивши рядок нижче та вказавши на вашу модель:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  \`\`\`sh</span></span>
<span class="line"><span>  $(find px4)/Tools/simulation/gazebo/sitl_gazebo-classic/models/$(arg vehicle)/$(arg vehicle).sdf</span></span>
<span class="line"><span>  \`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  :::info Переконайтесь, що вказали аргумент \`vehicle\` навіть якщо ви явно закодували шлях до вашої моделі.</span></span>
<span class="line"><span>:::</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- скопіювати свою модель в директорію, позначену вище (дотримуючись тих же правил шляху).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1. Аргумент \`vehicle\` використовується для встановлення змінної середовища \`PX4_SIM_MODEL\`, яка використовується rcS (стартовим скриптом) за замовчуванням щоб знайти відповідний файл налаштувань для моделі. У PX4 ці стартові файли можна знайти у директорії **PX4-Autopilot/ROMFS/px4fmu_common/init.d-posix/**. Для прикладу ось [стартовий скрипт](https://github.com/PX4/PX4-Autopilot/blob/release/1.15/ROMFS/px4fmu_common/init.d-posix/airframes/1030_gazebo-classic_plane) моделі літака. Для того, щоб це працювало, вузлу PX4 у файлі запуску передаються аргументи що визначають файл _rcS_ (**etc/init.d/rcS**) та розташування etc директорії (\`$(find px4)/build_px4_sitl_default/etc\`) у корені файлової системи. Для спрощення пропонується, що початковий файл для моделі розміщується поруч з PX4 в **PX4-Autopilot/ROMFS/px4fmu_common/init.d-posix/**.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>## Додаткові ресурси</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- Дивіться [Симуляція](../simulation/README.md) для опису налаштувань UDP порту.</span></span>
<span class="line"><span>- Дивіться [URDF у Gazebo](http://wiki.ros.org/urdf/Tutorials/Using%20a%20URDF%20in%20Gazebo) для додаткової інформації про відтворення моделі з xacro.</span></span>
<span class="line"><span>- Дивіться [RotorS](https://github.com/ethz-asl/rotors_simulator/tree/master/rotors_description/urdf) для додаткових моделей xacro.</span></span></code></pre></div>`,36),g=[h,p,k,o,d,r,c];function E(u,F,y,m,b,C){return e(),t("div",null,g)}const B=l(n,[["render",E]]);export{v as __pageData,B as default};
