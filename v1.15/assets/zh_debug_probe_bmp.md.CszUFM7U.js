import{_ as e,c as a,o as s,ab as i}from"./chunks/framework.CUflZczI.js";const g=JSON.parse('{"title":"Black Magic Probe (and Dronecode Probe)","description":"","frontmatter":{},"headers":[],"relativePath":"zh/debug/probe_bmp.md","filePath":"zh/debug/probe_bmp.md"}'),t={name:"zh/debug/probe_bmp.md"},o=i(`<h1 id="black-magic-probe-and-dronecode-probe" tabindex="-1">Black Magic Probe (and Dronecode Probe) <a class="header-anchor" href="#black-magic-probe-and-dronecode-probe" aria-label="Permalink to &quot;Black Magic Probe (and Dronecode Probe)&quot;">​</a></h1><p>The <a href="https://black-magic.org" target="_blank" rel="noreferrer">Black Magic Probe</a> is an easy to use, mostly plug-and-play, JTAG/SWD debugger for embedded microcontrollers. Since the Black Magic Probe is a generic debug probe, you will need an adapter to connect to Pixhawk flight controllers, which can be purchased here:</p><ul><li><a href="https://1bitsquared.com/products/drone-code-debug-adapter" target="_blank" rel="noreferrer">Drone Code Debug Adapter</a> (1 BIT SQUARED).</li></ul><h2 id="dronecode-probe" tabindex="-1">Dronecode Probe <a class="header-anchor" href="#dronecode-probe" aria-label="Permalink to &quot;Dronecode Probe&quot;">​</a></h2><p>The <a href="https://kb.zubax.com/display/MAINKB/Dronecode+Probe+documentation" target="_blank" rel="noreferrer">Dronecode Probe</a> is a specialization of the Black Magic Probe for debugging PX4 autopilots.</p><p>The probe&#39;s USB interface exposes two separate virtual serial port interfaces: one for connecting to the <a href="./system_console.html">System Console</a> (UART) and the other for an embedded GDB server (SWD interface).</p><p>The probe provides a DCD-M connector cable for attaching to the <a href="./swd_debug.html#pixhawk-debug-mini">Pixhawk Debug Mini</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The <em>6-pos DF13</em> connector that comes with the probe cannot be used for SWD debugging (it is for using the System Console).</p></div><h2 id="using-the-probe" tabindex="-1">Using the Probe <a class="header-anchor" href="#using-the-probe" aria-label="Permalink to &quot;Using the Probe&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>To debug STM32F7 or later (FMUv5 and newer) the Dronecode probe / Blackmagic probe likely requires a firmware update. You can find how to update the <a href="https://github.com/blacksphere/blackmagic/wiki/Upgrading-Firmware" target="_blank" rel="noreferrer">blackmagic probe here</a>.</p></div><p>To use a Dronecode probe with GDB, start GDB with the exact ELF file that is currently flashed on the autopilot:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arm-none-eabi-gdb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/px4_fmu-v5_default/px4_fmu-v5_default.elf</span></span></code></pre></div><p>Then, you have to select the Dronecode probe interface, on Linux this is e.g.:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ext</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/serial/by-id/usb-Black_Sphere_Technologies_Black_Magic_Probe_f9414d5_7DB85DAC-if00</span></span></code></pre></div><p>Then you scan for the target:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">monitor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> swdp_scan</span></span></code></pre></div><p>And you should see something like:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> voltage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3.3V</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Targets:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Att</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Driver</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      STM32F76x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M7</span></span></code></pre></div><p>Note that for some autopilots it shows 0.0V but the subsequent steps work nevertheless.</p><p>You can now attach to that target:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">attach</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span></code></pre></div><p>And now you should be connected.</p>`,22),n=[o];function r(h,p,l,c,d,b){return s(),a("div",null,n)}const u=e(t,[["render",r]]);export{g as __pageData,u as default};
