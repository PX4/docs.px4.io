import{_ as s,c as i,o as a,ab as e}from"./chunks/framework.CUflZczI.js";const u=JSON.parse('{"title":"PilotPi with Ubuntu Server","description":"","frontmatter":{},"headers":[],"relativePath":"uk/flight_controller/raspberry_pi_pilotpi_ubuntu_server.md","filePath":"uk/flight_controller/raspberry_pi_pilotpi_ubuntu_server.md"}'),t={name:"uk/flight_controller/raspberry_pi_pilotpi_ubuntu_server.md"},l=e(`<h1 id="pilotpi-with-ubuntu-server" tabindex="-1">PilotPi with Ubuntu Server <a class="header-anchor" href="#pilotpi-with-ubuntu-server" aria-label="Permalink to &quot;PilotPi with Ubuntu Server&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Ubuntu Server на RPi 4B споживає багато струму і генерує багато тепла. Розробляйте дизайн для кращого відведення тепла та високого енергоспоживання при використанні цього обладнання. :::</p><h2 id="швидкии-старт-для-розробника" tabindex="-1">Швидкий старт для розробника <a class="header-anchor" href="#швидкии-старт-для-розробника" aria-label="Permalink to &quot;Швидкий старт для розробника&quot;">​</a></h2><h3 id="os-image" tabindex="-1">OS Image <a class="header-anchor" href="#os-image" aria-label="Permalink to &quot;OS Image&quot;">​</a></h3><p>Підтримуються і armhf і arm64.</p><h4 id="armhf" tabindex="-1">armhf <a class="header-anchor" href="#armhf" aria-label="Permalink to &quot;armhf&quot;">​</a></h4><ul><li><a href="https://cdimage.ubuntu.com/releases/18.04.5/release/ubuntu-18.04.5-preinstalled-server-armhf+raspi2.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 18.04.5 для RPi2</a></li><li><a href="https://cdimage.ubuntu.com/releases/18.04.5/release/ubuntu-18.04.5-preinstalled-server-armhf+raspi3.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 18.04.5 для RPi3</a></li><li><a href="https://cdimage.ubuntu.com/releases/18.04.5/release/ubuntu-18.04.5-preinstalled-server-armhf+raspi4.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 18.04.5 для RPi4</a></li><li><a href="https://cdimage.ubuntu.com/releases/20.04.1/release/ubuntu-20.04.2-preinstalled-server-arm64+raspi.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 20.04.1 для RPi 2/3/4</a></li></ul><h4 id="arm64" tabindex="-1">arm64 <a class="header-anchor" href="#arm64" aria-label="Permalink to &quot;arm64&quot;">​</a></h4><ul><li><a href="https://cdimage.ubuntu.com/releases/18.04.5/release/ubuntu-18.04.5-preinstalled-server-arm64+raspi3.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 18.04.5 для RPi3</a></li><li><a href="https://cdimage.ubuntu.com/releases/18.04.5/release/ubuntu-18.04.5-preinstalled-server-arm64+raspi4.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 18.04.5 для RPi4</a></li><li><a href="https://cdimage.ubuntu.com/releases/20.04.1/release/ubuntu-20.04.2-preinstalled-server-arm64+raspi.img.xz" target="_blank" rel="noreferrer">Ubuntu Server 20.04.1 для RPi 3/4</a></li></ul><h4 id="наиновіша-ос" tabindex="-1">Найновіша ОС <a class="header-anchor" href="#наиновіша-ос" aria-label="Permalink to &quot;Найновіша ОС&quot;">​</a></h4><p>Будь ласка, звертайтеся до офіційної сторінки <a href="https://cdimage.ubuntu.com/releases/" target="_blank" rel="noreferrer">cdimage</a> для отримання будь-яких нових оновлень.</p><h3 id="першии-запуск" tabindex="-1">Перший запуск <a class="header-anchor" href="#першии-запуск" aria-label="Permalink to &quot;Перший запуск&quot;">​</a></h3><p>Під час налаштування Wi-Fi для RaPi вперше ми рекомендуємо використовувати провідне підключення Ethernet між домашнім маршрутизатором та RPi, а також монітор та клавіатуру.</p><h4 id="перед-завантаженням" tabindex="-1">Перед завантаженням <a class="header-anchor" href="#перед-завантаженням" aria-label="Permalink to &quot;Перед завантаженням&quot;">​</a></h4><p>Встановіть SD-карту на ваш комп&#39;ютер та змініть налаштування мережі. Будь ласка, дотримуйтесь офіційної інструкції <a href="https://ubuntu.com/tutorials/how-to-install-ubuntu-on-your-raspberry-pi#3-wifi-or-ethernet" target="_blank" rel="noreferrer">тут</a>.</p><p>Тепер під&#39;єднайте SD-карту до вашого Pi та завантажтеся вперше. Переконайтеся, що у вас є доступ до RPi через командний рядок - або через з&#39;єднання SSH по кабелю Ethernet, або безпосередній доступ за допомогою клавіатури та монітора.</p><h4 id="wifi-регіон" tabindex="-1">WiFi регіон <a class="header-anchor" href="#wifi-регіон" aria-label="Permalink to &quot;WiFi регіон&quot;">​</a></h4><p>Спочатку встановіть необхідний пакет:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> crda</span></span></code></pre></div><p>Відредагуйте файл <code>/etc/default/crda</code>, щоб встановити правильний WiFi регіон. <a href="https://www.arubanetworks.com/techdocs/InstantWenger_Mobile/Advanced/Content/Instant%20User%20Guide%20-%20volumes/Country_Codes_List.htm" target="_blank" rel="noreferrer">Reference List</a></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/default/crda</span></span></code></pre></div><p>Потім ваш Pi зможе приєднатися до вашої мережі WiFi після перезавантаження.</p><h4 id="hostname-та-mdns" tabindex="-1">Hostname та mDNS <a class="header-anchor" href="#hostname-та-mdns" aria-label="Permalink to &quot;Hostname та mDNS&quot;">​</a></h4><p>Давайте спочатку налаштуємо ім&#39;я хоста.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hostname</span></span></code></pre></div><p>Змініть значення hostname на те, що вам подобається. Потім встановіть пакет, необхідний для mDNS:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avahi-daemon</span></span></code></pre></div><p>Виконайте перезавантаження.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><p>Відновіть доступність через підключення WiFi після вищезазначеної операції.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu@pi_hostname.local</span></span></code></pre></div><h4 id="автентифікація-без-пароля-необов-язково" tabindex="-1">Автентифікація без пароля (необов&#39;язково) <a class="header-anchor" href="#автентифікація-без-пароля-необов-язково" aria-label="Permalink to &quot;Автентифікація без пароля (необов&#39;язково)&quot;">​</a></h4><p>Ви також можете налаштувати <a href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md" target="_blank" rel="noreferrer">безпарольну автентифікацію</a>.</p><h3 id="налаштування-ос" tabindex="-1">Налаштування ОС <a class="header-anchor" href="#налаштування-ос" aria-label="Permalink to &quot;Налаштування ОС&quot;">​</a></h3><h4 id="config-txt" tabindex="-1">config.txt <a class="header-anchor" href="#config-txt" aria-label="Permalink to &quot;config.txt&quot;">​</a></h4><p>Відповідний файл в Ubuntu - <code>/boot/firmware/usercfg.txt</code>.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/firmware/usercfg.txt</span></span></code></pre></div><p>Замініть контент файлу на:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># enable sc16is752 overlay</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtoverlay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sc16is752-spi1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># enable I2C-1 and set the frequency to 400KHz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtparam</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">i2c_arm=on,i2c_arm_baudrate=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400000</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># enable spidev0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtparam</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">spi=on</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># enable RC input</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enable_uart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># enable I2C-0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtparam</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">i2c_vc=on</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># switch Bluetooth to miniuart</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtoverlay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">miniuart-bt</span></span></code></pre></div><h4 id="cmdline-txt" tabindex="-1">cmdline.txt <a class="header-anchor" href="#cmdline-txt" aria-label="Permalink to &quot;cmdline.txt&quot;">​</a></h4><p>В Ubuntu Server 20.04:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/firmware/cmdline.txt</span></span></code></pre></div><p>Для Ubuntu Server 18.04 або ранішої версії, слід змінити <code>nobtcmd.txt</code> та <code>btcmd.txt</code>.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/firmware/nobtcmd.txt</span></span></code></pre></div><p>Знайдіть <code>console=/dev/ttyAMA0,115200</code> та видаліть цю частину, щоб вимкнути командний рядок логіну на послідовному інтерфейсі.</p><p>Додайте <code>isolcpus=2</code> після останнього слова. Весь файл буде виглядати так:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">net.ifnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=0 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dwc_otg.lpm_enable=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> console=tty1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root=LABEL=writable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rootfstype=ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> elevator=deadline</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rootwait</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fixrtc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isolcpus=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span></code></pre></div><p>Вищезазначений рядок вказує ядру Linux не планувати жодного процесу на ядрі CPU 2. Ми пізніше вручну запустимо PX4 на цьому ядрі.</p><p>Перезавантажте та увійдіть за допомогою SSH на ваш Pi.</p><p>Перевірте інтерфейс UART:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/tty</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>Має бути <code>/dev/ttyAMA0</code>, <code>/dev/ttySC0</code> та <code>/dev/ttySC1</code>.</p><p>Перевірте інтерфейс I2C:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/i2c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>Повинно бути <code>/dev/i2c-0</code> та <code>/dev/i2c-1</code></p><p>Перевірте інтерфейс SPI:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/spidev</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>Має бути <code>/dev/spidev0.0</code>.</p><h4 id="rc-local" tabindex="-1">rc.local <a class="header-anchor" href="#rc-local" aria-label="Permalink to &quot;rc.local&quot;">​</a></h4><p>У цьому розділі ми налаштуємо скрипт автозапуску в <strong>rc.local</strong>. Зверніть увагу, що нам потрібно створити цей файл, оскільки він відсутній у свіжій операційній системі Ubuntu.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/rc.local</span></span></code></pre></div><p>Додати вміст нижче до файлу:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;25&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/class/gpio/export</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;in&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/class/gpio/gpio25/direction</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/class/gpio/gpio25/value)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -eq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ] ; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Launching PX4&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/ubuntu/px4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> taskset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./bin/px4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pilotpi_mc.config</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /home/ubuntu/px4/px4.log &amp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;25&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/class/gpio/unexport</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div><p>Збережіть та вийдіть. Потім встановіть правильні права:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/rc.local</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Не забудьте вимкнути перемикач, коли він не потрібен!</p></div><h4 id="csi-камера" tabindex="-1">CSI камера <a class="header-anchor" href="#csi-камера" aria-label="Permalink to &quot;CSI камера&quot;">​</a></h4><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Увімкнення камери CSI призведе до зупинки роботи будь-чого на I2C-0.</p></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/firmware/usercfg.txt</span></span></code></pre></div><p>Додайте наступний рядок в кінці файлу:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start_x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></div><h3 id="збірка-коду" tabindex="-1">Збірка коду <a class="header-anchor" href="#збірка-коду" aria-label="Permalink to &quot;Збірка коду&quot;">​</a></h3><p>Для завантаження <em>найостаннішої</em> версії на свій комп&#39;ютер, введіть у терміналі наступну команду:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/PX4/PX4-Autopilot.git</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recursive</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Це все, що вам необхідно для збірки найновішого коду.</p></div><h4 id="встановити-точку-призначення-завантаження-rpi" tabindex="-1">Встановити точку призначення завантаження RPi <a class="header-anchor" href="#встановити-точку-призначення-завантаження-rpi" aria-label="Permalink to &quot;Встановити точку призначення завантаження RPi&quot;">​</a></h4><p>Встановіть IP-адресу (або ім&#39;я хоста) вашого RPi за допомогою:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTOPILOT_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">192.168.X.X</span></span></code></pre></div><p>або</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTOPILOT_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pi_hostname.local</span></span></code></pre></div><p>Додатково, нам потрібно встановити ім&#39;я користувача:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTOPILOT_USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span></span></code></pre></div><h4 id="збірка-для-архітектури-armhf" tabindex="-1">Збірка для архітектури armhf <a class="header-anchor" href="#збірка-для-архітектури-armhf" aria-label="Permalink to &quot;Збірка для архітектури armhf&quot;">​</a></h4><p>Зберіть виконуваний файл:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Firmware</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scumaker_pilotpi_default</span></span></code></pre></div><p>Потім завантажте його за допомогою:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scumaker_pilotpi_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upload</span></span></code></pre></div><h4 id="альтернативнии-метод-збірки-для-armhf-з-використанням-docker" tabindex="-1">Альтернативний метод збірки для armhf (з використанням Docker) <a class="header-anchor" href="#альтернативнии-метод-збірки-для-armhf-з-використанням-docker" aria-label="Permalink to &quot;Альтернативний метод збірки для armhf (з використанням Docker)&quot;">​</a></h4><p>Якщо ви вперше компілюєте з докером, будь ласка, зверніться до <a href="./../test_and_ci/docker.html#prerequisites">офіційної документації</a>.</p><p>Виконайте команду в директорії firmware:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/docker_run.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;export AUTOPILOT_HOST=192.168.X.X; export AUTOPILOT_USER=ubuntu; export NO_NINJA_BUILD=1; make scumaker_pilotpi_default upload&quot;</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>mDNS не підтримується з Docker. Ви повинні вказати правильну IP-адресу кожного разу при завантаженні.</p></div><div class="info custom-block"><p class="custom-block-title">Якщо ваша IDE не підтримує збірку ninja, опція <code>NO_NINJA_BUILD=1</code> допоможе. Ви можете компілювати без завантаження також. Просто видаліть <code>upload</code>.</p></div><p>Також можливо просто скомпілювати код за допомогою команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/docker_run.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;make scumaker_pilotpi_default&quot;</span></span></code></pre></div><h4 id="збірка-для-архітектури-arm64" tabindex="-1">Збірка для архітектури arm64 <a class="header-anchor" href="#збірка-для-архітектури-arm64" aria-label="Permalink to &quot;Збірка для архітектури arm64&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">Цей крок потребує встановлення утиліти <code>aarch64-linux-gnu</code>.</p></div><p>Зберіть виконуваний файл:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PX4-Autopilot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scumaker_pilotpi_arm64</span></span></code></pre></div><p>Потім завантажте його за допомогою:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scumaker_pilotpi_arm64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upload</span></span></code></pre></div><h4 id="альтернативнии-метод-збірки-для-arm64-з-використанням-docker" tabindex="-1">Альтернативний метод збірки для arm64 (з використанням Docker) <a class="header-anchor" href="#альтернативнии-метод-збірки-для-arm64-з-використанням-docker" aria-label="Permalink to &quot;Альтернативний метод збірки для arm64 (з використанням Docker)&quot;">​</a></h4><p>Якщо ви вперше компілюєте з докером, будь ласка, зверніться до <a href="./../test_and_ci/docker.html#prerequisites">офіційної документації</a>.</p><p>Виконайте команду в директорії <code>PX4-Autopilot</code>:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/docker_run.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;export AUTOPILOT_HOST=192.168.X.X; export AUTOPILOT_USER=ubuntu; export NO_NINJA_BUILD=1; make scumaker_pilotpi_arm64 upload&quot;</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>mDNS не підтримується з Docker. Ви повинні вказати правильну IP-адресу кожного разу при завантаженні.</p></div><div class="info custom-block"><p class="custom-block-title">Якщо ваша IDE не підтримує збірку ninja, опція <code>NO_NINJA_BUILD=1</code> допоможе. Ви можете компілювати без завантаження - просто видаліть <code>upload</code>.</p></div><p>Також можливо просто скомпілювати код за допомогою команди:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./Tools/docker_run.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;make scumaker_pilotpi_arm64&quot;</span></span></code></pre></div><h4 id="ручнии-запуск-px4" tabindex="-1">Ручний запуск PX4 <a class="header-anchor" href="#ручнии-запуск-px4" aria-label="Permalink to &quot;Ручний запуск PX4&quot;">​</a></h4><p>Під&#39;єднайтесь через ssh та запустіть за допомогою:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> taskset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./bin/px4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pilotpi_mc.config</span></span></code></pre></div><p>Тепер PX4 запустився з конфігурацією мультиротора.</p><p>Якщо ви стикалися з аналогічною проблемою під час виконання <code>bin/px4</code> на вашому Pi, як показано нижче:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>bin/px4: /lib/xxxx/xxxx: version \`GLIBC_2.29&#39; not found (required by bin/px4)</span></span></code></pre></div><p>Тоді ви повинні скомпілювати з Docker.</p><p>Перш ніж перейти до наступного кроку, спочатку видаліть наявну збірку:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build/scumaker_pilotpi_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>Потім поверніться до відповідного розділу вище.</p><h3 id="post-налаштування" tabindex="-1">Post налаштування <a class="header-anchor" href="#post-налаштування" aria-label="Permalink to &quot;Post налаштування&quot;">​</a></h3><p>Будь ласка, зверніться до інструкцій <a href="./raspberry_pi_pilotpi_rpios.html">тут</a></p></div>`,2),p=[l];function h(n,r,k,o,d,c){return a(),i("div",null,p)}const F=s(t,[["render",h]]);export{u as __pageData,F as default};
