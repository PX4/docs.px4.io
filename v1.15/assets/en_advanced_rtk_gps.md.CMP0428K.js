import{_ as s,c as e,o as i,ab as a}from"./chunks/framework.CUflZczI.js";const u=JSON.parse('{"title":"RTK GNSS/GPS (PX4 Integration)","description":"","frontmatter":{},"headers":[],"relativePath":"en/advanced/rtk_gps.md","filePath":"en/advanced/rtk_gps.md"}'),t={name:"en/advanced/rtk_gps.md"},n=a(`<h1 id="rtk-gnss-gps-px4-integration" tabindex="-1">RTK GNSS/GPS (PX4 Integration) <a class="header-anchor" href="#rtk-gnss-gps-px4-integration" aria-label="Permalink to &quot;RTK GNSS/GPS (PX4 Integration)&quot;">​</a></h1><p><a href="https://en.wikipedia.org/wiki/Real_Time_Kinematic" target="_blank" rel="noreferrer">Real Time Kinematic</a> (RTK) provides centimeter-level GPS accuracy. This page explains how RTK is integrated into PX4.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Instructions for <em>using</em> RTK GNSS are provided in <a href="./../gps_compass/rtk_gps.html">Hardware &gt; RTK GPS</a>.</p></div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>RTK uses measurements of the phase of the signal&#39;s carrier wave, rather than the information content of the signal. It relies on a single reference station to provide real-time corrections, which can work with multiple mobile stations.</p><p>Two RTK GNSS modules and a datalink are required to setup RTK with PX4. The fixed-position ground-based GPS unit is called the <em>Base</em> and the in-air unit is called the <em>Rover</em>. The Base unit connects to <em>QGroundControl</em> (via USB) and uses the datalink to stream RTCM corrections to the vehicle (using the MAVLink <a href="https://mavlink.io/en/messages/common.html#GPS_RTCM_DATA" target="_blank" rel="noreferrer">GPS_RTCM_DATA</a> message). On the autopilot, the MAVLink packets are unpacked and sent to the Rover unit, where they are processed to get the RTK solution.</p><p>The datalink should typically be able to handle an uplink rate of 300 bytes per second (see the <a href="#uplink-datarate">Uplink Datarate</a> section below for more information).</p><h2 id="supported-rtk-gnss-modules" tabindex="-1">Supported RTK GNSS modules <a class="header-anchor" href="#supported-rtk-gnss-modules" aria-label="Permalink to &quot;Supported RTK GNSS modules&quot;">​</a></h2><p>The list of devices that we have tested can be found <a href="./../gps_compass/rtk_gps.html#supported-devices">in the user guide</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Most devices come with two variants, a base and a rover. Make sure to select the correct variant.</p></div><h2 id="automatic-configuration" tabindex="-1">Automatic Configuration <a class="header-anchor" href="#automatic-configuration" aria-label="Permalink to &quot;Automatic Configuration&quot;">​</a></h2><p>The PX4 GPS stack automatically sets up the GPS modules to send and receive the correct messages over the UART or USB, depending on where the module is connected (to <em>QGroundControl</em> or the autopilot).</p><p>As soon as the autopilot receives <code>GPS_RTCM_DATA</code> MAVLink messages, it automatically forwards the RTCM data to the attached GPS module over existing data channels (a dedicated channel for correction data is not required).</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The u-blox U-Center RTK module configuration tool is not needed/used!</p></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Both <em>QGroundControl</em> and the autopilot firmware share the same <a href="https://github.com/PX4/GpsDrivers" target="_blank" rel="noreferrer">PX4 GPS driver stack</a>. In practice, this means that support for new protocols and/or messages only need to be added to one place.</p></div><h3 id="rtcm-messages" tabindex="-1">RTCM messages <a class="header-anchor" href="#rtcm-messages" aria-label="Permalink to &quot;RTCM messages&quot;">​</a></h3><p>QGroundControl configures the RTK base station to output the following RTCM3.2 frames, each with 1 Hz, unless otherwise stated:</p><ul><li><strong>1005</strong> - Station coordinates XYZ for antenna reference point (Base position), 0.2 Hz.</li><li><strong>1077</strong> - Full GPS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution).</li><li><strong>1087</strong> - Full GLONASS pseudo-ranges, carrier phases, Doppler and signal strength (high resolution).</li><li><strong>1230</strong> - GLONASS code-phase biases.</li><li><strong>1097</strong> - Full Galileo pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)</li><li><strong>1127</strong> - Full BeiDou pseudo-ranges, carrier phases, Doppler and signal strength (high resolution)</li></ul><h2 id="uplink-datarate" tabindex="-1">Uplink datarate <a class="header-anchor" href="#uplink-datarate" aria-label="Permalink to &quot;Uplink datarate&quot;">​</a></h2><p>The raw RTCM messages from the base are packed into a MAVLink <code>GPS_RTCM_DATA</code> message and sent over the datalink. The maximum length of each MAVLink message is 182 bytes. Depending on the RTCM message, the MAVLink message is almost never completely filled.</p><p>The RTCM Base Position message (1005) is of length 22 bytes, while the others are all of variable length depending on the number of visible satellites and the number of signals from the satellite (only 1 for L1 units like M8P). Since at a given time, the <em>maximum</em> number of satellites visible from any single constellation is 12, under real-world conditions, theoretically an uplink rate of 300 B/s is sufficient.</p><p>If <em>MAVLink 1</em> is used, a 182-byte <code>GPS_RTCM_DATA</code> message is sent for every RTCM message, irrespective of its length. As a result the approximate uplink requirement is around 700+ bytes per second. This can lead to link saturation on low-bandwidth half-duplex telemetry modules (e.g. 3DR Telemetry Radios).</p><p>If <em>MAVLink 2</em> is used then any empty space in the <code>GPS_RTCM_DATA message</code> is removed. The resulting uplink requirement is about the same as the theoretical value (~300 bytes per second).</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>PX4 automatically switches to MAVLink 2 if the GCS and telemetry modules support it.</p></div><p>MAVLink 2 must be used on low-bandwidth links for good RTK performance. Care must be taken to make sure that the telemetry chain uses MAVLink 2 throughout. You can verify the protocol version by using the <code>mavlink status</code> command on the system console:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nsh&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">instance</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        GCS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> heartbeat:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  593486</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> us</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ago</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        mavlink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chan:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:           </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3DR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RADIO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rssi:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    219</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txbuf:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          94</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          61</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noise:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   58</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> errors:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        fixed:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        flow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ON</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rates:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        tx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.285</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        txerr:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rx:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kB/s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mult:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.366</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        accepting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commands:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        MAVLink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        transport</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protocol:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (/dev/ttyS1 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@57600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,26),l=[n];function r(h,o,p,k,d,c){return i(),e("div",null,l)}const m=s(t,[["render",r]]);export{u as __pageData,m as default};
