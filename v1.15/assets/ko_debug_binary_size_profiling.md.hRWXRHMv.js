import{_ as s,c as i,o as a,ab as h}from"./chunks/framework.CUflZczI.js";const y=JSON.parse('{"title":"이진 크기 프로파일링","description":"","frontmatter":{},"headers":[],"relativePath":"ko/debug/binary_size_profiling.md","filePath":"ko/debug/binary_size_profiling.md"}'),n={name:"ko/debug/binary_size_profiling.md"},k=h(`<h1 id="이진-크기-프로파일링" tabindex="-1">이진 크기 프로파일링 <a class="header-anchor" href="#이진-크기-프로파일링" aria-label="Permalink to &quot;이진 크기 프로파일링&quot;">​</a></h1><p><code>bloaty_compare_master</code> 빌드 타겟을 사용하면, 변경 사항이 코드 크기에 미치는 영향을 더 잘 이해할 수 있습니다. 사용할 때 도구 체인은 특정 펌웨어의 성공적인 최신 마스터 빌드를 다운로드하고, 이를 로컬 빌드와 비교합니다(바이너리용 <a href="https://github.com/google/bloaty" target="_blank" rel="noreferrer">bloaty</a> 크기 프로파일러 사용).</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>px4_fmu-v2_default</code>가 1MB 플래시 제한에 도달할 수 있는 변경 사항을 분석합니다.</p></div><p><em>Bloaty</em> must be in your path and found at <em>cmake</em> configure time. The PX4 <a href="https://github.com/PX4/containers/blob/master/docker/Dockerfile_nuttx-bionic" target="_blank" rel="noreferrer">docker files</a> install <em>bloaty</em> as shown:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --recursive</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/google/bloaty.git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/bloaty</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/bloaty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cmake</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -GNinja</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ninja</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bloaty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bloaty</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>The example below shows how you might see the impact of removing the <em>mpu9250</em> driver from <code>px4_fmu-v2_default</code>. 먼저 드라이버없이 로컬로 빌드를 설정합니다.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diff</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">diff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a/boards/px4/fmu-v2/default.cmake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> b/boards/px4/fmu-v2/default.cmake</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 40d7778..2ce7972</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100644</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a/boards/px4/fmu-v2/default.cmake</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> b/boards/px4/fmu-v2/default.cmake</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -36,7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +36,7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_add_board</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                imu/l3gd20</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                imu/lsm303d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                imu/mpu6000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               imu/mpu9250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               #imu/mpu9250</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                #iridiumsbd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                #irlock</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                #magnetometer # all available magnetometer drivers</span></span></code></pre></div><p>그런 다음, 비교할 대상 빌드를 지정하여 make 대상을 사용합니다(이 경우 <code>px4_fmu-v2_default</code>).</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> px4_fmu-v2_default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bloaty_compare_master</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     VM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                                                                        FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SIZE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                                                                  --------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]     </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-52</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250::check_null_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unsigned</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> int</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unsigned</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-52</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]     </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-52</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250::test_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()                                                                </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-52</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]     </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-52</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250_gyro::MPU9250_gyro</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MPU9250*,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> char</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-52</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]     </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-56</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mpu9250::info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MPU9250_BUS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                                           </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]     </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-56</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mpu9250::regdump</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MPU9250_BUS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                                        </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                        -336</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]    </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-344</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250_mag::_measure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ak8963_regs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-344</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]    </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-684</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250::MPU9250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">device::Device*,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> device::Device</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> char</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> char</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cha</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -684</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]    </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-684</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250::init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()                                                                     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-684</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]   </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-1000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MPU9250::measure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()                                                                 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [DEL]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> -41.3%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   -1011</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [43 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Others]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                                                        -1011</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -41.3%</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -1.0%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1.05Ki</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Unmapped]                                                                       +24.2Ki  +0.2%</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -1.0%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -10.3Ki</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TOTAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                                                            +14.9Ki</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  +0.1%</span></span></code></pre></div><p>This shows that removing <em>mpu9250</em> from <code>px4_fmu-v2_default</code> would save 10.3 kB of flash. It also shows the sizes of different pieces of the <em>mpu9250</em> driver.</p>`,10),p=[k];function l(t,e,F,r,d,E){return a(),i("div",null,p)}const C=s(n,[["render",l]]);export{y as __pageData,C as default};
