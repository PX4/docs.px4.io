(window.webpackJsonp=window.webpackJsonp||[]).push([[1310],{2399:function(e,t,a){"use strict";a.r(t);var s=a(19),_=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"시스템-전체-재생"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#시스템-전체-재생"}},[e._v("#")]),e._v(" 시스템 전체 재생")]),e._v(" "),a("p",[e._v("Based on ORB messages, it's possible to record and replay arbitrary parts of the system.")]),e._v(" "),a("p",[e._v("Replay is useful to test the effect of different parameter values based on real data, compare different estimators, etc.")]),e._v(" "),a("h2",{attrs:{id:"전제-조건"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#전제-조건"}},[e._v("#")]),e._v(" 전제 조건")]),e._v(" "),a("p",[e._v("가장 먼저 해야 할 일은 재생 모듈을 식별하는 것입니다. 그런 다음 이 모듈에 대한 모든 입력, 즉 구독된 ORB 주제를 식별합니다. 시스템 전체 재생의 경우 센서, RC 입력, MAVLink 명령 및 파일 시스템과 같은 모든 하드웨어 입력으로 구성됩니다.")]),e._v(" "),a("p",[e._v("식별된 모든 주제는 최대 속도로 기록되어야 합니다("),a("RouterLink",{attrs:{to:"/ko/dev_log/logging.html"}},[e._v("로깅")]),e._v(" 참조). "),a("code",[e._v("ekf2")]),e._v("의 경우 이는 이미 기록된 주제의 기본 집합에 해당됩니다.")],1),e._v(" "),a("p",[e._v("재생된 모든 주제에는 자동으로 생성된 필드 "),a("code",[e._v("timestamp")]),e._v("인 단일 절대 타임스탬프만 포함되어야 합니다. 타임스탬프가 더 있는 경우 기본 타임스탬프와 관련하여 상대적이어야 합니다. 예는 "),a("a",{attrs:{href:"https://github.com/PX4/PX4-Autopilot/blob/master/msg/sensor_combined.msg",target:"_blank",rel:"noopener noreferrer"}},[e._v("sensor_combined.msg"),a("OutboundLink")],1),e._v("를 참고하십시오. 그 이유는 아래에서 설명합니다.")]),e._v(" "),a("h2",{attrs:{id:"사용법"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#사용법"}},[e._v("#")]),e._v(" 사용법")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("First, choose the file to replay, and build the target (from within the PX4-Autopilot directory):")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("replay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("absolute_path_to_log_file.ulg"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("make")]),e._v(" px4_sitl_default\n")])])]),a("p",[e._v("This will create the output in a separate build directory "),a("code",[e._v("build/px4_sitl_default_replay")]),e._v(" (so that the parameters don't interfere with normal builds). 재생을 위하여 posix SITL 빌드 대상을 선택할 수 있으며, 빌드 시스템은 "),a("code",[e._v("재생")]),e._v(" 환경변수로 재생 모드임을 알 수 있습니다.")])]),e._v(" "),a("li",[a("p",[e._v("Add ORB publisher rules file in "),a("code",[e._v("build/px4_sitl_default_replay/tmp/rootfs/orb_publisher.rules")]),e._v(". 이 파일은 어떤 모듈이 어떤 메시지를 게시하는 지를 정의합니다. 형식은 다음과 같습니다.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("restrict_topics: <topic1>, <topic2>, ..., <topicN>\nmodule: <module>\nignore_others: <true/false>\n")])])]),a("p",[e._v("주어진 주제 목록은 "),a("code",[e._v("<module>")]),e._v("(명령 이름)으로만 게시되는 것을 의미합니다. 다른 모듈에서 이러한 주제에 대한 발행은 자동으로 무시됩니다. "),a("code",[e._v("ignore_others")]),e._v("가 "),a("code",[e._v("true")]),e._v("이면, "),a("code",[e._v("<module>")]),e._v("의 다른 주제에 대한 발행은 무시됩니다.")]),e._v(" "),a("p",[e._v("재생의 경우 "),a("code",[e._v("재생")]),e._v(" 모듈만 이전에 식별된 주제 목록을 게시할 수 있기를 바랍니다. 따라서, "),a("code",[e._v("ekf2")]),e._v("를 재생하는 경우 규칙 파일은 다음과 같습니다.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("restrict_topics: sensor_combined, vehicle_gps_position, vehicle_land_detected\nmodule: replay\nignore_others: true\n")])])]),a("p",[e._v("이렇게 하면 이러한 주제를 게시하는 모듈을 재생을 위하여 비활성화할 필요가 없습니다.")])]),e._v(" "),a("li",[a("p",[e._v("선택 사항: "),a("code",[e._v("build/px4_sitl_default_replay/tmp/rootfs/replay_params.txt")]),e._v(" 파일에서 설정 매개변수를 재정의합니다. 이 파일에는 다음과 같은 "),a("code",[e._v("<param_name> <value>")]),e._v(" 목록이 포함되어야 합니다.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("EKF2_GB_NOISE 0.001\n")])])]),a("p",[e._v("기본적으로, 로그 파일의 모든 매개변수가 적용됩니다. 녹음 중에 파라미터가 변경되면, 재생 중에도 적절한 시점에 변경됩니다. "),a("code",[e._v("replay_params.txt")]),e._v("의 매개변수가 값을 재정의하고, 로그 파일의 변경사항이 적용되지 않습니다.")])]),e._v(" "),a("li",[a("p",[e._v("선택 사항: SD 카드에서 빌드 디렉토리로 "),a("code",[e._v("dataman")]),e._v(" 미션 파일을 복사합니다. 임무를 다시 플레이해야 하는 경우에만 필요합니다.")])]),e._v(" "),a("li",[a("p",[e._v("재생")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("make")]),e._v(" px4_sitl_default jmavsim\n")])])]),a("p",[e._v("그러면, 자동으로 로그 파일이 열리고 매개변수가 적용되고 재생이 시작됩니다. 완료되면, 결과를 보고하고 프로세스를 종료할 수 있습니다. 그런 다음, 새로 생성된 로그 파일을 분석할 수 있으며, 파일 이름에 "),a("code",[e._v("_replayed")]),e._v("가 추가됩니다.")]),e._v(" "),a("p",[e._v("위의 명령은 시뮬레이터도 표시하지만, 재생 중인 항목에 따라 실제로 진행 중인 작업은 표시되지 않습니다. QGC를 통해 연결하고 리플레이 중 태도 변화를 조회할 수 있습니다.")])]),e._v(" "),a("li",[a("p",[e._v("마지막으로, 일반 빌드 대상이 다시 사용되도록 환경 변수를 설정 해제합니다.")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("unset")]),e._v(" replay\n")])])])])]),e._v(" "),a("h3",{attrs:{id:"중요-참고-사항"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#중요-참고-사항"}},[e._v("#")]),e._v(" 중요 참고 사항")]),e._v(" "),a("ul",[a("li",[e._v("재생 중에 로그 파일의 모든 드롭아웃이 보고됩니다. 이는 재생에 부정적인 영향을 미치므로, 녹음 중에 드롭아웃이 발생하지 않도록 주의하여야합니다.")]),e._v(" "),a("li",[e._v("현재로서는 '실시간'으로만 재생이 가능합니다. 이는 향후 추가할 예정입니다.")]),e._v(" "),a("li",[e._v("타임스탬프가 0인 메시지는 유효하지 않은 것으로 간주되어 재생되지 않습니다.")])]),e._v(" "),a("h2",{attrs:{id:"ekf2-재생"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ekf2-재생"}},[e._v("#")]),e._v(" EKF2 재생")]),e._v(" "),a("p",[e._v("이것은 빠른 EKF2 재생을 위한 시스템 전체 재생의 전문화입니다.")]),e._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[e._v("Note")]),e._v(" "),a("p",[e._v("The recording and replay of flight logs with "),a("RouterLink",{attrs:{to:"/ko/advanced_config/tuning_the_ecl_ekf.html#running-multiple-ekf-instances"}},[e._v("multiple EKF instances")]),e._v(" is not supported. To enable recording for EKF replay you must set the parameters to enable a "),a("RouterLink",{attrs:{to:"/ko/advanced_config/tuning_the_ecl_ekf.html#running-a-single-ekf-instance"}},[e._v("single EKF instance")]),e._v(".")],1)]),e._v(" "),a("p",[e._v("자동으로 ORB 게시자 규칙을 만들고, 다음과 같이 작동합니다.")]),e._v(" "),a("ul",[a("li",[e._v("선택적으로 "),a("code",[e._v("SDLOG_MODE")]),e._v("를 1로 설정하여 부팅에서 로깅을 시작합니다.")]),e._v(" "),a("li",[e._v("로그를 기록합니다.")]),e._v(" "),a("li",[e._v("재생하려면:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("export replay_mode=ekf2\nexport replay=<abs_path_to_log.ulg>\nmake px4_sitl none\n")])])]),a("p",[e._v("다음과 같은 출력이 나온 후, 중지할 수 있습니다.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("INFO  [replay] Replay done (published 9917 msgs, 2.136 s)\n")])])]),a("p",[e._v("매개변수도 조정할 수 있습니다. They can be extracted from the log with the following (install pyulog with "),a("code",[e._v("sudo pip install pyulog")]),e._v(" first):")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ulog_params -i \"$replay\" -d ' ' | grep -e '^EKF2' > build/px4_sitl_default_replay/tmp/rootfs/replay_params.txt\n")])])]),a("p",[e._v("그런 다음 필요에 따라 파일의 매개변수를 편집하고, "),a("code",[e._v("make px4_sitl none")]),e._v("으로 재생 프로세스를 다시 시작합니다. 그러면 새 로그 파일이 생성됩니다.")]),e._v(" "),a("p",[e._v("생성된 로그의 위치는 다음과 같은 메시지와 함께 출력됩니다.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("INFO  [logger] Opened log file: rootfs/fs/microsd/log/2017-03-01/13_30_51_replayed.ulg\n")])])]),a("p",[e._v("완료되면 "),a("code",[e._v("설정되지 않은 재생")]),e._v("을 사용합니다. 재생 모드를 종료하려면 replay_mode를 설정 해제하십시오")]),e._v(" "),a("h2",{attrs:{id:"무대-뒤에서"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#무대-뒤에서"}},[e._v("#")]),e._v(" 무대 뒤에서")]),e._v(" "),a("p",[e._v("재생은 3가지 구성 요소로 이루어집니다.")]),e._v(" "),a("ul",[a("li",[e._v("재현 모듈")]),e._v(" "),a("li",[e._v("ORB 게시자 규칙")]),e._v(" "),a("li",[e._v("시간 처리")])]),e._v(" "),a("p",[e._v("재생 모듈은 로그를 읽고 기록된 것과 동일한 속도로 메시지를 게시합니다. 현재 시스템 시간과 일치하도록 각 메시지의 타임스탬프에 상수 오프셋이 추가됩니다(이것이 다른 모든 타임스탬프가 상대적이어야 하는 이유입니다). "),a("code",[e._v("replay tryapplyparams")]),e._v(" 명령은 다른 모든 모듈이 로드되기 전에 실행되고, 로그 및 사용자 설정 매개변수의 매개변수를 적용합니다. 그런 다음, 마지막 명령으로 "),a("code",[e._v("replay trystart")]),e._v("가 매개변수를 다시 적용하고, 실제 재생을 시작합니다. 환경 변수 "),a("code",[e._v("replay")]),e._v("가 설정되지 않은 경우, 두 명령 모두 아무 작업도 수행하지 않습니다.")]),e._v(" "),a("p",[e._v("ORB 게시자 규칙을 사용하면, 위에서 설명한 대로 시스템의 어느 부분을 재생할지 선택할 수 있습니다. POSIX SITL 대상에 대해서만 컴파일됩니다.")]),e._v(" "),a("p",[a("strong",[e._v("시간 처리")]),e._v("는 여전히 "),a("strong",[e._v("개방된 지점")]),e._v("이며 구현되어야 합니다.")])])}),[],!1,null,null,null);t.default=_.exports}}]);